import{j as e}from"./web3auth-ChsgSaJj.js";import{r,a as t}from"./router-zDWjfnwa.js";import{c as n,s as a,t as i,X as o,b as s,e as l,m as d,n as c,A as p,B as x}from"./index-k6dQoM7E.js";import{C as g,R as y,s as m}from"./web3authService-C4tanxeh.js";import{C as u}from"./check-HJpLFZGH.js";import{I as f}from"./info-FBfPS8Of.js";import{W as b}from"./wallet-75O3uuVP.js";import{C as h}from"./circle-alert-BtSN2k02.js";import{L as v}from"./loader-circle-DYf7zI1e.js";import{C as j}from"./copy-D8cmKkPB.js";import{A as C}from"./arrow-left-CwJBL0PZ.js";import{T as k}from"./trash-2-dDm9huAn.js";import{S as w}from"./sparkles-BD6VVOwb.js";import{H as z}from"./heart-CWswIFl1.js";import"./vendor-Cfs_Iq82.js";
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=n("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);function I({intent:t,onSelect:n,loading:a=!1,selectedMethod:i=null}){const[o,s]=r.useState(!1);t.payment_options.find(e=>"coinbase"===e.method);const l=r=>{switch(r){case"balance":default:return e.jsx(b,{size:20});case"coinbase":return e.jsx(g,{size:20});case"direct_crypto":return e.jsx(S,{size:20})}},d=(e,r)=>{const t={display:"flex",alignItems:"center",gap:"14px",padding:"16px",borderRadius:"12px",cursor:e.available&&!a?"pointer":"not-allowed",opacity:e.available?1:.5,transition:"all 0.2s ease",border:"2px solid"};return r?{...t,backgroundColor:"rgba(59, 130, 246, 0.1)",borderColor:"var(--accent, #3b82f6)"}:e.primary&&e.available?{...t,backgroundColor:"rgba(59, 130, 246, 0.05)",borderColor:"var(--border, #334155)"}:{...t,backgroundColor:"var(--bg-secondary, #1e293b)",borderColor:"var(--border, #334155)"}};return e.jsxs("div",{className:"rb-payment-options",style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"var(--bg-tertiary, #0f172a)",borderRadius:"8px",fontSize:"14px"},children:[e.jsx("span",{style:{color:"var(--text-muted, #94a3b8)"},children:"Current Balance"}),e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary, #f1f5f9)"},children:t.balance.display})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:t.payment_options.map(r=>{const t=i===r.method;return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>r.available&&!a&&n(r.method),disabled:!r.available||a,style:d(r,t),children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",borderRadius:"10px",backgroundColor:t?"var(--accent, #3b82f6)":"var(--bg-tertiary, #0f172a)",color:t?"white":"var(--text-muted, #94a3b8)"},children:l(r.method)}),e.jsxs("div",{style:{flex:1,textAlign:"left"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:"15px",color:"var(--text-primary, #f1f5f9)"},children:r.label}),r.primary&&r.available&&e.jsx("span",{style:{fontSize:"11px",fontWeight:500,padding:"2px 6px",borderRadius:"4px",backgroundColor:"rgba(34, 197, 94, 0.1)",color:"#22c55e"},children:"Recommended"})]}),e.jsx("span",{style:{fontSize:"13px",color:"var(--text-muted, #94a3b8)"},children:r.description})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"12px",backgroundColor:t?"var(--accent, #3b82f6)":"transparent",border:t?"none":"2px solid var(--border, #334155)"},children:t&&e.jsx(u,{size:14,color:"white"})})]}),"coinbase"===r.method&&r.explanation&&e.jsxs("div",{style:{marginTop:"8px",marginLeft:"54px",padding:"10px 12px",backgroundColor:"rgba(59, 130, 246, 0.05)",borderRadius:"8px",border:"1px solid rgba(59, 130, 246, 0.2)",display:"flex",alignItems:"flex-start",gap:"8px"},children:[e.jsx(f,{size:16,style:{color:"var(--accent, #3b82f6)",flexShrink:0,marginTop:"2px"}}),e.jsx("span",{style:{fontSize:"13px",color:"var(--text-secondary, #cbd5e1)",lineHeight:1.5},children:r.explanation})]})]},r.method)})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"var(--bg-tertiary, #0f172a)",borderRadius:"8px",marginTop:"8px",borderTop:"1px solid var(--border, #334155)"},children:[e.jsx("span",{style:{fontWeight:500,color:"var(--text-primary, #f1f5f9)"},children:"Total"}),e.jsx("span",{style:{fontWeight:700,fontSize:"18px",color:"var(--text-primary, #f1f5f9)"},children:t.display_total})]}),t.balance.sufficient&&t.balance.after_purchase&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",fontSize:"13px",color:"var(--text-muted, #94a3b8)"},children:[e.jsx("span",{children:"Balance after purchase"}),e.jsxs("span",{style:{fontWeight:500},children:["$",parseFloat(t.balance.after_purchase).toFixed(2)]})]})]})}function R({size:r="medium",showRefresh:t=!0,showLabel:n=!0,compact:i=!1,className:o=""}){const{displayBalance:s,loading:l,error:d,syncStatus:c,forceSync:p}=a(),x={small:{container:{fontSize:"14px",padding:i?"4px 8px":"6px 12px"},icon:14,balance:{fontSize:"14px",fontWeight:600}},medium:{container:{fontSize:"16px",padding:i?"6px 12px":"10px 16px"},icon:18,balance:{fontSize:"18px",fontWeight:700}},large:{container:{fontSize:"20px",padding:i?"8px 16px":"14px 24px"},icon:24,balance:{fontSize:"24px",fontWeight:700}}}[r];return l?e.jsxs("div",{className:`rb-balance-display rb-balance-display--loading ${o}`,style:{display:"inline-flex",alignItems:"center",gap:"8px",...x.container,backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px",color:"var(--text-muted, #94a3b8)"},children:[e.jsx(y,{size:x.icon,style:{animation:"spin 1s linear infinite"}}),e.jsx("span",{children:"Loading..."})]}):"no_wallet"===c?e.jsxs("div",{className:`rb-balance-display rb-balance-display--no-wallet ${o}`,style:{display:"inline-flex",alignItems:"center",gap:"8px",...x.container,backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px",color:"var(--text-muted, #94a3b8)"},children:[e.jsx(b,{size:x.icon}),e.jsx("span",{children:"No wallet connected"})]}):d&&!s?e.jsxs("div",{className:`rb-balance-display rb-balance-display--error ${o}`,style:{display:"inline-flex",alignItems:"center",gap:"8px",...x.container,backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"8px",color:"var(--error, #ef4444)"},children:[e.jsx(h,{size:x.icon}),e.jsx("span",{children:"Balance unavailable"})]}):e.jsxs("div",{className:`rb-balance-display ${o}`,style:{display:"inline-flex",alignItems:"center",gap:i?"6px":"10px",...x.container,backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px",border:"1px solid var(--border, #334155)"},children:[e.jsx(b,{size:x.icon,style:{color:"var(--accent, #3b82f6)"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[n&&!i&&e.jsx("span",{style:{fontSize:"12px",color:"var(--text-muted, #94a3b8)",lineHeight:1},children:"renaissBlock Balance"}),e.jsx("span",{style:{...x.balance,color:"var(--text-primary, #f1f5f9)"},children:s||"$0.00"})]}),t&&e.jsx("button",{onClick:p,disabled:"syncing"===c,title:"Refresh balance",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"4px",backgroundColor:"transparent",border:"none",borderRadius:"4px",cursor:"syncing"===c?"not-allowed":"pointer",color:"var(--text-muted, #94a3b8)",opacity:"syncing"===c?.5:1,transition:"color 0.2s"},onMouseEnter:e=>{"syncing"!==c&&(e.currentTarget.style.color="var(--accent, #3b82f6)")},onMouseLeave:e=>{e.currentTarget.style.color="var(--text-muted, #94a3b8)"},children:e.jsx(y,{size:x.icon-2,style:{animation:"syncing"===c?"spin 1s linear infinite":"none"}})}),e.jsx("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      "})]})}function _({intentId:t,onSuccess:n,onCancel:l,onError:d}){const[c,p]=r.useState("loading"),[x,m]=r.useState(null),[u,f]=r.useState(null),[b,j]=r.useState(null),C=r.useRef(null),{forceSync:k}=a();r.useEffect(()=>{if(document.getElementById("coinbase-onramp-sdk"))return;const e=document.createElement("script");return e.id="coinbase-onramp-sdk",e.src="https://pay.coinbase.com/sdk/v1/cbpay.js",e.async=!0,document.body.appendChild(e),()=>{}},[]),r.useEffect(()=>{(async()=>{try{p("loading");const e=await i.initiateCoinbaseOnramp(t);m(e),p("ready")}catch(e){const r=e instanceof Error?e.message:"Failed to initialize payment";f(r),p("error"),d(r)}})()},[t,d]);const w=r.useCallback(e=>{const r=setInterval(async()=>{try{const t=await i.getCoinbaseStatus(e);"completed"===t.status?(clearInterval(r),j(null),p("success"),await k(),await i.completeCoinbaseOnramp(e),setTimeout(()=>{n()},1500)):"failed"===t.status&&(clearInterval(r),j(null),f(t.failure_reason||"Payment failed"),p("error"))}catch(t){}},3e3);j(r)},[k,n]);r.useEffect(()=>()=>{b&&clearInterval(b),C.current&&C.current.destroy()},[b]);const z=r.useCallback(()=>{if(!x||!window.CBPay)return f("Payment widget not ready"),void p("error");const{widget_config:e}=x;try{C.current=window.CBPay.create({appId:e.appId,widgetParameters:{destinationWallets:e.destinationWallets,presetCryptoAmount:e.presetCryptoAmount,defaultAsset:e.defaultAsset,defaultNetwork:e.defaultNetwork,defaultExperience:e.defaultExperience,handlingRequestedUrls:e.handlingRequestedUrls,partnerUserId:e.partnerUserId},onSuccess:()=>{p("processing"),w(x.transaction_id)},onExit:e=>{"user_exit"!==(null==e?void 0:e.reason)&&"ready"!==c||l()},onEvent:e=>{if("error"===e.eventName){const r=e.eventData;f((null==r?void 0:r.message)||"Payment error occurred"),p("error")}}}),C.current.open()}catch(r){const e=r instanceof Error?r.message:"Failed to open payment widget";f(e),p("error")}},[x,l,w,c]);return r.useEffect(()=>{if("ready"===c&&window.CBPay){const e=setTimeout(()=>{z()},500);return()=>clearTimeout(e)}},[c,z]),e.jsxs("div",{className:"rb-coinbase-onramp",style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:[e.jsxs("div",{style:{backgroundColor:"var(--bg-primary, #0f172a)",borderRadius:"16px",padding:"32px",maxWidth:"420px",width:"100%",border:"1px solid var(--border, #334155)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:600,color:"var(--text-primary, #f1f5f9)"},children:"Add Funds"}),"processing"!==c&&"success"!==c&&e.jsx("button",{onClick:l,style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",backgroundColor:"transparent",border:"none",borderRadius:"8px",cursor:"pointer",color:"var(--text-muted, #94a3b8)"},children:e.jsx(o,{size:20})})]}),e.jsxs("div",{style:{textAlign:"center"},children:["loading"===c&&e.jsxs(e.Fragment,{children:[e.jsx(v,{size:48,style:{color:"var(--accent, #3b82f6)",animation:"spin 1s linear infinite",marginBottom:"16px"}}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:"Preparing secure payment..."})]}),"ready"===c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"16px",backgroundColor:"rgba(59, 130, 246, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(g,{size:32,style:{color:"var(--accent, #3b82f6)"}})}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:"0 0 16px"},children:"Opening secure payment window..."}),x&&e.jsx("p",{style:{fontSize:"14px",color:"var(--text-muted, #94a3b8)",margin:0,padding:"12px",backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px"},children:x.explanation}),e.jsxs("button",{onClick:z,style:{marginTop:"16px",padding:"12px 24px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",margin:"16px auto 0"},children:[e.jsx(g,{size:18}),"Open Payment Window"]})]}),"processing"===c&&e.jsxs(e.Fragment,{children:[e.jsx(v,{size:48,style:{color:"var(--accent, #3b82f6)",animation:"spin 1s linear infinite",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Processing Payment"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:"Your funds are being added to your account..."}),e.jsx("p",{style:{fontSize:"13px",color:"var(--text-muted, #94a3b8)",margin:"16px 0 0"},children:"This usually takes 10-30 seconds"})]}),"success"===c&&e.jsxs(e.Fragment,{children:[e.jsx(s,{size:48,style:{color:"#22c55e",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Funds Added!"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:"Completing your purchase..."})]}),"error"===c&&e.jsxs(e.Fragment,{children:[e.jsx(h,{size:48,style:{color:"var(--error, #ef4444)",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Payment Issue"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:"0 0 16px"},children:u||"Something went wrong with your payment."}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsxs("button",{onClick:()=>{p("loading"),f(null),i.initiateCoinbaseOnramp(t).then(e=>{m(e),p("ready")}).catch(e=>{f(e.message),p("error")})},style:{padding:"10px 20px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(y,{size:16}),"Try Again"]}),e.jsx("button",{onClick:l,style:{padding:"10px 20px",backgroundColor:"var(--bg-secondary, #1e293b)",color:"var(--text-primary, #f1f5f9)",border:"1px solid var(--border, #334155)",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Cancel"})]})]})]})]}),e.jsx("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      "})]})}function W({intentId:t,onSuccess:n,onCancel:a,onError:d}){const[c,p]=r.useState("loading"),[x,g]=r.useState(null),[y,m]=r.useState(null),[f,b]=r.useState(null),[C,k]=r.useState(0),w=r.useRef(null),z=r.useRef(null);r.useEffect(()=>{(async()=>{try{p("loading");const e=await i.initiateDirectCrypto(t);g(e),k(e.expires_in_seconds),p("awaiting")}catch(e){const r=e instanceof Error?e.message:"Failed to initialize payment";m(r),p("error"),d(r)}})()},[t,d]);const S=r.useCallback(async()=>{if(x)try{const e=await i.getDirectCryptoStatus(x.payment_id);switch(e.status){case"detected":p("detected");break;case"confirming":p("confirming");break;case"completed":p("completed"),w.current&&clearInterval(w.current),setTimeout(()=>{n()},1500);break;case"expired":p("expired"),w.current&&clearInterval(w.current);break;case"failed":p("error"),m(e.failure_reason||"Payment failed"),w.current&&clearInterval(w.current)}}catch(e){}},[x,n]);r.useEffect(()=>{if("awaiting"===c||"detected"===c||"confirming"===c)return w.current=setInterval(S,5e3),()=>{w.current&&clearInterval(w.current)}},[c,S]),r.useEffect(()=>{if("awaiting"===c&&C>0)return z.current=setInterval(()=>{k(e=>e<=1?(p("expired"),z.current&&clearInterval(z.current),0):e-1)},1e3),()=>{z.current&&clearInterval(z.current)}},[c,C]),r.useEffect(()=>()=>{w.current&&clearInterval(w.current),z.current&&clearInterval(z.current)},[]);const I=async(e,r)=>{try{await navigator.clipboard.writeText(e),b(r),setTimeout(()=>b(null),2e3)}catch(t){}};return e.jsxs("div",{className:"rb-direct-crypto-modal",style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:[e.jsxs("div",{style:{backgroundColor:"var(--bg-primary, #0f172a)",borderRadius:"16px",padding:"32px",maxWidth:"480px",width:"100%",maxHeight:"90vh",overflow:"auto",border:"1px solid var(--border, #334155)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:600,color:"var(--text-primary, #f1f5f9)"},children:"Pay with Crypto Wallet"}),("awaiting"===c||"loading"===c||"error"===c||"expired"===c)&&e.jsx("button",{onClick:async()=>{if(x&&"awaiting"===c)try{await i.cancelDirectCrypto(x.payment_id)}catch(e){}a()},style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",backgroundColor:"transparent",border:"none",borderRadius:"8px",cursor:"pointer",color:"var(--text-muted, #94a3b8)"},children:e.jsx(o,{size:20})})]}),"loading"===c&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(v,{size:48,style:{color:"var(--accent, #3b82f6)",animation:"spin 1s linear infinite",marginBottom:"16px"}}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:"Generating payment details..."})]}),"awaiting"===c&&x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"12px",backgroundColor:C<60?"rgba(239, 68, 68, 0.1)":"var(--bg-secondary, #1e293b)",borderRadius:"8px",marginBottom:"20px",color:C<60?"var(--error, #ef4444)":"var(--text-secondary, #cbd5e1)"},children:[e.jsx(l,{size:18}),e.jsxs("span",{style:{fontSize:"14px"},children:["Payment expires in ",e.jsx("strong",{children:(R=C,`${Math.floor(R/60)}:${(R%60).toString().padStart(2,"0")}`)})]})]}),e.jsx("p",{style:{fontSize:"14px",color:"var(--text-secondary, #cbd5e1)",marginBottom:"20px",lineHeight:1.6},children:x.instructions}),x.qr_code_data&&e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"24px"},children:e.jsx("div",{style:{padding:"16px",backgroundColor:"white",borderRadius:"12px"},children:e.jsx("img",{src:x.qr_code_data,alt:"Payment QR Code",style:{width:"160px",height:"160px",display:"block"}})})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,color:"var(--text-muted, #94a3b8)",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Amount (USDC)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px",border:"1px solid var(--border, #334155)"},children:[e.jsx("span",{style:{flex:1,fontSize:"18px",fontWeight:700,color:"var(--text-primary, #f1f5f9)"},children:x.display_amount}),e.jsxs("button",{onClick:()=>I(x.expected_amount,"amount"),style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 10px",backgroundColor:"amount"===f?"rgba(34, 197, 94, 0.1)":"var(--bg-tertiary, #0f172a)",border:"none",borderRadius:"6px",cursor:"pointer",color:"amount"===f?"#22c55e":"var(--text-muted, #94a3b8)",fontSize:"13px"},children:["amount"===f?e.jsx(u,{size:14}):e.jsx(j,{size:14}),"amount"===f?"Copied":"Copy"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,color:"var(--text-muted, #94a3b8)",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Send To Address"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px",border:"1px solid var(--border, #334155)"},children:[e.jsx("span",{style:{flex:1,fontSize:"13px",fontFamily:"monospace",color:"var(--text-primary, #f1f5f9)",wordBreak:"break-all"},children:x.payment_address}),e.jsxs("button",{onClick:()=>I(x.payment_address,"address"),style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 10px",backgroundColor:"address"===f?"rgba(34, 197, 94, 0.1)":"var(--bg-tertiary, #0f172a)",border:"none",borderRadius:"6px",cursor:"pointer",color:"address"===f?"#22c55e":"var(--text-muted, #94a3b8)",fontSize:"13px",flexShrink:0},children:["address"===f?e.jsx(u,{size:14}):e.jsx(j,{size:14}),"address"===f?"Copied":"Copy"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:500,color:"var(--text-muted, #94a3b8)",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Memo (Required)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",backgroundColor:"rgba(234, 179, 8, 0.1)",borderRadius:"8px",border:"1px solid rgba(234, 179, 8, 0.3)"},children:[e.jsx("span",{style:{flex:1,fontSize:"16px",fontWeight:600,fontFamily:"monospace",color:"var(--text-primary, #f1f5f9)"},children:x.payment_memo}),e.jsxs("button",{onClick:()=>I(x.payment_memo,"memo"),style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 10px",backgroundColor:"memo"===f?"rgba(34, 197, 94, 0.1)":"var(--bg-tertiary, #0f172a)",border:"none",borderRadius:"6px",cursor:"pointer",color:"memo"===f?"#22c55e":"var(--text-muted, #94a3b8)",fontSize:"13px",flexShrink:0},children:["memo"===f?e.jsx(u,{size:14}):e.jsx(j,{size:14}),"memo"===f?"Copied":"Copy"]})]}),e.jsx("p",{style:{fontSize:"12px",color:"#eab308",margin:"8px 0 0"},children:"Include this memo in your transaction to identify your payment"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"24px",padding:"12px",backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"8px",color:"var(--text-muted, #94a3b8)",fontSize:"14px"},children:[e.jsx(v,{size:16,style:{animation:"spin 1s linear infinite"}}),"Waiting for payment..."]})]}),("detected"===c||"confirming"===c)&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(v,{size:48,style:{color:"#22c55e",animation:"spin 1s linear infinite",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"detected"===c?"Payment Detected!":"Confirming Transaction..."}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:"detected"===c?"We found your payment. Confirming on the blockchain...":"Almost done. Finalizing your purchase..."})]}),"completed"===c&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(s,{size:48,style:{color:"#22c55e",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Payment Complete!"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:"Your purchase is being processed..."})]}),"expired"===c&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(l,{size:48,style:{color:"var(--text-muted, #94a3b8)",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Payment Expired"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:"0 0 16px"},children:"The payment window has expired. Please try again."}),e.jsx("button",{onClick:a,style:{padding:"12px 24px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:600,cursor:"pointer"},children:"Start Over"})]}),"error"===c&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[e.jsx(h,{size:48,style:{color:"var(--error, #ef4444)",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Payment Issue"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:"0 0 16px"},children:y||"Something went wrong with your payment."}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{p("loading"),m(null),i.initiateDirectCrypto(t).then(e=>{g(e),k(e.expires_in_seconds),p("awaiting")}).catch(e=>{m(e.message),p("error")})},style:{padding:"10px 20px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Try Again"}),e.jsx("button",{onClick:a,style:{padding:"10px 20px",backgroundColor:"var(--bg-secondary, #1e293b)",color:"var(--text-primary, #f1f5f9)",border:"1px solid var(--border, #334155)",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Cancel"})]})]})]}),e.jsx("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      "})]});var R}function B(){const{cart:n,loading:s,error:l,removeFromCart:g,clearCart:y,refreshCart:u}=d(),{forceSync:f}=a(),[j,S]=r.useState(null),B=t(),[T,P]=r.useState("idle"),[E,A]=r.useState(null),[F,M]=r.useState(null),[N,$]=r.useState(null),[D,L]=r.useState("");async function O(){await y(),await f(),P("success")}function q(){P("idle"),A(null),M(null)}function H(e){$(e),P("error")}function U(){P("idle"),A(null),M(null),$(null)}if(s)return e.jsxs("div",{className:"rb-cart-page rb-cart-page--loading",style:{padding:"60px 20px",textAlign:"center",color:"var(--text-muted, #94a3b8)"},children:[e.jsx(c,{size:48,style:{opacity:.5,marginBottom:"16px"}}),e.jsx("div",{children:"Loading cart..."})]});if(!n||0===n.item_count)return e.jsxs("div",{className:"rb-cart-page rb-cart-page--empty",style:{padding:"60px 20px",textAlign:"center",maxWidth:"500px",margin:"0 auto"},children:[e.jsx(c,{size:64,style:{opacity:.3,marginBottom:"24px"}}),e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,marginBottom:"12px"},children:"Your Cart is Empty"}),e.jsx("p",{style:{color:"var(--text-muted, #94a3b8)",marginBottom:"32px"},children:"Browse chapters and add them to your cart to purchase multiple items at once."}),e.jsxs("button",{onClick:()=>B("/"),style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"14px 28px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:600,cursor:"pointer"},children:[e.jsx(C,{size:18}),"Browse Marketplace"]})]});const Y=parseFloat(n.savings_vs_individual||"0")>0;return e.jsxs("div",{className:"rb-cart-page",style:{maxWidth:"900px",margin:"0 auto",padding:"40px 20px"},children:[e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h1",{style:{fontSize:"28px",fontWeight:700,marginBottom:"8px"},children:"Shopping Cart"}),e.jsxs("p",{style:{color:"var(--text-muted, #94a3b8)"},children:[n.item_count," ",1===n.item_count?"item":"items"," in your cart"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"32px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[n.items.map(r=>{let t=null;return r.cover_url&&(t=r.cover_url.startsWith("http")?r.cover_url:`${p}${r.cover_url}`),e.jsxs("div",{style:{display:"flex",gap:"16px",padding:"16px",backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"12px",border:"1px solid var(--border, #334155)",opacity:j===r.id?.5:1,transition:"opacity 0.2s ease"},children:[e.jsx("div",{style:{width:"80px",height:"100px",flexShrink:0,borderRadius:"8px",overflow:"hidden",backgroundColor:"var(--bg-tertiary, #0f172a)",display:"flex",alignItems:"center",justifyContent:"center"},children:t?e.jsx("img",{src:t,alt:r.title,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(x,{size:32,style:{color:"var(--text-muted, #64748b)",opacity:.5}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.title}),r.book_title&&e.jsxs("p",{style:{fontSize:"13px",color:"var(--text-muted, #94a3b8)",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[r.book_title," â€¢ Chapter ",r.chapter_order]}),e.jsxs("p",{style:{fontSize:"13px",color:"var(--text-muted, #64748b)"},children:["By @",r.creator_username]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"space-between",flexShrink:0},children:[e.jsxs("span",{style:{fontSize:"18px",fontWeight:600,color:"var(--accent, #3b82f6)"},children:["$",r.unit_price]}),e.jsx("button",{onClick:()=>async function(e){S(e),await g(e),S(null)}(r.id),disabled:j===r.id,style:{padding:"8px",backgroundColor:"transparent",color:"var(--text-error, #ef4444)",border:"1px solid var(--text-error, #ef4444)",borderRadius:"8px",cursor:"pointer",opacity:j===r.id?.5:1},title:"Remove from cart",children:e.jsx(k,{size:16})})]})]},r.id)}),e.jsx("button",{onClick:async function(){window.confirm("Remove all items from your cart?")&&await y()},style:{alignSelf:"flex-start",padding:"8px 16px",backgroundColor:"transparent",color:"var(--text-muted, #94a3b8)",border:"1px solid var(--border, #334155)",borderRadius:"6px",fontSize:"13px",cursor:"pointer",marginTop:"8px"},children:"Clear Cart"})]}),e.jsxs("div",{style:{padding:"24px",backgroundColor:"var(--bg-secondary, #1e293b)",borderRadius:"16px",border:"1px solid var(--border, #334155)",height:"fit-content",position:"sticky",top:"100px"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:600,marginBottom:"20px"},children:"Order Summary"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("span",{style:{color:"var(--text-muted, #94a3b8)"},children:[n.item_count," ",1===n.item_count?"item":"items"]}),e.jsxs("span",{children:["$",n.subtotal]})]}),Y&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 12px",backgroundColor:"var(--bg-success, #052e16)",borderRadius:"8px",border:"1px solid var(--border-success, #16a34a)"},children:[e.jsxs("span",{style:{color:"var(--text-success, #4ade80)",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(w,{size:14}),"Cart Savings"]}),e.jsxs("span",{style:{color:"var(--text-success, #4ade80)",fontWeight:600},children:["-$",n.savings_vs_individual]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"16px",borderTop:"1px solid var(--border, #334155)",fontSize:"20px",fontWeight:700},children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{style:{color:"var(--accent, #3b82f6)"},children:["$",n.subtotal]})]})]}),l&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",padding:"12px",backgroundColor:"var(--bg-error, #450a0a)",border:"1px solid var(--border-error, #ef4444)",borderRadius:"8px",color:"var(--text-error, #fca5a5)",fontSize:"14px"},children:[e.jsx(h,{size:16}),l]}),e.jsx("button",{onClick:async function(){P("creating_intent"),$(null);try{const e=await i.createIntent({cart:!0});A(e),P("selecting_method")}catch(e){const r=e instanceof Error?e.message:"Failed to start checkout";$(r),P("error")}},disabled:"idle"!==T,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",padding:"16px 24px",backgroundColor:"idle"!==T?"var(--bg-disabled, #475569)":"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:600,cursor:"idle"!==T?"not-allowed":"pointer",transition:"background-color 0.2s ease"},children:"creating_intent"===T?e.jsxs(e.Fragment,{children:[e.jsx(v,{size:20,style:{animation:"spin 1s linear infinite"}}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{size:20}),"Checkout - $",n.subtotal]})}),e.jsxs("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"var(--bg-tertiary, #0f172a)",borderRadius:"10px",fontSize:"13px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(z,{size:16,style:{color:"var(--text-success, #10b981)"}}),e.jsx("span",{style:{fontWeight:600,color:"var(--text-success, #10b981)"},children:"Supporting Creators"})]}),e.jsx("p",{style:{color:"var(--text-muted, #94a3b8)",lineHeight:"1.5"},children:"Creators receive 90% of each item's price. Your purchase directly supports the creators you love."})]}),e.jsx("div",{style:{marginTop:"12px"},children:e.jsx(R,{size:"small",showLabel:!0,compact:!1})})]})]}),"selecting_method"===T&&E&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:e.jsxs("div",{style:{backgroundColor:"var(--bg-primary, #0f172a)",borderRadius:"16px",padding:"32px",maxWidth:"480px",width:"100%",maxHeight:"90vh",overflow:"auto",border:"1px solid var(--border, #334155)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:600,color:"var(--text-primary, #f1f5f9)"},children:"Choose Payment Method"}),e.jsx("button",{onClick:q,style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",backgroundColor:"transparent",border:"none",borderRadius:"8px",cursor:"pointer",color:"var(--text-muted, #94a3b8)"},children:e.jsx(o,{size:20})})]}),e.jsx(I,{intent:E,onSelect:async function(e){if(E){M(e),$(null);try{await i.selectPaymentMethod(E.intent_id,e),"balance"===e?await async function(){if(!E)return;P("processing_balance"),L("Preparing transaction...");try{const e=await i.payWithBalance(E.intent_id);L("Please approve the transaction in your wallet...");const{signedTransaction:r,userSignatureIndex:t}=await m(e.serialized_transaction);L("Submitting payment..."),await i.submitSponsoredPayment(E.intent_id,r,t),L("Purchase complete!"),await y(),await f(),P("success")}catch(e){const r=e instanceof Error?e.message:"Payment failed";$(r),P("error")}}():"coinbase"===e?P("coinbase"):"direct_crypto"===e&&P("direct_crypto")}catch(r){const e=r instanceof Error?r.message:"Failed to select payment method";$(e),P("error")}}},loading:!1,selectedMethod:F})]})}),"processing_balance"===T&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:e.jsxs("div",{style:{backgroundColor:"var(--bg-primary, #0f172a)",borderRadius:"16px",padding:"32px",maxWidth:"400px",width:"100%",textAlign:"center",border:"1px solid var(--border, #334155)"},children:[e.jsx(v,{size:48,style:{color:"var(--accent, #3b82f6)",animation:"spin 1s linear infinite",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Processing Payment"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:0},children:D})]})}),"coinbase"===T&&E&&e.jsx(_,{intentId:E.intent_id,onSuccess:O,onCancel:q,onError:H}),"direct_crypto"===T&&E&&e.jsx(W,{intentId:E.intent_id,onSuccess:O,onCancel:q,onError:H}),"success"===T&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:e.jsxs("div",{style:{backgroundColor:"var(--bg-primary, #0f172a)",borderRadius:"16px",padding:"32px",maxWidth:"400px",width:"100%",textAlign:"center",border:"1px solid var(--border, #334155)"},children:[e.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",backgroundColor:"rgba(34, 197, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(z,{size:32,style:{color:"#22c55e"}})}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"20px",margin:"0 0 8px"},children:"Purchase Complete!"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:"0 0 24px"},children:"Your items have been added to your library."}),e.jsx("button",{onClick:()=>{U(),B("/dashboard")},style:{padding:"12px 24px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:600,cursor:"pointer"},children:"Go to Library"})]})}),"error"===T&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:e.jsxs("div",{style:{backgroundColor:"var(--bg-primary, #0f172a)",borderRadius:"16px",padding:"32px",maxWidth:"400px",width:"100%",textAlign:"center",border:"1px solid var(--border, #334155)"},children:[e.jsx(h,{size:48,style:{color:"var(--error, #ef4444)",marginBottom:"16px"}}),e.jsx("h3",{style:{color:"var(--text-primary, #f1f5f9)",fontSize:"18px",margin:"0 0 8px"},children:"Payment Failed"}),e.jsx("p",{style:{color:"var(--text-secondary, #cbd5e1)",margin:"0 0 24px"},children:N||"Something went wrong with your payment."}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{$(null),P("selecting_method")},style:{padding:"10px 20px",backgroundColor:"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Try Again"}),e.jsx("button",{onClick:U,style:{padding:"10px 20px",backgroundColor:"var(--bg-secondary, #1e293b)",color:"var(--text-primary, #f1f5f9)",border:"1px solid var(--border, #334155)",borderRadius:"8px",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Cancel"})]})]})}),e.jsx("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      "})]})}export{B as default};
