const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-BgEIjoZf.js","assets/web3auth-Sk1I85Hw.js","assets/router-XSTgIKKd.js","assets/vendor-Cfs_Iq82.js","assets/VideoCard-B8CP3G6Z.js","assets/star-S9Nv1KnN.js","assets/eye-BuwHLAKC.js","assets/thumbs-up-DjSwz5Ef.js","assets/SearchPage-CyHB7p29.js","assets/StudioPage-C7FCRiN5.js","assets/layers-D6_W8uKa.js","assets/video-CPtOMCYC.js","assets/CollaborativeComicEditor-lH-C2tVx.js","assets/loader-circle-PBM_fOeR.js","assets/trash-2-DS2E6x2f.js","assets/regionCalculator-D3m0QDUE.js","assets/grid-3x3-C7FbZRSc.js","assets/settings-DcuNAi1C.js","assets/check-BF3xcS49.js","assets/plus-BjL_UqUi.js","assets/type-CnmuKB2d.js","assets/message-circle-D1A-Y7KC.js","assets/CollaborativeComicEditor-CkbfgUCq.css","assets/file-text-DCxmHtnU.js","assets/PreviewModal-BII7evui.js","assets/socialApi-CcCPP1SF.js","assets/pen-CmvC40AR.js","assets/send-DeD3KWT3.js","assets/circle-alert-Cf_HOCGa.js","assets/ComicPageRenderer-BI3ujhV2.js","assets/copy-Dxkxg0uX.js","assets/twitter-i_T3fBBR.js","assets/external-link-Bf4RgLAk.js","assets/loader-DXIu036y.js","assets/triangle-alert-DMTlciQx.js","assets/info-4j47LV_N.js","assets/arrow-left-CamZ81jU.js","assets/shield-DieSQ5jm.js","assets/StudioPage-KxyYeuh_.css","assets/DashboardPage-BROTydW2.js","assets/ProfilePageRedesigned-C15O8B_w.js","assets/BalanceDisplay-CaTP52fh.js","assets/refresh-cw-CA6L4ld8.js","assets/wallet-V5f0XhLb.js","assets/user-check-Bt7OSCC8.js","assets/bridgeApi-DoF7GnfB.js","assets/arrow-right-C9HgPq3f.js","assets/map-pin-CwjkSkEi.js","assets/square-BoK4_8Us.js","assets/briefcase-C3g6uHKD.js","assets/palette-BGvwPv1F.js","assets/AuthPage-DFehIRyj.js","assets/WalletInfoPage-yYhiKXfn.js","assets/BetaLanding-CHzm5c2D.js","assets/sparkles-C-cNTdBZ.js","assets/heart-CpUdsE7y.js","assets/BetaLanding-BhmzUrnj.css","assets/CollaboratorsPage-BkpmoC_n.js","assets/InviteModal-BN6wWB3D.js","assets/volume-2-CzMBWjF2.js","assets/PublicProfilePage-Bz_Xqv8R.js","assets/RatingForm-CO_eCL4h.js","assets/user-plus-CnFsGmSl.js","assets/book-CcGS2lpy.js","assets/ContentDetail-BxAG7xvt.js","assets/CopyrightNotice-QO9KeZVg.js","assets/PurchaseSuccessPage-D_gTp71O.js","assets/ReaderPage-BqSOrlxx.js","assets/CollaborationDashboard-BYc1OOwl.js","assets/CollaborativeProjectPage-BohqWT6b.js","assets/calendar-BxENfbkC.js","assets/circle-check-BppJ4jWe.js","assets/NotificationsPage-DfNdBSW7.js","assets/FollowingFeedPage-CmtHBGzH.js","assets/CartPage-BiyDWFDM.js","assets/credit-card-DVWN-qQ5.js","assets/CartSuccessPage-DHHeBa7I.js","assets/PayoutSettingsPage-BzK_rouj.js","assets/TermsOfServicePage-BaQ74S7m.js","assets/LegalPageLayout-DYtvQ4Uq.js","assets/PrivacyPolicyPage-CC2DCYaw.js","assets/ContentPolicyPage-Bdd5jst3.js","assets/DMCAPolicyPage-DNsdqpwJ.js","assets/CreatorAgreementPage-CvfDGYRa.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,n,a)=>((t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a)(t,"symbol"!=typeof n?n+"":n,a);import{B as n,p as a,e as i,j as o,P as r,a as s,L as l,S as c,V as d,b as p,C as u,c as h,W as f,d as g,f as y,T as x,_ as m,R as b}from"./web3auth-Sk1I85Hw.js";import{r as j,L as v,u as w,N as k,a as S,R as C,b as T,c as R,B as _}from"./router-XSTgIKKd.js";import"./vendor-Cfs_Iq82.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const E="undefined"!=typeof globalThis?globalThis:window;if(E.global||(E.global=E),E.Buffer||(E.Buffer=n),E.process||(E.process=a),E.process&&!E.process.on){const e=new i.EventEmitter;E.process.on=e.on.bind(e),E.process.once=e.once.bind(e),E.process.off=e.off.bind(e),E.process.emit=e.emit.bind(e),E.process.removeListener=e.removeListener.bind(e),E.process.removeAllListeners=e.removeAllListeners.bind(e),E.process.listeners=e.listeners.bind(e)}E.process.env||(E.process.env={});const z="https://api.renaissblock.com";const $={async getLibrary(){const e=await fetch(`${z}/api/library/`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch library: ${e.statusText}`);return e.json()},async getFullContent(e){const t=await fetch(`${z}/api/content/${e}/full/`,{method:"GET",credentials:"include"});if(!t.ok){if(403===t.status)throw new Error("You do not own this content");throw new Error(`Failed to fetch content: ${t.statusText}`)}return t.json()},async updateProgress(e,t,n=""){const a=await async function(){try{const e=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch(e){return""}}(),i=await fetch(`${z}/api/reading-progress/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":a,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({content_id:e,progress_percentage:t,last_position:n})});if(!i.ok)throw new Error(`Failed to update progress: ${i.statusText}`);return i.json()},async getProgress(e){const t=await fetch(`${z}/api/reading-progress/${e}/`,{method:"GET",credentials:"include"});if(!t.ok)throw new Error(`Failed to fetch progress: ${t.statusText}`);return t.json()},async getAllProgress(){const e=await fetch(`${z}/api/reading-progress/`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch all progress: ${e.statusText}`);return e.json()},async getComicReaderData(e){const t=await fetch(`${z}/api/content/${e}/comic-reader-data/`,{method:"GET",credentials:"include"});if(!t.ok){if(403===t.status)throw new Error("You do not own this content");if(404===t.status)throw new Error("Comic data not found");throw new Error(`Failed to fetch comic data: ${t.statusText}`)}return t.json()},async getComicPreviewData(e){const t=await fetch(`${z}/api/content/${e}/comic-preview/`,{method:"GET",credentials:"include"});if(!t.ok){if(404===t.status)throw new Error("Comic data not found");throw new Error(`Failed to fetch comic preview: ${t.statusText}`)}return t.json()}};const P=j.memo(function({item:e,onClick:t}){const n=Math.round(e.progress),a=function(e){if(!e)return null;const t=new Date(e),n=(new Date).getTime()-t.getTime(),a=Math.floor(n/1e3),i=Math.floor(a/60),o=Math.floor(i/60),r=Math.floor(o/24);return a<60?"Just now":i<60?`${i}m ago`:o<24?`${o}h ago`:1===r?"Yesterday":r<7?`${r}d ago`:r<30?`${Math.floor(r/7)}w ago`:`${Math.floor(r/30)}mo ago`}(e.last_read_at);return o.jsxs(v,{to:`/reader/${e.id}`,className:"library-item-card",onClick:t,style:{display:"flex",gap:12,padding:12,background:"#0b1220",border:"1px solid #2a3444",borderRadius:8,textDecoration:"none",color:"inherit",transition:"all 0.2s ease",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.background="#111827",e.currentTarget.style.borderColor="#374151"},onMouseLeave:e=>{e.currentTarget.style.background="#0b1220",e.currentTarget.style.borderColor="#2a3444"},children:[o.jsxs("div",{style:{position:"relative",width:80,height:80,flexShrink:0,borderRadius:6,overflow:"hidden",background:"#0e1320"},children:[o.jsx("img",{src:e.thumbnail||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="80" height="80"%3E%3Crect fill="%23111827" width="80" height="80"/%3E%3Ctext fill="%2394a3b8" font-family="sans-serif" font-size="12" x="50%25" y="50%25" text-anchor="middle" dominant-baseline="middle"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E',alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="80" height="80"%3E%3Crect fill="%23111827" width="80" height="80"/%3E%3Ctext fill="%2394a3b8" font-family="sans-serif" font-size="12" x="50%25" y="50%25" text-anchor="middle" dominant-baseline="middle"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E'}}),o.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:4,background:"rgba(0,0,0,0.5)"},children:o.jsx("div",{style:{height:"100%",width:`${e.progress}%`,background:100===n?"#10b981":"#f59e0b",transition:"width 0.3s ease"}})})]}),o.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",minWidth:0},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,fontSize:14,color:"#e5e7eb",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title}),o.jsx("div",{style:{fontSize:12,color:"#94a3b8"},children:e.creator})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{fontSize:11,color:100===n?"#10b981":n>0?"#f59e0b":"#64748b",fontWeight:600},children:100===n?"Finished":n>0?`${n}% complete`:"Not started"}),a&&n>0&&o.jsxs("span",{style:{fontSize:10,color:"#64748b"},children:["Â· ",a]})]})]})]})}),L=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},X=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),M=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var I={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=j.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:i="",children:o,iconNode:r,...s},l)=>j.createElement("svg",{ref:l,...I,width:t,height:t,stroke:e,strokeWidth:a?24*Number(n)/Number(t):n,className:X("lucide",i),...!o&&!M(s)&&{"aria-hidden":"true"},...s},[...r.map(([e,t])=>j.createElement(e,t)),...Array.isArray(o)?o:[o]])),O=(e,t)=>{const n=j.forwardRef(({className:n,...a},i)=>{return j.createElement(W,{ref:i,iconNode:t,className:X(`lucide-${o=L(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...a});var o});return n.displayName=L(e),n},A=O("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),B=O("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),q=O("book-marked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),N=O("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),F=O("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),D=O("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),H=O("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),J=O("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),V=O("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),G=O("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),U=O("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Y=O("file-pen",[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]]),K=O("film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Z=O("flask-conical",[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]]),Q=O("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),ee=O("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),te=O("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]),ne=O("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),ae=O("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),ie=O("mail-open",[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]]),oe=O("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),re=O("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),se=O("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),le=O("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),ce=O("party-popper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]),de=O("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),pe=O("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),ue=O("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),he=O("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),fe=O("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),ge=O("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ye=new r("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */new r("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb");const xe=new r("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");new r("So11111111111111111111111111111111111111112"),new r("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");const me=e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)});var be,je={};var ve=(be||(be=1,Object.defineProperty(je,"__esModule",{value:!0}),je.toBigIntLE=function(e){{const t=s.from(e);t.reverse();const n=t.toString("hex");return 0===n.length?BigInt(0):BigInt(`0x${n}`)}},je.toBigIntBE=function(e){{const t=e.toString("hex");return 0===t.length?BigInt(0):BigInt(`0x${t}`)}},je.toBufferLE=function(e,t){{const n=e.toString(16),a=s.from(n.padStart(2*t,"0").slice(0,2*t),"hex");return a.reverse(),a}},je.toBufferBE=function(e,t){{const n=e.toString(16);return s.from(n.padStart(2*t,"0").slice(0,2*t),"hex")}}),je);const we=(ke=8,e=>{const t=l.blob(ke,e),{encode:n,decode:a}=me(t),i=t;return i.decode=(e,t)=>{const n=a(e,t);return ve.toBigIntLE(s.from(n))},i.encode=(e,t,a)=>{const i=ve.toBufferLE(e,ke);return n(i,t,a)},i});var ke;const Se=e=>{const t=l.blob(32,e),{encode:n,decode:a}=me(t),i=t;return i.decode=(e,t)=>{const n=a(e,t);return new r(n)},i.encode=(e,t,a)=>{const i=e.toBuffer();return n(i,t,a)},i};class Ce extends Error{constructor(e){super(e)}}class Te extends Ce{constructor(){super(...arguments),this.name="TokenOwnerOffCurveError"}}async function Re(e,t,n=!1,a=ye,i=xe){if(!n&&!r.isOnCurve(t.toBuffer()))throw new Te;const[o]=await r.findProgramAddress([t.toBuffer(),a.toBuffer(),e.toBuffer()],i);return o}l.struct([l.u32("mintAuthorityOption"),Se("mintAuthority"),we("supply"),l.u8("decimals"),(e=>{const t=l.u8(e),{encode:n,decode:a}=me(t),i=t;return i.decode=(e,t)=>!!a(e,t),i.encode=(e,t,a)=>{const i=Number(e);return n(i,t,a)},i})("isInitialized"),l.u32("freezeAuthorityOption"),Se("freezeAuthority")]).span;const _e="https://api.devnet.solana.com",Ee="4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU",ze=6;let $e=null,Pe=null;function Le(){return Pe||(Pe=new y(_e,"confirmed")),Pe}async function Xe(){const e=await async function(){if($e)return $e;const e={chainNamespace:u.SOLANA,chainId:"0x3",rpcTarget:_e,displayName:"Solana Devnet",blockExplorerUrl:"https://solscan.io/?cluster=devnet",ticker:"SOL",tickerName:"Solana"},t=new h({config:{chainConfig:e}});return $e=new f({clientId:"BKECVnfm_tGc5XfDSuwBycgrP0N1sPen30bFwzRxdZFvXSDYzSzJ7tCdYYS3xJ0t_6xU-Qy8Slcr5oBCtK3kNKs",chainConfig:e,privateKeyProvider:t,web3AuthNetwork:g.SAPPHIRE_DEVNET,uiConfig:{appName:"RenaissBlock",mode:"dark",loginMethodsOrder:["google","discord"],defaultLanguage:"en"}}),await $e.initModal(),$e}();if(e.connected&&e.provider)return e.provider;const t=await e.connect();if(!t)throw new Error("Failed to connect to Web3Auth");return t}async function Me(){const e=await Xe(),t=await e.request({method:"getAccounts"});if(!t||0===t.length)throw new Error("No accounts found");return new r(t[0])}async function Ie(e){const t=await Xe(),n=Le(),a=new c(t),i=await a.requestAccounts();if(!i||0===i.length)throw new Error("No accounts found");const o=new r(i[0]);if(e instanceof x){const{blockhash:t}=await n.getLatestBlockhash();e.recentBlockhash=t,e.feePayer=o}const s=await a.signAndSendTransaction(e),l="string"==typeof s?s:s.signature,{blockhash:d,lastValidBlockHeight:p}=await n.getLatestBlockhash();return await n.confirmTransaction({signature:l,blockhash:d,lastValidBlockHeight:p}),l}async function We(e){const t=await Xe(),n=new c(t),a=await n.requestAccounts();if(!a||0===a.length)throw new Error("No accounts found");const i=new r(a[0]),o=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),s=d.deserialize(o),l=await n.signTransaction(s),p=l.message.staticAccountKeys;let u=-1;for(let r=0;r<p.length;r++)if(p[r].equals(i)){u=r;break}if(-1===u)throw new Error("User public key not found in transaction signers");const h=l.serialize();return{signedTransaction:btoa(String.fromCharCode(...h)),userSignatureIndex:u}}async function Oe(e){const t=Le(),n=new r(e);return await t.getBalance(n)/p}async function Ae(e){var t;const n=Le(),a=new r(e),i=new r(Ee);try{const e=await Re(i,a,!1,ye),t=await n.getTokenAccountBalance(e);return parseFloat(t.value.uiAmountString||"0")}catch(o){if(null==(t=o.message)?void 0:t.includes("could not find account"))return 0;throw o}}async function Be(){$e&&$e.connected&&await $e.logout()}function qe(e){return`https://solscan.io/tx/${e}?cluster=devnet`}function Ne(e){return`https://solscan.io/account/${e}?cluster=devnet`}function Fe(e){try{return new r(e),!0}catch{return!1}}const De=()=>{const[e,t]=j.useState({user:null,loading:!0,isAuthenticated:!1}),n=j.useCallback(async()=>{try{const e=await fetch(`${z}/api/auth/status/`,{credentials:"include"});if(!e.ok)return void t({user:null,loading:!1,isAuthenticated:!1});const n=await e.json();(null==n?void 0:n.authenticated)&&(null==n?void 0:n.user)?t({user:n.user,loading:!1,isAuthenticated:!0}):t({user:null,loading:!1,isAuthenticated:!1})}catch(e){t({user:null,loading:!1,isAuthenticated:!1})}},[]),a=j.useCallback(async()=>{try{const n=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"}),a=await n.json(),i=(null==a?void 0:a.csrfToken)||"";await fetch(`${z}/api/auth/logout/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":i,"X-Requested-With":"XMLHttpRequest"}});try{await Be()}catch(e){}t({user:null,loading:!1,isAuthenticated:!1})}catch(n){}},[]),i=j.useCallback(()=>{t(e=>({...e,loading:!0})),n()},[n]);return j.useEffect(()=>{n()},[n]),j.useEffect(()=>{const e=()=>{t({user:null,loading:!1,isAuthenticated:!1})};return window.addEventListener("auth-logout",e),()=>{window.removeEventListener("auth-logout",e)}},[]),{user:e.user,loading:e.loading,isAuthenticated:e.isAuthenticated,logout:a,refreshAuth:i}};async function He(e,t={}){const n=`${z}${e}`,a=await async function(){const e=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"});return(await e.json()).csrfToken}(),i=await fetch(n,{...t,credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":a,...t.headers}});if(!i.ok){const e=await i.json().catch(()=>({error:"Request failed"}));throw new Error(e.error||e.message||"Request failed")}return i.json()}const Je={getBalance:async()=>He("/api/balance/"),syncBalance:async()=>He("/api/balance/sync/",{method:"POST"}),checkBalanceSufficiency:async e=>He("/api/balance/check/",{method:"POST",body:JSON.stringify({amount:e})}),createIntent:async e=>He("/api/payment/intent/",{method:"POST",body:JSON.stringify(e)}),selectPaymentMethod:async(e,t)=>He(`/api/payment/intent/${e}/select/`,{method:"POST",body:JSON.stringify({method:t})}),payWithBalance:async e=>He(`/api/payment/intent/${e}/pay-with-balance/`,{method:"POST"}),submitSponsoredPayment:async(e,t,n)=>He(`/api/payment/intent/${e}/submit/`,{method:"POST",body:JSON.stringify({signed_transaction:t,user_signature_index:n})}),confirmBalancePayment:async(e,t)=>He(`/api/payment/intent/${e}/confirm/`,{method:"POST",body:JSON.stringify({signature:t})}),getIntentStatus:async e=>He(`/api/payment/intent/${e}/status/`),initiateCoinbaseOnramp:async e=>He(`/api/coinbase/onramp/${e}/`,{method:"POST"}),getCoinbaseStatus:async e=>He(`/api/coinbase/status/${e}/`),completeCoinbaseOnramp:async e=>He(`/api/coinbase/complete/${e}/`,{method:"POST"}),initiateDirectCrypto:async e=>He(`/api/direct-crypto/initiate/${e}/`,{method:"POST"}),getDirectCryptoStatus:async e=>He(`/api/direct-crypto/status/${e}/`),cancelDirectCrypto:async e=>He(`/api/direct-crypto/cancel/${e}/`,{method:"POST"})},Ve=j.createContext(null);function Ge({children:e}){const[t,n]=j.useState(null),[a,i]=j.useState(null),[r,s]=j.useState(!0),[l,c]=j.useState(null),[d,p]=j.useState(null),[u,h]=j.useState(null),f=j.useCallback(async()=>{try{s(!0),c(null);const e=await Je.getBalance();n(e.balance),i(e.display_balance),h(e.sync_status),e.last_synced&&p(new Date(e.last_synced)),e.error&&c(e.error)}catch(e){const t=e instanceof Error?e.message:"Failed to fetch balance";c(t)}finally{s(!1)}},[]),g=j.useCallback(async()=>{try{s(!0),h("syncing"),c(null);const e=await Je.syncBalance();n(e.balance),i(e.display_balance),h(e.sync_status),e.last_synced&&p(new Date(e.last_synced))}catch(e){const t=e instanceof Error?e.message:"Failed to sync balance";c(t),h("error")}finally{s(!1)}},[]),y=j.useCallback(async()=>{await f()},[f]),x=j.useCallback(e=>{if(!t)return!1;return parseFloat(t)>=("string"==typeof e?parseFloat(e):e)},[t]),m=j.useCallback(()=>t?parseFloat(t):0,[t]);j.useEffect(()=>{f()},[f]),j.useEffect(()=>{if("stale"===u){const e=setTimeout(()=>{f()},2e3);return()=>clearTimeout(e)}if("syncing"===u){const e=setInterval(()=>{f()},1500);return()=>clearInterval(e)}},[u,f]);const b={balance:t,displayBalance:a,loading:r,error:l,lastSynced:d,syncStatus:u,refreshBalance:y,forceSync:g,isBalanceSufficient:x,getBalanceNumber:m};return o.jsx(Ve.Provider,{value:b,children:e})}function Ue(){const e=j.useContext(Ve);if(!e)throw new Error("useBalance must be used within a BalanceProvider");return e}function Ye({isExpanded:e,onExpandedChange:t}){const[n,a]=j.useState(null),[i,r]=j.useState(!0),[s,l]=j.useState(null),[c,d]=j.useState("books"),[p,u]=j.useState(()=>localStorage.getItem("library-sort")||"recent"),[h,f]=j.useState(""),{isAuthenticated:g}=De(),{displayBalance:y,syncStatus:x}=Ue();j.useEffect(()=>{g?m():(a(null),r(!1),l(null))},[g]);const m=async()=>{try{r(!0),l(null);const e=await $.getLibrary();a(e)}catch(e){l(e instanceof Error?e.message:"Failed to load library")}finally{r(!1)}};if(!g)return null;if(!e)return o.jsxs("div",{style:{position:"fixed",left:0,top:72,bottom:0,width:48,background:"#0b1220",borderRight:"1px solid #2a3444",display:"flex",flexDirection:"column",alignItems:"center",padding:"12px 0",zIndex:40},children:[o.jsx("button",{onClick:()=>t(!0),style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#111827",e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},"aria-label":"Expand library",children:o.jsx(H,{size:20})}),o.jsx("div",{style:{writingMode:"vertical-rl",fontSize:12,fontWeight:600,color:"#94a3b8",marginTop:16},children:"LIBRARY"})]});const b=n?Object.values(n).reduce((e,t)=>e+t.length,0):0,w=(null==n?void 0:n[c])?(k=n[c],[...k].sort((e,t)=>{switch(p){case"progress":return t.progress-e.progress;case"az":return e.title.localeCompare(t.title);default:return e.last_read_at&&t.last_read_at?new Date(t.last_read_at).getTime()-new Date(e.last_read_at).getTime():e.last_read_at?-1:t.last_read_at?1:new Date(t.purchased_at).getTime()-new Date(e.purchased_at).getTime()}})).filter(e=>""===h||e.title.toLowerCase().includes(h.toLowerCase())):[];var k;const S=n?Object.values(n).flat().filter(e=>e.progress>0&&e.progress<100).sort((e,t)=>e.last_read_at&&t.last_read_at?new Date(t.last_read_at).getTime()-new Date(e.last_read_at).getTime():e.last_read_at?-1:t.last_read_at?1:t.progress-e.progress).slice(0,3):[];return o.jsxs("div",{style:{position:"fixed",left:0,top:72,bottom:0,width:320,background:"#0b1220",borderRight:"1px solid #2a3444",display:"flex",flexDirection:"column",zIndex:40,transition:"width 0.3s ease"},children:[o.jsxs("div",{style:{padding:16,borderBottom:"1px solid #2a3444",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#e5e7eb"},children:"My Library"}),o.jsxs("div",{style:{fontSize:12,color:"#94a3b8",marginTop:2},children:[b," ",1===b?"item":"items"]}),"no_wallet"!==x&&o.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"#10b981",marginTop:6,display:"flex",alignItems:"center",gap:4},children:[o.jsx("span",{style:{color:"#64748b",fontWeight:400},children:"Balance:"}),y||"$0.00"]})]}),o.jsx("button",{onClick:()=>t(!1),style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#111827",e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},"aria-label":"Collapse library",children:o.jsx(D,{size:20})})]}),o.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #2a3444"},children:o.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[o.jsx(pe,{size:14,style:{position:"absolute",left:10,color:"#64748b"}}),o.jsx("input",{type:"text",placeholder:"Search library...",value:h,onChange:e=>f(e.target.value),style:{width:"100%",background:"#111827",border:"1px solid #2a3444",borderRadius:8,padding:"8px 32px 8px 32px",fontSize:13,color:"#e5e7eb",outline:"none"}}),h&&o.jsx("button",{onClick:()=>f(""),style:{position:"absolute",right:8,background:"transparent",border:"none",color:"#64748b",cursor:"pointer",padding:2,display:"flex",alignItems:"center"},children:o.jsx(ge,{size:14})})]})}),S.length>0&&o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #2a3444"},children:[o.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#f59e0b",marginBottom:10,display:"flex",alignItems:"center",gap:6},children:[o.jsx(N,{size:14}),"Continue Reading"]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:S.map(e=>o.jsx(P,{item:e},`continue-${e.id}`))})]}),o.jsxs("div",{className:"library-tabs-scroll",style:{display:"flex",gap:4,padding:"12px 16px",borderBottom:"1px solid #2a3444",overflowX:"auto"},children:[["books","art","comics"].map(e=>{var t;const a=(null==(t=null==n?void 0:n[e])?void 0:t.length)||0,i=c===e,r="books"===e?N:"art"===e?ee:q;return o.jsxs("button",{onClick:()=>d(e),style:{display:"flex",alignItems:"center",gap:6,background:i?"#f59e0b":"#111827",border:"1px solid",borderColor:i?"#f59e0b":"#2a3444",color:i?"#111827":"#cbd5e1",padding:"6px 12px",borderRadius:18,fontSize:12,fontWeight:600,cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.2s ease"},onMouseEnter:e=>{i||(e.currentTarget.style.background="#1f2937",e.currentTarget.style.borderColor="#374151")},onMouseLeave:e=>{i||(e.currentTarget.style.background="#111827",e.currentTarget.style.borderColor="#2a3444")},children:[o.jsx(r,{size:14}),e.charAt(0).toUpperCase()+e.slice(1)," (",a,")"]},e)}),["film","music"].map(e=>o.jsxs("button",{disabled:!0,style:{background:"#111827",border:"1px solid #2a3444",color:"#64748b",padding:"6px 12px",borderRadius:18,fontSize:12,fontWeight:600,cursor:"not-allowed",whiteSpace:"nowrap",opacity:.5,display:"flex",alignItems:"center",gap:4},children:[e.charAt(0).toUpperCase()+e.slice(1),o.jsx("span",{style:{fontSize:8,background:"#f59e0b",color:"#000",padding:"1px 3px",borderRadius:2,fontWeight:700},children:"SOON"})]},e))]}),o.jsxs("div",{style:{padding:"8px 16px",borderBottom:"1px solid #2a3444",display:"flex",alignItems:"center",gap:8},children:[o.jsx(A,{size:14,style:{color:"#64748b"}}),o.jsxs("select",{value:p,onChange:e=>{return t=e.target.value,u(t),void localStorage.setItem("library-sort",t);var t},style:{background:"#111827",border:"1px solid #2a3444",borderRadius:6,padding:"4px 8px",fontSize:12,color:"#cbd5e1",cursor:"pointer",flex:1},children:[o.jsx("option",{value:"recent",children:"Recent"}),o.jsx("option",{value:"progress",children:"Progress"}),o.jsx("option",{value:"az",children:"A-Z"})]})]}),o.jsxs("div",{className:"library-sidebar-content",style:{flex:1,overflowY:"auto",padding:16},children:[i&&o.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8",fontSize:14},children:"Loading library..."}),s&&o.jsxs("div",{style:{background:"#ef444420",border:"1px solid #ef4444",borderRadius:8,padding:16,color:"#fca5a5",fontSize:14},children:[s,o.jsx("button",{onClick:m,style:{marginTop:8,background:"#ef4444",color:"#fff",padding:"6px 12px",fontSize:12},children:"Retry"})]}),!i&&!s&&0===w.length&&o.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8",fontSize:14},children:h?`No results for "${h}"`:`No ${c} in your library yet.`}),!i&&!s&&w.length>0&&o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:w.map(e=>o.jsx(P,{item:e},e.id))})]}),o.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #2a3444",flexShrink:0},children:[o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px 12px",marginBottom:8},children:[o.jsx(v,{to:"/legal/terms",style:Ke,children:"Terms"}),o.jsx(v,{to:"/legal/privacy",style:Ke,children:"Privacy"}),o.jsx(v,{to:"/legal/content-policy",style:Ke,children:"Content Policy"}),o.jsx(v,{to:"/legal/dmca",style:Ke,children:"DMCA"})]}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px 12px",marginBottom:10},children:[o.jsx("a",{href:"mailto:support@renaissblock.com",style:Ke,children:"Contact"}),o.jsx("a",{href:"mailto:dmca@renaissblock.com",style:Ke,children:"Report Copyright"})]}),o.jsxs("div",{style:{fontSize:11,color:"#64748b"},children:["Â© ",(new Date).getFullYear()," renaissBlock"]})]})]})}const Ke={fontSize:11,color:"#64748b",textDecoration:"none",transition:"color 0.2s"};const Ze=j.memo(function({item:e}){const t=Math.round(e.progress),n=function(e){if(!e)return null;const t=new Date(e),n=(new Date).getTime()-t.getTime(),a=Math.floor(n/1e3),i=Math.floor(a/60),o=Math.floor(i/60),r=Math.floor(o/24);return a<60?"Just now":i<60?`${i}m ago`:o<24?`${o}h ago`:1===r?"Yesterday":r<7?`${r}d ago`:r<30?`${Math.floor(r/7)}w ago`:`${Math.floor(r/30)}mo ago`}(e.last_read_at),a='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200"%3E%3Crect fill="%23111827" width="200" height="200"/%3E%3Ctext fill="%2394a3b8" font-family="sans-serif" font-size="48" x="50%25" y="50%25" text-anchor="middle" dominant-baseline="middle"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E';return o.jsxs(v,{to:`/reader/${e.id}`,style:{display:"flex",flexDirection:"column",background:"#0b1220",border:"1px solid #2a3444",borderRadius:12,overflow:"hidden",textDecoration:"none",color:"inherit",transition:"transform 0.2s ease, box-shadow 0.2s ease"},children:[o.jsxs("div",{style:{position:"relative",aspectRatio:"1",background:"#0e1320"},children:[o.jsx("img",{src:e.thumbnail||a,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.currentTarget.src=a}}),o.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:4,background:"rgba(0,0,0,0.6)"},children:o.jsx("div",{style:{height:"100%",width:`${e.progress}%`,background:100===t?"#10b981":"#f59e0b",transition:"width 0.3s ease"}})})]}),o.jsxs("div",{style:{padding:10},children:[o.jsx("div",{style:{fontWeight:600,fontSize:13,color:"#e5e7eb",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title}),o.jsx("div",{style:{fontSize:11,color:"#94a3b8",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.creator}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("span",{style:{fontSize:11,color:100===t?"#10b981":t>0?"#f59e0b":"#64748b",fontWeight:500},children:100===t?"Finished":t>0?`${t}%`:"Not started"}),n&&t>0&&o.jsxs("span",{style:{fontSize:10,color:"#64748b"},children:["Â· ",n]})]})]})]})}),Qe={books:N,art:ee,comics:q,film:K,music:le};function et(){const[e,t]=j.useState(null),[n,a]=j.useState(!0),[i,r]=j.useState(null),[s,l]=j.useState("books"),[c,d]=j.useState(()=>localStorage.getItem("library-sort")||"recent"),[p,u]=j.useState(""),[h,f]=j.useState(()=>"true"===localStorage.getItem("mobile-library-collapsed")),{isAuthenticated:g}=De();j.useEffect(()=>{g?y():(t(null),a(!1),r(null))},[g]);const y=async()=>{try{a(!0),r(null);const e=await $.getLibrary();t(e)}catch(e){r(e instanceof Error?e.message:"Failed to load library")}finally{a(!1)}};if(!g)return null;const x=e?Object.values(e).reduce((e,t)=>e+t.length,0):0,m=(null==e?void 0:e[s])?(b=e[s],[...b].sort((e,t)=>{switch(c){case"progress":return t.progress-e.progress;case"az":return e.title.localeCompare(t.title);default:return e.last_read_at&&t.last_read_at?new Date(t.last_read_at).getTime()-new Date(e.last_read_at).getTime():e.last_read_at?-1:t.last_read_at?1:new Date(t.purchased_at).getTime()-new Date(e.purchased_at).getTime()}})).filter(e=>""===p||e.title.toLowerCase().includes(p.toLowerCase())):[];var b;const v=e?Object.values(e).flat().filter(e=>e.progress>0&&e.progress<100).sort((e,t)=>e.last_read_at&&t.last_read_at?new Date(t.last_read_at).getTime()-new Date(e.last_read_at).getTime():e.last_read_at?-1:t.last_read_at?1:t.progress-e.progress).slice(0,3):[];return n||i||0!==x?o.jsxs("div",{style:{background:"#0a0f1a",padding:h?"12px 16px":"20px 16px",marginBottom:16,transition:"padding 0.2s ease"},children:[o.jsxs("button",{onClick:()=>{const e=!h;f(e),localStorage.setItem("mobile-library-collapsed",String(e))},style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",background:"transparent",border:"none",padding:0,cursor:"pointer",marginBottom:h?0:16},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsx(te,{size:20,style:{color:"#f59e0b"}}),o.jsxs("div",{style:{textAlign:"left"},children:[o.jsx("h2",{style:{fontSize:16,fontWeight:700,color:"#e5e7eb",margin:0},children:"My Library"}),h&&o.jsxs("div",{style:{fontSize:12,color:"#94a3b8",marginTop:2},children:[x," ",1===x?"item":"items"," â€¢ Tap to expand"]})]})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,color:"#94a3b8"},children:[!h&&o.jsxs("span",{style:{fontSize:12},children:[x," ",1===x?"item":"items"]}),h?o.jsx(F,{size:20}):o.jsx(J,{size:20})]})]}),!h&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{marginBottom:16},children:o.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[o.jsx(pe,{size:16,style:{position:"absolute",left:12,color:"#64748b"}}),o.jsx("input",{type:"text",placeholder:"Search library...",value:p,onChange:e=>u(e.target.value),style:{width:"100%",background:"#111827",border:"1px solid #2a3444",borderRadius:10,padding:"10px 36px 10px 40px",fontSize:14,color:"#e5e7eb",outline:"none"}}),p&&o.jsx("button",{onClick:()=>u(""),style:{position:"absolute",right:10,background:"transparent",border:"none",color:"#64748b",cursor:"pointer",padding:4,display:"flex",alignItems:"center"},children:o.jsx(ge,{size:16})})]})}),v.length>0&&o.jsxs("div",{style:{marginBottom:16},children:[o.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"#f59e0b",marginBottom:10,display:"flex",alignItems:"center",gap:6},children:[o.jsx(N,{size:16}),"Continue Reading"]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:v.map(e=>o.jsx(Ze,{item:e},`continue-${e.id}`))})]}),o.jsxs("div",{style:{display:"flex",gap:8,overflowX:"auto",WebkitOverflowScrolling:"touch",paddingBottom:8,marginBottom:16,scrollbarWidth:"none",msOverflowStyle:"none"},children:[["books","art","comics"].map(t=>{var n;const a=(null==(n=null==e?void 0:e[t])?void 0:n.length)||0,i=s===t,r=Qe[t];return o.jsxs("button",{onClick:()=>l(t),style:{display:"flex",alignItems:"center",gap:6,background:i?"#f59e0b":"#111827",border:"1px solid",borderColor:i?"#f59e0b":"#2a3444",color:i?"#111827":"#cbd5e1",padding:"10px 16px",borderRadius:20,fontSize:13,fontWeight:600,cursor:"pointer",whiteSpace:"nowrap",flexShrink:0,transition:"all 0.2s ease"},children:[o.jsx(r,{size:16}),t.charAt(0).toUpperCase()+t.slice(1),o.jsx("span",{style:{background:i?"rgba(0,0,0,0.2)":"#2a3444",padding:"2px 8px",borderRadius:10,fontSize:11},children:a})]},t)}),["film","music"].map(e=>{const t=Qe[e];return o.jsxs("button",{disabled:!0,style:{display:"flex",alignItems:"center",gap:6,background:"#111827",border:"1px solid #2a3444",color:"#64748b",padding:"10px 16px",borderRadius:20,fontSize:13,fontWeight:600,cursor:"not-allowed",whiteSpace:"nowrap",flexShrink:0,opacity:.6},children:[o.jsx(t,{size:16}),e.charAt(0).toUpperCase()+e.slice(1),o.jsx("span",{style:{background:"#2a3444",padding:"2px 6px",borderRadius:10,fontSize:10},children:"Soon"})]},e)})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16},children:[o.jsx(A,{size:14,style:{color:"#64748b"}}),o.jsxs("select",{value:c,onChange:e=>{return t=e.target.value,d(t),void localStorage.setItem("library-sort",t);var t},style:{background:"#111827",border:"1px solid #2a3444",borderRadius:8,padding:"6px 10px",fontSize:13,color:"#cbd5e1",cursor:"pointer"},children:[o.jsx("option",{value:"recent",children:"Recent"}),o.jsx("option",{value:"progress",children:"Progress"}),o.jsx("option",{value:"az",children:"A-Z"})]})]}),n&&o.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8",fontSize:14},children:"Loading library..."}),i&&o.jsxs("div",{style:{background:"#ef444420",border:"1px solid #ef4444",borderRadius:12,padding:16,color:"#fca5a5",fontSize:14},children:[i,o.jsx("button",{onClick:y,style:{marginTop:8,display:"block",background:"#ef4444",color:"#fff",border:"none",padding:"8px 16px",borderRadius:8,fontSize:13,fontWeight:600,cursor:"pointer"},children:"Retry"})]}),!n&&!i&&0===m.length&&o.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8",fontSize:14},children:p?`No results for "${p}"`:`No ${s} in your library yet.`}),!n&&!i&&m.length>0&&o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:m.map(e=>o.jsx(Ze,{item:e},e.id))})]})]}):null}function tt(){const e="undefined"!=typeof window?window.innerWidth:1024;return{isMobile:e<=768,isPhone:e<=480,isTablet:e>480&&e<=768,isDesktop:e>768,screenWidth:e}}function nt(){const[e,t]=j.useState(tt);return j.useEffect(()=>{const e=()=>t(tt());return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}function at({children:e}){const[t,n]=j.useState(null),a=w();j.useEffect(()=>{i()},[]);const i=async()=>{try{const e=await fetch(`${z}/api/auth/status/`,{credentials:"include"}),t=await e.json();n(!!(null==t?void 0:t.authenticated))}catch{n(!1)}};return null===t?o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"60vh",color:"#94a3b8",fontSize:16},children:"Checking authentication..."}):t?o.jsx(o.Fragment,{children:e}):o.jsx(k,{to:"/auth",state:{from:a},replace:!0})}class it extends j.Component{constructor(e){super(e),t(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})}),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?this.props.fallback?this.props.fallback:o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px",padding:"40px",textAlign:"center",color:"var(--text, #e5e7eb)"},children:[o.jsx("h2",{style:{marginBottom:"16px",color:"var(--text, #e5e7eb)"},children:"Something went wrong"}),o.jsx("p",{style:{marginBottom:"24px",color:"var(--text-muted, #94a3b8)"},children:"An error occurred while loading this section."}),o.jsx("button",{onClick:this.handleRetry,style:{padding:"10px 24px",background:"var(--accent, #f59e0b)",color:"#111",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Try Again"})]}):this.props.children}}const ot={notifications:[],unreadCount:0,lastChecked:null,isPolling:!1,lastError:null,knownNotificationIds:new Set,initialLoadComplete:!1},rt={POLLING_INTERVAL:3e4,MAX_RETRIES:3,RETRY_DELAY:5e3};async function st(){try{const e=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch(e){return""}}async function lt(e,t={}){const n=e.startsWith("/")?`${z}${e}`:e,a=await fetch(n,{credentials:"include",headers:{"Content-Type":"application/json",...t.headers},...t});if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error((null==e?void 0:e.error)||`API request failed: ${a.status}`)}return a.json()}async function ct(){try{const e=await lt("/api/notifications/");return ot.notifications=e,ot.unreadCount=e.filter(e=>!e.read).length,ot.lastChecked=new Date,ot.lastError=null,e.forEach(e=>ot.knownNotificationIds.add(e.id)),yt.emit("notifications:updated",{notifications:e,unreadCount:ot.unreadCount}),e}catch(e){throw ot.lastError=e,e}}let dt=null,pt=0,ut=null;async function ht(){if(ot.isPolling)try{const e=new Set(ot.knownNotificationIds);if(await ct(),ot.initialLoadComplete){const t=ot.notifications.filter(t=>!e.has(t.id)&&!t.read);t.length>0&&yt.emit("notifications:new",{notifications:t,count:t.length})}else ot.initialLoadComplete=!0;pt=0}catch(e){pt++,pt>=rt.MAX_RETRIES?(gt(),yt.emit("notifications:polling-error",{error:e,retryCount:pt})):(ut&&clearTimeout(ut),ut=setTimeout(()=>{ht()},rt.RETRY_DELAY))}}function ft(){ot.isPolling||(ot.isPolling=!0,pt=0,ht(),dt=setInterval(ht,rt.POLLING_INTERVAL),yt.emit("notifications:polling-started",{}))}function gt(){ot.isPolling&&(ot.isPolling=!1,dt&&(clearInterval(dt),dt=null),ut&&(clearTimeout(ut),ut=null),yt.emit("notifications:polling-stopped",{}))}const yt=new class{constructor(){t(this,"listeners",new Map)}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>this.off(e,t)}off(e,t){const n=this.listeners.get(e);n&&n.delete(t)}emit(e,t){const n=this.listeners.get(e);n&&n.forEach(e=>{try{e(t)}catch(n){}})}clear(){this.listeners.clear()}};function xt(e){const t=new Date(e),n=new Date,a=Math.floor((n.getTime()-t.getTime())/1e3);return a<60?"just now":a<3600?`${Math.floor(a/60)}m ago`:a<86400?`${Math.floor(a/3600)}h ago`:a<604800?`${Math.floor(a/86400)}d ago`:t.toLocaleDateString()}function mt(e){return{invitation:"ðŸ“¬",invitation_response:"âœ‰ï¸",comment:"ðŸ’¬",approval:"âœ…",section_update:"ðŸ“",revenue_proposal:"ðŸ’°",mint_ready:"ðŸŽ‰"}[e]||"ðŸ””"}function bt(e){return{invitation:"#3b82f6",invitation_response:"#8b5cf6",comment:"#06b6d4",approval:"#10b981",section_update:"#f59e0b",revenue_proposal:"#eab308",mint_ready:"#ec4899"}[e]||"#6b7280"}const jt={getNotifications:ct,getUnreadNotifications:async function(){return(await ct()).filter(e=>!e.read)},getUnreadCount:async function(){try{const e=(await ct()).filter(e=>!e.read).length;return ot.unreadCount=e,yt.emit("notifications:unread-count",{count:e}),e}catch(e){return ot.unreadCount}},markNotificationRead:async function(e){try{const t=await st();await lt(`/api/notifications/${e}/mark-read/`,{method:"POST",headers:{"X-CSRFToken":t}});const n=ot.notifications.find(t=>t.id===e);n&&!n.read&&(n.read=!0,ot.unreadCount=Math.max(0,ot.unreadCount-1),yt.emit("notifications:updated",{notifications:ot.notifications,unreadCount:ot.unreadCount}),yt.emit("notifications:unread-count",{count:ot.unreadCount}))}catch(t){throw t}},markAllNotificationsRead:async function(){try{const e=await st();await lt("/api/notifications/mark-all-read/",{method:"POST",headers:{"X-CSRFToken":e}}),ot.notifications.forEach(e=>e.read=!0),ot.unreadCount=0,yt.emit("notifications:updated",{notifications:ot.notifications,unreadCount:0}),yt.emit("notifications:unread-count",{count:0})}catch(e){throw e}},deleteNotification:async function(e){const t=()=>{const t=ot.notifications.findIndex(t=>t.id===e);if(-1!==t){const n=!ot.notifications[t].read;ot.notifications.splice(t,1),n&&(ot.unreadCount=Math.max(0,ot.unreadCount-1)),ot.knownNotificationIds.delete(e),yt.emit("notifications:updated",{notifications:ot.notifications,unreadCount:ot.unreadCount}),yt.emit("notifications:unread-count",{count:ot.unreadCount})}};try{const n=await st(),a=`${z}/api/notifications/${e}/`,i=await fetch(a,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":n}});if(404===i.status)return void t();if(!i.ok)throw new Error(`Failed to delete notification: ${i.status}`);t()}catch(n){throw t(),n}},getNotificationStats:async function(){const e=await ct(),t={total:e.length,unread:e.filter(e=>!e.read).length,by_type:{invitation:0,invitation_response:0,comment:0,approval:0,section_update:0,revenue_proposal:0,mint_ready:0}};return e.forEach(e=>{t.by_type[e.type]=(t.by_type[e.type]||0)+1}),t},startPolling:ft,stopPolling:gt,isPolling:function(){return ot.isPolling},setPollingInterval:function(e){rt.POLLING_INTERVAL=e,ot.isPolling&&(gt(),ft())},getState:function(){return{...ot}},getCachedNotifications:function(){return[...ot.notifications]},getCachedUnreadCount:function(){return ot.unreadCount},reset:function(){gt(),ot.notifications=[],ot.unreadCount=0,ot.lastChecked=null,ot.lastError=null,ot.knownNotificationIds.clear(),ot.initialLoadComplete=!1,yt.clear()},events:yt,getTimeAgo:xt,getNotificationIcon:mt,getNotificationColor:bt};function vt(e={}){const{autoStart:t=!1,onNewNotification:n}=e,[a,i]=j.useState([]),[o,r]=j.useState(0),[s,l]=j.useState(!1),[c,d]=j.useState(!1),[p,u]=j.useState(null),h=j.useCallback(async()=>{l(!0),u(null);try{const e=await jt.getNotifications();i(e),r(e.filter(e=>!e.read).length)}catch(e){u(e)}finally{l(!1)}},[]),f=j.useCallback(async e=>{try{await jt.markNotificationRead(e)}catch(t){throw u(t),t}},[]),g=j.useCallback(async()=>{try{await jt.markAllNotificationsRead()}catch(e){throw u(e),e}},[]),y=j.useCallback(async e=>{try{await jt.deleteNotification(e)}catch(t){}},[]),x=j.useCallback(()=>{jt.startPolling(),d(!0)},[]),m=j.useCallback(()=>{jt.stopPolling(),d(!1)},[]),b=j.useCallback(async()=>{try{return await jt.getNotificationStats()}catch(e){throw u(e),e}},[]);return j.useEffect(()=>{const e=yt.on("notifications:updated",({notifications:e,unreadCount:t})=>{i(e),r(t)}),t=yt.on("notifications:unread-count",({count:e})=>{r(e)}),a=yt.on("notifications:new",({notifications:e})=>{n&&n(e)}),o=yt.on("notifications:polling-started",()=>{d(!0)}),s=yt.on("notifications:polling-stopped",()=>{d(!1)}),l=yt.on("notifications:polling-error",({error:e})=>{u(e),d(!1)});return()=>{e(),t(),a(),o(),s(),l()}},[n]),j.useEffect(()=>(t&&(x(),h()),()=>{t&&m()}),[t,x,m,h]),{notifications:a,unreadCount:o,isLoading:s,isPolling:c,error:p,refresh:h,markAsRead:f,markAllAsRead:g,deleteNotification:y,startPolling:x,stopPolling:m,getStats:b}}const wt=j.memo(function({notification:e,onClick:t,onDelete:n,onViewInvite:a}){const i=function(e){const t={size:20};switch(e){case"invitation":return o.jsx(oe,{...t});case"invitation_response":return o.jsx(ie,{...t});case"comment":return o.jsx(se,{...t});case"approval":return o.jsx(V,{...t});case"section_update":return o.jsx(Y,{...t});case"revenue_proposal":return o.jsx(U,{...t});case"mint_ready":return o.jsx(ce,{...t});default:return o.jsx(B,{...t})}}(e.type),r=bt(e.type),s=xt(e.created_at),l="invitation"===e.type;return o.jsxs("div",{onClick:t,role:"button",tabIndex:0,"aria-label":`${e.read?"Read":"Unread"} notification: ${e.title}`,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t())},style:{padding:"12px 20px",cursor:"pointer",background:e.read?"transparent":"#0b1220",borderLeft:`3px solid ${e.read?"transparent":r}`,transition:"all 0.2s",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b"},onMouseLeave:t=>{t.currentTarget.style.background=e.read?"transparent":"#0b1220"},children:[o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsx("div",{style:{width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:`${r}20`,borderRadius:8,flexShrink:0,color:r},"aria-hidden":"true",children:i}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#e5e7eb",marginBottom:4,lineHeight:1.4},children:e.title}),o.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginBottom:6,lineHeight:1.5},children:e.message}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:11,color:"#64748b"},children:[o.jsxs("span",{children:["@",e.from_user.username]}),o.jsx("span",{children:"â€¢"}),o.jsx("span",{children:s})]}),l&&a&&o.jsx("button",{onClick:t=>{t.stopPropagation(),a(e)},style:{marginTop:10,background:"#f59e0b",color:"#000",border:"none",padding:"8px 16px",borderRadius:6,fontSize:12,fontWeight:700,cursor:"pointer",display:"flex",alignItems:"center",gap:6,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#fbbf24"},onMouseLeave:e=>{e.currentTarget.style.background="#f59e0b"},children:"View Invite â†’"})]}),o.jsx("button",{onClick:n,"aria-label":"Delete notification",style:{background:"transparent",border:"none",color:"#64748b",cursor:"pointer",padding:4,borderRadius:4,fontSize:18,width:28,height:28,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,opacity:.6,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b",e.currentTarget.style.color="#ef4444",e.currentTarget.style.opacity="1"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#64748b",e.currentTarget.style.opacity="0.6"},children:"Ã—"})]}),!e.read&&o.jsx("div",{"aria-label":"Unread",style:{position:"absolute",top:18,right:20,width:8,height:8,background:r,borderRadius:"50%",boxShadow:`0 0 8px ${r}`}})]})});async function kt(){try{const e=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch(e){return""}}async function St(e){if(!e.ok){let t=`Request failed: ${e.statusText}`;try{const n=await e.json();n.error?t=n.error:n.detail&&(t=n.detail)}catch{}throw new Error(t)}return e.json()}const Ct={async createCollaborativeProject(e){const t=await kt();return St(await fetch(`${z}/api/collaborative-projects/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)}))},getCollaborativeProjects:async()=>St(await fetch(`${z}/api/collaborative-projects/`,{method:"GET",credentials:"include"})),getCollaborativeProject:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/`,{method:"GET",credentials:"include"})),getPendingInvites:async()=>St(await fetch(`${z}/api/collaborative-projects/pending_invites/`,{method:"GET",credentials:"include"})),updateCollaborativeProject:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteCollaborativeProject(e){const t=await fetch(`${z}/api/collaborative-projects/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete project: ${t.statusText}`)},inviteCollaborator:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/invite_collaborator/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),acceptInvitation:async(e,t=!0)=>St(await fetch(`${z}/api/collaborative-projects/${e}/accept_invitation/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({warranty_of_originality_acknowledged:t})})),declineInvitation:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/decline_invitation/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),counterProposeInvite:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/counter_propose/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),respondToCounterProposal:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/respond-to-counter-proposal/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),proposeRevenueSplit:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/propose_revenue_split/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({splits:t})})),approveCurrentVersion:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/approve_version/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),async getApprovalStatus(e){const t=await this.getCollaborativeProject(e),n=t.collaborators.filter(e=>!("accepted"!==e.status||e.approved_current_version&&e.approved_revenue_split)).map(e=>e.username);return{is_fully_approved:t.is_fully_approved,pending_approvals:n}},getProjectPreview:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/preview/`,{method:"GET",credentials:"include"})),async createProjectSection(e){const t=new FormData;t.append("project",e.project.toString()),t.append("section_type",e.section_type),t.append("title",e.title),e.content_html&&t.append("content_html",e.content_html),e.media_file&&t.append("media_file",e.media_file),void 0!==e.order&&t.append("order",e.order.toString());return St(await fetch(`${z}/api/project-sections/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:t}))},async updateProjectSection(e,t){const n=new FormData;t.section_type&&n.append("section_type",t.section_type),t.title&&n.append("title",t.title),void 0!==t.content_html&&n.append("content_html",t.content_html),t.media_file&&n.append("media_file",t.media_file),void 0!==t.order&&n.append("order",t.order.toString());return St(await fetch(`${z}/api/project-sections/${e}/`,{method:"PATCH",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:n}))},async deleteProjectSection(e){const t=await fetch(`${z}/api/project-sections/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete section: ${t.statusText}`)},getProjectSections:async e=>St(await fetch(`${z}/api/project-sections/?project=${e}`,{method:"GET",credentials:"include"})),async addComment(e){if(e.attachments&&e.attachments.length>0){const t=new FormData;t.append("project",e.project.toString()),t.append("content",e.content),e.section&&t.append("section",e.section.toString()),e.parent_comment&&t.append("parent_comment",e.parent_comment.toString()),e.mentions&&t.append("mentions",JSON.stringify(e.mentions)),e.attachments.forEach((e,n)=>{t.append(`attachment_${n}`,e)});return St(await fetch(`${z}/api/project-comments/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:t}))}return St(await fetch(`${z}/api/project-comments/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)}))},async getComments(e,t){let n=`${z}/api/project-comments/?project=${e}`;t&&(n+=`&section=${t}`);return St(await fetch(n,{method:"GET",credentials:"include"}))},resolveComment:async e=>St(await fetch(`${z}/api/project-comments/${e}/resolve/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),unresolveComment:async e=>St(await fetch(`${z}/api/project-comments/${e}/unresolve/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),updateComment:async(e,t)=>St(await fetch(`${z}/api/project-comments/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({content:t})})),async deleteComment(e){const t=await fetch(`${z}/api/project-comments/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete comment: ${t.statusText}`)},addReaction:async(e,t)=>St(await fetch(`${z}/api/project-comments/${e}/add-reaction/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({emoji:t})})),async removeReaction(e,t){const n=await fetch(`${z}/api/project-comments/${e}/remove-reaction/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({reaction_id:t})});if(!n.ok)throw new Error(`Failed to remove reaction: ${n.statusText}`)},getCommentThread:async e=>St(await fetch(`${z}/api/project-comments/${e}/thread/`,{method:"GET",credentials:"include"})),async getCommentsBySection(e,t=!1){let n=`${z}/api/project-comments/by-section/?project=${e}`;t&&(n+="&include_resolved=true");return St(await fetch(n,{method:"GET",credentials:"include"}))},async getUnresolvedCommentCount(e){return(await this.getComments(e)).filter(e=>!e.resolved).length},requestApproval:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/request_approval/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),approveProject:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/approve_project/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),setPrice:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/set_price/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({price_usd:t})})),updateCustomization:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/update_customization/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),mintProject:async(e,t=!1)=>St(await fetch(`${z}/api/collaborative-projects/${e}/mint/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({force_mint:t})})),getMintingStatus:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/minting-status/`,{method:"GET",credentials:"include"})),cancelApproval:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/cancel_approval/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),getProposals:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/proposals/`,{method:"GET",credentials:"include"})),createProposal:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/proposals/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),castVote:async(e,t,n)=>St(await fetch(`${z}/api/collaborative-projects/${e}/proposals/${t}/vote/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(n)})),cancelProposal:async(e,t)=>St(await fetch(`${z}/api/collaborative-projects/${e}/proposals/${t}/cancel/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),rateCollaborator:async(e,t,n)=>St(await fetch(`${z}/api/collaborative-projects/${e}/rate_collaborator/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({rated_user_id:t,...n})})),getUserRatings:async e=>St(await fetch(`${z}/api/users/${e}/ratings/`,{method:"GET",credentials:"include"})),getComicPages:async e=>St(await fetch(`${z}/api/comic-pages/?project=${e}`,{method:"GET",credentials:"include"})),getComicPage:async e=>St(await fetch(`${z}/api/comic-pages/${e}/`,{method:"GET",credentials:"include"})),createComicPage:async e=>St(await fetch(`${z}/api/comic-pages/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})),updateComicPage:async(e,t)=>St(await fetch(`${z}/api/comic-pages/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteComicPage(e){const t=await fetch(`${z}/api/comic-pages/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete page: ${t.statusText}`)},reorderComicPage:async(e,t)=>St(await fetch(`${z}/api/comic-pages/${e}/reorder/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({new_position:t})})),getComicPanels:async e=>St(await fetch(`${z}/api/comic-panels/?page=${e}`,{method:"GET",credentials:"include"})),createComicPanel:async e=>St(await fetch(`${z}/api/comic-panels/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})),updateComicPanel:async(e,t)=>St(await fetch(`${z}/api/comic-panels/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteComicPanel(e){const t=await fetch(`${z}/api/comic-panels/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete panel: ${t.statusText}`)},async uploadPanelArtwork(e,t){const n=new FormData;n.append("artwork",t);return St(await fetch(`${z}/api/comic-panels/${e}/upload_artwork/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:n}))},batchUpdatePanelPositions:async e=>St(await fetch(`${z}/api/comic-panels/batch_update_positions/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({panels:e})})),getSpeechBubbles:async e=>St(await fetch(`${z}/api/speech-bubbles/?panel=${e}`,{method:"GET",credentials:"include"})),createSpeechBubble:async e=>St(await fetch(`${z}/api/speech-bubbles/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})),updateSpeechBubble:async(e,t)=>St(await fetch(`${z}/api/speech-bubbles/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteSpeechBubble(e){const t=await fetch(`${z}/api/speech-bubbles/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete bubble: ${t.statusText}`)},batchCreateSpeechBubbles:async e=>St(await fetch(`${z}/api/speech-bubbles/batch_create/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({bubbles:e})})),batchUpdateBubblePositions:async e=>St(await fetch(`${z}/api/speech-bubbles/batch_update_positions/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({bubbles:e})})),getDividerLines:async e=>St(await fetch(`${z}/api/divider-lines/?page=${e}`,{method:"GET",credentials:"include"})),createDividerLine:async e=>St(await fetch(`${z}/api/divider-lines/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})),updateDividerLine:async(e,t)=>St(await fetch(`${z}/api/divider-lines/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteDividerLine(e){const t=await fetch(`${z}/api/divider-lines/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete divider line: ${t.statusText}`)},batchCreateDividerLines:async(e,t,n=!1)=>St(await fetch(`${z}/api/divider-lines/batch_create/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({page:e,lines:t,clear_existing:n})})),batchUpdateDividerLines:async e=>St(await fetch(`${z}/api/divider-lines/batch_update/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({lines:e})})),getComicSeries:async()=>St(await fetch(`${z}/api/comic-series/`,{method:"GET",credentials:"include"})),getComicSeriesDetail:async e=>St(await fetch(`${z}/api/comic-series/${e}/`,{method:"GET",credentials:"include"})),createComicSeries:async e=>St(await fetch(`${z}/api/comic-series/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})),updateComicSeries:async(e,t)=>St(await fetch(`${z}/api/comic-series/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteComicSeries(e){const t=await fetch(`${z}/api/comic-series/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete series: ${t.statusText}`)},publishComicSeries:async e=>St(await fetch(`${z}/api/comic-series/${e}/publish/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),async getComicIssues(e){let t=`${z}/api/comic-issues/`;if(e){const n=new URLSearchParams;e.series&&n.append("series",e.series.toString()),e.project&&n.append("project",e.project.toString()),n.toString()&&(t+=`?${n.toString()}`)}return St(await fetch(t,{method:"GET",credentials:"include"}))},getComicIssueDetail:async e=>St(await fetch(`${z}/api/comic-issues/${e}/`,{method:"GET",credentials:"include"})),createComicIssue:async e=>St(await fetch(`${z}/api/comic-issues/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})),updateComicIssue:async(e,t)=>St(await fetch(`${z}/api/comic-issues/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteComicIssue(e){const t=await fetch(`${z}/api/comic-issues/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete issue: ${t.statusText}`)},prepareComicIssue:async e=>St(await fetch(`${z}/api/comic-issues/${e}/prepare/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),publishComicIssue:async e=>St(await fetch(`${z}/api/comic-issues/${e}/publish/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}})),getComicIssuePages:async e=>St(await fetch(`${z}/api/comic-pages/?issue=${e}`,{method:"GET",credentials:"include"})),getArtworkLibrary:async e=>St(await fetch(`${z}/api/collaborative-projects/${e}/artwork-library/`,{method:"GET",credentials:"include"})),async uploadArtworkToLibrary(e,t,n){const a=new FormData;a.append("file",t),n&&a.append("title",n);return St(await fetch(`${z}/api/collaborative-projects/${e}/artwork-library/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:a}))},async deleteArtworkFromLibrary(e){const t=await fetch(`${z}/api/artwork-library/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete artwork: ${t.statusText}`)},applyArtworkToPanel:async(e,t)=>St(await fetch(`${z}/api/artwork-library/${e}/apply-to-panel/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await kt(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)}))};function Tt({open:e,onClose:t,projectId:n,notificationMessage:a}){const i=S(),[r,s]=j.useState(!0),[l,c]=j.useState(null),[d,p]=j.useState(null),[u,h]=j.useState("view"),[f,g]=j.useState(50),[y,x]=j.useState(""),[m,b]=j.useState(!1),[v,w]=j.useState(""),[k,C]=j.useState("");if(j.useEffect(()=>{if(!e||!n)return;(async()=>{s(!0),w("");try{const e=await Ct.getCollaborativeProject(n);c(e);const t=e.collaborators.find(e=>"invited"===e.status);t&&(p(t),g(t.revenue_percentage))}catch(e){w(e.message||"Failed to load project details")}finally{s(!1)}})()},[e,n]),j.useEffect(()=>{e||(h("view"),x(""),w(""),C(""))},[e]),!e)return null;const T=async()=>{b(!0),w("");try{await Ct.declineInvitation(n),C("Invite declined."),setTimeout(()=>{t()},1500)}catch(e){w(e.message||"Failed to decline invitation")}finally{b(!1)}},R=null==l?void 0:l.collaborators.find(e=>e.user===l.created_by),_=d?100-d.revenue_percentage:0,E=d&&null!==d.proposed_percentage&&void 0!==d.proposed_percentage&&Math.abs(Number(d.proposed_percentage)-Number(d.revenue_percentage))>.001;return o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.9)",display:"grid",placeItems:"center",zIndex:1e3,padding:20},onClick:e=>{e.target!==e.currentTarget||m||t()},children:o.jsxs("div",{style:{background:"#0f172a",border:"1px solid #334155",borderRadius:16,width:"100%",maxWidth:600,maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.5)"},children:[o.jsxs("div",{style:{padding:24,borderBottom:"1px solid #334155",background:"linear-gradient(135deg, #1e293b 0%, #0f172a 100%)",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[o.jsx("span",{style:{fontSize:24},children:"ðŸ¤"}),o.jsx("h2",{style:{margin:0,color:"#f8fafc",fontSize:20,fontWeight:600},children:"Collaboration Invite"})]}),R&&o.jsxs("p",{style:{margin:0,color:"#94a3b8",fontSize:14},children:["from ",o.jsxs("span",{style:{color:"#f59e0b"},children:["@",R.username]})]})]}),o.jsx("button",{onClick:t,disabled:m,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:24,cursor:m?"not-allowed":"pointer",padding:4},children:"Ã—"})]}),o.jsx("div",{style:{padding:24},children:r?o.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"Loading project details..."}):v&&!l?o.jsx("div",{style:{textAlign:"center",padding:40,color:"#ef4444"},children:v}):l&&d?"view"===u?o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{marginBottom:24},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[o.jsx("span",{style:{background:"#f59e0b20",color:"#f59e0b",padding:"4px 12px",borderRadius:6,fontSize:12,fontWeight:600},children:{book:"Book",music:"Music",video:"Video",art:"Art"}[l.content_type]||l.content_type}),o.jsx("span",{style:{color:"#64748b",fontSize:13},children:"draft"===l.status?"Draft":"Active"})]}),o.jsx("h3",{style:{margin:0,color:"#f8fafc",fontSize:24,fontWeight:700},children:l.title}),l.description&&o.jsx("p",{style:{margin:"8px 0 0",color:"#94a3b8",fontSize:14,lineHeight:1.6},children:l.description})]}),o.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[o.jsx("div",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,marginBottom:8,textTransform:"uppercase"},children:"Your Role"}),o.jsx("div",{style:{color:"#f8fafc",fontSize:18,fontWeight:600},children:d.role||"Collaborator"})]}),d.contract_tasks&&d.contract_tasks.length>0&&o.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[o.jsx("span",{style:{fontSize:18},children:"ðŸ“‹"}),o.jsxs("span",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,textTransform:"uppercase"},children:["Your Contract Tasks (",d.contract_tasks.length,")"]})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:d.contract_tasks.map((e,t)=>o.jsxs("div",{style:{background:"#0f172a",borderRadius:8,padding:14,borderLeft:"3px solid #f59e0b"},children:[o.jsx("div",{style:{color:"#f8fafc",fontSize:14,fontWeight:600},children:e.title}),e.description&&o.jsx("div",{style:{color:"#94a3b8",fontSize:13,marginTop:6,lineHeight:1.5},children:e.description}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:10,color:"#f59e0b",fontSize:12,fontWeight:500},children:[o.jsx("span",{children:"â°"}),o.jsxs("span",{children:["Due: ",new Date(e.deadline).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})]})]})]},e.id||t))}),o.jsxs("div",{style:{marginTop:16,padding:12,background:"rgba(245, 158, 11, 0.1)",borderRadius:8,display:"flex",alignItems:"flex-start",gap:10},children:[o.jsx("span",{style:{fontSize:16},children:"âš ï¸"}),o.jsxs("div",{style:{color:"#f59e0b",fontSize:12,lineHeight:1.5},children:[o.jsx("strong",{children:"Contract Terms:"})," By accepting, you commit to completing these tasks by their deadlines. Tasks become binding and can only be changed via mutual agreement. Missing deadlines may affect the collaboration."]})]})]}),a&&o.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20,borderLeft:"3px solid #3b82f6"},children:[o.jsxs("div",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,marginBottom:8,textTransform:"uppercase"},children:["Message from @",null==R?void 0:R.username]}),o.jsx("div",{style:{color:"#cbd5e1",fontSize:14,lineHeight:1.6,whiteSpace:"pre-wrap"},children:a})]}),o.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[o.jsx("span",{style:{fontSize:18},children:"ðŸ’°"}),o.jsx("span",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,textTransform:"uppercase"},children:"Revenue Split"})]}),o.jsxs("div",{style:{display:"flex",gap:4,marginBottom:8},children:[o.jsxs("div",{style:{flex:d.revenue_percentage,background:"#f59e0b",height:40,borderRadius:"8px 0 0 8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#000",fontWeight:700,fontSize:14,minWidth:60},children:["You: ",d.revenue_percentage,"%"]}),o.jsxs("div",{style:{flex:_,background:"#334155",height:40,borderRadius:"0 8px 8px 0",display:"flex",alignItems:"center",justifyContent:"center",color:"#cbd5e1",fontWeight:600,fontSize:14,minWidth:60},children:["Others: ",_,"%"]})]})]}),o.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[o.jsx("span",{style:{fontSize:18},children:"âœï¸"}),o.jsx("span",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,textTransform:"uppercase"},children:"Your Permissions"})]}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[{key:"can_edit_text",label:"Text",value:d.can_edit_text},{key:"can_edit_images",label:"Images",value:d.can_edit_images},{key:"can_edit_audio",label:"Audio",value:d.can_edit_audio},{key:"can_edit_video",label:"Video",value:d.can_edit_video}].map(e=>o.jsxs("span",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",borderRadius:6,background:e.value?"#10b98120":"#64748b20",color:e.value?"#10b981":"#64748b",fontSize:13,fontWeight:500},children:[e.value?"âœ“":"âœ—"," ",e.label]},e.key))})]}),o.jsxs("div",{style:{background:"linear-gradient(135deg, #7c3aed20 0%, #3b82f620 100%)",border:"1px solid #7c3aed40",borderRadius:12,padding:16,marginBottom:24},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[o.jsx("span",{style:{fontSize:18},children:"â›“ï¸"}),o.jsx("span",{style:{color:"#a78bfa",fontSize:13,fontWeight:600},children:"On-Chain Agreement"})]}),o.jsx("p",{style:{margin:0,color:"#c4b5fd",fontSize:13,lineHeight:1.6},children:"By accepting, you agree to the revenue split above. When this project is minted as an NFT, the split will be enforced via smart contract. USDC payments will be distributed automatically."})]}),v&&o.jsx("div",{style:{background:"#ef444420",border:"1px solid #ef4444",color:"#fca5a5",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:v}),k&&o.jsx("div",{style:{background:"#10b98120",border:"1px solid #10b981",color:"#6ee7b7",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:k}),E?o.jsxs("div",{style:{background:"linear-gradient(135deg, #f59e0b10 0%, #fbbf2410 100%)",border:"1px solid #f59e0b40",borderRadius:12,padding:20,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:10,marginBottom:12},children:[o.jsx(G,{size:22,style:{color:"#f59e0b"}}),o.jsx("span",{style:{color:"#f59e0b",fontSize:16,fontWeight:600},children:"Counter-Proposal Pending"})]}),o.jsxs("p",{style:{margin:0,color:"#fbbf24",fontSize:14,lineHeight:1.6},children:["You proposed ",o.jsxs("strong",{children:[null==d?void 0:d.proposed_percentage,"%"]})," revenue split (original offer: ",null==d?void 0:d.revenue_percentage,"%)."]}),o.jsxs("p",{style:{margin:"8px 0 0",color:"#94a3b8",fontSize:13},children:["Waiting for @",null==R?void 0:R.username," to respond to your counter-proposal."]}),o.jsx("button",{onClick:T,disabled:m,style:{marginTop:16,padding:"10px 24px",borderRadius:8,border:"1px solid #ef4444",background:"transparent",color:"#ef4444",fontSize:13,fontWeight:600,cursor:m?"not-allowed":"pointer",opacity:m?.6:1},children:"Withdraw & Decline"})]}):o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsx("button",{onClick:T,disabled:m,style:{flex:1,padding:"14px 20px",borderRadius:10,border:"1px solid #ef4444",background:"transparent",color:"#ef4444",fontSize:14,fontWeight:600,cursor:m?"not-allowed":"pointer",opacity:m?.6:1},children:"Decline"}),o.jsx("button",{onClick:()=>h("counter-propose"),disabled:m,style:{flex:1,padding:"14px 20px",borderRadius:10,border:"1px solid #3b82f6",background:"transparent",color:"#3b82f6",fontSize:14,fontWeight:600,cursor:m?"not-allowed":"pointer",opacity:m?.6:1},children:"Counter-Propose"}),o.jsx("button",{onClick:async()=>{b(!0),w("");try{await Ct.acceptInvitation(n),C("Invite accepted! Redirecting to project..."),setTimeout(()=>{t(),i(`/collaborations/${n}`)},1500)}catch(e){w(e.message||"Failed to accept invitation")}finally{b(!1)}},disabled:m,style:{flex:1.5,padding:"14px 20px",borderRadius:10,border:"none",background:"#10b981",color:"#fff",fontSize:14,fontWeight:700,cursor:m?"not-allowed":"pointer",opacity:m?.6:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:m?"Processing...":"âœ“ Accept Invite"})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>h("view"),style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:14,cursor:"pointer",padding:0,marginBottom:16,display:"flex",alignItems:"center",gap:8},children:"â† Back to invite"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:24},children:[o.jsx("span",{style:{fontSize:24},children:"ðŸ’¬"}),o.jsx("h3",{style:{margin:0,color:"#f8fafc",fontSize:20,fontWeight:600},children:"Propose Different Terms"})]}),o.jsxs("div",{style:{marginBottom:24},children:[o.jsxs("label",{style:{display:"block",color:"#94a3b8",fontSize:13,fontWeight:600,marginBottom:12},children:["Suggested Revenue Split: ",f,"% for you"]}),o.jsx("input",{type:"range",min:5,max:95,step:5,value:f,onChange:e=>g(parseInt(e.target.value)),style:{width:"100%",marginBottom:8}}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,color:"#64748b"},children:[o.jsxs("span",{children:["Current offer: ",d.revenue_percentage,"%"]}),o.jsxs("span",{children:["Proposing: ",f,"%"]})]}),f!==d.revenue_percentage&&o.jsxs("div",{style:{marginTop:12,padding:12,background:"#1e293b",borderRadius:8,fontSize:13},children:[o.jsx("span",{style:{color:"#94a3b8"},children:"Change: "}),o.jsxs("span",{style:{color:f>d.revenue_percentage?"#10b981":"#ef4444",fontWeight:600},children:[d.revenue_percentage,"% â†’ ",f,"% (",f>d.revenue_percentage?"+":"",f-d.revenue_percentage,"%)"]})]})]}),o.jsxs("div",{style:{marginBottom:24},children:[o.jsxs("label",{style:{display:"block",color:"#94a3b8",fontSize:13,fontWeight:600,marginBottom:8},children:["Message to @",null==R?void 0:R.username]}),o.jsx("textarea",{value:y,onChange:e=>x(e.target.value),placeholder:"Explain why you'd like a different split...",style:{width:"100%",minHeight:120,background:"#1e293b",border:"1px solid #334155",borderRadius:8,padding:12,color:"#f8fafc",fontSize:14,resize:"vertical"}}),o.jsxs("div",{style:{fontSize:11,color:"#64748b",marginTop:4},children:[y.length,"/500 characters"]})]}),v&&o.jsx("div",{style:{background:"#ef444420",border:"1px solid #ef4444",color:"#fca5a5",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:v}),k&&o.jsx("div",{style:{background:"#10b98120",border:"1px solid #10b981",color:"#6ee7b7",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:k}),o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsx("button",{onClick:()=>h("view"),disabled:m,style:{flex:1,padding:"14px 20px",borderRadius:10,border:"1px solid #334155",background:"transparent",color:"#cbd5e1",fontSize:14,fontWeight:600,cursor:m?"not-allowed":"pointer"},children:"Cancel"}),o.jsx("button",{onClick:async()=>{if(y.trim()){b(!0),w("");try{await Ct.counterProposeInvite(n,{proposed_percentage:f,message:y}),C("Counter-proposal sent! Waiting for response..."),setTimeout(()=>{t()},2e3)}catch(e){w(e.message||"Failed to send counter-proposal")}finally{b(!1)}}else w("Please add a message explaining your counter-proposal")},disabled:m||!y.trim()||y.length>500,style:{flex:2,padding:"14px 20px",borderRadius:10,border:"none",background:"#3b82f6",color:"#fff",fontSize:14,fontWeight:700,cursor:m||!y.trim()||y.length>500?"not-allowed":"pointer",opacity:m||!y.trim()||y.length>500?.6:1},children:m?"Sending...":"Send Counter-Offer"})]})]}):o.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"No invite found for this project."})})]})})}function Rt({isOpen:e,onClose:t,anchorEl:n}){const a=S(),i=j.useRef(null),[r,s]=j.useState(!1),[l,c]=j.useState(null),{notifications:d,unreadCount:p,isLoading:u,markAsRead:h,markAllAsRead:f,deleteNotification:g,refresh:y}=vt(),x=d.slice(0,10),m=async e=>{e.read||await h(e.id),c(e),s(!0)};j.useEffect(()=>{if(!e)return;const a=e=>{i.current&&!i.current.contains(e.target)&&n&&!n.contains(e.target)&&t()},o=setTimeout(()=>{document.addEventListener("mousedown",a)},100);return()=>{clearTimeout(o),document.removeEventListener("mousedown",a)}},[e,t,n]),j.useEffect(()=>{if(!e)return;const n=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[e,t]),j.useEffect(()=>{e&&y()},[e,y]);return e?o.jsxs("div",{ref:i,role:"dialog","aria-label":"Notifications","aria-modal":"false",style:{position:"absolute",top:"100%",right:0,marginTop:8,width:"min(420px, calc(100vw - 32px))",maxHeight:600,background:"#0f172a",border:"1px solid #1f2937",borderRadius:12,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5)",zIndex:3e3,display:"flex",flexDirection:"column",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #1f2937",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#e5e7eb",margin:0},children:"Notifications"}),p>0&&o.jsx("div",{"aria-label":`${p} unread`,style:{background:"#ef4444",color:"#fff",fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:10,minWidth:20,textAlign:"center"},children:p})]}),x.length>0&&p>0&&o.jsx("button",{onClick:async()=>{try{await f()}catch(e){}},"aria-label":"Mark all as read",style:{background:"transparent",color:"#3b82f6",border:"none",fontSize:12,fontWeight:600,cursor:"pointer",padding:"4px 8px",borderRadius:4,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"Mark All Read"})]}),o.jsx("div",{style:{flex:1,overflowY:"auto",maxHeight:500},children:u&&0===x.length?o.jsx("div",{style:{padding:40,textAlign:"center",color:"#94a3b8",fontSize:14},children:"Loading notifications..."}):0===x.length?o.jsxs("div",{style:{padding:40,textAlign:"center",color:"#94a3b8"},children:[o.jsx("div",{style:{marginBottom:12},"aria-hidden":"true",children:o.jsx(B,{size:48,color:"#64748b",strokeWidth:1.5})}),o.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:4},children:"No notifications yet"}),o.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"We'll notify you when there's activity on your collaborations"})]}):o.jsx("div",{style:{padding:"8px 0"},children:x.map(e=>o.jsx(wt,{notification:e,onClick:()=>(async e=>{e.read||await h(e.id),e.action_url?(a(e.action_url),t()):e.project_id&&(a(`/collaborations/${e.project_id}`),t())})(e),onDelete:t=>(async(e,t)=>{e.stopPropagation();try{await g(t)}catch(n){}})(t,e.id),onViewInvite:m},e.id))})}),x.length>0&&o.jsx("div",{style:{padding:"12px 20px",borderTop:"1px solid #1f2937",display:"flex",gap:8},children:o.jsxs("button",{onClick:()=>{a("/notifications"),t()},"aria-label":"View all notifications",style:{background:"transparent",color:"#3b82f6",border:"none",fontSize:13,fontWeight:600,cursor:"pointer",padding:"6px 12px",borderRadius:6,flex:1,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:["View All (",d.length,")"]})}),l&&l.project_id&&o.jsx(Tt,{open:r,onClose:()=>{s(!1),c(null),y()},projectId:l.project_id,notificationMessage:l.message})]}):null}function _t(){const[e,t]=j.useState(!1),[n,a]=j.useState(!1),i=j.useRef(null),{unreadCount:r}=function(e=!1){const[t,n]=j.useState(0),a=j.useCallback(async()=>{try{const e=await jt.getUnreadCount();n(e)}catch(e){}},[]);return j.useEffect(()=>{const t=yt.on("notifications:unread-count",({count:e})=>{n(e)});return e&&a(),()=>{t()}},[e,a]),{unreadCount:t,refresh:a}}(),{isMobile:s}=nt(),l=S();j.useEffect(()=>{const e=yt.on("notifications:new",()=>{a(!0),setTimeout(()=>a(!1),1e3)});return()=>e()},[]);return o.jsxs("div",{style:{position:"relative"},children:[o.jsxs("button",{ref:i,onClick:()=>{s?l("/notifications"):t(!e)},"aria-label":"Notifications"+(r>0?` (${r} unread)`:""),"aria-expanded":e,"aria-haspopup":"true",className:"rb-nav-link",title:"Notifications",children:[o.jsxs("span",{style:{position:"relative",display:"flex",alignItems:"center"},children:[o.jsx(B,{size:20,style:{animation:n?"ring 1s ease-in-out":"none",transformOrigin:"top center"}}),r>0&&o.jsx("span",{style:{position:"absolute",top:-6,right:-8,background:"#ef4444",color:"#fff",fontSize:10,fontWeight:700,padding:"2px 5px",borderRadius:10,minWidth:16,textAlign:"center",boxShadow:"0 0 8px rgba(239, 68, 68, 0.5)"},"aria-label":`${r} unread notifications`,children:r})]}),o.jsx("span",{children:"Alerts"})]}),o.jsx(Rt,{isOpen:e,onClose:()=>t(!1),anchorEl:i.current}),o.jsx("style",{children:"\n        @keyframes ring {\n          0%, 100% { transform: rotate(0deg); }\n          10%, 30%, 50%, 70% { transform: rotate(15deg); }\n          20%, 40%, 60%, 80% { transform: rotate(-15deg); }\n          90% { transform: rotate(5deg); }\n        }\n      "})]})}function Et({notification:e,onDismiss:t,autoDismissMs:n=5e3}){const a=S(),[i,r]=j.useState(!1),s=mt(e.type),l=bt(e.type);j.useEffect(()=>{const e=setTimeout(()=>{c()},n);return()=>clearTimeout(e)},[n]);const c=()=>{r(!0),setTimeout(()=>{t()},300)};return o.jsxs("div",{role:"alert","aria-live":"polite","aria-atomic":"true",style:{width:380,background:"#1e293b",border:`1px solid ${l}40`,borderLeft:`4px solid ${l}`,borderRadius:8,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",overflow:"hidden",marginBottom:12,animation:i?"slideOut 0.3s ease-out forwards":"slideIn 0.3s ease-out"},children:[o.jsx("div",{style:{height:3,background:`linear-gradient(90deg, ${l} 0%, transparent 100%)`,animation:`progress ${n}ms linear forwards`}}),o.jsxs("div",{style:{padding:"16px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12,marginBottom:12},children:[o.jsx("div",{style:{fontSize:24,width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:`${l}20`,borderRadius:8,flexShrink:0},"aria-hidden":"true",children:s}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#e5e7eb",marginBottom:4,lineHeight:1.3},children:e.title}),o.jsx("div",{style:{fontSize:13,color:"#94a3b8",lineHeight:1.4},children:e.message})]}),o.jsx("button",{onClick:c,"aria-label":"Dismiss notification",style:{background:"transparent",border:"none",color:"#64748b",cursor:"pointer",padding:4,fontSize:20,lineHeight:1,transition:"color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.color="#64748b"},children:"Ã—"})]}),o.jsxs("div",{style:{display:"flex",gap:8},children:[(e.action_url||e.project_id)&&o.jsx("button",{onClick:()=>{e.action_url?a(e.action_url):e.project_id&&a(`/collaborations/${e.project_id}`),c()},style:{background:l,color:"#fff",border:"none",borderRadius:6,padding:"6px 16px",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.opacity="0.9",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.opacity="1",e.currentTarget.style.transform="translateY(0)"},children:"View"}),o.jsx("button",{onClick:c,style:{background:"transparent",color:"#94a3b8",border:"1px solid #334155",borderRadius:6,padding:"6px 16px",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#334155",e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},children:"Dismiss"})]})]}),o.jsx("style",{children:"\n        @keyframes slideIn {\n          from {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n\n        @keyframes slideOut {\n          from {\n            transform: translateX(0);\n            opacity: 1;\n          }\n          to {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n        }\n\n        @keyframes progress {\n          from {\n            transform: scaleX(1);\n          }\n          to {\n            transform: scaleX(0);\n          }\n        }\n      "})]})}function zt(){const[e,t]=j.useState([]);j.useEffect(()=>{const e=yt.on("notifications:new",({notifications:e})=>{t(t=>[...t,...e])});return()=>e()},[]);return 0===e.length?null:o.jsx("div",{"aria-live":"polite","aria-atomic":"false",style:{position:"fixed",top:80,right:20,zIndex:9999,display:"flex",flexDirection:"column",alignItems:"flex-end",pointerEvents:"none"},children:o.jsx("div",{style:{pointerEvents:"auto"},children:e.map(e=>o.jsx(Et,{notification:e,onDismiss:()=>{return n=e.id,void t(e=>e.filter(e=>e.id!==n));var n}},e.id))})})}function $t({isOpen:e,onClose:t}){const[n,a]=j.useState(""),[i,r]=j.useState(""),[s,l]=j.useState(!1),[c,d]=j.useState(!1),[p,u]=j.useState("");if(!e)return null;return o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},onClick:t,children:o.jsx("div",{style:{background:"#1a1f2e",border:"1px solid #2a3444",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:c?o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"âœ“"}),o.jsx("h2",{style:{fontSize:"24px",fontWeight:700,color:"#10b981",margin:"0 0 8px 0"},children:"Thank You!"}),o.jsx("p",{style:{fontSize:"14px",color:"#94a3b8",margin:0},children:"Your feedback helps us improve renaissBlock"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[o.jsx("h2",{style:{fontSize:"24px",fontWeight:700,color:"#e5e7eb",margin:0},children:"Beta Feedback"}),o.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:"24px",cursor:"pointer",padding:"0",lineHeight:1},children:"Ã—"})]}),o.jsx("p",{style:{fontSize:"14px",color:"#94a3b8",margin:0},children:"Help us improve by sharing your thoughts, bugs, or feature requests"})]}),o.jsxs("form",{onSubmit:async e=>{e.preventDefault(),l(!0),u("");try{(await fetch(`${z}/api/feedback/`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({feedback:n,email:i||"anonymous"})})).ok?(d(!0),a(""),r(""),setTimeout(()=>{t(),d(!1)},2e3)):u("Failed to submit feedback. Please try again.")}catch(o){u("Network error. Please try again later.")}finally{l(!1)}},style:{display:"grid",gap:"16px"},children:[o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",fontSize:"13px",color:"#cbd5e1",marginBottom:"8px",fontWeight:600},children:"Your Feedback *"}),o.jsx("textarea",{value:n,onChange:e=>a(e.target.value),placeholder:"Tell us what you think! Include bugs, feature requests, or general feedback...",required:!0,rows:6,style:{width:"100%",padding:"12px",background:"#0f1419",border:"1px solid #2a3444",borderRadius:"8px",color:"#e5e7eb",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{display:"block",fontSize:"13px",color:"#cbd5e1",marginBottom:"8px",fontWeight:600},children:"Email (optional)"}),o.jsx("input",{type:"email",value:i,onChange:e=>r(e.target.value),placeholder:"your@email.com (if you'd like a response)",style:{width:"100%",padding:"12px",background:"#0f1419",border:"1px solid #2a3444",borderRadius:"8px",color:"#e5e7eb",fontSize:"14px"}})]}),p&&o.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#dc2626",borderRadius:"8px",fontSize:"14px"},children:p}),o.jsx("button",{type:"submit",disabled:s||!n.trim(),style:{background:s?"#94a3b8":"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",border:"none",padding:"14px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:700,cursor:s?"not-allowed":"pointer",width:"100%"},children:s?"Submitting...":"Submit Feedback"})]})]})})})}function Pt({variant:e="header",showTestMode:t=!0}){return"header"===e?o.jsx("span",{style:{display:"inline-flex",alignItems:"center",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:700,color:"#000",letterSpacing:"0.3px"},children:"Beta"}):"inline"===e?o.jsx("span",{style:{display:"inline-block",background:"#f59e0b",color:"#000",padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:700,letterSpacing:"0.5px",marginLeft:"8px"},children:"BETA"}):"full"===e?o.jsxs("div",{style:{background:"linear-gradient(135deg, #f59e0b15 0%, #d9770615 100%)",border:"1px solid #f59e0b40",borderRadius:"12px",padding:"16px 20px",display:"flex",alignItems:"center",gap:"16px"},children:[o.jsx("div",{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:700,color:"#000",letterSpacing:"0.5px",whiteSpace:"nowrap"},children:"BETA"}),o.jsxs("div",{style:{flex:1},children:[o.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#e5e7eb",marginBottom:"4px"},children:"You're in the Beta!"}),o.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8",lineHeight:1.4},children:["Help us improve by"," ",o.jsx("a",{href:"mailto:feedback@renaissblock.com",style:{color:"#f59e0b",textDecoration:"none",fontWeight:600},children:"sharing feedback"}),". All transactions are in test mode."]})]})]}):null}function Lt(){const[e,t]=j.useState(!1);return o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>t(!0),style:{position:"fixed",bottom:20,right:20,background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",border:"none",padding:"12px 20px",borderRadius:"30px",fontSize:"14px",fontWeight:700,cursor:"pointer",zIndex:1e3,boxShadow:"0 4px 12px rgba(245, 158, 11, 0.4)",display:"flex",alignItems:"center",gap:"8px",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 6px 16px rgba(245, 158, 11, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(245, 158, 11, 0.4)"},title:"Send feedback about the beta",children:[o.jsx(se,{size:18}),"Feedback"]}),o.jsx($t,{isOpen:e,onClose:()=>t(!1)})]})}function Xt({onClose:e}){return o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},onClick:e,children:o.jsxs("div",{style:{background:"#1a1f2e",border:"1px solid #2a3444",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:[o.jsxs("div",{style:{textAlign:"center",marginBottom:"24px"},children:[o.jsx("div",{style:{display:"inline-block",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"12px 24px",borderRadius:"12px",fontSize:"18px",fontWeight:700,color:"#000",letterSpacing:"1px",marginBottom:"16px"},children:"BETA TESTER"}),o.jsx("h2",{style:{fontSize:"24px",fontWeight:700,color:"#e5e7eb",margin:"0 0 8px 0"},children:"Welcome to renaissBlock Beta!"}),o.jsx("p",{style:{fontSize:"14px",color:"#94a3b8",margin:0},children:"You're one of the first creators to experience the future"})]}),o.jsxs("div",{style:{marginBottom:"24px"},children:[o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#f59e0b",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:[o.jsx(Z,{size:16})," Test Mode Active"]}),o.jsxs("ul",{style:{fontSize:"13px",color:"#cbd5e1",margin:"0",paddingLeft:"20px",lineHeight:1.6},children:[o.jsx("li",{children:"No real money charged (use test card: 4242 4242 4242 4242)"}),o.jsx("li",{children:"Blockchain features use Solana devnet (fake SOL)"}),o.jsx("li",{children:"Some features still being polished"})]})]}),o.jsxs("div",{style:{marginBottom:"16px"},children:[o.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#f59e0b",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:[o.jsx(ne,{size:16})," What to Try"]}),o.jsxs("ul",{style:{fontSize:"13px",color:"#cbd5e1",margin:"0",paddingLeft:"20px",lineHeight:1.6},children:[o.jsx("li",{children:"Create and publish your first content"}),o.jsx("li",{children:"Collaborate with other beta testers"}),o.jsx("li",{children:"Test the purchase and reading experience"})]})]}),o.jsxs("div",{style:{background:"#f59e0b20",border:"1px solid #f59e0b40",borderRadius:"8px",padding:"12px",marginTop:"16px"},children:[o.jsxs("div",{style:{fontSize:"13px",color:"#fbbf24",fontWeight:600,marginBottom:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[o.jsx(Q,{size:14})," Beta Perks"]}),o.jsx("p",{style:{fontSize:"12px",color:"#cbd5e1",margin:0,lineHeight:1.5},children:"As a beta tester, you'll get early access to new features and special recognition when we launch!"})]})]}),o.jsxs("div",{style:{textAlign:"center"},children:[o.jsxs("button",{onClick:e,style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",border:"none",padding:"12px 32px",borderRadius:"8px",fontSize:"14px",fontWeight:700,cursor:"pointer",width:"100%",marginBottom:"12px"},children:["Let's Go! ",o.jsx(de,{size:16,style:{marginLeft:4}})]}),o.jsxs("div",{style:{fontSize:"12px",color:"#64748b"},children:["Questions?"," ",o.jsx("a",{href:"mailto:feedback@renaissblock.com",style:{color:"#f59e0b",textDecoration:"none",fontWeight:600},children:"feedback@renaissblock.com"})]})]})]})})}function Mt(){const{isAuthenticated:e,user:t}=De(),[n,a]=j.useState(!1);j.useEffect(()=>{if(!e||!t)return;const n=localStorage.getItem("beta_welcome_seen_users");(n?new Set(JSON.parse(n)):new Set).has(String(t.id))||setTimeout(()=>{a(!0)},1e3)},[e,t]);return o.jsx(o.Fragment,{children:n&&o.jsx(Xt,{onClose:()=>{if(t){const e=localStorage.getItem("beta_welcome_seen_users"),n=e?new Set(JSON.parse(e)):new Set;n.add(String(t.id)),localStorage.setItem("beta_welcome_seen_users",JSON.stringify([...n]))}a(!1)}})})}function It(){const e=(new Date).getFullYear();return o.jsx("footer",{style:{marginTop:"auto",padding:"24px 20px",borderTop:"1px solid var(--border, #334155)",background:"var(--bg-secondary, #1e293b)"},children:o.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-start",gap:32},children:[o.jsxs("div",{style:{minWidth:200},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[o.jsx("img",{src:"/rb-logo.png",alt:"renaissBlock",style:{height:28,width:"auto",borderRadius:4}}),o.jsx("span",{style:{fontSize:16,fontWeight:700,color:"var(--text, #e5e7eb)"},children:"renaissBlock"})]}),o.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"A platform for serious creators."})]}),o.jsxs("div",{style:{minWidth:150},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--text, #e5e7eb)",marginBottom:12,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Legal"}),o.jsxs("nav",{style:{display:"flex",flexDirection:"column",gap:8},children:[o.jsx(v,{to:"/legal/terms",style:Wt,children:"Terms of Service"}),o.jsx(v,{to:"/legal/privacy",style:Wt,children:"Privacy Policy"}),o.jsx(v,{to:"/legal/content-policy",style:Wt,children:"Content Policy"}),o.jsx(v,{to:"/legal/dmca",style:Wt,children:"DMCA / Copyright"}),o.jsx(v,{to:"/legal/creator-agreement",style:Wt,children:"Creator Agreement"})]})]}),o.jsxs("div",{style:{minWidth:150},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--text, #e5e7eb)",marginBottom:12,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Support"}),o.jsxs("nav",{style:{display:"flex",flexDirection:"column",gap:8},children:[o.jsx("a",{href:"mailto:support@renaissblock.com",style:Wt,children:"Contact Us"}),o.jsx("a",{href:"mailto:dmca@renaissblock.com",style:Wt,children:"Report Copyright"}),o.jsx("a",{href:"mailto:reports@renaissblock.com",style:Wt,children:"Report Content"})]})]}),o.jsx("div",{style:{width:"100%",paddingTop:16,borderTop:"1px solid var(--border, #334155)",marginTop:8},children:o.jsxs("div",{style:{fontSize:12,color:"var(--text-muted, #94a3b8)",textAlign:"center"},children:["Â© ",e," renaissBlock. All rights reserved."]})})]})})}const Wt={fontSize:13,color:"var(--text-muted, #94a3b8)",textDecoration:"none",transition:"color 0.2s"},Ot="rb_cookie_consent";function At(){const[e,t]=j.useState(!1),[n,a]=j.useState(!1),[i,r]=j.useState({necessary:!0,analytics:!1,marketing:!1});j.useEffect(()=>{if(!localStorage.getItem(Ot)){const e=setTimeout(()=>t(!0),1e3);return()=>clearTimeout(e)}},[]);const s=e=>{localStorage.setItem(Ot,JSON.stringify({...e,timestamp:(new Date).toISOString()})),t(!1)},l=()=>{s({necessary:!0,analytics:!1,marketing:!1})};return e?o.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,zIndex:9999,background:"var(--bg, #0f172a)",borderTop:"1px solid var(--border, #334155)",padding:"16px 20px",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:o.jsx("div",{style:{maxWidth:1200,margin:"0 auto"},children:n?o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:600,color:"var(--text, #e5e7eb)"},children:"Cookie Preferences"}),o.jsx("button",{onClick:()=>a(!1),style:{background:"none",border:"none",padding:4,cursor:"pointer",color:"var(--text-muted, #94a3b8)"},children:o.jsx(ge,{size:18})})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:16},children:[o.jsxs("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:12,background:"var(--bg-secondary, #1e293b)",borderRadius:6},children:[o.jsx("input",{type:"checkbox",checked:!0,disabled:!0,style:{marginTop:3}}),o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:500,color:"var(--text, #e5e7eb)",marginBottom:2},children:"Necessary Cookies"}),o.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"Required for the website to function. Cannot be disabled."})]})]}),o.jsxs("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:12,background:"var(--bg-secondary, #1e293b)",borderRadius:6,cursor:"pointer"},children:[o.jsx("input",{type:"checkbox",checked:i.analytics,onChange:e=>r(t=>({...t,analytics:e.target.checked})),style:{marginTop:3}}),o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:500,color:"var(--text, #e5e7eb)",marginBottom:2},children:"Analytics Cookies"}),o.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"Help us understand how you use the site to improve it."})]})]}),o.jsxs("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:12,background:"var(--bg-secondary, #1e293b)",borderRadius:6,cursor:"pointer"},children:[o.jsx("input",{type:"checkbox",checked:i.marketing,onChange:e=>r(t=>({...t,marketing:e.target.checked})),style:{marginTop:3}}),o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:500,color:"var(--text, #e5e7eb)",marginBottom:2},children:"Marketing Cookies"}),o.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"Used to show you relevant content and ads."})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[o.jsx("button",{onClick:l,style:{padding:"8px 16px",borderRadius:6,border:"1px solid var(--border, #334155)",background:"transparent",color:"var(--text, #e5e7eb)",fontSize:13,cursor:"pointer"},children:"Reject All"}),o.jsx("button",{onClick:()=>{s(i)},style:{padding:"8px 16px",borderRadius:6,border:"none",background:"var(--accent, #f59e0b)",color:"#000",fontSize:13,fontWeight:600,cursor:"pointer"},children:"Save Preferences"})]})]}):o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:16,justifyContent:"space-between"},children:[o.jsx("div",{style:{flex:"1 1 400px"},children:o.jsxs("p",{style:{margin:0,fontSize:14,color:"var(--text, #e5e7eb)"},children:["We use cookies to improve your experience."," ",o.jsx(v,{to:"/legal/privacy",style:{color:"var(--accent, #f59e0b)"},children:"Learn more in our Privacy Policy"})]})}),o.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[o.jsx("button",{onClick:()=>a(!0),style:{padding:"8px 16px",borderRadius:6,border:"1px solid var(--border, #334155)",background:"transparent",color:"var(--text, #e5e7eb)",fontSize:13,cursor:"pointer"},children:"Customize"}),o.jsx("button",{onClick:l,style:{padding:"8px 16px",borderRadius:6,border:"1px solid var(--border, #334155)",background:"transparent",color:"var(--text, #e5e7eb)",fontSize:13,cursor:"pointer"},children:"Reject Non-Essential"}),o.jsx("button",{onClick:()=>{s({necessary:!0,analytics:!0,marketing:!0})},style:{padding:"8px 16px",borderRadius:6,border:"none",background:"var(--accent, #f59e0b)",color:"#000",fontSize:13,fontWeight:600,cursor:"pointer"},children:"Accept All"})]})]})})}):null}const Bt=j.createContext(void 0);function qt({children:e}){const[t,n]=j.useState(null),[a,i]=j.useState(!0),[r,s]=j.useState(null),l=async()=>{try{const e=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch{return""}},c=j.useCallback(async()=>{try{const e=await fetch(`${z}/api/cart/`,{credentials:"include"});if(e.ok){const t=await e.json();n(t),s(null)}else 403===e.status&&n(null)}catch(e){}finally{i(!1)}},[]);j.useEffect(()=>{c()},[c]);return o.jsx(Bt.Provider,{value:{cart:t,loading:a,error:r,addToCart:async(e,t)=>{s(null);try{const n=await l(),a=await fetch(`${z}/api/cart/add/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":n},credentials:"include",body:JSON.stringify({chapter_id:e,content_id:t})}),i=await a.json();return a.ok?(await c(),!0):(s(i.error||"Failed to add to cart"),!1)}catch(n){return s("Failed to add to cart"),!1}},removeFromCart:async e=>{s(null);try{const t=await l();return!!(await fetch(`${z}/api/cart/remove/${e}/`,{method:"DELETE",headers:{"X-CSRFToken":t},credentials:"include"})).ok&&(await c(),!0)}catch(t){return!1}},clearCart:async()=>{s(null);try{const e=await l();await fetch(`${z}/api/cart/clear/`,{method:"POST",headers:{"X-CSRFToken":e},credentials:"include"}),await c()}catch(e){}},checkout:async()=>{s(null);try{const e=await l(),t=await fetch(`${z}/api/cart/checkout/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":e},credentials:"include"}),n=await t.json();return t.ok?n.checkout_url:(s(n.error||"Checkout failed"),null)}catch(e){return s("Checkout failed"),null}},refreshCart:c,isInCart:(e,n)=>!!t&&t.items.some(t=>t.item_id===e&&t.type===n)},children:e})}function Nt(){const e=j.useContext(Bt);if(!e)throw new Error("useCart must be used within CartProvider");return e}function Ft({className:e=""}){const{cart:t,loading:n}=Nt(),a=(null==t?void 0:t.item_count)||0;return o.jsxs(v,{to:"/cart",className:`rb-nav-link rb-cart-icon ${e}`,title:a>0?`Cart (${a} items)`:"Cart",style:{position:"relative",display:"flex",alignItems:"center",color:"var(--text, #e2e8f0)",textDecoration:"none"},children:[o.jsxs("span",{style:{position:"relative",display:"flex",alignItems:"center"},children:[o.jsx(ue,{size:20}),!n&&a>0&&o.jsx("span",{style:{position:"absolute",top:"-6px",right:"-8px",backgroundColor:"var(--accent, #3b82f6)",color:"white",fontSize:"10px",fontWeight:600,minWidth:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 3px"},children:a>99?"99+":a})]}),o.jsx("span",{children:"Cart"})]})}const Dt="rb_recent_searches";function Ht({onSearch:e}){const[t,n]=j.useState(""),[a,i]=j.useState([]),[r,s]=j.useState([]),[l,c]=j.useState(!1),[d,p]=j.useState(-1),[u,h]=j.useState(!1),f=j.useRef(null),g=j.useRef(null),y=S();j.useEffect(()=>{try{const e=localStorage.getItem(Dt);e&&s(JSON.parse(e))}catch{}},[]);j.useEffect(()=>{if(t.length<2)return void i([]);const e=setTimeout(()=>{h(!0),fetch(`${z}/api/search/?q=${encodeURIComponent(t)}`,{credentials:"include"}).then(e=>e.json()).then(e=>{Array.isArray(e)&&i(e.slice(0,6))}).catch(()=>i([])).finally(()=>h(!1))},200);return()=>clearTimeout(e)},[t]),j.useEffect(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const x=t=>{t.trim()&&((e=>{if(!e.trim())return;const t=[e,...r.filter(t=>t!==e)].slice(0,5);s(t);try{localStorage.setItem(Dt,JSON.stringify(t))}catch{}})(t.trim()),c(!1),n(t),e?e(t):y(`/search?q=${encodeURIComponent(t.trim())}`))};j.useEffect(()=>{p(-1)},[a,r]);const m=l&&(t.length>=2?a.length>0:r.length>0);return o.jsxs("div",{ref:g,className:"search-autocomplete",style:{position:"relative",width:"100%"},children:[o.jsxs("form",{onSubmit:e=>{e.preventDefault(),x(t)},className:"rb-search",children:[o.jsx("input",{ref:f,type:"text",value:t,onChange:e=>n(e.target.value),onFocus:()=>c(!0),onKeyDown:e=>{var n,i;const o=(t.length>=2?a:r).length;switch(e.key){case"ArrowDown":e.preventDefault(),p(e=>e<o-1?e+1:e);break;case"ArrowUp":e.preventDefault(),p(e=>e>0?e-1:-1);break;case"Enter":if(e.preventDefault(),d>=0&&d<o){const e=t.length>=2?null==(n=a[d])?void 0:n.title:r[d];e&&x(e)}else x(t);break;case"Escape":c(!1),null==(i=f.current)||i.blur()}},placeholder:"Search",autoComplete:"off"}),o.jsx("button",{type:"submit",children:o.jsx(pe,{size:18})})]}),m&&o.jsx("div",{className:"search-dropdown",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:4,background:"#1e293b",borderRadius:8,boxShadow:"0 4px 20px rgba(0,0,0,0.4)",zIndex:1e3,overflow:"hidden",border:"1px solid #334155"},children:t.length>=2?o.jsx(o.Fragment,{children:a.map((e,t)=>o.jsxs("div",{onClick:()=>x(e.title),style:{display:"flex",alignItems:"center",gap:12,padding:"10px 16px",cursor:"pointer",background:d===t?"#334155":"transparent"},onMouseEnter:()=>p(t),children:[o.jsx(pe,{size:16,style:{color:"#64748b",flexShrink:0}}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{color:"#f1f5f9",fontSize:14,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.title}),e.creator_username&&o.jsxs("div",{style:{color:"#64748b",fontSize:12},children:["by ",e.creator_username]})]}),e.content_type&&o.jsx("span",{style:{fontSize:10,padding:"2px 6px",background:"#334155",borderRadius:4,color:"#94a3b8",textTransform:"capitalize"},children:e.content_type})]},e.id))}):o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{padding:"8px 16px",fontSize:12,color:"#64748b",borderBottom:"1px solid #334155"},children:"Recent searches"}),r.map((e,t)=>o.jsxs("div",{onClick:()=>x(e),style:{display:"flex",alignItems:"center",gap:12,padding:"10px 16px",cursor:"pointer",background:d===t?"#334155":"transparent"},onMouseEnter:()=>p(t),children:[o.jsx(G,{size:16,style:{color:"#64748b",flexShrink:0}}),o.jsx("span",{style:{flex:1,color:"#f1f5f9",fontSize:14},children:e}),o.jsx("button",{onClick:t=>((e,t)=>{t.stopPropagation();const n=r.filter(t=>t!==e);s(n);try{localStorage.setItem(Dt,JSON.stringify(n))}catch{}})(e,t),style:{background:"none",border:"none",padding:4,cursor:"pointer",color:"#64748b",display:"flex",alignItems:"center"},children:o.jsx(ge,{size:14})})]},e))]})})]})}const Jt=j.lazy(()=>m(()=>import("./HomePage-BgEIjoZf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Vt=j.lazy(()=>m(()=>import("./SearchPage-CyHB7p29.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]))),Gt=j.lazy(()=>m(()=>import("./StudioPage-C7FCRiN5.js"),__vite__mapDeps([9,1,2,3,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,7,26,27,28,29,30,6,31,32,33,34,35,36,37,38]))),Ut=j.lazy(()=>m(()=>import("./DashboardPage-BROTydW2.js"),__vite__mapDeps([39,1,2,3]))),Yt=j.lazy(()=>m(()=>import("./ProfilePageRedesigned-C15O8B_w.js"),__vite__mapDeps([40,1,2,3,24,15,25,7,26,14,27,18,28,29,21,41,42,43,33,44,35,30,32,17,34,6,45,46,47,48,37,49,19,23,50,13]))),Kt=j.lazy(()=>m(()=>import("./AuthPage-DFehIRyj.js"),__vite__mapDeps([51,1,2,3]))),Zt=j.lazy(()=>m(()=>import("./WalletInfoPage-yYhiKXfn.js"),__vite__mapDeps([52,1,2,3]))),Qt=j.lazy(()=>m(()=>import("./BetaLanding-CHzm5c2D.js"),__vite__mapDeps([53,1,2,3,54,46,26,55,56]))),en=j.lazy(()=>m(()=>import("./CollaboratorsPage-BkpmoC_n.js"),__vite__mapDeps([57,1,2,3,58,18,19,50,59,20,49,11,23,6,26,47,5]))),tn=j.lazy(()=>m(()=>import("./PublicProfilePage-Bz_Xqv8R.js"),__vite__mapDeps([60,1,2,3,58,18,19,50,59,20,49,11,23,6,26,61,5,27,25,54,13,44,62,47,32,31,63]))),nn=j.lazy(()=>m(()=>import("./ContentDetail-BxAG7xvt.js"),__vite__mapDeps([64,1,2,3,24,15,25,7,26,14,27,18,28,29,21,65,61,5,54,36]))),an=j.lazy(()=>m(()=>import("./PurchaseSuccessPage-D_gTp71O.js"),__vite__mapDeps([66,1,2,3]))),on=j.lazy(()=>m(()=>import("./ReaderPage-BqSOrlxx.js"),__vite__mapDeps([67,1,2,3,15,36,17,20,19,25,29,16,65])).then(e=>({default:e.ReaderPage})));j.lazy(()=>m(()=>import("./CollaborationDashboard-BYc1OOwl.js"),__vite__mapDeps([68,1,2,3,48,37,23,11,10,63,42])));const rn=j.lazy(()=>m(()=>import("./CollaborativeProjectPage-BohqWT6b.js"),__vite__mapDeps([69,1,2,3,23,18,34,13,19,70,59,20,49,11,6,50,26,71,27,12,14,15,16,17,21,22,54,62,28]))),sn=j.lazy(()=>m(()=>import("./NotificationsPage-DfNdBSW7.js"),__vite__mapDeps([72,1,2,3,36,70,48,14]))),ln=j.lazy(()=>m(()=>import("./FollowingFeedPage-CmtHBGzH.js"),__vite__mapDeps([73,1,2,3,25,6,55,50,63]))),cn=j.lazy(()=>m(()=>import("./CartPage-BiyDWFDM.js"),__vite__mapDeps([74,1,2,3,18,35,43,75,41,42,28,13,30,36,14,55,37,71,32]))),dn=j.lazy(()=>m(()=>import("./CartSuccessPage-DHHeBa7I.js"),__vite__mapDeps([76,1,2,3,13,46]))),pn=j.lazy(()=>m(()=>import("./PayoutSettingsPage-BzK_rouj.js"),__vite__mapDeps([77,1,2,3,45,28,34,32,42,5,14,43,33,27,36,37,71,19,75,35]))),un=j.lazy(()=>m(()=>import("./TermsOfServicePage-BaQ74S7m.js"),__vite__mapDeps([78,1,2,3,79]))),hn=j.lazy(()=>m(()=>import("./PrivacyPolicyPage-CC2DCYaw.js"),__vite__mapDeps([80,1,2,3,79]))),fn=j.lazy(()=>m(()=>import("./ContentPolicyPage-Bdd5jst3.js"),__vite__mapDeps([81,1,2,3,79]))),gn=j.lazy(()=>m(()=>import("./DMCAPolicyPage-DNsdqpwJ.js"),__vite__mapDeps([82,1,2,3,79]))),yn=j.lazy(()=>m(()=>import("./CreatorAgreementPage-CvfDGYRa.js"),__vite__mapDeps([83,1,2,3,79]))),xn=()=>o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"200px",color:"var(--text-muted, #94a3b8)"},children:"Loading..."});function mn(){const[e,t]=j.useState(!1),[n,a]=j.useState(""),[i,r]=j.useState(null),[s,l]=j.useState(!1),c=S(),d=w();j.useEffect(()=>{l(!1)},[d.pathname]);const p=R.useCallback(()=>{fetch(`${z}/api/auth/status/`,{credentials:"include"}).then(e=>e.json()).then(e=>{var n;const i=!!(null==e?void 0:e.authenticated);t(i),i&&(null==(n=null==e?void 0:e.user)?void 0:n.username)?(a(e.user.username),r(e.user.avatar_url||null)):(a(""),r(null)),i?jt.isPolling()||jt.startPolling():(jt.isPolling()&&jt.stopPolling(),jt.reset())}).catch(()=>{t(!1),a(""),r(null),jt.stopPolling(),jt.reset()})},[]);j.useEffect(()=>{p();const e=setInterval(p,1e4);return()=>{clearInterval(e),jt.stopPolling()}},[d.pathname,p]),j.useEffect(()=>{"/"===d.pathname&&p()},[d.pathname,p]);return o.jsxs("nav",{className:"rb-header",children:[o.jsxs("div",{className:"rb-header-left",children:[o.jsx(v,{to:"/",className:"rb-logo-link",children:o.jsx("img",{src:"/rb-logo.png",alt:"renaissBlock",className:"rb-logo-img"})}),o.jsx(Pt,{variant:"header",showTestMode:!0})]}),o.jsx("div",{className:"rb-header-center",children:o.jsx(Ht,{})}),o.jsx("button",{className:"rb-mobile-menu-toggle",onClick:()=>l(!s),"aria-label":"Toggle menu",children:s?o.jsx(ge,{size:24}):o.jsx(re,{size:24})}),o.jsxs("div",{className:"rb-header-right rb-nav "+(s?"rb-nav-mobile-open":""),children:[e&&o.jsxs(o.Fragment,{children:[o.jsx(Ft,{}),o.jsx(_t,{}),o.jsxs(v,{to:"/collaborators",className:"rb-nav-link",title:"Find Collaborators",children:[o.jsx(fe,{size:20}),o.jsx("span",{children:"Creators"})]}),o.jsxs(v,{to:"/profile",className:"rb-nav-link rb-profile-link",title:"Profile",children:[i?o.jsx("img",{src:i,alt:n,style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid var(--accent)"}}):o.jsx(he,{size:20}),o.jsxs("span",{children:["@",n||"Profile"]})]}),o.jsxs("button",{onClick:async()=>{try{const e=await fetch(`${z}/api/auth/csrf/`,{credentials:"include"}).then(e=>e.json()).then(e=>(null==e?void 0:e.csrfToken)||"");await fetch(`${z}/api/auth/logout/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":e,"X-Requested-With":"XMLHttpRequest"}})}catch{}try{await Be()}catch(e){}jt.stopPolling(),jt.reset(),t(!1),window.dispatchEvent(new Event("auth-logout")),c("/"),setTimeout(()=>p(),100)},className:"rb-nav-link rb-logout-btn",title:"Logout",children:[o.jsx(ae,{size:20}),o.jsx("span",{children:"Logout"})]})]}),!e&&o.jsxs("button",{onClick:()=>{c("/auth")},className:"rb-nav-link rb-signin-btn",children:[o.jsx(he,{size:20}),o.jsx("span",{children:"Sign in"})]})]})]})}function bn(){const e=w(),{isAuthenticated:t,loading:n}=De(),{isMobile:a}=nt(),[i,r]=j.useState(!0),s=!a&&t&&[/^\/$/,/^\/search/].some(t=>t.test(e.pathname)),l=a&&t&&"/"===e.pathname,c=/^\/reader/.test(e.pathname),d=!s,p=["/auth","/terms","/wallet-info","/beta","/profile/","/legal"].some(t=>e.pathname.startsWith(t));if(n)return o.jsx("div",{className:"rb-app",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"var(--bg)",color:"var(--text)"},children:o.jsx("div",{style:{textAlign:"center"},children:o.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"Loading..."})})});if(!t&&!p)return o.jsxs("div",{className:"rb-app",children:[o.jsx(Qt,{}),o.jsx(zt,{})]});return"/beta"===e.pathname?o.jsxs("div",{className:"rb-app",children:[o.jsx(Qt,{}),o.jsx(zt,{})]}):c?o.jsx("div",{className:"rb-app",children:o.jsx(it,{children:o.jsx(j.Suspense,{fallback:o.jsx(xn,{}),children:o.jsx(C,{children:o.jsx(T,{path:"/reader/:contentId",element:o.jsx(on,{})})})})})}):o.jsx(qt,{children:o.jsx(Ge,{children:o.jsxs("div",{className:"rb-app",children:[o.jsx(mn,{}),s&&o.jsx(Ye,{isExpanded:i,onExpandedChange:r}),o.jsxs("main",{className:"rb-main",style:{display:"grid",gridTemplateColumns:"1fr",gap:16,marginLeft:s?i?320:48:0,marginRight:0,width:s?i?"calc(100% - 320px)":"calc(100% - 48px)":"100%",transition:"margin-left 0.3s ease, width 0.3s ease"},children:[!1,o.jsxs("div",{style:{width:"100%",minWidth:0},children:[l&&o.jsx(et,{}),o.jsx(it,{children:o.jsx(j.Suspense,{fallback:o.jsx(xn,{}),children:o.jsxs(C,{children:[o.jsx(T,{path:"/",element:o.jsx(Jt,{})}),o.jsx(T,{path:"/beta",element:o.jsx(Qt,{})}),o.jsx(T,{path:"/login",element:o.jsx(k,{to:"/auth",replace:!0})}),o.jsx(T,{path:"/signup",element:o.jsx(k,{to:"/auth",replace:!0})}),o.jsx(T,{path:"/search",element:o.jsx(Vt,{})}),o.jsx(T,{path:"/studio",element:o.jsx(Gt,{})}),o.jsx(T,{path:"/dashboard",element:o.jsx(Ut,{})}),o.jsx(T,{path:"/profile",element:o.jsx(Yt,{})}),o.jsx(T,{path:"/profile/:username",element:o.jsx(tn,{})}),o.jsx(T,{path:"/collaborators",element:o.jsx(en,{})}),o.jsx(T,{path:"/auth",element:o.jsx(Kt,{})}),o.jsx(T,{path:"/wallet-info",element:o.jsx(Zt,{})}),o.jsx(T,{path:"/terms",element:o.jsx(un,{})}),o.jsx(T,{path:"/legal/terms",element:o.jsx(un,{})}),o.jsx(T,{path:"/legal/privacy",element:o.jsx(hn,{})}),o.jsx(T,{path:"/legal/content-policy",element:o.jsx(fn,{})}),o.jsx(T,{path:"/legal/dmca",element:o.jsx(gn,{})}),o.jsx(T,{path:"/legal/creator-agreement",element:o.jsx(yn,{})}),o.jsx(T,{path:"/content/:id",element:o.jsx(nn,{})}),o.jsx(T,{path:"/purchase/success",element:o.jsx(an,{})}),o.jsx(T,{path:"/cart",element:o.jsx(at,{children:o.jsx(cn,{})})}),o.jsx(T,{path:"/cart/success",element:o.jsx(at,{children:o.jsx(dn,{})})}),o.jsx(T,{path:"/collaborations",element:o.jsx(k,{to:"/profile?tab=collaborations",replace:!0})}),o.jsx(T,{path:"/collaborations/:projectId",element:o.jsx(at,{children:o.jsx(rn,{})})}),o.jsx(T,{path:"/notifications",element:o.jsx(at,{children:o.jsx(sn,{})})}),o.jsx(T,{path:"/feed",element:o.jsx(at,{children:o.jsx(ln,{})})}),o.jsx(T,{path:"/payout-settings",element:o.jsx(at,{children:o.jsx(pn,{})})})]})})})]})]}),d&&o.jsx(It,{}),o.jsx(zt,{}),o.jsx(At,{}),o.jsx(Lt,{}),o.jsx(Mt,{})]})})})}window.Buffer||(window.Buffer=n),window.process||(window.process=a);b.createRoot(document.getElementById("root")).render(o.jsx(R.StrictMode,{children:o.jsx(_,{children:o.jsx(bn,{})})}));export{z as A,N as B,J as C,U as D,Fe as E,K as F,Le as G,Ee as H,ee as I,Re as J,Ae as K,Ie as L,re as M,wt as N,ze as O,ce as P,Oe as Q,de as R,pe as S,ye as T,fe as U,Ne as V,ge as X,F as a,V as b,O as c,Ct as d,G as e,Tt as f,le as g,De as h,D as i,H as j,se as k,he as l,Ue as m,Nt as n,ue as o,$ as p,B as q,Y as r,vt as s,Je as t,nt as u,qe as v,Me as w,We as x,xe as y,we as z};
