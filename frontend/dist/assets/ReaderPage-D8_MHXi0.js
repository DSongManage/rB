import{j as e}from"./web3auth-Sk1I85Hw.js";import{r,a as t,f as n}from"./router-XSTgIKKd.js";import{c as o,i as a,j as i,X as s,B as l,u as d,p as c}from"./index-BeJcpABu.js";import{s as p,p as u}from"./regionCalculator-D3m0QDUE.js";import{A as x}from"./arrow-left-9ZwHef2f.js";import{S as g}from"./settings-D0QdJPmp.js";import{T as f}from"./type-DcqIeQR-.js";import{P as h}from"./plus-M4LBYNoy.js";import{e as b}from"./socialApi-DAfCeVP0.js";import{C as m}from"./ComicPageRenderer-BI3ujhV2.js";import{G as y}from"./grid-3x3-B4WBwGxR.js";import{C as v}from"./CopyrightNotice-QO9KeZVg.js";import"./vendor-Cfs_Iq82.js";
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=o("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),k=o("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),w=o("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),S=o("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]),C=o("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),z=o("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),R=o("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),I=o("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]),E=o("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),T=o("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),A=o("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),M={fontSize:"medium",lineHeight:"normal",theme:"dark",fontFamily:"bookerly",margins:"medium",textAlign:"justify",columns:"two",continuousScroll:!1},L={xsmall:"14px",small:"16px",medium:"18px",large:"22px",xlarge:"26px"},F={compact:"1.4",normal:"1.7",relaxed:"2.0"},B={light:{background:"#ffffff",text:"#1a1a1a",secondary:"#6b7280",border:"#e5e7eb",accent:"#0066cc"},sepia:{background:"#f5e6c8",text:"#5b4636",secondary:"#8b7355",border:"#d4c4a8",accent:"#8b5a2b"},green:{background:"#d4e8d4",text:"#2d4a2d",secondary:"#4a6b4a",border:"#a8c8a8",accent:"#2d6b2d"},dark:{background:"#0a1628",text:"#c9d1d9",secondary:"#8b949e",border:"#21262d",accent:"#58a6ff"}},P={"amazon-ember":{name:"Amazon Ember",css:"'Amazon Ember', 'Helvetica Neue', Helvetica, Arial, sans-serif"},baskerville:{name:"Baskerville",css:"Baskerville, 'Baskerville Old Face', 'Times New Roman', serif"},bookerly:{name:"Bookerly",css:"Bookerly, Georgia, 'Times New Roman', serif"},georgia:{name:"Georgia",css:"Georgia, 'Times New Roman', serif"},palatino:{name:"Palatino",css:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"}},W={narrow:"20px",medium:"48px",wide:"80px"},D="rb_reader_settings";function _(){const[e,t]=r.useState(()=>{try{const e=localStorage.getItem(D);if(e){const r=function(e){const r={...e};"serif"===e.fontFamily?r.fontFamily="georgia":"sans-serif"===e.fontFamily&&(r.fontFamily="amazon-ember");r.margins||(r.margins=M.margins);r.textAlign||(r.textAlign=M.textAlign);r.columns||(r.columns=M.columns);void 0===r.continuousScroll&&(r.continuousScroll=M.continuousScroll);return r}(JSON.parse(e));return{...M,...r}}}catch(e){}return M});r.useEffect(()=>{try{localStorage.setItem(D,JSON.stringify(e))}catch(r){}},[e]);const n=r.useCallback((e,r)=>{t(t=>({...t,[e]:r}))},[]),o=r.useCallback(()=>{t(M)},[]),a=r.useMemo(()=>({"--reader-font-size":L[e.fontSize],"--reader-line-height":F[e.lineHeight],"--reader-bg":B[e.theme].background,"--reader-text":B[e.theme].text,"--reader-secondary":B[e.theme].secondary,"--reader-border":B[e.theme].border,"--reader-accent":B[e.theme].accent,"--reader-font-family":P[e.fontFamily].css,"--reader-margin":W[e.margins],"--reader-text-align":e.textAlign}),[e]),i=`reader-theme-${e.theme}`;return{settings:e,updateSetting:n,resetSettings:o,cssVars:a,themeClass:i}}function N({title:r,chapterTitle:t,onBack:n,onToggleSettings:o,onToggleTOC:a,visible:i}){return e.jsxs("header",{className:"reader-header "+(i?"visible":"hidden"),style:{position:"fixed",top:0,left:0,right:0,height:"60px",background:"var(--reader-bg)",borderBottom:"1px solid var(--reader-border)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",zIndex:100,transition:"transform 0.3s ease, opacity 0.3s ease",transform:i?"translateY(0)":"translateY(-100%)",opacity:i?1:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:n,className:"reader-icon-button","aria-label":"Go back",style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(x,{size:24})}),e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx("h1",{style:{fontSize:"16px",fontWeight:600,color:"var(--reader-text)",margin:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:"200px"},children:r}),t&&e.jsx("p",{style:{fontSize:"12px",color:"var(--reader-secondary)",margin:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:"200px"},children:t})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("button",{onClick:a,className:"reader-icon-button","aria-label":"Table of Contents",style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(k,{size:24})}),e.jsx("button",{onClick:o,className:"reader-icon-button","aria-label":"Settings",style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(g,{size:24})})]})]})}function H({currentPage:r,totalPages:t,percentComplete:n,visible:o,continuousScroll:a=!1,copyrightYear:i,copyrightHolder:s}){const l=s||i,d=l?"70px":"50px";return e.jsxs("footer",{className:"reader-footer "+(o?"visible":"hidden"),style:{position:"fixed",bottom:0,left:0,right:0,height:d,background:"var(--reader-bg)",borderTop:"1px solid var(--reader-border)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 16px",zIndex:100,transition:"transform 0.3s ease, opacity 0.3s ease",transform:o?"translateY(0)":"translateY(100%)",opacity:o?1:0},children:[e.jsx("div",{style:{width:"100%",maxWidth:"400px",height:"3px",background:"var(--reader-border)",borderRadius:"2px",marginBottom:"8px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${n}%`,height:"100%",background:"var(--reader-accent, var(--reader-secondary))",borderRadius:"2px",transition:"width 0.3s ease"}})}),e.jsx("p",{style:{fontSize:"12px",color:"var(--reader-secondary)",margin:0},children:a?`${n}% complete`:`Page ${r+1} of ${t} (${n}%)`}),l&&e.jsxs("p",{style:{fontSize:"9px",color:"var(--reader-secondary)",margin:"4px 0 0 0",opacity:.7},children:["(C) ",i||(new Date).getFullYear()," ",s,". All Rights Reserved."]})]})}function O({onPrevious:r,onNext:t,onCenter:n,isFirstPage:o,isLastPage:s,showArrows:l,isMobile:d=!1,headerHeight:c=60,footerHeight:p=50}){const u=d?"33%":"25%",x=d?"33%":"25%",g=d?"33%":"25%";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"reader-nav-zone reader-nav-left",onClick:e=>{e.stopPropagation(),o||r()},style:{position:"fixed",left:0,top:d?0:`${c}px`,bottom:d?0:`${p}px`,width:u,cursor:o?"default":"pointer",zIndex:50,display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:d?"8px":"12px"},role:"button","aria-label":"Previous page",children:!d&&l&&!o&&e.jsx("div",{className:"reader-nav-arrow",style:{opacity:.3,transition:"opacity 0.2s ease",color:"var(--reader-secondary)"},children:e.jsx(a,{size:32})})}),e.jsx("div",{className:"reader-nav-zone reader-nav-center",onClick:e=>{e.stopPropagation(),n()},style:{position:"fixed",left:x,right:g,top:d?0:`${c}px`,bottom:d?0:`${p}px`,cursor:"pointer",zIndex:50},role:"button","aria-label":"Toggle controls"}),e.jsx("div",{className:"reader-nav-zone reader-nav-right",onClick:e=>{e.stopPropagation(),s||t()},style:{position:"fixed",right:0,top:d?0:`${c}px`,bottom:d?0:`${p}px`,width:u,cursor:s?"default":"pointer",zIndex:50,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:d?"8px":"12px"},role:"button","aria-label":"Next page",children:!d&&l&&!s&&e.jsx("div",{className:"reader-nav-arrow",style:{opacity:.3,transition:"opacity 0.2s ease",color:"var(--reader-secondary)"},children:e.jsx(i,{size:32})})})]})}function Y({settings:t,updateSetting:n,resetSettings:o,onClose:a,visible:i}){const[l,d]=r.useState("font");if(!i)return null;const c=["xsmall","small","medium","large","xlarge"],p=c.indexOf(t.fontSize);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"reader-settings-backdrop",onClick:a,style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:200,animation:"fadeIn 0.2s ease"}}),e.jsxs("div",{className:"reader-settings-panel",style:{position:"fixed",top:0,right:0,bottom:0,width:"320px",maxWidth:"90vw",background:"var(--reader-bg)",borderLeft:"1px solid var(--reader-border)",zIndex:201,display:"flex",flexDirection:"column",animation:"slideFromRight 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--reader-border)",padding:"0 8px"},children:[[{id:"font",label:"Font"},{id:"layout",label:"Layout"},{id:"themes",label:"Themes"},{id:"more",label:"More"}].map(r=>e.jsx("button",{onClick:()=>d(r.id),style:{flex:1,padding:"16px 8px",background:"none",border:"none",borderBottom:l===r.id?"2px solid var(--reader-accent, #58a6ff)":"2px solid transparent",color:l===r.id?"var(--reader-accent, #58a6ff)":"var(--reader-secondary)",fontSize:"14px",fontWeight:l===r.id?600:400,cursor:"pointer",transition:"all 0.2s ease"},children:r.label},r.id)),e.jsx("button",{onClick:a,style:{background:"none",border:"none",color:"var(--reader-secondary)",cursor:"pointer",padding:"16px 12px"},"aria-label":"Close settings",children:e.jsx(s,{size:20})})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:["font"===l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsx("div",{children:e.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Object.keys(P).map(r=>e.jsxs("button",{onClick:()=>n("fontFamily",r),style:{padding:"12px 16px",border:t.fontFamily===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:t.fontFamily===r?"rgba(88, 166, 255, 0.1)":"transparent",color:t.fontFamily===r?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",fontFamily:P[r].css,fontSize:"18px",minWidth:"70px"},children:["Aa",e.jsx("div",{style:{fontSize:"10px",marginTop:"4px",fontFamily:"system-ui"},children:P[r].name})]},r))})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Size"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("span",{style:{fontSize:"14px",color:"var(--reader-text)"},children:"A"}),e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("input",{type:"range",min:0,max:c.length-1,value:p,onChange:e=>n("fontSize",c[parseInt(e.target.value)]),style:{width:"100%",height:"4px",appearance:"none",background:"var(--reader-border)",borderRadius:"2px",cursor:"pointer"}}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:c.map((r,t)=>e.jsx("div",{style:{width:"2px",height:"6px",background:t<=p?"var(--reader-accent, #58a6ff)":"var(--reader-border)",borderRadius:"1px"}},t))})]}),e.jsx("span",{style:{fontSize:"22px",color:"var(--reader-text)"},children:"A"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:["Spacing",e.jsx("span",{style:{fontSize:"12px",color:"var(--reader-secondary)"},children:"Adjust text spacing of the page."})]}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:["compact","normal","relaxed"].map(r=>e.jsx("button",{onClick:()=>n("lineHeight",r),style:{flex:1,padding:"10px 8px",border:t.lineHeight===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:t.lineHeight===r?"rgba(88, 166, 255, 0.1)":"transparent",color:t.lineHeight===r?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",fontSize:"12px",textTransform:"capitalize"},children:r},r))})]})]}),"layout"===l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Page Color"}),e.jsx("div",{style:{display:"flex",gap:"12px"},children:Object.keys(B).map(r=>e.jsx("button",{onClick:()=>n("theme",r),style:{width:"48px",height:"48px",borderRadius:"50%",background:B[r].background,border:t.theme===r?"3px solid var(--reader-accent, #58a6ff)":"2px solid var(--reader-border)",cursor:"pointer",transition:"transform 0.2s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},title:r.charAt(0).toUpperCase()+r.slice(1)},r))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("label",{style:{fontSize:"14px",color:"var(--reader-text)"},children:"Continuous Scrolling"}),e.jsx("button",{onClick:()=>n("continuousScroll",!t.continuousScroll),style:{width:"48px",height:"28px",borderRadius:"14px",border:"none",background:t.continuousScroll?"var(--reader-accent, #58a6ff)":"var(--reader-border)",cursor:"pointer",position:"relative",transition:"background 0.2s ease"},children:e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"#fff",position:"absolute",top:"2px",left:t.continuousScroll?"22px":"2px",transition:"left 0.2s ease",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Alignment"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>n("textAlign","left"),style:{flex:1,padding:"12px",border:"left"===t.textAlign?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"left"===t.textAlign?"rgba(88, 166, 255, 0.1)":"transparent",color:"left"===t.textAlign?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(E,{size:20})}),e.jsx("button",{onClick:()=>n("textAlign","justify"),style:{flex:1,padding:"12px",border:"justify"===t.textAlign?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"justify"===t.textAlign?"rgba(88, 166, 255, 0.1)":"transparent",color:"justify"===t.textAlign?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(I,{size:20})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Margins"}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:["narrow","medium","wide"].map(r=>e.jsx("button",{onClick:()=>n("margins",r),style:{flex:1,padding:"12px 8px",border:t.margins===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:t.margins===r?"rgba(88, 166, 255, 0.1)":"transparent",color:t.margins===r?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{width:"narrow"===r?"28px":"medium"===r?"20px":"12px",height:"20px",background:"currentColor",opacity:.3,borderRadius:"2px"}})},r))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Layout"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>n("columns","single"),style:{flex:1,padding:"12px 8px",border:"single"===t.columns?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"single"===t.columns?"rgba(88, 166, 255, 0.1)":"transparent",color:"single"===t.columns?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx("div",{style:{width:"24px",height:"32px",border:"2px solid currentColor",borderRadius:"3px"}}),e.jsx("span",{style:{fontSize:"11px"},children:"Single"})]}),e.jsxs("button",{onClick:()=>n("columns","two"),style:{flex:1,padding:"12px 8px",border:"two"===t.columns?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"two"===t.columns?"rgba(88, 166, 255, 0.1)":"transparent",color:"two"===t.columns?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsxs("div",{style:{display:"flex",gap:"3px"},children:[e.jsx("div",{style:{width:"16px",height:"32px",border:"2px solid currentColor",borderRadius:"3px"}}),e.jsx("div",{style:{width:"16px",height:"32px",border:"2px solid currentColor",borderRadius:"3px"}})]}),e.jsx("span",{style:{fontSize:"11px"},children:"Two Column"})]})]})]})]}),"themes"===l&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:Object.keys(B).map(r=>e.jsxs("button",{onClick:()=>n("theme",r),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",border:t.theme===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"12px",background:"transparent",cursor:"pointer",textAlign:"left"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"8px",background:B[r].background,border:"1px solid var(--reader-border)",display:"flex",alignItems:"center",justifyContent:"center",color:B[r].text,fontSize:"16px",fontFamily:"Georgia, serif"},children:"Aa"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"15px",fontWeight:500,color:"var(--reader-text)",textTransform:"capitalize"},children:r}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--reader-secondary)",marginTop:"2px"},children:["light"===r&&"Classic white background","sepia"===r&&"Warm, paper-like tone","green"===r&&"Easy on the eyes","dark"===r&&"Perfect for night reading"]})]}),t.theme===r&&e.jsx("div",{style:{marginLeft:"auto",width:"20px",height:"20px",borderRadius:"50%",background:"var(--reader-accent, #58a6ff)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]},r))}),"more"===l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx("button",{onClick:o,style:{width:"100%",padding:"14px",border:"1px solid var(--reader-border)",borderRadius:"8px",background:"transparent",color:"var(--reader-text)",cursor:"pointer",fontSize:"14px"},children:"Reset to Defaults"}),e.jsxs("div",{style:{padding:"16px",background:"rgba(255,255,255,0.02)",borderRadius:"8px",border:"1px solid var(--reader-border)"},children:[e.jsx("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--reader-text)",marginBottom:"12px"},children:"Keyboard Shortcuts"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",fontSize:"12px",color:"var(--reader-secondary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Next page"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"Arrow Right"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Previous page"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"Arrow Left"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Toggle settings"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"S"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Table of contents"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"T"})]})]})]})]})]}),e.jsxs("div",{style:{padding:"16px 20px",borderTop:"1px solid var(--reader-border)",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--reader-secondary)",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),e.jsx("input",{type:"range",min:0,max:100,defaultValue:100,style:{flex:1,height:"4px",appearance:"none",background:"linear-gradient(to right, var(--reader-border) 0%, var(--reader-text) 100%)",borderRadius:"2px",cursor:"pointer"},title:"Brightness (system controlled)",disabled:!0}),e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"var(--reader-text)",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})]})]}),e.jsx("style",{children:'\n        @keyframes slideFromRight {\n          from { transform: translateX(100%); }\n          to { transform: translateX(0); }\n        }\n\n        input[type="range"]::-webkit-slider-thumb {\n          -webkit-appearance: none;\n          width: 16px;\n          height: 16px;\n          border-radius: 50%;\n          background: var(--reader-accent, #58a6ff);\n          cursor: pointer;\n          border: 2px solid white;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n        }\n\n        input[type="range"]::-moz-range-thumb {\n          width: 16px;\n          height: 16px;\n          border-radius: 50%;\n          background: var(--reader-accent, #58a6ff);\n          cursor: pointer;\n          border: 2px solid white;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n        }\n      '})]})}function $({settings:r,updateSetting:t,onClose:n,visible:o}){if(!o)return null;const a=["xsmall","small","medium","large","xlarge"],i=a.indexOf(r.fontSize);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:n,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",zIndex:200}}),e.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,background:"var(--reader-bg, #0a1628)",borderTopLeftRadius:16,borderTopRightRadius:16,padding:16,paddingBottom:"max(24px, env(safe-area-inset-bottom))",zIndex:201,animation:"slideUp 0.3s ease",maxHeight:"70vh",overflowY:"auto"},children:[e.jsx("div",{style:{width:40,height:4,background:"var(--reader-border, #21262d)",borderRadius:2,margin:"0 auto 20px"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid var(--reader-border, #21262d)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(f,{size:18,style:{color:"var(--reader-secondary, #8b949e)"}}),e.jsx("span",{style:{fontSize:14,color:"var(--reader-text, #c9d1d9)"},children:"Text Size"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("button",{onClick:()=>i>0&&t("fontSize",a[i-1]),disabled:0===i,style:{width:44,height:44,borderRadius:"50%",border:"1px solid var(--reader-border, #21262d)",background:"transparent",color:0===i?"var(--reader-border, #21262d)":"var(--reader-text, #c9d1d9)",display:"flex",alignItems:"center",justifyContent:"center",cursor:0===i?"not-allowed":"pointer"},"aria-label":"Decrease font size",children:e.jsx(C,{size:20})}),e.jsx("span",{style:{minWidth:32,textAlign:"center",fontSize:14,fontWeight:600,color:"var(--reader-text, #c9d1d9)"},children:{xsmall:"XS",small:"S",medium:"M",large:"L",xlarge:"XL"}[r.fontSize]}),e.jsx("button",{onClick:()=>i<a.length-1&&t("fontSize",a[i+1]),disabled:i===a.length-1,style:{width:44,height:44,borderRadius:"50%",border:"1px solid var(--reader-border, #21262d)",background:"transparent",color:i===a.length-1?"var(--reader-border, #21262d)":"var(--reader-text, #c9d1d9)",display:"flex",alignItems:"center",justifyContent:"center",cursor:i===a.length-1?"not-allowed":"pointer"},"aria-label":"Increase font size",children:e.jsx(h,{size:20})})]})]}),e.jsxs("div",{style:{padding:"16px 0",borderBottom:"1px solid var(--reader-border, #21262d)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:["dark"===r.theme?e.jsx(z,{size:18,style:{color:"var(--reader-secondary, #8b949e)"}}):e.jsx(R,{size:18,style:{color:"var(--reader-secondary, #8b949e)"}}),e.jsx("span",{style:{fontSize:14,color:"var(--reader-text, #c9d1d9)"},children:"Theme"})]}),e.jsx("div",{style:{display:"flex",gap:12,overflowX:"auto",WebkitOverflowScrolling:"touch",paddingBottom:4},children:Object.keys(B).map(n=>e.jsx("button",{onClick:()=>t("theme",n),style:{width:56,height:56,borderRadius:12,background:B[n].background,border:r.theme===n?"3px solid var(--reader-accent, #58a6ff)":"2px solid var(--reader-border, #21262d)",flexShrink:0,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":`${n} theme`,children:e.jsx("span",{style:{fontSize:16,fontWeight:700,color:B[n].text},children:"Aa"})},n))})]}),e.jsx("div",{style:{padding:"16px 0",borderBottom:"1px solid var(--reader-border, #21262d)"},children:e.jsx("div",{style:{display:"flex",gap:8,overflowX:"auto",WebkitOverflowScrolling:"touch",paddingBottom:4},children:Object.keys(P).map(n=>e.jsx("button",{onClick:()=>t("fontFamily",n),style:{padding:"10px 14px",borderRadius:8,border:r.fontFamily===n?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border, #21262d)",background:r.fontFamily===n?"rgba(88, 166, 255, 0.1)":"transparent",color:r.fontFamily===n?"var(--reader-accent, #58a6ff)":"var(--reader-text, #c9d1d9)",fontFamily:P[n].css,fontSize:13,fontWeight:500,whiteSpace:"nowrap",flexShrink:0,cursor:"pointer"},children:P[n].name},n))})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",padding:"16px 0"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:11,color:"var(--reader-secondary, #8b949e)"},children:"Align"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{onClick:()=>t("textAlign","left"),style:{width:40,height:40,borderRadius:8,border:"left"===r.textAlign?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border, #21262d)",background:"left"===r.textAlign?"rgba(88, 166, 255, 0.1)":"transparent",color:"left"===r.textAlign?"var(--reader-accent, #58a6ff)":"var(--reader-secondary, #8b949e)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},"aria-label":"Align left",children:e.jsx(E,{size:18})}),e.jsx("button",{onClick:()=>t("textAlign","justify"),style:{width:40,height:40,borderRadius:8,border:"justify"===r.textAlign?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border, #21262d)",background:"justify"===r.textAlign?"rgba(88, 166, 255, 0.1)":"transparent",color:"justify"===r.textAlign?"var(--reader-accent, #58a6ff)":"var(--reader-secondary, #8b949e)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},"aria-label":"Justify",children:e.jsx(I,{size:18})})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:11,color:"var(--reader-secondary, #8b949e)"},children:"Spacing"}),e.jsx("div",{style:{display:"flex",gap:4},children:["compact","normal","relaxed"].map(n=>e.jsx("button",{onClick:()=>t("lineHeight",n),style:{width:40,height:40,borderRadius:8,border:r.lineHeight===n?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border, #21262d)",background:r.lineHeight===n?"rgba(88, 166, 255, 0.1)":"transparent",color:r.lineHeight===n?"var(--reader-accent, #58a6ff)":"var(--reader-secondary, #8b949e)",fontSize:11,fontWeight:600,cursor:"pointer"},"aria-label":`${n} line height`,children:n[0].toUpperCase()},n))})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:11,color:"var(--reader-secondary, #8b949e)"},children:"Scroll"}),e.jsx("button",{onClick:()=>t("continuousScroll",!r.continuousScroll),style:{width:56,height:40,borderRadius:20,border:"none",background:r.continuousScroll?"var(--reader-accent, #58a6ff)":"var(--reader-border, #21262d)",position:"relative",cursor:"pointer",transition:"background 0.2s ease"},"aria-label":"Toggle continuous scroll",children:e.jsx("div",{style:{position:"absolute",top:4,left:r.continuousScroll?20:4,width:32,height:32,borderRadius:"50%",background:"var(--reader-bg, #0a1628)",transition:"left 0.2s ease"}})})]})]})]})]})}function X({chapters:r,currentChapterId:t,onSelectChapter:n,onClose:o,visible:a}){return a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"reader-toc-backdrop",onClick:o,style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:200,animation:"fadeIn 0.2s ease"}}),e.jsxs("div",{className:"reader-toc-panel",style:{position:"fixed",top:0,left:0,bottom:0,width:"300px",maxWidth:"80vw",background:"var(--reader-bg)",borderRight:"1px solid var(--reader-border)",zIndex:201,display:"flex",flexDirection:"column",animation:"slideRight 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid var(--reader-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(l,{size:20,color:"var(--reader-text)"}),e.jsx("h2",{style:{fontSize:"18px",fontWeight:600,color:"var(--reader-text)",margin:0},children:"Contents"})]}),e.jsx("button",{onClick:o,style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px"},"aria-label":"Close table of contents",children:e.jsx(s,{size:24})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:0===r.length?e.jsx("p",{style:{color:"var(--reader-secondary)",fontSize:"14px",textAlign:"center",padding:"20px"},children:"No chapters detected"}):e.jsx("ul",{style:{listStyle:"none",margin:0,padding:0},children:r.map(r=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>{n(r),o()},style:{width:"100%",padding:"12px 16px",paddingLeft:16+16*(r.level-1)+"px",border:"none",borderRadius:"8px",background:t===r.id?"var(--reader-border)":"transparent",color:t===r.id?"var(--reader-text)":"var(--reader-secondary)",cursor:"pointer",textAlign:"left",fontSize:1===r.level?"15px":"14px",fontWeight:1===r.level?500:400,display:"flex",alignItems:"center",gap:"8px",transition:"background 0.2s ease"},onMouseEnter:e=>{t!==r.id&&(e.currentTarget.style.background="var(--reader-border)")},onMouseLeave:e=>{t!==r.id&&(e.currentTarget.style.background="transparent")},children:[1===r.level&&e.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:t===r.id?"var(--reader-text)":"var(--reader-secondary)",flexShrink:0}}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.title})]})},r.id))})})]})]}):null}function q({contentId:n,title:o,htmlContent:a,onBack:i,copyrightYear:s,copyrightHolder:l}){const u=t(),x=r.useRef(null),g=r.useRef(null),f=r.useRef(null),[h,m]=r.useState(!0),[y,v]=r.useState(!1),[j,k]=r.useState(!1),[w,S]=r.useState([]),[C,z]=r.useState(0),[R,I]=r.useState(1),[E,T]=r.useState(0),[A,M]=r.useState(0),[L,F]=r.useState(!1),B=r.useRef(null),P=r.useRef(-1),W=r.useRef(!1),D=r.useRef(!1),q=r.useRef(null),{settings:G,updateSetting:J,resetSettings:U,cssVars:V,themeClass:K}=_(),{isMobile:Z,isPhone:Q}=d();!function(e){const[t,n]=r.useState(!1),o="undefined"!=typeof document&&("fullscreenEnabled"in document||"webkitFullscreenEnabled"in document),a=r.useCallback(async()=>{const r=e.current;if(r)try{r.requestFullscreen?await r.requestFullscreen():r.webkitRequestFullscreen&&await r.webkitRequestFullscreen()}catch(t){}},[e]),i=r.useCallback(()=>{try{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}catch(e){}},[]),s=r.useCallback(()=>{t?i():a()},[t,a,i]);r.useEffect(()=>{const e=()=>{const e=document.fullscreenElement||document.webkitFullscreenElement;n(!!e)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e)}},[])}(x);const ee=r.useMemo(()=>function(e){const r=(new DOMParser).parseFromString(e,"text/html");return r.querySelectorAll("h1, h2, h3").forEach((e,r)=>{e.id||(e.id=`chapter-${r+1}`)}),r.body.innerHTML}(a),[a]);r.useEffect(()=>{const e=function(e){const r=[];return(new DOMParser).parseFromString(e,"text/html").querySelectorAll("h1, h2, h3").forEach((e,t)=>{var n;const o=e.tagName.toLowerCase(),a=parseInt(o.charAt(1),10),i=(null==(n=e.textContent)?void 0:n.trim())||`Chapter ${t+1}`,s=e.id||`chapter-${t+1}`;e.id||(e.id=s),r.push({id:s,title:i,level:a,pageIndex:0,elementId:s})}),r}(a);S(e)},[a]),r.useEffect(()=>{D.current||c.getProgress(parseInt(n)).then(e=>{if(e.last_position)try{const r=JSON.parse(e.last_position);if("number"==typeof r.page&&r.page>0&&(q.current=r.page,R>1&&!D.current)){const e=Math.min(r.page,R-1);z(e),D.current=!0}}catch(r){}}).catch(e=>{})},[n]);const re=r.useCallback(()=>{const e=g.current,r=f.current;if(!e||!r||G.continuousScroll)return void I(1);const t=e.clientWidth;T(t);const n=Q?"single":G.columns;M("two"===n?2:1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(!e)return;const r=e.scrollWidth,n=Math.max(1,Math.round(r/t));if(I(n),null!==q.current&&!D.current&&n>1){const e=Math.min(q.current,n-1);z(e),D.current=!0}else z(e=>Math.min(e,Math.max(0,n-1)))})})},[G.continuousScroll,G.columns,Q]);r.useEffect(()=>{const e=g.current;e&&!G.continuousScroll&&0!==E&&e.scrollTo({left:C*E,top:0,behavior:"smooth"})},[C,E,G.continuousScroll]),r.useEffect(()=>{if(G.continuousScroll)return;const e=setTimeout(re,250),r=()=>{setTimeout(re,150)};return window.addEventListener("resize",r),()=>{clearTimeout(e),window.removeEventListener("resize",r)}},[re,G.continuousScroll]),r.useEffect(()=>{const e=setTimeout(re,200);return()=>clearTimeout(e)},[ee,re,G.fontSize,G.lineHeight,G.columns,G.margins]),r.useEffect(()=>{if(G.continuousScroll||R<=1)return;B.current&&clearTimeout(B.current);const e=Math.round((C+1)/R*100);return B.current=setTimeout(()=>{c.updateProgress(parseInt(n),e,JSON.stringify({page:C,totalPages:R})).then(()=>{P.current=e}).catch(console.error)},1e3),()=>{B.current&&clearTimeout(B.current)}},[C,R,n,G.continuousScroll]),r.useEffect(()=>()=>{if(R<=1)return;const e=Math.round((C+1)/R*100);e!==P.current&&-1!==P.current&&c.updateProgress(parseInt(n),e,JSON.stringify({page:C,totalPages:R})).catch(console.error)},[C,R,n]),r.useEffect(()=>{if(W.current||R<=1)return;C>=R-1&&(W.current=!0,c.updateProgress(parseInt(n),100,JSON.stringify({page:C,totalPages:R,completed:!0})).then(()=>{P.current=100}).catch(console.error),b(parseInt(n)).then(e=>{e?(F(!0),setTimeout(()=>F(!1),3e3)):(F(!0),setTimeout(()=>{u(`/content/${n}?completed=true`)},2e3))}).catch(()=>{F(!0),setTimeout(()=>{u(`/content/${n}?completed=true`)},2e3)}))},[C,R,n,u]);const te=r.useCallback(e=>{const r=Math.max(0,Math.min(e,R-1));z(r)},[R]),ne=r.useCallback(()=>{C<R-1&&te(C+1)},[C,R,te]),oe=r.useCallback(()=>{C>0&&te(C-1)},[C,te]),ae=r.useCallback(()=>{te(0)},[te]),ie=r.useCallback(()=>{te(R-1)},[R,te]),se=r.useMemo(()=>function(e,r){if(0===e.length)return null;let t=null;for(const n of e){if(!(n.pageIndex<=r))break;t=n}return t}(w,C),[w,C]),le=r.useCallback(e=>{te(e.pageIndex),k(!1)},[te]),de=r.useCallback(()=>{y||j||m(e=>!e)},[y,j]),ce=r.useCallback(()=>{i?i():u(-1)},[u,i]);!function(e,t){const{onSwipeLeft:n,onSwipeRight:o,onSwipeUp:a,onSwipeDown:i,threshold:s=50,velocityThreshold:l=.3,enabled:d=!0}=t,c=r.useRef(null),p=r.useRef(null),u=r.useCallback(e=>{if(!d)return;const r=e.touches[0];c.current={x:r.clientX,y:r.clientY,time:Date.now()},p.current=null},[d]),x=r.useCallback(e=>{if(!d||!c.current)return;const r=e.touches[0];p.current={x:r.clientX,y:r.clientY,time:Date.now()};const t=r.clientX-c.current.x,n=r.clientY-c.current.y;Math.abs(t)>Math.abs(n)&&Math.abs(t)>10&&e.preventDefault()},[d]),g=r.useCallback(e=>{if(!d||!c.current||!p.current)return;const r=c.current,t=p.current,u=t.x-r.x,x=t.y-r.y,g=t.time-r.time,f=Math.abs(u)/g,h=Math.abs(x)/g;Math.abs(u)>Math.abs(x)?Math.abs(u)>=s&&f>=l&&(u>0?null==o||o():null==n||n()):Math.abs(x)>=s&&h>=l&&(x>0?null==i||i():null==a||a()),c.current=null,p.current=null},[d,s,l,n,o,a,i]);r.useEffect(()=>{const r=e.current;if(r&&d)return r.addEventListener("touchstart",u,{passive:!0}),r.addEventListener("touchmove",x,{passive:!1}),r.addEventListener("touchend",g,{passive:!0}),()=>{r.removeEventListener("touchstart",u),r.removeEventListener("touchmove",x),r.removeEventListener("touchend",g)}},[e,d,u,x,g])}(x,{onSwipeLeft:ne,onSwipeRight:oe,enabled:!y&&!j&&!G.continuousScroll}),function(e){const{onNext:t,onPrevious:n,onFirst:o,onLast:a,onEscape:i,onToggleSettings:s,onToggleTOC:l,enabled:d=!0}=e,c=r.useCallback(e=>{if(d&&!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement))switch(e.key){case"ArrowRight":case"PageDown":case" ":" "===e.key&&e.preventDefault(),null==t||t();break;case"ArrowLeft":case"PageUp":null==n||n();break;case"Home":e.preventDefault(),null==o||o();break;case"End":e.preventDefault(),null==a||a();break;case"Escape":null==i||i();break;case"s":case"S":e.ctrlKey||e.metaKey||null==s||s();break;case"t":case"T":e.ctrlKey||e.metaKey||null==l||l()}},[d,t,n,o,a,i,s,l]);r.useEffect(()=>{if(d)return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[d,c])}({onNext:G.continuousScroll?void 0:ne,onPrevious:G.continuousScroll?void 0:oe,onFirst:ae,onLast:ie,onEscape:()=>{y||j?(v(!1),k(!1)):h&&m(!1)},onToggleSettings:()=>{j||v(e=>!e)},onToggleTOC:()=>{y||k(e=>!e)},enabled:!0}),function(e,t){const{onLeftEdge:n,onRightEdge:o,edgeThreshold:a=30,swipeDistance:i=50,enabled:s=!0}=t,l=r.useRef(null),d=r.useCallback(e=>{if(!s)return;const r=e.touches[0],t=window.innerWidth;let n=null;r.clientX<=a?n="left":r.clientX>=t-a&&(n="right"),l.current={x:r.clientX,y:r.clientY,isEdge:n,time:Date.now()}},[s,a]),c=r.useCallback(e=>{var r;if(null==(r=l.current)?void 0:r.isEdge){const r=e.touches[0],t=Math.abs(r.clientX-l.current.x);t>Math.abs(r.clientY-l.current.y)&&t>10&&e.preventDefault()}},[]),p=r.useCallback(e=>{var r;if(!s||!(null==(r=l.current)?void 0:r.isEdge))return void(l.current=null);const t=e.changedTouches[0],a=t.clientX-l.current.x;Math.abs(t.clientY-l.current.y)>Math.abs(a)||("left"===l.current.isEdge&&a>=i?null==n||n():"right"===l.current.isEdge&&a<=-i&&(null==o||o())),l.current=null},[s,i,n,o]);r.useEffect(()=>{const r=e.current;if(r&&s)return r.addEventListener("touchstart",d,{passive:!0}),r.addEventListener("touchmove",c,{passive:!1}),r.addEventListener("touchend",p,{passive:!0}),()=>{r.removeEventListener("touchstart",d),r.removeEventListener("touchmove",c),r.removeEventListener("touchend",p)}},[e,s,d,c,p])}(x,{onLeftEdge:()=>k(!0),onRightEdge:()=>v(!0),enabled:Z&&!y&&!j&&!G.continuousScroll});const pe=Q?"single":G.columns,ue=r.useMemo(()=>R<=1?100:Math.round((C+1)/R*100),[C,R]),xe=0===C,ge=C>=R-1,fe={"--reader-font-size":V["--reader-font-size"],"--reader-line-height":V["--reader-line-height"],"--reader-bg":V["--reader-bg"],"--reader-text":V["--reader-text"],"--reader-secondary":V["--reader-secondary"],"--reader-border":V["--reader-border"],"--reader-accent":V["--reader-accent"],"--reader-font-family":V["--reader-font-family"],"--reader-margin":V["--reader-margin"],"--reader-text-align":V["--reader-text-align"]},he="two"===pe?1200:650,be=Z?48:60,me=l||s?Z?60:70:Z?40:50;return e.jsxs("div",{ref:x,className:`kindle-reader ${K}`,style:{position:"fixed",inset:0,background:"var(--reader-bg)",color:"var(--reader-text)",overflow:"hidden",touchAction:G.continuousScroll?"auto":"pan-y",...fe},children:[e.jsx(N,{title:o,chapterTitle:null==se?void 0:se.title,onBack:ce,onToggleSettings:()=>v(!0),onToggleTOC:()=>k(!0),visible:h}),e.jsx("div",{className:"reader-content-area",style:{position:"fixed",top:h?`${be}px`:"0",left:0,right:0,bottom:h?`${me}px`:"0",display:"flex",justifyContent:"center",overflow:G.continuousScroll?"auto":"hidden",transition:"top 0.3s ease, bottom 0.3s ease",background:"var(--reader-bg)"},children:e.jsx("div",{ref:g,className:"reader-viewport",style:{width:"100%",maxWidth:`${he}px`,height:"100%",overflowX:G.continuousScroll?"hidden":"scroll",overflowY:G.continuousScroll?"auto":"hidden",position:"relative",scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsx("div",{ref:f,className:"reader-columns",dangerouslySetInnerHTML:{__html:p(ee)},style:{height:G.continuousScroll?"auto":"100%",width:G.continuousScroll?"100%":void 0,padding:G.continuousScroll?"24px 48px":"24px 0",boxSizing:"border-box",columnCount:G.continuousScroll?void 0:"two"===pe?2:1,columnGap:G.continuousScroll?void 0:"0px",columnFill:"auto",fontFamily:"var(--reader-font-family)",fontSize:"var(--reader-font-size)",lineHeight:"var(--reader-line-height)",color:"var(--reader-text)",textAlign:G.textAlign,hyphens:"justify"===G.textAlign?"auto":"none",WebkitHyphens:"justify"===G.textAlign?"auto":"none",wordBreak:"break-word"}})})}),!G.continuousScroll&&e.jsx(O,{onPrevious:oe,onNext:ne,onCenter:de,isFirstPage:xe,isLastPage:ge,showArrows:h,isMobile:Z,headerHeight:be,footerHeight:me}),e.jsx(H,{currentPage:G.continuousScroll?0:C,totalPages:G.continuousScroll?1:R,percentComplete:ue,visible:h,continuousScroll:G.continuousScroll,copyrightYear:s,copyrightHolder:l}),Z?e.jsx($,{settings:G,updateSetting:J,onClose:()=>v(!1),visible:y}):e.jsx(Y,{settings:G,updateSetting:J,resetSettings:U,onClose:()=>v(!1),visible:y}),e.jsx(X,{chapters:w,currentChapterId:null==se?void 0:se.id,onSelectChapter:le,onClose:()=>k(!1),visible:j}),e.jsx("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n\n        @keyframes slideUp {\n          from { transform: translateY(100%); }\n          to { transform: translateY(0); }\n        }\n\n        @keyframes slideRight {\n          from { transform: translateX(-100%); }\n          to { transform: translateX(0); }\n        }\n\n        .reader-nav-zone:hover .reader-nav-arrow {\n          opacity: 0.7 !important;\n        }\n\n        .reader-icon-button:hover {\n          background: var(--reader-border) !important;\n        }\n\n        /*\n          Reader content styles - Kindle-like typography\n          IMPORTANT: Visual margins are applied here to content elements,\n          NOT to the column container. This keeps columns aligned with pages.\n        */\n        .reader-columns {\n          letter-spacing: 0.01em;\n        }\n\n        /* Hide scrollbar but allow programmatic scrolling (industry-standard approach) */\n        .reader-viewport::-webkit-scrollbar {\n          display: none;\n        }\n\n        .reader-viewport {\n          -ms-overflow-style: none;\n          scrollbar-width: none;\n        }\n\n        /* Apply horizontal padding to all direct children and common elements */\n        .reader-columns > *,\n        .reader-columns p,\n        .reader-columns h1,\n        .reader-columns h2,\n        .reader-columns h3,\n        .reader-columns h4,\n        .reader-columns h5,\n        .reader-columns h6,\n        .reader-columns ul,\n        .reader-columns ol,\n        .reader-columns blockquote,\n        .reader-columns pre,\n        .reader-columns div {\n          padding-left: 32px;\n          padding-right: 32px;\n          box-sizing: border-box;\n        }\n\n        .reader-columns h1,\n        .reader-columns h2,\n        .reader-columns h3 {\n          color: var(--reader-text);\n          margin-top: 1.5em;\n          margin-bottom: 0.7em;\n          line-height: 1.3;\n          break-after: avoid;\n        }\n\n        .reader-columns h1:first-child,\n        .reader-columns h2:first-child,\n        .reader-columns h3:first-child {\n          margin-top: 0;\n        }\n\n        .reader-columns h1 {\n          font-size: 1.5em;\n          font-weight: 700;\n        }\n\n        .reader-columns h2 {\n          font-size: 1.3em;\n          font-weight: 600;\n        }\n\n        .reader-columns h3 {\n          font-size: 1.15em;\n          font-weight: 600;\n        }\n\n        .reader-columns p {\n          margin: 0 0 1em 0;\n          text-indent: 0;\n          orphans: 2;\n          widows: 2;\n          break-inside: avoid-column;\n          -webkit-column-break-inside: avoid;\n        }\n\n        .reader-columns p + p {\n          text-indent: 1.5em;\n          margin-top: 0;\n        }\n\n        .reader-columns blockquote {\n          margin: 1em 0;\n          padding-top: 0.6em;\n          padding-bottom: 0.6em;\n          border-left: 3px solid var(--reader-border);\n          color: var(--reader-secondary);\n          font-style: italic;\n          margin-left: 32px;\n          padding-left: 1em;\n        }\n\n        .reader-columns a {\n          color: var(--reader-accent, var(--reader-text));\n          text-decoration: underline;\n          text-underline-offset: 2px;\n        }\n\n        .reader-columns img {\n          max-width: calc(100% - 64px);\n          height: auto;\n          margin: 1em auto;\n          display: block;\n        }\n\n        .reader-columns ul,\n        .reader-columns ol {\n          margin: 1em 0;\n          padding-left: calc(32px + 1.5em);\n        }\n\n        .reader-columns li {\n          margin-bottom: 0.3em;\n          padding-left: 0;\n          padding-right: 0;\n        }\n\n        .reader-columns hr {\n          border: none;\n          text-align: center;\n          margin: 1.5em 32px;\n          padding: 0;\n        }\n\n        .reader-columns hr::before {\n          content: \"* * *\";\n          color: var(--reader-secondary);\n          letter-spacing: 0.5em;\n        }\n\n        .reader-columns sup {\n          font-size: 0.75em;\n          vertical-align: super;\n          line-height: 0;\n        }\n\n        .reader-columns pre,\n        .reader-columns code {\n          font-family: 'SF Mono', Monaco, 'Consolas', monospace;\n          font-size: 0.85em;\n          background: rgba(128, 128, 128, 0.1);\n          border-radius: 4px;\n        }\n\n        .reader-columns pre {\n          padding-top: 0.8em;\n          padding-bottom: 0.8em;\n          overflow-x: auto;\n          margin: 1em 0;\n        }\n\n        .reader-columns code {\n          padding: 0.15em 0.35em;\n        }\n\n        .reader-columns pre code {\n          padding: 0;\n          background: none;\n        }\n\n        /* Scrollbar for continuous mode */\n        .reader-content-area::-webkit-scrollbar {\n          width: 8px;\n        }\n\n        .reader-content-area::-webkit-scrollbar-track {\n          background: transparent;\n        }\n\n        .reader-content-area::-webkit-scrollbar-thumb {\n          background: var(--reader-border);\n          border-radius: 4px;\n        }\n\n        .reader-content-area::-webkit-scrollbar-thumb:hover {\n          background: var(--reader-secondary);\n        }\n\n        /* Selection */\n        .reader-columns ::selection {\n          background: var(--reader-accent, #58a6ff);\n          color: white;\n        }\n      "}),L&&e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(16, 185, 129, 0.95)",color:"#fff",padding:"24px 48px",borderRadius:16,textAlign:"center",zIndex:1e3,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",animation:"fadeIn 0.3s ease"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{style:{fontSize:24,fontWeight:700,marginBottom:8},children:"Finished!"}),e.jsx("div",{style:{fontSize:14,opacity:.9},children:"Taking you to rate this book..."})]})]})}function G({pages:r,currentPage:t,onSelectPage:n,onClose:o}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3},onClick:o}),e.jsxs("div",{style:{position:"fixed",top:0,left:0,bottom:0,width:280,maxWidth:"80vw",backgroundColor:"#0f172a",zIndex:1001,display:"flex",flexDirection:"column",boxShadow:"4px 0 20px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #1e293b",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{style:{fontSize:16,fontWeight:600,color:"#f8fafc"},children:["Pages (",r.length,")"]}),e.jsx("button",{onClick:o,style:{background:"transparent",border:"none",padding:8,cursor:"pointer",color:"#94a3b8",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(s,{size:20})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:16,display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:r.map((r,a)=>{const i=a===t,s=r.canvas_width/r.canvas_height;return e.jsxs("button",{onClick:()=>{n(a),o()},style:{background:i?"#1e3a5f":"#1e293b",border:i?"2px solid #3b82f6":"2px solid transparent",borderRadius:8,padding:8,cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:8,transition:"all 0.2s ease"},children:[e.jsx("div",{style:{width:"100%",aspectRatio:`${s}`,backgroundColor:r.background_color||"#ffffff",backgroundImage:r.background_image?`url(${r.background_image})`:void 0,backgroundSize:"cover",borderRadius:4,position:"relative",overflow:"hidden"},children:r.panels.map(r=>e.jsx("div",{style:{position:"absolute",left:`${r.x_percent}%`,top:`${r.y_percent}%`,width:`${r.width_percent}%`,height:`${r.height_percent}%`,border:"1px solid rgba(0,0,0,0.3)",backgroundColor:r.artwork?"transparent":r.background_color||"rgba(255,255,255,0.8)",backgroundImage:r.artwork?`url(${r.artwork})`:void 0,backgroundSize:"cover",backgroundPosition:"center",transform:`rotate(${r.rotation||0}deg) skewX(${r.skew_x||0}deg) skewY(${r.skew_y||0}deg)`,transformOrigin:"center center",borderRadius:r.border_radius?r.border_radius/4:0}},r.id))}),e.jsxs("span",{style:{fontSize:12,color:i?"#60a5fa":"#94a3b8",fontWeight:i?600:400},children:["Page ",a+1]})]},r.id)})})]})]})}function J({contentId:t,title:n,comicData:o,onBack:s,copyrightYear:l,copyrightHolder:d}){const[p,u]=r.useState(0),[g,f]=r.useState(1),[h,b]=r.useState(!0),[v,j]=r.useState(!1),[k,C]=r.useState(!1),[z,R]=r.useState(!0),I=r.useRef(null),E=r.useRef(null),M=r.useRef(!1),L=o.total_pages,F=o.pages[p];r.useEffect(()=>{M.current?R(!1):c.getProgress(parseInt(t)).then(e=>{if(e.last_position)try{const r=JSON.parse(e.last_position);if("number"==typeof r.page&&r.page>0){const e=Math.min(r.page,L-1);u(e),M.current=!0}}catch(r){}}).catch(e=>{}).finally(()=>{R(!1),M.current=!0})},[t,L]);const B=r.useCallback(e=>{const r=Math.max(0,Math.min(e,L-1));u(r)},[L]),P=r.useCallback(()=>{p<L-1&&B(p+1)},[p,L,B]),W=r.useCallback(()=>{p>0&&B(p-1)},[p,B]),D=r.useCallback(()=>{f(e=>Math.min(e+.25,3))},[]),_=r.useCallback(()=>{f(e=>Math.max(e-.25,.5))},[]),N=r.useCallback(()=>{f(1)},[]),H=r.useCallback(()=>{var e;document.fullscreenElement?(document.exitFullscreen(),C(!1)):(null==(e=I.current)||e.requestFullscreen(),C(!0))},[]);r.useEffect(()=>{const e=()=>{C(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),r.useEffect(()=>{const e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement))switch(e.key){case"ArrowRight":case" ":case"PageDown":e.preventDefault(),P();break;case"ArrowLeft":case"PageUp":e.preventDefault(),W();break;case"Home":e.preventDefault(),B(0);break;case"End":e.preventDefault(),B(L-1);break;case"Escape":v?j(!1):k?document.exitFullscreen():s();break;case"+":case"=":e.preventDefault(),D();break;case"-":e.preventDefault(),_();break;case"0":e.preventDefault(),N();break;case"t":case"T":e.preventDefault(),j(e=>!e);break;case"f":case"F":e.preventDefault(),H()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[P,W,B,L,v,k,s,D,_,N,H]);const O=r.useRef(-1);r.useEffect(()=>{E.current&&clearTimeout(E.current);const e=(p+1)/L*100;return E.current=setTimeout(()=>{c.updateProgress(parseInt(t),e,JSON.stringify({page:p,totalPages:L})).then(()=>{O.current=e}).catch(console.error)},1e3),()=>{E.current&&clearTimeout(E.current);const e=(p+1)/L*100;e!==O.current&&c.updateProgress(parseInt(t),e,JSON.stringify({page:p,totalPages:L})).catch(console.error)}},[p,L,t]),r.useEffect(()=>{let e;const r=()=>{b(!0),clearTimeout(e),e=setTimeout(()=>{v||b(!1)},3e3)};return window.addEventListener("mousemove",r),window.addEventListener("touchstart",r),r(),()=>{clearTimeout(e),window.removeEventListener("mousemove",r),window.removeEventListener("touchstart",r)}},[v]);const Y=(p+1)/L*100;return e.jsxs("div",{ref:I,style:{position:"fixed",inset:0,backgroundColor:"#0a0f1a",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,padding:"12px 16px",background:"linear-gradient(to bottom, rgba(10, 15, 26, 0.95), transparent)",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:100,opacity:h?1:0,transform:h?"translateY(0)":"translateY(-100%)",transition:"opacity 0.3s ease, transform 0.3s ease",pointerEvents:h?"auto":"none"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("button",{onClick:s,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:8,cursor:"pointer",color:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(x,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:16,fontWeight:600,color:"#f8fafc"},children:n}),e.jsxs("div",{style:{fontSize:12,color:"#94a3b8"},children:["by ",o.creator]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{onClick:()=>j(!0),style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:8,cursor:"pointer",color:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center"},title:"Pages (T)",children:e.jsx(y,{size:20})}),e.jsx("button",{onClick:_,disabled:g<=.5,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:8,cursor:g<=.5?"not-allowed":"pointer",color:g<=.5?"#475569":"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center",opacity:g<=.5?.5:1},title:"Zoom out (-)",children:e.jsx(A,{size:20})}),e.jsxs("button",{onClick:N,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:"4px 12px",cursor:"pointer",color:"#f8fafc",fontSize:14,fontWeight:500},title:"Reset zoom (0)",children:[Math.round(100*g),"%"]}),e.jsx("button",{onClick:D,disabled:g>=3,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:8,cursor:g>=3?"not-allowed":"pointer",color:g>=3?"#475569":"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center",opacity:g>=3?.5:1},title:"Zoom in (+)",children:e.jsx(T,{size:20})}),e.jsx("button",{onClick:H,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:8,cursor:"pointer",color:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center"},title:"Fullscreen (F)",children:k?e.jsx(S,{size:20}):e.jsx(w,{size:20})})]})]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"60px 60px 80px",position:"relative"},onClick:()=>b(e=>!e),children:F&&e.jsx(m,{page:F,zoom:g,fitToContainer:!0})}),e.jsx("div",{style:{position:"absolute",top:60,bottom:80,left:0,width:"25%",cursor:p>0?"pointer":"default",zIndex:50},onClick:e=>{e.stopPropagation(),W()},children:h&&p>0&&e.jsx("div",{style:{position:"absolute",top:"50%",left:16,transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.5)",borderRadius:"50%",padding:12,color:"#f8fafc"},children:e.jsx(a,{size:24})})}),e.jsx("div",{style:{position:"absolute",top:60,bottom:80,right:0,width:"25%",cursor:p<L-1?"pointer":"default",zIndex:50},onClick:e=>{e.stopPropagation(),P()},children:h&&p<L-1&&e.jsx("div",{style:{position:"absolute",top:"50%",right:16,transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.5)",borderRadius:"50%",padding:12,color:"#f8fafc"},children:e.jsx(i,{size:24})})}),e.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"16px 20px",background:"linear-gradient(to top, rgba(10, 15, 26, 0.95), transparent)",zIndex:100,opacity:h?1:0,transform:h?"translateY(0)":"translateY(100%)",transition:"opacity 0.3s ease, transform 0.3s ease",pointerEvents:h?"auto":"none"},children:[e.jsx("div",{style:{height:4,backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:2,marginBottom:12,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${Y}%`,backgroundColor:"#f59e0b",borderRadius:2,transition:"width 0.3s ease"}})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("button",{onClick:W,disabled:0===p,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:"8px 16px",cursor:0===p?"not-allowed":"pointer",color:0===p?"#475569":"#f8fafc",display:"flex",alignItems:"center",gap:8,fontSize:14,opacity:0===p?.5:1},children:[e.jsx(a,{size:16}),"Previous"]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:16,fontWeight:600,color:"#f8fafc"},children:["Page ",p+1," of ",L]}),e.jsxs("div",{style:{fontSize:12,color:"#94a3b8"},children:[Math.round(Y),"% complete"]})]}),e.jsxs("button",{onClick:P,disabled:p>=L-1,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:8,padding:"8px 16px",cursor:p>=L-1?"not-allowed":"pointer",color:p>=L-1?"#475569":"#f8fafc",display:"flex",alignItems:"center",gap:8,fontSize:14,opacity:p>=L-1?.5:1},children:["Next",e.jsx(i,{size:16})]})]}),e.jsxs("div",{style:{marginTop:12,fontSize:11,color:"#64748b",textAlign:"center"},children:["Press ",e.jsx("kbd",{style:{background:"#1e293b",padding:"2px 6px",borderRadius:4},children:"+"}),"/",e.jsx("kbd",{style:{background:"#1e293b",padding:"2px 6px",borderRadius:4},children:"-"})," to zoom, ",e.jsx("kbd",{style:{background:"#1e293b",padding:"2px 6px",borderRadius:4},children:"0"})," ","to reset,"," ",e.jsx("kbd",{style:{background:"#1e293b",padding:"2px 6px",borderRadius:4},children:"Esc"})," to go back"]}),(d||l)&&e.jsxs("div",{style:{marginTop:8,fontSize:9,color:"#64748b",textAlign:"center",opacity:.7},children:["(C) ",l||(new Date).getFullYear()," ",d,". All Rights Reserved."]})]}),v&&e.jsx(G,{pages:o.pages,currentPage:p,onSelectPage:B,onClose:()=>j(!1)})]})}function U({title:t,imageUrl:n,creator:o,onBack:a,copyrightYear:i,copyrightHolder:s}){const[l,d]=r.useState(1),[c,p]=r.useState(!1),u=r.useRef(null),g=()=>d(e=>Math.min(e+.25,3)),f=()=>d(e=>Math.max(e-.25,.5)),h=()=>d(1);return r.useEffect(()=>{const e=()=>{p(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),r.useEffect(()=>{const e=e=>{"Escape"!==e.key||document.fullscreenElement?"+"===e.key||"="===e.key?g():"-"===e.key?f():"0"===e.key&&h():a()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a]),e.jsxs("div",{ref:u,style:{position:"fixed",inset:0,background:"#0a0f1a",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 20px",background:"#111827",borderBottom:"1px solid #1f2937",zIndex:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:a,style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center",gap:8},children:e.jsx(x,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#f8fafc",fontSize:16,fontWeight:600},children:t}),e.jsxs("div",{style:{color:"#64748b",fontSize:13},children:["by ",o]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{onClick:f,disabled:l<=.5,style:{background:"#1f2937",border:"none",color:l<=.5?"#475569":"#94a3b8",cursor:l<=.5?"not-allowed":"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center"},title:"Zoom out (-)",children:e.jsx(A,{size:18})}),e.jsxs("span",{style:{color:"#94a3b8",fontSize:13,minWidth:50,textAlign:"center",cursor:"pointer"},onClick:h,title:"Reset zoom (0)",children:[Math.round(100*l),"%"]}),e.jsx("button",{onClick:g,disabled:l>=3,style:{background:"#1f2937",border:"none",color:l>=3?"#475569":"#94a3b8",cursor:l>=3?"not-allowed":"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center"},title:"Zoom in (+)",children:e.jsx(T,{size:18})}),e.jsx("div",{style:{width:1,height:24,background:"#334155",margin:"0 8px"}}),e.jsx("button",{onClick:()=>{var e;document.fullscreenElement?(document.exitFullscreen(),p(!1)):(null==(e=u.current)||e.requestFullscreen(),p(!0))},style:{background:"#1f2937",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center"},title:"Toggle fullscreen",children:e.jsx(w,{size:18})}),e.jsx("a",{href:n,download:!0,target:"_blank",rel:"noopener noreferrer",style:{background:"#1f2937",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center",textDecoration:"none"},title:"Download",children:e.jsx(j,{size:18})})]})]}),e.jsx("div",{style:{flex:1,overflow:"auto",display:"flex",alignItems:"center",justifyContent:"center",padding:24},children:e.jsx("img",{src:n,alt:t,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",transform:`scale(${l})`,transition:"transform 0.2s ease",borderRadius:8,boxShadow:"0 8px 32px rgba(0,0,0,0.5)"},draggable:!1})}),e.jsxs("div",{style:{background:"#111827",borderTop:"1px solid #1f2937"},children:[e.jsx(v,{authorName:s||o,year:i||(new Date).getFullYear(),compact:!0}),e.jsxs("div",{style:{padding:"8px 20px",textAlign:"center",color:"#64748b",fontSize:12},children:["Press ",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"+"})," /",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"-"})," to zoom,",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"0"})," to reset,",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"Esc"})," to go back"]})]})]})}function V({title:r,contentType:t,creator:n,onBack:o}){return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0f1a",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:24},children:[e.jsxs("button",{onClick:o,style:{position:"absolute",top:20,left:20,background:"#1f2937",border:"none",color:"#94a3b8",cursor:"pointer",padding:"8px 16px",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx(x,{size:18}),"Back"]}),e.jsxs("div",{style:{textAlign:"center",maxWidth:400},children:[e.jsx("div",{style:{width:80,height:80,background:"#1f2937",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",fontSize:32},children:"music"===t?"":""}),e.jsx("h2",{style:{color:"#f8fafc",fontSize:24,marginBottom:8},children:r}),e.jsxs("p",{style:{color:"#64748b",marginBottom:4},children:["by ",n]}),e.jsxs("p",{style:{color:"#94a3b8",marginTop:16},children:["music"===t?"Music":"Film"," playback coming soon"]})]})]})}function K(){const{contentId:o}=n(),a=t(),[i,s]=r.useState(null),[l,d]=r.useState(null),[p,x]=r.useState(!0),[g,f]=r.useState(null),h=r.useRef(-1);r.useEffect(()=>{if(!o)return;(async()=>{try{x(!0),f(null),d(null);const r=await c.getFullContent(parseInt(o));if(s(r),"comic"===r.content_type)try{const e=await c.getComicReaderData(parseInt(o));d(e)}catch(e){f("Failed to load comic pages. Please try again.")}"art"===r.content_type&&c.updateProgress(parseInt(o),100,JSON.stringify({viewed:!0})).then(()=>{h.current=100}).catch(e=>{})}catch(r){f(r instanceof Error?r.message:"Failed to load content")}finally{x(!1)}})()},[o]);const b=r.useCallback(()=>{a(-1)},[a]);if(p)return e.jsxs("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",color:"#94a3b8",fontSize:16},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:40,height:40,border:"3px solid #1f2937",borderTopColor:"#f59e0b",borderRadius:"50%",margin:"0 auto 16px",animation:"spin 1s linear infinite"}}),"Loading content..."]}),e.jsx("style",{children:"\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        "})]});if(g||!i)return e.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",padding:24},children:e.jsxs("div",{style:{maxWidth:400,background:"#ef444420",border:"1px solid #ef4444",borderRadius:12,padding:24,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#fca5a5",marginBottom:8},children:g||"Content not found"}),e.jsx("div",{style:{fontSize:14,color:"#94a3b8",marginBottom:16},children:"You may not have access to this content."}),e.jsx("button",{onClick:()=>a("/"),style:{background:"#f59e0b",color:"#111827",padding:"10px 20px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},children:"Go to Home"})]})});if("comic"===i.content_type)return l&&l.pages.length>0?e.jsx(J,{contentId:o||"",title:i.title,comicData:l,onBack:b,copyrightYear:i.copyright_year,copyrightHolder:i.copyright_holder}):e.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",padding:24},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),e.jsx("div",{style:{color:"#f8fafc",fontSize:20,fontWeight:600,marginBottom:8},children:i.title}),e.jsx("div",{style:{color:"#94a3b8",marginBottom:24},children:g||"Comic pages not available"}),e.jsx("button",{onClick:b,style:{background:"#f59e0b",color:"#111827",padding:"10px 20px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},children:"Go Back"})]})});if("art"===i.content_type)return i.teaser_link?e.jsx(U,{title:i.title,imageUrl:i.teaser_link,creator:i.creator,onBack:b,copyrightYear:i.copyright_year,copyrightHolder:i.copyright_holder}):e.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",padding:24},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),e.jsx("div",{style:{color:"#f8fafc",fontSize:20,fontWeight:600,marginBottom:8},children:i.title}),e.jsx("div",{style:{color:"#94a3b8",marginBottom:24},children:"Image not available"}),e.jsx("button",{onClick:b,style:{background:"#f59e0b",color:"#111827",padding:"10px 20px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},children:"Go Back"})]})});if("music"===i.content_type||"film"===i.content_type)return e.jsx(V,{title:i.title,contentType:i.content_type,creator:i.creator,onBack:b});const m=u.sanitize(i.content_html,{ALLOWED_TAGS:["p","br","strong","em","u","i","b","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","pre","code","a","img","div","span"],ALLOWED_ATTR:["href","src","alt","title","class","id"],FORBID_TAGS:["script","style","iframe","object","embed","form","input"],FORBID_ATTR:["onerror","onclick","onload","onmouseover"],ALLOW_DATA_ATTR:!1});return e.jsx(q,{contentId:o||"",title:i.title,htmlContent:m,onBack:b,copyrightYear:i.copyright_year,copyrightHolder:i.copyright_holder})}r.forwardRef(({htmlContent:r,cssVars:t},n)=>e.jsx("div",{ref:n,className:"reader-content-container",style:{position:"fixed",top:"60px",left:0,right:0,bottom:"50px",overflow:"hidden",padding:"20px 24px",boxSizing:"border-box",background:"var(--reader-bg)",...t},children:e.jsx("div",{className:"reader-content",dangerouslySetInnerHTML:{__html:p(r)},style:{height:"100%",columnWidth:"100vw",columnGap:"48px",columnFill:"auto",fontFamily:"var(--reader-font-family)",fontSize:"var(--reader-font-size)",lineHeight:"var(--reader-line-height)",color:"var(--reader-text)",textAlign:"justify",hyphens:"auto",wordBreak:"break-word",overflowX:"hidden",overflowY:"hidden"}})})).displayName="ReaderContent";export{K as ReaderPage};
