import{j as e}from"./web3auth-BkZxjmxM.js";import{u as a,f as t,r as l}from"./router-cVcvJ1e3.js";import{V as o}from"./VideoCard-De6n0S3T.js";import{A as n}from"./index-CMx0GQyy.js";import"./vendor-Cfs_Iq82.js";import"./star-ksjL11SQ.js";import"./eye-DO7pWHda.js";import"./thumbs-up-DC6UR-Zc.js";const r=[{label:"All",value:"all"},{label:"Books",value:"book"},{label:"Art",value:"art"},{label:"Film",value:"film",comingSoon:!0},{label:"Music",value:"music",comingSoon:!0}],i=[{label:"All Genres",value:"all"},{label:"Fantasy",value:"fantasy"},{label:"Sci-Fi",value:"scifi"},{label:"Non-Fiction",value:"nonfiction"},{label:"Drama",value:"drama"},{label:"Comedy",value:"comedy"},{label:"Other",value:"other"}];function s(){a();const[s,c]=t(),d=s.get("q")||"",[u,m]=l.useState(s.get("type")||"all"),[g,h]=l.useState(s.get("genre")||"all"),[p,f]=l.useState([]),[v,b]=l.useState(!1),y=(e,a)=>{const t=new URLSearchParams(s);"all"!==e?t.set("type",e):t.delete("type"),"all"!==a?t.set("genre",a):t.delete("genre"),c(t)},j=l.useCallback(()=>{b(!0);const e=new URLSearchParams;d&&e.set("q",d),"all"!==u&&e.set("type",u),"all"!==g&&e.set("genre",g),fetch(`${n}/api/search/?${e.toString()}`,{credentials:"include"}).then(e=>e.json()).then(e=>{Array.isArray(e)?f(e):f([])}).catch(()=>f([])).finally(()=>b(!1))},[d,u,g]);l.useEffect(()=>{j()},[j]),l.useEffect(()=>{m(s.get("type")||"all"),h(s.get("genre")||"all")},[s]);const x=e=>{if(!e)return"Recently";const a=new Date(e),t=new Date,l=Math.floor((t.getTime()-a.getTime())/1e3);return l<60?"Just now":l<3600?`${Math.floor(l/60)} minutes ago`:l<86400?`${Math.floor(l/3600)} hours ago`:l<604800?`${Math.floor(l/86400)} days ago`:`${Math.floor(l/604800)} weeks ago`};return e.jsxs("div",{className:"page",style:{background:"transparent",border:"none",boxShadow:"none"},children:[d&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("h2",{style:{margin:0,fontSize:20,color:"#f1f5f9"},children:['Results for "',d,'"']}),e.jsxs("p",{style:{margin:"4px 0 0",fontSize:14,color:"#94a3b8"},children:[p.length," result",1!==p.length?"s":""," found"]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{className:"chips",style:{marginBottom:8},children:r.map(a=>e.jsxs("button",{className:`chip ${u===a.value?"active":""} ${a.comingSoon?"disabled":""}`,onClick:()=>{return!a.comingSoon&&(e=a.value,m(e),void y(e,g));var e},disabled:a.comingSoon,style:{opacity:a.comingSoon?.5:1,cursor:a.comingSoon?"not-allowed":"pointer",position:"relative"},children:[a.label,a.comingSoon&&e.jsx("span",{style:{fontSize:9,background:"#f59e0b",color:"#000",padding:"1px 4px",borderRadius:3,marginLeft:4,fontWeight:700},children:"SOON"})]},a.value))}),e.jsx("div",{className:"chips",children:i.map(a=>e.jsx("button",{className:"chip "+(g===a.value?"active":""),onClick:()=>{return e=a.value,h(e),void y(u,e);var e},children:a.label},a.value))})]}),v?e.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"Searching..."}):0===p.length?e.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:d?`No results found for "${d}"`:"Browse content using the filters above"}):e.jsx("div",{className:"yt-grid",children:p.map(a=>e.jsx(o,{id:a.id,title:a.title,author:a.creator_username||`Creator #${a.creator??0}`,likeCount:a.like_count,averageRating:a.average_rating,ratingCount:a.rating_count,timeText:x(a.created_at),thumbnailUrl:a.teaser_link||"",teaser_link:a.teaser_link,price:a.price_usd,editions:a.editions,owned:a.owned},a.id))})]})}export{s as default};
