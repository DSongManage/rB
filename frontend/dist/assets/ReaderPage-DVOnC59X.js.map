{"version":3,"file":"ReaderPage-DVOnC59X.js","sources":["../../node_modules/lucide-react/dist/esm/icons/list.js","../../node_modules/lucide-react/dist/esm/icons/text-align-justify.js","../../node_modules/lucide-react/dist/esm/icons/text-align-start.js","../../src/types/reader.ts","../../src/hooks/useReaderSettings.ts","../../src/components/reader/ReaderHeader.tsx","../../src/components/reader/ReaderFooter.tsx","../../src/components/reader/ReaderNavigation.tsx","../../src/components/reader/ReaderSettings.tsx","../../src/components/reader/TableOfContents.tsx","../../src/components/reader/KindleReader.tsx","../../src/utils/chapterDetection.ts","../../src/hooks/useSwipeGesture.ts","../../src/hooks/useKeyboardNavigation.ts","../../src/pages/ReaderPage.tsx","../../src/components/reader/ReaderContent.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 5h.01\", key: \"18ugdj\" }],\n  [\"path\", { d: \"M3 12h.01\", key: \"nlz23k\" }],\n  [\"path\", { d: \"M3 19h.01\", key: \"noohij\" }],\n  [\"path\", { d: \"M8 5h13\", key: \"1pao27\" }],\n  [\"path\", { d: \"M8 12h13\", key: \"1za7za\" }],\n  [\"path\", { d: \"M8 19h13\", key: \"m83p4d\" }]\n];\nconst List = createLucideIcon(\"list\", __iconNode);\n\nexport { __iconNode, List as default };\n//# sourceMappingURL=list.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 5h18\", key: \"1u36vt\" }],\n  [\"path\", { d: \"M3 12h18\", key: \"1i2n21\" }],\n  [\"path\", { d: \"M3 19h18\", key: \"awlh7x\" }]\n];\nconst TextAlignJustify = createLucideIcon(\"text-align-justify\", __iconNode);\n\nexport { __iconNode, TextAlignJustify as default };\n//# sourceMappingURL=text-align-justify.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21 5H3\", key: \"1fi0y6\" }],\n  [\"path\", { d: \"M15 12H3\", key: \"6jk70r\" }],\n  [\"path\", { d: \"M17 19H3\", key: \"z6ezky\" }]\n];\nconst TextAlignStart = createLucideIcon(\"text-align-start\", __iconNode);\n\nexport { __iconNode, TextAlignStart as default };\n//# sourceMappingURL=text-align-start.js.map\n","/**\n * Kindle-style Reader Type Definitions\n */\n\n// Reader settings that persist to localStorage\nexport interface ReaderSettings {\n  fontSize: 'xsmall' | 'small' | 'medium' | 'large' | 'xlarge';\n  lineHeight: 'compact' | 'normal' | 'relaxed';\n  theme: 'light' | 'sepia' | 'green' | 'dark';\n  fontFamily: 'amazon-ember' | 'baskerville' | 'bookerly' | 'georgia' | 'palatino';\n  margins: 'narrow' | 'medium' | 'wide';\n  textAlign: 'left' | 'justify';\n  columns: 'single' | 'two';\n  continuousScroll: boolean;\n}\n\nexport const DEFAULT_READER_SETTINGS: ReaderSettings = {\n  fontSize: 'medium',\n  lineHeight: 'normal',\n  theme: 'dark',\n  fontFamily: 'bookerly',\n  margins: 'medium',\n  textAlign: 'justify',\n  columns: 'two',\n  continuousScroll: false,\n};\n\n// Font size mappings in pixels (more granular like Kindle)\nexport const FONT_SIZE_MAP: Record<ReaderSettings['fontSize'], string> = {\n  xsmall: '14px',\n  small: '16px',\n  medium: '18px',\n  large: '22px',\n  xlarge: '26px',\n};\n\n// Line height mappings\nexport const LINE_HEIGHT_MAP: Record<ReaderSettings['lineHeight'], string> = {\n  compact: '1.4',\n  normal: '1.7',\n  relaxed: '2.0',\n};\n\n// Theme color mappings (matching Kindle's 4 page colors)\nexport const THEME_COLORS: Record<ReaderSettings['theme'], {\n  background: string;\n  text: string;\n  secondary: string;\n  border: string;\n  accent: string;\n}> = {\n  light: {\n    background: '#ffffff',\n    text: '#1a1a1a',\n    secondary: '#6b7280',\n    border: '#e5e7eb',\n    accent: '#0066cc',\n  },\n  sepia: {\n    background: '#f5e6c8',\n    text: '#5b4636',\n    secondary: '#8b7355',\n    border: '#d4c4a8',\n    accent: '#8b5a2b',\n  },\n  green: {\n    background: '#d4e8d4',\n    text: '#2d4a2d',\n    secondary: '#4a6b4a',\n    border: '#a8c8a8',\n    accent: '#2d6b2d',\n  },\n  dark: {\n    background: '#0a1628',\n    text: '#c9d1d9',\n    secondary: '#8b949e',\n    border: '#21262d',\n    accent: '#58a6ff',\n  },\n};\n\n// Font family mappings (Kindle-style fonts)\nexport const FONT_FAMILY_MAP: Record<ReaderSettings['fontFamily'], { name: string; css: string }> = {\n  'amazon-ember': {\n    name: 'Amazon Ember',\n    css: \"'Amazon Ember', 'Helvetica Neue', Helvetica, Arial, sans-serif\",\n  },\n  'baskerville': {\n    name: 'Baskerville',\n    css: \"Baskerville, 'Baskerville Old Face', 'Times New Roman', serif\",\n  },\n  'bookerly': {\n    name: 'Bookerly',\n    css: \"Bookerly, Georgia, 'Times New Roman', serif\",\n  },\n  'georgia': {\n    name: 'Georgia',\n    css: \"Georgia, 'Times New Roman', serif\",\n  },\n  'palatino': {\n    name: 'Palatino',\n    css: \"'Palatino Linotype', 'Book Antiqua', Palatino, serif\",\n  },\n};\n\n// Margin mappings\nexport const MARGIN_MAP: Record<ReaderSettings['margins'], string> = {\n  narrow: '20px',\n  medium: '48px',\n  wide: '80px',\n};\n\n// Chapter detected from HTML headings\nexport interface Chapter {\n  id: string;\n  title: string;\n  level: number; // 1, 2, or 3 (h1, h2, h3)\n  pageIndex: number; // Which page this chapter starts on\n  elementId?: string; // ID attribute if present in HTML\n}\n\n// Position saved for progress tracking\nexport interface PagePosition {\n  page: number;\n  totalPages: number;\n  chapterId?: string;\n  fontSize: ReaderSettings['fontSize'];\n  lineHeight: ReaderSettings['lineHeight'];\n  margins?: ReaderSettings['margins'];\n  columns?: ReaderSettings['columns'];\n}\n\n// Legacy position format (for backward compatibility)\nexport interface ScrollPosition {\n  scroll: number;\n}\n\n// Combined position type\nexport type SavedPosition = PagePosition | ScrollPosition;\n\n// Check if position is page-based\nexport function isPagePosition(pos: SavedPosition): pos is PagePosition {\n  return 'page' in pos && 'totalPages' in pos;\n}\n","import { useState, useEffect, useCallback, useMemo } from 'react';\nimport {\n  ReaderSettings,\n  DEFAULT_READER_SETTINGS,\n  FONT_SIZE_MAP,\n  LINE_HEIGHT_MAP,\n  THEME_COLORS,\n  FONT_FAMILY_MAP,\n  MARGIN_MAP,\n} from '../types/reader';\n\nconst STORAGE_KEY = 'rb_reader_settings';\n\nexport function useReaderSettings() {\n  const [settings, setSettings] = useState<ReaderSettings>(() => {\n    // Load from localStorage on init\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        const parsed = JSON.parse(stored);\n        // Migrate old settings format\n        const migrated = migrateSettings(parsed);\n        return { ...DEFAULT_READER_SETTINGS, ...migrated };\n      }\n    } catch (e) {\n      console.error('Failed to load reader settings:', e);\n    }\n    return DEFAULT_READER_SETTINGS;\n  });\n\n  // Persist to localStorage on change\n  useEffect(() => {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\n    } catch (e) {\n      console.error('Failed to save reader settings:', e);\n    }\n  }, [settings]);\n\n  const updateSetting = useCallback(\n    <K extends keyof ReaderSettings>(key: K, value: ReaderSettings[K]) => {\n      setSettings((prev) => ({ ...prev, [key]: value }));\n    },\n    []\n  );\n\n  const resetSettings = useCallback(() => {\n    setSettings(DEFAULT_READER_SETTINGS);\n  }, []);\n\n  // Computed CSS variables for easy application\n  const cssVars = useMemo(\n    () => ({\n      '--reader-font-size': FONT_SIZE_MAP[settings.fontSize],\n      '--reader-line-height': LINE_HEIGHT_MAP[settings.lineHeight],\n      '--reader-bg': THEME_COLORS[settings.theme].background,\n      '--reader-text': THEME_COLORS[settings.theme].text,\n      '--reader-secondary': THEME_COLORS[settings.theme].secondary,\n      '--reader-border': THEME_COLORS[settings.theme].border,\n      '--reader-accent': THEME_COLORS[settings.theme].accent,\n      '--reader-font-family': FONT_FAMILY_MAP[settings.fontFamily].css,\n      '--reader-margin': MARGIN_MAP[settings.margins],\n      '--reader-text-align': settings.textAlign,\n    }),\n    [settings]\n  );\n\n  // Theme class name for CSS\n  const themeClass = `reader-theme-${settings.theme}`;\n\n  return {\n    settings,\n    updateSetting,\n    resetSettings,\n    cssVars,\n    themeClass,\n  };\n}\n\n// Migrate old settings format to new format\nfunction migrateSettings(oldSettings: Record<string, unknown>): Partial<ReaderSettings> {\n  const migrated: Partial<ReaderSettings> = { ...oldSettings } as Partial<ReaderSettings>;\n\n  // Migrate old fontFamily values\n  if (oldSettings.fontFamily === 'serif') {\n    migrated.fontFamily = 'georgia';\n  } else if (oldSettings.fontFamily === 'sans-serif') {\n    migrated.fontFamily = 'amazon-ember';\n  }\n\n  // Ensure new fields have defaults if missing\n  if (!migrated.margins) migrated.margins = DEFAULT_READER_SETTINGS.margins;\n  if (!migrated.textAlign) migrated.textAlign = DEFAULT_READER_SETTINGS.textAlign;\n  if (!migrated.columns) migrated.columns = DEFAULT_READER_SETTINGS.columns;\n  if (migrated.continuousScroll === undefined) migrated.continuousScroll = DEFAULT_READER_SETTINGS.continuousScroll;\n\n  return migrated;\n}\n\nexport default useReaderSettings;\n","import React from 'react';\nimport { ArrowLeft, Settings, List } from 'lucide-react';\n\ninterface ReaderHeaderProps {\n  title: string;\n  chapterTitle?: string;\n  onBack: () => void;\n  onToggleSettings: () => void;\n  onToggleTOC: () => void;\n  visible: boolean;\n}\n\nexport function ReaderHeader({\n  title,\n  chapterTitle,\n  onBack,\n  onToggleSettings,\n  onToggleTOC,\n  visible,\n}: ReaderHeaderProps) {\n  return (\n    <header\n      className={`reader-header ${visible ? 'visible' : 'hidden'}`}\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        height: '60px',\n        background: 'var(--reader-bg)',\n        borderBottom: '1px solid var(--reader-border)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        padding: '0 16px',\n        zIndex: 100,\n        transition: 'transform 0.3s ease, opacity 0.3s ease',\n        transform: visible ? 'translateY(0)' : 'translateY(-100%)',\n        opacity: visible ? 1 : 0,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\n        <button\n          onClick={onBack}\n          className=\"reader-icon-button\"\n          aria-label=\"Go back\"\n          style={{\n            background: 'none',\n            border: 'none',\n            color: 'var(--reader-text)',\n            cursor: 'pointer',\n            padding: '8px',\n            borderRadius: '8px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          <ArrowLeft size={24} />\n        </button>\n\n        <div style={{ overflow: 'hidden' }}>\n          <h1\n            style={{\n              fontSize: '16px',\n              fontWeight: 600,\n              color: 'var(--reader-text)',\n              margin: 0,\n              whiteSpace: 'nowrap',\n              textOverflow: 'ellipsis',\n              overflow: 'hidden',\n              maxWidth: '200px',\n            }}\n          >\n            {title}\n          </h1>\n          {chapterTitle && (\n            <p\n              style={{\n                fontSize: '12px',\n                color: 'var(--reader-secondary)',\n                margin: 0,\n                whiteSpace: 'nowrap',\n                textOverflow: 'ellipsis',\n                overflow: 'hidden',\n                maxWidth: '200px',\n              }}\n            >\n              {chapterTitle}\n            </p>\n          )}\n        </div>\n      </div>\n\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n        <button\n          onClick={onToggleTOC}\n          className=\"reader-icon-button\"\n          aria-label=\"Table of Contents\"\n          style={{\n            background: 'none',\n            border: 'none',\n            color: 'var(--reader-text)',\n            cursor: 'pointer',\n            padding: '8px',\n            borderRadius: '8px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          <List size={24} />\n        </button>\n\n        <button\n          onClick={onToggleSettings}\n          className=\"reader-icon-button\"\n          aria-label=\"Settings\"\n          style={{\n            background: 'none',\n            border: 'none',\n            color: 'var(--reader-text)',\n            cursor: 'pointer',\n            padding: '8px',\n            borderRadius: '8px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          <Settings size={24} />\n        </button>\n      </div>\n    </header>\n  );\n}\n\nexport default ReaderHeader;\n","import React from 'react';\n\ninterface ReaderFooterProps {\n  currentPage: number;\n  totalPages: number;\n  percentComplete: number;\n  visible: boolean;\n  continuousScroll?: boolean;\n}\n\nexport function ReaderFooter({\n  currentPage,\n  totalPages,\n  percentComplete,\n  visible,\n  continuousScroll = false,\n}: ReaderFooterProps) {\n  return (\n    <footer\n      className={`reader-footer ${visible ? 'visible' : 'hidden'}`}\n      style={{\n        position: 'fixed',\n        bottom: 0,\n        left: 0,\n        right: 0,\n        height: '50px',\n        background: 'var(--reader-bg)',\n        borderTop: '1px solid var(--reader-border)',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        padding: '0 16px',\n        zIndex: 100,\n        transition: 'transform 0.3s ease, opacity 0.3s ease',\n        transform: visible ? 'translateY(0)' : 'translateY(100%)',\n        opacity: visible ? 1 : 0,\n      }}\n    >\n      {/* Progress bar */}\n      <div\n        style={{\n          width: '100%',\n          maxWidth: '400px',\n          height: '3px',\n          background: 'var(--reader-border)',\n          borderRadius: '2px',\n          marginBottom: '8px',\n          overflow: 'hidden',\n        }}\n      >\n        <div\n          style={{\n            width: `${percentComplete}%`,\n            height: '100%',\n            background: 'var(--reader-accent, var(--reader-secondary))',\n            borderRadius: '2px',\n            transition: 'width 0.3s ease',\n          }}\n        />\n      </div>\n\n      {/* Page indicator */}\n      <p\n        style={{\n          fontSize: '12px',\n          color: 'var(--reader-secondary)',\n          margin: 0,\n        }}\n      >\n        {continuousScroll\n          ? `${percentComplete}% complete`\n          : `Page ${currentPage + 1} of ${totalPages} (${percentComplete}%)`\n        }\n      </p>\n    </footer>\n  );\n}\n\nexport default ReaderFooter;\n","import React from 'react';\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\n\ninterface ReaderNavigationProps {\n  onPrevious: () => void;\n  onNext: () => void;\n  onCenter: () => void;\n  isFirstPage: boolean;\n  isLastPage: boolean;\n  showArrows: boolean;\n}\n\nexport function ReaderNavigation({\n  onPrevious,\n  onNext,\n  onCenter,\n  isFirstPage,\n  isLastPage,\n  showArrows,\n}: ReaderNavigationProps) {\n  return (\n    <>\n      {/* Left click zone (previous page) */}\n      <div\n        className=\"reader-nav-zone reader-nav-left\"\n        onClick={(e) => {\n          e.stopPropagation();\n          if (!isFirstPage) onPrevious();\n        }}\n        style={{\n          position: 'fixed',\n          left: 0,\n          top: '60px',\n          bottom: '50px',\n          width: '25%',\n          cursor: isFirstPage ? 'default' : 'pointer',\n          zIndex: 50,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'flex-start',\n          paddingLeft: '12px',\n        }}\n        role=\"button\"\n        aria-label=\"Previous page\"\n      >\n        {showArrows && !isFirstPage && (\n          <div\n            className=\"reader-nav-arrow\"\n            style={{\n              opacity: 0.3,\n              transition: 'opacity 0.2s ease',\n              color: 'var(--reader-secondary)',\n            }}\n          >\n            <ChevronLeft size={32} />\n          </div>\n        )}\n      </div>\n\n      {/* Center click zone (toggle UI) */}\n      <div\n        className=\"reader-nav-zone reader-nav-center\"\n        onClick={(e) => {\n          e.stopPropagation();\n          onCenter();\n        }}\n        style={{\n          position: 'fixed',\n          left: '25%',\n          right: '25%',\n          top: '60px',\n          bottom: '50px',\n          cursor: 'pointer',\n          zIndex: 50,\n        }}\n        role=\"button\"\n        aria-label=\"Toggle controls\"\n      />\n\n      {/* Right click zone (next page) */}\n      <div\n        className=\"reader-nav-zone reader-nav-right\"\n        onClick={(e) => {\n          e.stopPropagation();\n          if (!isLastPage) onNext();\n        }}\n        style={{\n          position: 'fixed',\n          right: 0,\n          top: '60px',\n          bottom: '50px',\n          width: '25%',\n          cursor: isLastPage ? 'default' : 'pointer',\n          zIndex: 50,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'flex-end',\n          paddingRight: '12px',\n        }}\n        role=\"button\"\n        aria-label=\"Next page\"\n      >\n        {showArrows && !isLastPage && (\n          <div\n            className=\"reader-nav-arrow\"\n            style={{\n              opacity: 0.3,\n              transition: 'opacity 0.2s ease',\n              color: 'var(--reader-secondary)',\n            }}\n          >\n            <ChevronRight size={32} />\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\nexport default ReaderNavigation;\n","import React, { useState } from 'react';\nimport { X, AlignLeft, AlignJustify } from 'lucide-react';\nimport { ReaderSettings as ReaderSettingsType, FONT_FAMILY_MAP, THEME_COLORS } from '../../types/reader';\n\ntype SettingsTab = 'font' | 'layout' | 'themes' | 'more';\n\ninterface ReaderSettingsPanelProps {\n  settings: ReaderSettingsType;\n  updateSetting: <K extends keyof ReaderSettingsType>(\n    key: K,\n    value: ReaderSettingsType[K]\n  ) => void;\n  resetSettings: () => void;\n  onClose: () => void;\n  visible: boolean;\n}\n\nexport function ReaderSettingsPanel({\n  settings,\n  updateSetting,\n  resetSettings,\n  onClose,\n  visible,\n}: ReaderSettingsPanelProps) {\n  const [activeTab, setActiveTab] = useState<SettingsTab>('font');\n\n  if (!visible) return null;\n\n  const tabs: { id: SettingsTab; label: string }[] = [\n    { id: 'font', label: 'Font' },\n    { id: 'layout', label: 'Layout' },\n    { id: 'themes', label: 'Themes' },\n    { id: 'more', label: 'More' },\n  ];\n\n  const fontSizes: ReaderSettingsType['fontSize'][] = ['xsmall', 'small', 'medium', 'large', 'xlarge'];\n  const currentSizeIndex = fontSizes.indexOf(settings.fontSize);\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div\n        className=\"reader-settings-backdrop\"\n        onClick={onClose}\n        style={{\n          position: 'fixed',\n          inset: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          zIndex: 200,\n          animation: 'fadeIn 0.2s ease',\n        }}\n      />\n\n      {/* Settings Panel - Slides from right like Kindle */}\n      <div\n        className=\"reader-settings-panel\"\n        style={{\n          position: 'fixed',\n          top: 0,\n          right: 0,\n          bottom: 0,\n          width: '320px',\n          maxWidth: '90vw',\n          background: 'var(--reader-bg)',\n          borderLeft: '1px solid var(--reader-border)',\n          zIndex: 201,\n          display: 'flex',\n          flexDirection: 'column',\n          animation: 'slideFromRight 0.3s ease',\n        }}\n      >\n        {/* Tab Navigation */}\n        <div\n          style={{\n            display: 'flex',\n            borderBottom: '1px solid var(--reader-border)',\n            padding: '0 8px',\n          }}\n        >\n          {tabs.map((tab) => (\n            <button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id)}\n              style={{\n                flex: 1,\n                padding: '16px 8px',\n                background: 'none',\n                border: 'none',\n                borderBottom: activeTab === tab.id ? '2px solid var(--reader-accent, #58a6ff)' : '2px solid transparent',\n                color: activeTab === tab.id ? 'var(--reader-accent, #58a6ff)' : 'var(--reader-secondary)',\n                fontSize: '14px',\n                fontWeight: activeTab === tab.id ? 600 : 400,\n                cursor: 'pointer',\n                transition: 'all 0.2s ease',\n              }}\n            >\n              {tab.label}\n            </button>\n          ))}\n          <button\n            onClick={onClose}\n            style={{\n              background: 'none',\n              border: 'none',\n              color: 'var(--reader-secondary)',\n              cursor: 'pointer',\n              padding: '16px 12px',\n            }}\n            aria-label=\"Close settings\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Tab Content */}\n        <div\n          style={{\n            flex: 1,\n            overflowY: 'auto',\n            padding: '20px',\n          }}\n        >\n          {/* Font Tab */}\n          {activeTab === 'font' && (\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>\n              {/* Font Family Selection */}\n              <div>\n                <div\n                  style={{\n                    display: 'flex',\n                    gap: '8px',\n                    flexWrap: 'wrap',\n                  }}\n                >\n                  {(Object.keys(FONT_FAMILY_MAP) as ReaderSettingsType['fontFamily'][]).map((fontKey) => (\n                    <button\n                      key={fontKey}\n                      onClick={() => updateSetting('fontFamily', fontKey)}\n                      style={{\n                        padding: '12px 16px',\n                        border: settings.fontFamily === fontKey\n                          ? '2px solid var(--reader-accent, #58a6ff)'\n                          : '1px solid var(--reader-border)',\n                        borderRadius: '8px',\n                        background: settings.fontFamily === fontKey\n                          ? 'rgba(88, 166, 255, 0.1)'\n                          : 'transparent',\n                        color: settings.fontFamily === fontKey\n                          ? 'var(--reader-accent, #58a6ff)'\n                          : 'var(--reader-text)',\n                        cursor: 'pointer',\n                        fontFamily: FONT_FAMILY_MAP[fontKey].css,\n                        fontSize: '18px',\n                        minWidth: '70px',\n                      }}\n                    >\n                      Aa\n                      <div style={{ fontSize: '10px', marginTop: '4px', fontFamily: 'system-ui' }}>\n                        {FONT_FAMILY_MAP[fontKey].name}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Font Size Slider */}\n              <div>\n                <label\n                  style={{\n                    display: 'block',\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-secondary)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Size\n                </label>\n                <div\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '12px',\n                  }}\n                >\n                  <span style={{ fontSize: '14px', color: 'var(--reader-text)' }}>A</span>\n                  <div style={{ flex: 1, position: 'relative' }}>\n                    <input\n                      type=\"range\"\n                      min={0}\n                      max={fontSizes.length - 1}\n                      value={currentSizeIndex}\n                      onChange={(e) => updateSetting('fontSize', fontSizes[parseInt(e.target.value)])}\n                      style={{\n                        width: '100%',\n                        height: '4px',\n                        appearance: 'none',\n                        background: 'var(--reader-border)',\n                        borderRadius: '2px',\n                        cursor: 'pointer',\n                      }}\n                    />\n                    {/* Tick marks */}\n                    <div\n                      style={{\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        marginTop: '8px',\n                      }}\n                    >\n                      {fontSizes.map((_, i) => (\n                        <div\n                          key={i}\n                          style={{\n                            width: '2px',\n                            height: '6px',\n                            background: i <= currentSizeIndex ? 'var(--reader-accent, #58a6ff)' : 'var(--reader-border)',\n                            borderRadius: '1px',\n                          }}\n                        />\n                      ))}\n                    </div>\n                  </div>\n                  <span style={{ fontSize: '22px', color: 'var(--reader-text)' }}>A</span>\n                </div>\n              </div>\n\n              {/* Spacing */}\n              <div>\n                <label\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-secondary)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Spacing\n                  <span style={{ fontSize: '12px', color: 'var(--reader-secondary)' }}>\n                    Adjust text spacing of the page.\n                  </span>\n                </label>\n                <div style={{ display: 'flex', gap: '8px' }}>\n                  {(['compact', 'normal', 'relaxed'] as const).map((spacing) => (\n                    <button\n                      key={spacing}\n                      onClick={() => updateSetting('lineHeight', spacing)}\n                      style={{\n                        flex: 1,\n                        padding: '10px 8px',\n                        border: settings.lineHeight === spacing\n                          ? '2px solid var(--reader-accent, #58a6ff)'\n                          : '1px solid var(--reader-border)',\n                        borderRadius: '8px',\n                        background: settings.lineHeight === spacing\n                          ? 'rgba(88, 166, 255, 0.1)'\n                          : 'transparent',\n                        color: settings.lineHeight === spacing\n                          ? 'var(--reader-accent, #58a6ff)'\n                          : 'var(--reader-text)',\n                        cursor: 'pointer',\n                        fontSize: '12px',\n                        textTransform: 'capitalize',\n                      }}\n                    >\n                      {spacing}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Layout Tab */}\n          {activeTab === 'layout' && (\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>\n              {/* Page Color */}\n              <div>\n                <label\n                  style={{\n                    display: 'block',\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-secondary)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Page Color\n                </label>\n                <div style={{ display: 'flex', gap: '12px' }}>\n                  {(Object.keys(THEME_COLORS) as ReaderSettingsType['theme'][]).map((themeKey) => (\n                    <button\n                      key={themeKey}\n                      onClick={() => updateSetting('theme', themeKey)}\n                      style={{\n                        width: '48px',\n                        height: '48px',\n                        borderRadius: '50%',\n                        background: THEME_COLORS[themeKey].background,\n                        border: settings.theme === themeKey\n                          ? '3px solid var(--reader-accent, #58a6ff)'\n                          : '2px solid var(--reader-border)',\n                        cursor: 'pointer',\n                        transition: 'transform 0.2s ease',\n                        boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n                      }}\n                      title={themeKey.charAt(0).toUpperCase() + themeKey.slice(1)}\n                    />\n                  ))}\n                </div>\n              </div>\n\n              {/* Continuous Scrolling Toggle */}\n              <div\n                style={{\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  alignItems: 'center',\n                }}\n              >\n                <label\n                  style={{\n                    fontSize: '14px',\n                    color: 'var(--reader-text)',\n                  }}\n                >\n                  Continuous Scrolling\n                </label>\n                <button\n                  onClick={() => updateSetting('continuousScroll', !settings.continuousScroll)}\n                  style={{\n                    width: '48px',\n                    height: '28px',\n                    borderRadius: '14px',\n                    border: 'none',\n                    background: settings.continuousScroll ? 'var(--reader-accent, #58a6ff)' : 'var(--reader-border)',\n                    cursor: 'pointer',\n                    position: 'relative',\n                    transition: 'background 0.2s ease',\n                  }}\n                >\n                  <div\n                    style={{\n                      width: '24px',\n                      height: '24px',\n                      borderRadius: '50%',\n                      background: '#fff',\n                      position: 'absolute',\n                      top: '2px',\n                      left: settings.continuousScroll ? '22px' : '2px',\n                      transition: 'left 0.2s ease',\n                      boxShadow: '0 1px 3px rgba(0,0,0,0.2)',\n                    }}\n                  />\n                </button>\n              </div>\n\n              {/* Alignment */}\n              <div>\n                <label\n                  style={{\n                    display: 'block',\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-secondary)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Alignment\n                </label>\n                <div style={{ display: 'flex', gap: '8px' }}>\n                  <button\n                    onClick={() => updateSetting('textAlign', 'left')}\n                    style={{\n                      flex: 1,\n                      padding: '12px',\n                      border: settings.textAlign === 'left'\n                        ? '2px solid var(--reader-accent, #58a6ff)'\n                        : '1px solid var(--reader-border)',\n                      borderRadius: '8px',\n                      background: settings.textAlign === 'left'\n                        ? 'rgba(88, 166, 255, 0.1)'\n                        : 'transparent',\n                      color: settings.textAlign === 'left'\n                        ? 'var(--reader-accent, #58a6ff)'\n                        : 'var(--reader-text)',\n                      cursor: 'pointer',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                    }}\n                  >\n                    <AlignLeft size={20} />\n                  </button>\n                  <button\n                    onClick={() => updateSetting('textAlign', 'justify')}\n                    style={{\n                      flex: 1,\n                      padding: '12px',\n                      border: settings.textAlign === 'justify'\n                        ? '2px solid var(--reader-accent, #58a6ff)'\n                        : '1px solid var(--reader-border)',\n                      borderRadius: '8px',\n                      background: settings.textAlign === 'justify'\n                        ? 'rgba(88, 166, 255, 0.1)'\n                        : 'transparent',\n                      color: settings.textAlign === 'justify'\n                        ? 'var(--reader-accent, #58a6ff)'\n                        : 'var(--reader-text)',\n                      cursor: 'pointer',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                    }}\n                  >\n                    <AlignJustify size={20} />\n                  </button>\n                </div>\n              </div>\n\n              {/* Margins */}\n              <div>\n                <label\n                  style={{\n                    display: 'block',\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-secondary)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Margins\n                </label>\n                <div style={{ display: 'flex', gap: '8px' }}>\n                  {(['narrow', 'medium', 'wide'] as const).map((margin) => (\n                    <button\n                      key={margin}\n                      onClick={() => updateSetting('margins', margin)}\n                      style={{\n                        flex: 1,\n                        padding: '12px 8px',\n                        border: settings.margins === margin\n                          ? '2px solid var(--reader-accent, #58a6ff)'\n                          : '1px solid var(--reader-border)',\n                        borderRadius: '8px',\n                        background: settings.margins === margin\n                          ? 'rgba(88, 166, 255, 0.1)'\n                          : 'transparent',\n                        color: settings.margins === margin\n                          ? 'var(--reader-accent, #58a6ff)'\n                          : 'var(--reader-text)',\n                        cursor: 'pointer',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                      }}\n                    >\n                      {/* Visual margin representation */}\n                      <div\n                        style={{\n                          width: margin === 'narrow' ? '28px' : margin === 'medium' ? '20px' : '12px',\n                          height: '20px',\n                          background: 'currentColor',\n                          opacity: 0.3,\n                          borderRadius: '2px',\n                        }}\n                      />\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Columns */}\n              <div>\n                <label\n                  style={{\n                    display: 'block',\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-secondary)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Layout\n                </label>\n                <div style={{ display: 'flex', gap: '8px' }}>\n                  <button\n                    onClick={() => updateSetting('columns', 'single')}\n                    style={{\n                      flex: 1,\n                      padding: '12px 8px',\n                      border: settings.columns === 'single'\n                        ? '2px solid var(--reader-accent, #58a6ff)'\n                        : '1px solid var(--reader-border)',\n                      borderRadius: '8px',\n                      background: settings.columns === 'single'\n                        ? 'rgba(88, 166, 255, 0.1)'\n                        : 'transparent',\n                      color: settings.columns === 'single'\n                        ? 'var(--reader-accent, #58a6ff)'\n                        : 'var(--reader-text)',\n                      cursor: 'pointer',\n                      display: 'flex',\n                      flexDirection: 'column',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      gap: '6px',\n                    }}\n                  >\n                    {/* Single page icon - one rectangle */}\n                    <div\n                      style={{\n                        width: '24px',\n                        height: '32px',\n                        border: '2px solid currentColor',\n                        borderRadius: '3px',\n                      }}\n                    />\n                    <span style={{ fontSize: '11px' }}>Single</span>\n                  </button>\n                  <button\n                    onClick={() => updateSetting('columns', 'two')}\n                    style={{\n                      flex: 1,\n                      padding: '12px 8px',\n                      border: settings.columns === 'two'\n                        ? '2px solid var(--reader-accent, #58a6ff)'\n                        : '1px solid var(--reader-border)',\n                      borderRadius: '8px',\n                      background: settings.columns === 'two'\n                        ? 'rgba(88, 166, 255, 0.1)'\n                        : 'transparent',\n                      color: settings.columns === 'two'\n                        ? 'var(--reader-accent, #58a6ff)'\n                        : 'var(--reader-text)',\n                      cursor: 'pointer',\n                      display: 'flex',\n                      flexDirection: 'column',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      gap: '6px',\n                    }}\n                  >\n                    {/* Two column icon - two rectangles side by side */}\n                    <div style={{ display: 'flex', gap: '3px' }}>\n                      <div\n                        style={{\n                          width: '16px',\n                          height: '32px',\n                          border: '2px solid currentColor',\n                          borderRadius: '3px',\n                        }}\n                      />\n                      <div\n                        style={{\n                          width: '16px',\n                          height: '32px',\n                          border: '2px solid currentColor',\n                          borderRadius: '3px',\n                        }}\n                      />\n                    </div>\n                    <span style={{ fontSize: '11px' }}>Two Column</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Themes Tab */}\n          {activeTab === 'themes' && (\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>\n              {(Object.keys(THEME_COLORS) as ReaderSettingsType['theme'][]).map((themeKey) => (\n                <button\n                  key={themeKey}\n                  onClick={() => updateSetting('theme', themeKey)}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '16px',\n                    padding: '16px',\n                    border: settings.theme === themeKey\n                      ? '2px solid var(--reader-accent, #58a6ff)'\n                      : '1px solid var(--reader-border)',\n                    borderRadius: '12px',\n                    background: 'transparent',\n                    cursor: 'pointer',\n                    textAlign: 'left',\n                  }}\n                >\n                  <div\n                    style={{\n                      width: '48px',\n                      height: '48px',\n                      borderRadius: '8px',\n                      background: THEME_COLORS[themeKey].background,\n                      border: '1px solid var(--reader-border)',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      color: THEME_COLORS[themeKey].text,\n                      fontSize: '16px',\n                      fontFamily: 'Georgia, serif',\n                    }}\n                  >\n                    Aa\n                  </div>\n                  <div>\n                    <div\n                      style={{\n                        fontSize: '15px',\n                        fontWeight: 500,\n                        color: 'var(--reader-text)',\n                        textTransform: 'capitalize',\n                      }}\n                    >\n                      {themeKey}\n                    </div>\n                    <div\n                      style={{\n                        fontSize: '12px',\n                        color: 'var(--reader-secondary)',\n                        marginTop: '2px',\n                      }}\n                    >\n                      {themeKey === 'light' && 'Classic white background'}\n                      {themeKey === 'sepia' && 'Warm, paper-like tone'}\n                      {themeKey === 'green' && 'Easy on the eyes'}\n                      {themeKey === 'dark' && 'Perfect for night reading'}\n                    </div>\n                  </div>\n                  {settings.theme === themeKey && (\n                    <div\n                      style={{\n                        marginLeft: 'auto',\n                        width: '20px',\n                        height: '20px',\n                        borderRadius: '50%',\n                        background: 'var(--reader-accent, #58a6ff)',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                      }}\n                    >\n                      <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\">\n                        <path\n                          d=\"M2 6L5 9L10 3\"\n                          stroke=\"white\"\n                          strokeWidth=\"2\"\n                          strokeLinecap=\"round\"\n                          strokeLinejoin=\"round\"\n                        />\n                      </svg>\n                    </div>\n                  )}\n                </button>\n              ))}\n            </div>\n          )}\n\n          {/* More Tab */}\n          {activeTab === 'more' && (\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>\n              {/* Reset Button */}\n              <button\n                onClick={resetSettings}\n                style={{\n                  width: '100%',\n                  padding: '14px',\n                  border: '1px solid var(--reader-border)',\n                  borderRadius: '8px',\n                  background: 'transparent',\n                  color: 'var(--reader-text)',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                }}\n              >\n                Reset to Defaults\n              </button>\n\n              {/* Keyboard Shortcuts Info */}\n              <div\n                style={{\n                  padding: '16px',\n                  background: 'rgba(255,255,255,0.02)',\n                  borderRadius: '8px',\n                  border: '1px solid var(--reader-border)',\n                }}\n              >\n                <div\n                  style={{\n                    fontSize: '13px',\n                    fontWeight: 500,\n                    color: 'var(--reader-text)',\n                    marginBottom: '12px',\n                  }}\n                >\n                  Keyboard Shortcuts\n                </div>\n                <div\n                  style={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    gap: '8px',\n                    fontSize: '12px',\n                    color: 'var(--reader-secondary)',\n                  }}\n                >\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span>Next page</span>\n                    <kbd style={{ background: 'var(--reader-border)', padding: '2px 8px', borderRadius: '4px' }}>\n                      Arrow Right\n                    </kbd>\n                  </div>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span>Previous page</span>\n                    <kbd style={{ background: 'var(--reader-border)', padding: '2px 8px', borderRadius: '4px' }}>\n                      Arrow Left\n                    </kbd>\n                  </div>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span>Toggle settings</span>\n                    <kbd style={{ background: 'var(--reader-border)', padding: '2px 8px', borderRadius: '4px' }}>S</kbd>\n                  </div>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span>Table of contents</span>\n                    <kbd style={{ background: 'var(--reader-border)', padding: '2px 8px', borderRadius: '4px' }}>T</kbd>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Brightness Slider at Bottom (like Kindle) */}\n        <div\n          style={{\n            padding: '16px 20px',\n            borderTop: '1px solid var(--reader-border)',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '12px',\n          }}\n        >\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--reader-secondary)\" strokeWidth=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"5\" />\n            <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\n            <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\n            <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\n            <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\n            <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\n            <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\n            <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\n            <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\n          </svg>\n          <input\n            type=\"range\"\n            min={0}\n            max={100}\n            defaultValue={100}\n            style={{\n              flex: 1,\n              height: '4px',\n              appearance: 'none',\n              background: 'linear-gradient(to right, var(--reader-border) 0%, var(--reader-text) 100%)',\n              borderRadius: '2px',\n              cursor: 'pointer',\n            }}\n            title=\"Brightness (system controlled)\"\n            disabled\n          />\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--reader-text)\" strokeWidth=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"5\" />\n            <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\n            <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\n            <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\n            <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\n            <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\n            <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\n            <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\n            <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\n          </svg>\n        </div>\n      </div>\n\n      {/* Animation styles */}\n      <style>{`\n        @keyframes slideFromRight {\n          from { transform: translateX(100%); }\n          to { transform: translateX(0); }\n        }\n\n        input[type=\"range\"]::-webkit-slider-thumb {\n          -webkit-appearance: none;\n          width: 16px;\n          height: 16px;\n          border-radius: 50%;\n          background: var(--reader-accent, #58a6ff);\n          cursor: pointer;\n          border: 2px solid white;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n        }\n\n        input[type=\"range\"]::-moz-range-thumb {\n          width: 16px;\n          height: 16px;\n          border-radius: 50%;\n          background: var(--reader-accent, #58a6ff);\n          cursor: pointer;\n          border: 2px solid white;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n        }\n      `}</style>\n    </>\n  );\n}\n\nexport default ReaderSettingsPanel;\n","import React from 'react';\nimport { X, BookOpen } from 'lucide-react';\nimport { Chapter } from '../../types/reader';\n\ninterface TableOfContentsProps {\n  chapters: Chapter[];\n  currentChapterId?: string;\n  onSelectChapter: (chapter: Chapter) => void;\n  onClose: () => void;\n  visible: boolean;\n}\n\nexport function TableOfContents({\n  chapters,\n  currentChapterId,\n  onSelectChapter,\n  onClose,\n  visible,\n}: TableOfContentsProps) {\n  if (!visible) return null;\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div\n        className=\"reader-toc-backdrop\"\n        onClick={onClose}\n        style={{\n          position: 'fixed',\n          inset: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          zIndex: 200,\n          animation: 'fadeIn 0.2s ease',\n        }}\n      />\n\n      {/* TOC Panel */}\n      <div\n        className=\"reader-toc-panel\"\n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          bottom: 0,\n          width: '300px',\n          maxWidth: '80vw',\n          background: 'var(--reader-bg)',\n          borderRight: '1px solid var(--reader-border)',\n          zIndex: 201,\n          display: 'flex',\n          flexDirection: 'column',\n          animation: 'slideRight 0.3s ease',\n        }}\n      >\n        {/* Header */}\n        <div\n          style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            padding: '20px',\n            borderBottom: '1px solid var(--reader-border)',\n          }}\n        >\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <BookOpen size={20} color=\"var(--reader-text)\" />\n            <h2\n              style={{\n                fontSize: '18px',\n                fontWeight: 600,\n                color: 'var(--reader-text)',\n                margin: 0,\n              }}\n            >\n              Contents\n            </h2>\n          </div>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'none',\n              border: 'none',\n              color: 'var(--reader-text)',\n              cursor: 'pointer',\n              padding: '8px',\n            }}\n            aria-label=\"Close table of contents\"\n          >\n            <X size={24} />\n          </button>\n        </div>\n\n        {/* Chapter List */}\n        <div\n          style={{\n            flex: 1,\n            overflowY: 'auto',\n            padding: '12px',\n          }}\n        >\n          {chapters.length === 0 ? (\n            <p\n              style={{\n                color: 'var(--reader-secondary)',\n                fontSize: '14px',\n                textAlign: 'center',\n                padding: '20px',\n              }}\n            >\n              No chapters detected\n            </p>\n          ) : (\n            <ul\n              style={{\n                listStyle: 'none',\n                margin: 0,\n                padding: 0,\n              }}\n            >\n              {chapters.map((chapter) => (\n                <li key={chapter.id}>\n                  <button\n                    onClick={() => {\n                      onSelectChapter(chapter);\n                      onClose();\n                    }}\n                    style={{\n                      width: '100%',\n                      padding: '12px 16px',\n                      paddingLeft: `${16 + (chapter.level - 1) * 16}px`,\n                      border: 'none',\n                      borderRadius: '8px',\n                      background:\n                        currentChapterId === chapter.id\n                          ? 'var(--reader-border)'\n                          : 'transparent',\n                      color:\n                        currentChapterId === chapter.id\n                          ? 'var(--reader-text)'\n                          : 'var(--reader-secondary)',\n                      cursor: 'pointer',\n                      textAlign: 'left',\n                      fontSize: chapter.level === 1 ? '15px' : '14px',\n                      fontWeight: chapter.level === 1 ? 500 : 400,\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '8px',\n                      transition: 'background 0.2s ease',\n                    }}\n                    onMouseEnter={(e) => {\n                      if (currentChapterId !== chapter.id) {\n                        e.currentTarget.style.background =\n                          'var(--reader-border)';\n                      }\n                    }}\n                    onMouseLeave={(e) => {\n                      if (currentChapterId !== chapter.id) {\n                        e.currentTarget.style.background = 'transparent';\n                      }\n                    }}\n                  >\n                    {chapter.level === 1 && (\n                      <span\n                        style={{\n                          width: '6px',\n                          height: '6px',\n                          borderRadius: '50%',\n                          background:\n                            currentChapterId === chapter.id\n                              ? 'var(--reader-text)'\n                              : 'var(--reader-secondary)',\n                          flexShrink: 0,\n                        }}\n                      />\n                    )}\n                    <span\n                      style={{\n                        overflow: 'hidden',\n                        textOverflow: 'ellipsis',\n                        whiteSpace: 'nowrap',\n                      }}\n                    >\n                      {chapter.title}\n                    </span>\n                  </button>\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default TableOfContents;\n","import React, { useState, useRef, useCallback, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useReaderSettings } from '../../hooks/useReaderSettings';\nimport { useSwipeGesture } from '../../hooks/useSwipeGesture';\nimport { useKeyboardNavigation } from '../../hooks/useKeyboardNavigation';\nimport {\n  detectChapters,\n  getCurrentChapter,\n  injectChapterIds,\n} from '../../utils/chapterDetection';\nimport { sanitizeHtml } from '../../utils/sanitize';\nimport { Chapter } from '../../types/reader';\nimport { ReaderHeader } from './ReaderHeader';\nimport { ReaderFooter } from './ReaderFooter';\nimport { ReaderNavigation } from './ReaderNavigation';\nimport { ReaderSettingsPanel } from './ReaderSettings';\nimport { TableOfContents } from './TableOfContents';\n\ninterface KindleReaderProps {\n  contentId: string;\n  title: string;\n  htmlContent: string;\n  onBack?: () => void;\n}\n\n// Fixed reading widths for comfortable reading\nconst SINGLE_COLUMN_MAX_WIDTH = 650;\nconst TWO_COLUMN_MAX_WIDTH = 1200;\n// Gap between columns in two-column mode\nconst COLUMN_GAP = 60;\n\nexport function KindleReader({\n  contentId,\n  title,\n  htmlContent,\n  onBack,\n}: KindleReaderProps) {\n  const navigate = useNavigate();\n  const containerRef = useRef<HTMLDivElement>(null);\n  const viewportRef = useRef<HTMLDivElement>(null);\n  const contentRef = useRef<HTMLDivElement>(null);\n\n  // State\n  const [showUI, setShowUI] = useState(true);\n  const [showSettings, setShowSettings] = useState(false);\n  const [showTOC, setShowTOC] = useState(false);\n  const [chapters, setChapters] = useState<Chapter[]>([]);\n  const [currentPage, setCurrentPage] = useState(0);\n  const [totalPages, setTotalPages] = useState(1);\n  const [pageWidth, setPageWidth] = useState(0);\n  const [columnWidth, setColumnWidth] = useState(0);\n\n  // Hooks\n  const { settings, updateSetting, resetSettings, cssVars, themeClass } =\n    useReaderSettings();\n\n  // Process content with chapter IDs\n  const processedContent = useMemo(\n    () => injectChapterIds(htmlContent),\n    [htmlContent]\n  );\n\n  // Detect chapters from content\n  useEffect(() => {\n    const detectedChapters = detectChapters(htmlContent);\n    setChapters(detectedChapters);\n  }, [htmlContent]);\n\n  // Calculate the page dimensions\n  // First principles: viewport width = page width = column width (for single column)\n  // or viewport width = 2 * column width + gap (for two columns)\n  // NO padding on the column container - margins applied via CSS to content\n  const calculateDimensions = useCallback(() => {\n    const viewport = viewportRef.current;\n    const content = contentRef.current;\n    if (!viewport || !content || settings.continuousScroll) {\n      setTotalPages(1);\n      return;\n    }\n\n    // The viewport width IS the page width - they must be identical\n    const viewportWidth = viewport.clientWidth;\n    setPageWidth(viewportWidth);\n\n    // Column width must fit EXACTLY within viewport\n    // Single column: column width = viewport width (entire page is one column)\n    // Two columns: 2 * column width + gap = viewport width\n    const calculatedColumnWidth = settings.columns === 'two'\n      ? Math.floor((viewportWidth - COLUMN_GAP) / 2)\n      : viewportWidth; // Single column = full viewport width, no rounding needed\n    setColumnWidth(calculatedColumnWidth);\n\n    // Wait for columns to render, then calculate total pages\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        if (!content) return;\n\n        const scrollWidth = content.scrollWidth;\n        // Pages = total scroll width / viewport width\n        // Use Math.ceil to ensure we don't lose the last partial page\n        const pages = Math.max(1, Math.ceil(scrollWidth / viewportWidth));\n        setTotalPages(pages);\n\n        // Ensure current page is valid\n        setCurrentPage((prev) => Math.min(prev, Math.max(0, pages - 1)));\n      });\n    });\n  }, [settings.continuousScroll, settings.columns]);\n\n  // Initialize and handle resize\n  useEffect(() => {\n    if (settings.continuousScroll) return;\n\n    // Wait for content to render\n    const timer = setTimeout(calculateDimensions, 250);\n\n    // Handle resize\n    const handleResize = () => {\n      setTimeout(calculateDimensions, 150);\n    };\n\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      clearTimeout(timer);\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [calculateDimensions, settings.continuousScroll]);\n\n  // Recalculate when settings change\n  useEffect(() => {\n    const timer = setTimeout(calculateDimensions, 200);\n    return () => clearTimeout(timer);\n  }, [\n    processedContent,\n    calculateDimensions,\n    settings.fontSize,\n    settings.lineHeight,\n    settings.columns,\n    settings.margins,\n  ]);\n\n  // Navigation functions\n  const goToPage = useCallback((page: number) => {\n    const validPage = Math.max(0, Math.min(page, totalPages - 1));\n    setCurrentPage(validPage);\n  }, [totalPages]);\n\n  const nextPage = useCallback(() => {\n    if (currentPage < totalPages - 1) {\n      goToPage(currentPage + 1);\n    }\n  }, [currentPage, totalPages, goToPage]);\n\n  const prevPage = useCallback(() => {\n    if (currentPage > 0) {\n      goToPage(currentPage - 1);\n    }\n  }, [currentPage, goToPage]);\n\n  const goToStart = useCallback(() => {\n    goToPage(0);\n  }, [goToPage]);\n\n  const goToEnd = useCallback(() => {\n    goToPage(totalPages - 1);\n  }, [totalPages, goToPage]);\n\n  // Get current chapter\n  const currentChapter = useMemo(\n    () => getCurrentChapter(chapters, currentPage),\n    [chapters, currentPage]\n  );\n\n  // Handle chapter selection from TOC\n  const handleSelectChapter = useCallback(\n    (chapter: Chapter) => {\n      goToPage(chapter.pageIndex);\n      setShowTOC(false);\n    },\n    [goToPage]\n  );\n\n  // Toggle UI visibility\n  const toggleUI = useCallback(() => {\n    if (!showSettings && !showTOC) {\n      setShowUI((prev) => !prev);\n    }\n  }, [showSettings, showTOC]);\n\n  // Handle back navigation\n  const handleBack = useCallback(() => {\n    if (onBack) {\n      onBack();\n    } else {\n      navigate(-1);\n    }\n  }, [navigate, onBack]);\n\n  // Swipe gestures\n  useSwipeGesture(containerRef, {\n    onSwipeLeft: nextPage,\n    onSwipeRight: prevPage,\n    enabled: !showSettings && !showTOC && !settings.continuousScroll,\n  });\n\n  // Keyboard navigation\n  useKeyboardNavigation({\n    onNext: settings.continuousScroll ? undefined : nextPage,\n    onPrevious: settings.continuousScroll ? undefined : prevPage,\n    onFirst: goToStart,\n    onLast: goToEnd,\n    onEscape: () => {\n      if (showSettings || showTOC) {\n        setShowSettings(false);\n        setShowTOC(false);\n      } else if (showUI) {\n        setShowUI(false);\n      }\n    },\n    onToggleSettings: () => {\n      if (!showTOC) {\n        setShowSettings((prev) => !prev);\n      }\n    },\n    onToggleTOC: () => {\n      if (!showSettings) {\n        setShowTOC((prev) => !prev);\n      }\n    },\n    enabled: true,\n  });\n\n  // Calculate percent complete\n  const percentComplete = useMemo(() => {\n    if (totalPages <= 1) return 100;\n    return Math.round(((currentPage + 1) / totalPages) * 100);\n  }, [currentPage, totalPages]);\n\n  const isFirstPage = currentPage === 0;\n  const isLastPage = currentPage >= totalPages - 1;\n\n  // CSS variables for theming\n  const themeStyles: React.CSSProperties = {\n    '--reader-font-size': cssVars['--reader-font-size'],\n    '--reader-line-height': cssVars['--reader-line-height'],\n    '--reader-bg': cssVars['--reader-bg'],\n    '--reader-text': cssVars['--reader-text'],\n    '--reader-secondary': cssVars['--reader-secondary'],\n    '--reader-border': cssVars['--reader-border'],\n    '--reader-accent': cssVars['--reader-accent'],\n    '--reader-font-family': cssVars['--reader-font-family'],\n    '--reader-margin': cssVars['--reader-margin'],\n    '--reader-text-align': cssVars['--reader-text-align'],\n  } as React.CSSProperties;\n\n  // Content width based on column setting\n  const contentMaxWidth = settings.columns === 'two' ? TWO_COLUMN_MAX_WIDTH : SINGLE_COLUMN_MAX_WIDTH;\n\n  return (\n    <div\n      ref={containerRef}\n      className={`kindle-reader ${themeClass}`}\n      style={{\n        position: 'fixed',\n        inset: 0,\n        background: 'var(--reader-bg)',\n        color: 'var(--reader-text)',\n        overflow: 'hidden',\n        touchAction: settings.continuousScroll ? 'auto' : 'pan-y',\n        ...themeStyles,\n      }}\n    >\n      {/* Header */}\n      <ReaderHeader\n        title={title}\n        chapterTitle={currentChapter?.title}\n        onBack={handleBack}\n        onToggleSettings={() => setShowSettings(true)}\n        onToggleTOC={() => setShowTOC(true)}\n        visible={showUI}\n      />\n\n      {/* Content Area */}\n      <div\n        className=\"reader-content-area\"\n        style={{\n          position: 'fixed',\n          top: showUI ? '60px' : '0',\n          left: 0,\n          right: 0,\n          bottom: showUI ? '50px' : '0',\n          display: 'flex',\n          justifyContent: 'center',\n          overflow: settings.continuousScroll ? 'auto' : 'hidden',\n          transition: 'top 0.3s ease, bottom 0.3s ease',\n          background: 'var(--reader-bg)',\n        }}\n      >\n        {/*\n          VIEWPORT: The visible page area\n          - Fixed width = max reading width\n          - overflow: hidden clips columns at exact page boundaries\n          - NO padding here - padding would misalign columns with pages\n        */}\n        <div\n          ref={viewportRef}\n          className=\"reader-viewport\"\n          style={{\n            width: '100%',\n            maxWidth: `${contentMaxWidth}px`,\n            height: '100%',\n            overflow: 'hidden',\n            position: 'relative',\n          }}\n        >\n          {/*\n            CONTENT: CSS columns container\n            - column-width = viewport width (single) or (viewport - gap) / 2 (two)\n            - ZERO padding - critical for alignment!\n            - Margins are applied via CSS rules on p, h1, h2, etc.\n            - Transform slides by exactly viewport width per page\n          */}\n          <div\n            ref={contentRef}\n            className=\"reader-columns\"\n            dangerouslySetInnerHTML={{ __html: sanitizeHtml(processedContent) }}\n            style={{\n              height: settings.continuousScroll ? 'auto' : '100%',\n              // CRITICAL: No horizontal padding on the column container!\n              // Padding would offset columns from page boundaries\n              padding: settings.continuousScroll ? '24px 48px' : '24px 0',\n              boxSizing: 'border-box',\n              // CSS Columns\n              columnGap: settings.columns === 'two' ? `${COLUMN_GAP}px` : '0',\n              columnFill: 'auto',\n              columnWidth: settings.continuousScroll\n                ? undefined\n                : columnWidth > 0 ? `${columnWidth}px` : undefined,\n              // Transform slides content by exactly one page width\n              transform: settings.continuousScroll\n                ? 'none'\n                : `translateX(-${currentPage * pageWidth}px)`,\n              transition: 'transform 0.35s cubic-bezier(0.4, 0, 0.2, 1)',\n              // Typography\n              fontFamily: 'var(--reader-font-family)',\n              fontSize: 'var(--reader-font-size)',\n              lineHeight: 'var(--reader-line-height)',\n              color: 'var(--reader-text)',\n              textAlign: settings.textAlign as 'left' | 'justify',\n              hyphens: settings.textAlign === 'justify' ? 'auto' : 'none',\n              WebkitHyphens: settings.textAlign === 'justify' ? 'auto' : 'none',\n              wordBreak: 'break-word',\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Navigation Zones */}\n      {!settings.continuousScroll && (\n        <ReaderNavigation\n          onPrevious={prevPage}\n          onNext={nextPage}\n          onCenter={toggleUI}\n          isFirstPage={isFirstPage}\n          isLastPage={isLastPage}\n          showArrows={showUI}\n        />\n      )}\n\n      {/* Footer */}\n      <ReaderFooter\n        currentPage={settings.continuousScroll ? 0 : currentPage}\n        totalPages={settings.continuousScroll ? 1 : totalPages}\n        percentComplete={percentComplete}\n        visible={showUI}\n        continuousScroll={settings.continuousScroll}\n      />\n\n      {/* Settings Panel */}\n      <ReaderSettingsPanel\n        settings={settings}\n        updateSetting={updateSetting}\n        resetSettings={resetSettings}\n        onClose={() => setShowSettings(false)}\n        visible={showSettings}\n      />\n\n      {/* Table of Contents */}\n      <TableOfContents\n        chapters={chapters}\n        currentChapterId={currentChapter?.id}\n        onSelectChapter={handleSelectChapter}\n        onClose={() => setShowTOC(false)}\n        visible={showTOC}\n      />\n\n      {/* Global styles */}\n      <style>{`\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n\n        @keyframes slideUp {\n          from { transform: translateY(100%); }\n          to { transform: translateY(0); }\n        }\n\n        @keyframes slideRight {\n          from { transform: translateX(-100%); }\n          to { transform: translateX(0); }\n        }\n\n        .reader-nav-zone:hover .reader-nav-arrow {\n          opacity: 0.7 !important;\n        }\n\n        .reader-icon-button:hover {\n          background: var(--reader-border) !important;\n        }\n\n        /*\n          Reader content styles - Kindle-like typography\n          IMPORTANT: Visual margins are applied here to content elements,\n          NOT to the column container. This keeps columns aligned with pages.\n        */\n        .reader-columns {\n          letter-spacing: 0.01em;\n        }\n\n        /* Apply horizontal padding to all direct children and common elements */\n        .reader-columns > *,\n        .reader-columns p,\n        .reader-columns h1,\n        .reader-columns h2,\n        .reader-columns h3,\n        .reader-columns h4,\n        .reader-columns h5,\n        .reader-columns h6,\n        .reader-columns ul,\n        .reader-columns ol,\n        .reader-columns blockquote,\n        .reader-columns pre,\n        .reader-columns div {\n          padding-left: 32px;\n          padding-right: 32px;\n          box-sizing: border-box;\n        }\n\n        .reader-columns h1,\n        .reader-columns h2,\n        .reader-columns h3 {\n          color: var(--reader-text);\n          margin-top: 1.5em;\n          margin-bottom: 0.7em;\n          line-height: 1.3;\n          break-after: avoid;\n        }\n\n        .reader-columns h1:first-child,\n        .reader-columns h2:first-child,\n        .reader-columns h3:first-child {\n          margin-top: 0;\n        }\n\n        .reader-columns h1 {\n          font-size: 1.5em;\n          font-weight: 700;\n        }\n\n        .reader-columns h2 {\n          font-size: 1.3em;\n          font-weight: 600;\n        }\n\n        .reader-columns h3 {\n          font-size: 1.15em;\n          font-weight: 600;\n        }\n\n        .reader-columns p {\n          margin: 0 0 1em 0;\n          text-indent: 0;\n          orphans: 2;\n          widows: 2;\n        }\n\n        .reader-columns p + p {\n          text-indent: 1.5em;\n          margin-top: 0;\n        }\n\n        .reader-columns blockquote {\n          margin: 1em 0;\n          padding-top: 0.6em;\n          padding-bottom: 0.6em;\n          border-left: 3px solid var(--reader-border);\n          color: var(--reader-secondary);\n          font-style: italic;\n          margin-left: 32px;\n          padding-left: 1em;\n        }\n\n        .reader-columns a {\n          color: var(--reader-accent, var(--reader-text));\n          text-decoration: underline;\n          text-underline-offset: 2px;\n        }\n\n        .reader-columns img {\n          max-width: calc(100% - 64px);\n          height: auto;\n          margin: 1em auto;\n          display: block;\n        }\n\n        .reader-columns ul,\n        .reader-columns ol {\n          margin: 1em 0;\n          padding-left: calc(32px + 1.5em);\n        }\n\n        .reader-columns li {\n          margin-bottom: 0.3em;\n          padding-left: 0;\n          padding-right: 0;\n        }\n\n        .reader-columns hr {\n          border: none;\n          text-align: center;\n          margin: 1.5em 32px;\n          padding: 0;\n        }\n\n        .reader-columns hr::before {\n          content: \"* * *\";\n          color: var(--reader-secondary);\n          letter-spacing: 0.5em;\n        }\n\n        .reader-columns sup {\n          font-size: 0.75em;\n          vertical-align: super;\n          line-height: 0;\n        }\n\n        .reader-columns pre,\n        .reader-columns code {\n          font-family: 'SF Mono', Monaco, 'Consolas', monospace;\n          font-size: 0.85em;\n          background: rgba(128, 128, 128, 0.1);\n          border-radius: 4px;\n        }\n\n        .reader-columns pre {\n          padding-top: 0.8em;\n          padding-bottom: 0.8em;\n          overflow-x: auto;\n          margin: 1em 0;\n        }\n\n        .reader-columns code {\n          padding: 0.15em 0.35em;\n        }\n\n        .reader-columns pre code {\n          padding: 0;\n          background: none;\n        }\n\n        /* Scrollbar for continuous mode */\n        .reader-content-area::-webkit-scrollbar {\n          width: 8px;\n        }\n\n        .reader-content-area::-webkit-scrollbar-track {\n          background: transparent;\n        }\n\n        .reader-content-area::-webkit-scrollbar-thumb {\n          background: var(--reader-border);\n          border-radius: 4px;\n        }\n\n        .reader-content-area::-webkit-scrollbar-thumb:hover {\n          background: var(--reader-secondary);\n        }\n\n        /* Selection */\n        .reader-columns ::selection {\n          background: var(--reader-accent, #58a6ff);\n          color: white;\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default KindleReader;\n","import { Chapter } from '../types/reader';\n\n/**\n * Parse HTML content to detect chapter headings (h1, h2, h3)\n * and create a table of contents structure.\n */\nexport function detectChapters(htmlContent: string): Chapter[] {\n  const chapters: Chapter[] = [];\n\n  // Create a temporary DOM element to parse HTML\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(htmlContent, 'text/html');\n\n  // Find all heading elements\n  const headings = doc.querySelectorAll('h1, h2, h3');\n\n  headings.forEach((heading, index) => {\n    const tagName = heading.tagName.toLowerCase();\n    const level = parseInt(tagName.charAt(1), 10);\n    const title = heading.textContent?.trim() || `Chapter ${index + 1}`;\n\n    // Generate an ID if not present\n    const elementId = heading.id || `chapter-${index + 1}`;\n\n    // Add ID to the heading if not present (for navigation)\n    if (!heading.id) {\n      heading.id = elementId;\n    }\n\n    chapters.push({\n      id: elementId,\n      title,\n      level,\n      pageIndex: 0, // Will be updated after pagination\n      elementId,\n    });\n  });\n\n  return chapters;\n}\n\n/**\n * Update chapter page indices after pagination is calculated.\n * Call this after the content is rendered and pagination is ready.\n */\nexport function updateChapterPageIndices(\n  chapters: Chapter[],\n  contentElement: HTMLElement\n): Chapter[] {\n  const containerWidth = contentElement.clientWidth;\n\n  if (containerWidth === 0) return chapters;\n\n  return chapters.map((chapter) => {\n    const element = contentElement.querySelector(`#${CSS.escape(chapter.elementId || chapter.id)}`);\n\n    if (element) {\n      // Get the element's position relative to the scrollable container\n      const elementRect = element.getBoundingClientRect();\n      const containerRect = contentElement.getBoundingClientRect();\n      const elementLeft = elementRect.left - containerRect.left + contentElement.scrollLeft;\n\n      // Calculate which page this element is on\n      const pageIndex = Math.floor(elementLeft / containerWidth);\n\n      return {\n        ...chapter,\n        pageIndex,\n      };\n    }\n\n    return chapter;\n  });\n}\n\n/**\n * Find the current chapter based on the current page.\n */\nexport function getCurrentChapter(\n  chapters: Chapter[],\n  currentPage: number\n): Chapter | null {\n  if (chapters.length === 0) return null;\n\n  // Find the last chapter that starts at or before the current page\n  let currentChapter: Chapter | null = null;\n\n  for (const chapter of chapters) {\n    if (chapter.pageIndex <= currentPage) {\n      currentChapter = chapter;\n    } else {\n      break;\n    }\n  }\n\n  return currentChapter;\n}\n\n/**\n * Inject IDs into HTML content for chapters without IDs.\n * Returns modified HTML string with IDs added to headings.\n */\nexport function injectChapterIds(htmlContent: string): string {\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(htmlContent, 'text/html');\n\n  const headings = doc.querySelectorAll('h1, h2, h3');\n\n  headings.forEach((heading, index) => {\n    if (!heading.id) {\n      heading.id = `chapter-${index + 1}`;\n    }\n  });\n\n  return doc.body.innerHTML;\n}\n","import { useEffect, useRef, useCallback } from 'react';\n\ninterface SwipeHandlers {\n  onSwipeLeft?: () => void;\n  onSwipeRight?: () => void;\n  onSwipeUp?: () => void;\n  onSwipeDown?: () => void;\n}\n\ninterface UseSwipeGestureOptions extends SwipeHandlers {\n  threshold?: number; // Minimum distance for swipe (default 50px)\n  velocityThreshold?: number; // Minimum velocity for swipe (default 0.3 px/ms)\n  enabled?: boolean;\n}\n\ninterface TouchPoint {\n  x: number;\n  y: number;\n  time: number;\n}\n\nexport function useSwipeGesture(\n  elementRef: React.RefObject<HTMLElement>,\n  options: UseSwipeGestureOptions\n) {\n  const {\n    onSwipeLeft,\n    onSwipeRight,\n    onSwipeUp,\n    onSwipeDown,\n    threshold = 50,\n    velocityThreshold = 0.3,\n    enabled = true,\n  } = options;\n\n  const touchStartRef = useRef<TouchPoint | null>(null);\n  const touchEndRef = useRef<TouchPoint | null>(null);\n\n  const handleTouchStart = useCallback(\n    (e: TouchEvent) => {\n      if (!enabled) return;\n\n      const touch = e.touches[0];\n      touchStartRef.current = {\n        x: touch.clientX,\n        y: touch.clientY,\n        time: Date.now(),\n      };\n      touchEndRef.current = null;\n    },\n    [enabled]\n  );\n\n  const handleTouchMove = useCallback(\n    (e: TouchEvent) => {\n      if (!enabled || !touchStartRef.current) return;\n\n      const touch = e.touches[0];\n      touchEndRef.current = {\n        x: touch.clientX,\n        y: touch.clientY,\n        time: Date.now(),\n      };\n\n      // Calculate horizontal distance\n      const deltaX = touch.clientX - touchStartRef.current.x;\n      const deltaY = touch.clientY - touchStartRef.current.y;\n\n      // If horizontal swipe is more dominant, prevent vertical scroll\n      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 10) {\n        e.preventDefault();\n      }\n    },\n    [enabled]\n  );\n\n  const handleTouchEnd = useCallback(\n    (e: TouchEvent) => {\n      if (!enabled || !touchStartRef.current || !touchEndRef.current) return;\n\n      const start = touchStartRef.current;\n      const end = touchEndRef.current;\n\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n      const deltaTime = end.time - start.time;\n\n      // Calculate velocity\n      const velocityX = Math.abs(deltaX) / deltaTime;\n      const velocityY = Math.abs(deltaY) / deltaTime;\n\n      // Determine if it's a horizontal or vertical swipe\n      const isHorizontal = Math.abs(deltaX) > Math.abs(deltaY);\n\n      if (isHorizontal) {\n        // Horizontal swipe\n        if (\n          Math.abs(deltaX) >= threshold &&\n          velocityX >= velocityThreshold\n        ) {\n          if (deltaX > 0) {\n            // Swipe right (go to previous page)\n            onSwipeRight?.();\n          } else {\n            // Swipe left (go to next page)\n            onSwipeLeft?.();\n          }\n        }\n      } else {\n        // Vertical swipe\n        if (\n          Math.abs(deltaY) >= threshold &&\n          velocityY >= velocityThreshold\n        ) {\n          if (deltaY > 0) {\n            onSwipeDown?.();\n          } else {\n            onSwipeUp?.();\n          }\n        }\n      }\n\n      // Reset\n      touchStartRef.current = null;\n      touchEndRef.current = null;\n    },\n    [\n      enabled,\n      threshold,\n      velocityThreshold,\n      onSwipeLeft,\n      onSwipeRight,\n      onSwipeUp,\n      onSwipeDown,\n    ]\n  );\n\n  useEffect(() => {\n    const element = elementRef.current;\n    if (!element || !enabled) return;\n\n    // Add touch event listeners\n    element.addEventListener('touchstart', handleTouchStart, { passive: true });\n    element.addEventListener('touchmove', handleTouchMove, { passive: false });\n    element.addEventListener('touchend', handleTouchEnd, { passive: true });\n\n    return () => {\n      element.removeEventListener('touchstart', handleTouchStart);\n      element.removeEventListener('touchmove', handleTouchMove);\n      element.removeEventListener('touchend', handleTouchEnd);\n    };\n  }, [elementRef, enabled, handleTouchStart, handleTouchMove, handleTouchEnd]);\n}\n\nexport default useSwipeGesture;\n","import { useEffect, useCallback } from 'react';\n\ninterface KeyboardNavigationHandlers {\n  onNext?: () => void;\n  onPrevious?: () => void;\n  onFirst?: () => void;\n  onLast?: () => void;\n  onEscape?: () => void;\n  onToggleSettings?: () => void;\n  onToggleTOC?: () => void;\n}\n\ninterface UseKeyboardNavigationOptions extends KeyboardNavigationHandlers {\n  enabled?: boolean;\n}\n\nexport function useKeyboardNavigation(options: UseKeyboardNavigationOptions) {\n  const {\n    onNext,\n    onPrevious,\n    onFirst,\n    onLast,\n    onEscape,\n    onToggleSettings,\n    onToggleTOC,\n    enabled = true,\n  } = options;\n\n  const handleKeyDown = useCallback(\n    (e: KeyboardEvent) => {\n      if (!enabled) return;\n\n      // Don't handle if user is typing in an input\n      if (\n        e.target instanceof HTMLInputElement ||\n        e.target instanceof HTMLTextAreaElement ||\n        e.target instanceof HTMLSelectElement\n      ) {\n        return;\n      }\n\n      switch (e.key) {\n        case 'ArrowRight':\n        case 'PageDown':\n        case ' ': // Space bar\n          if (e.key === ' ') e.preventDefault(); // Prevent page scroll\n          onNext?.();\n          break;\n\n        case 'ArrowLeft':\n        case 'PageUp':\n          onPrevious?.();\n          break;\n\n        case 'Home':\n          e.preventDefault();\n          onFirst?.();\n          break;\n\n        case 'End':\n          e.preventDefault();\n          onLast?.();\n          break;\n\n        case 'Escape':\n          onEscape?.();\n          break;\n\n        case 's':\n        case 'S':\n          // Toggle settings with 's' key\n          if (!e.ctrlKey && !e.metaKey) {\n            onToggleSettings?.();\n          }\n          break;\n\n        case 't':\n        case 'T':\n          // Toggle table of contents with 't' key\n          if (!e.ctrlKey && !e.metaKey) {\n            onToggleTOC?.();\n          }\n          break;\n\n        default:\n          break;\n      }\n    },\n    [\n      enabled,\n      onNext,\n      onPrevious,\n      onFirst,\n      onLast,\n      onEscape,\n      onToggleSettings,\n      onToggleTOC,\n    ]\n  );\n\n  useEffect(() => {\n    if (!enabled) return;\n\n    window.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [enabled, handleKeyDown]);\n}\n\nexport default useKeyboardNavigation;\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { libraryApi, type FullContent } from '../services/libraryApi';\nimport { KindleReader } from '../components/reader';\nimport DOMPurify from 'dompurify';\n\nexport function ReaderPage() {\n  const { contentId } = useParams<{ contentId: string }>();\n  const navigate = useNavigate();\n  const [content, setContent] = useState<FullContent | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const progressUpdateTimer = useRef<NodeJS.Timeout | null>(null);\n\n  // Load content\n  useEffect(() => {\n    if (!contentId) return;\n\n    const loadContent = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        const data = await libraryApi.getFullContent(parseInt(contentId));\n        setContent(data);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load content');\n        console.error('Content load error:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadContent();\n\n    // Cleanup on unmount\n    return () => {\n      if (progressUpdateTimer.current) {\n        clearTimeout(progressUpdateTimer.current);\n      }\n    };\n  }, [contentId]);\n\n  // Handle page changes for progress tracking\n  const handlePageChange = useCallback(\n    (page: number, totalPages: number) => {\n      if (!contentId) return;\n\n      const progress = totalPages > 1 ? ((page + 1) / totalPages) * 100 : 100;\n\n      // Debounce API calls\n      if (progressUpdateTimer.current) {\n        clearTimeout(progressUpdateTimer.current);\n      }\n\n      progressUpdateTimer.current = setTimeout(() => {\n        libraryApi\n          .updateProgress(\n            parseInt(contentId),\n            progress,\n            JSON.stringify({ page, totalPages })\n          )\n          .catch((err) => console.error('Failed to update progress:', err));\n      }, 2000);\n    },\n    [contentId]\n  );\n\n  // Handle back navigation\n  const handleBack = useCallback(() => {\n    navigate('/');\n  }, [navigate]);\n\n  if (loading) {\n    return (\n      <div\n        style={{\n          position: 'fixed',\n          inset: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          background: '#0a0f1a',\n          color: '#94a3b8',\n          fontSize: 16,\n        }}\n      >\n        <div style={{ textAlign: 'center' }}>\n          <div\n            style={{\n              width: 40,\n              height: 40,\n              border: '3px solid #1f2937',\n              borderTopColor: '#f59e0b',\n              borderRadius: '50%',\n              margin: '0 auto 16px',\n              animation: 'spin 1s linear infinite',\n            }}\n          />\n          Loading content...\n        </div>\n        <style>{`\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        `}</style>\n      </div>\n    );\n  }\n\n  if (error || !content) {\n    return (\n      <div\n        style={{\n          position: 'fixed',\n          inset: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          background: '#0a0f1a',\n          padding: 24,\n        }}\n      >\n        <div\n          style={{\n            maxWidth: 400,\n            background: '#ef444420',\n            border: '1px solid #ef4444',\n            borderRadius: 12,\n            padding: 24,\n            textAlign: 'center',\n          }}\n        >\n          <div\n            style={{\n              fontSize: 18,\n              fontWeight: 600,\n              color: '#fca5a5',\n              marginBottom: 8,\n            }}\n          >\n            {error || 'Content not found'}\n          </div>\n          <div style={{ fontSize: 14, color: '#94a3b8', marginBottom: 16 }}>\n            You may not have access to this content.\n          </div>\n          <button\n            onClick={() => navigate('/')}\n            style={{\n              background: '#f59e0b',\n              color: '#111827',\n              padding: '10px 20px',\n              borderRadius: 8,\n              border: 'none',\n              fontWeight: 600,\n              cursor: 'pointer',\n            }}\n          >\n            Go to Home\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Sanitize the HTML content\n  const sanitizedContent = DOMPurify.sanitize(content.content_html, {\n    ALLOWED_TAGS: [\n      'p',\n      'br',\n      'strong',\n      'em',\n      'u',\n      'i',\n      'b',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'ul',\n      'ol',\n      'li',\n      'blockquote',\n      'pre',\n      'code',\n      'a',\n      'img',\n      'div',\n      'span',\n    ],\n    ALLOWED_ATTR: ['href', 'src', 'alt', 'title', 'class', 'id'],\n    FORBID_TAGS: [\n      'script',\n      'style',\n      'iframe',\n      'object',\n      'embed',\n      'form',\n      'input',\n    ],\n    FORBID_ATTR: ['onerror', 'onclick', 'onload', 'onmouseover'],\n    ALLOW_DATA_ATTR: false,\n  });\n\n  return (\n    <KindleReader\n      contentId={contentId || ''}\n      title={content.title}\n      htmlContent={sanitizedContent}\n      onBack={handleBack}\n    />\n  );\n}\n","import React, { forwardRef } from 'react';\nimport { sanitizeHtml } from '../../utils/sanitize';\n\ninterface ReaderContentProps {\n  htmlContent: string;\n  cssVars: Record<string, string>;\n}\n\nexport const ReaderContent = forwardRef<HTMLDivElement, ReaderContentProps>(\n  ({ htmlContent, cssVars }, ref) => {\n    return (\n      <div\n        ref={ref}\n        className=\"reader-content-container\"\n        style={{\n          position: 'fixed',\n          top: '60px',\n          left: 0,\n          right: 0,\n          bottom: '50px',\n          overflow: 'hidden',\n          padding: '20px 24px',\n          boxSizing: 'border-box',\n          background: 'var(--reader-bg)',\n          ...cssVars,\n        }}\n      >\n        <div\n          className=\"reader-content\"\n          dangerouslySetInnerHTML={{ __html: sanitizeHtml(htmlContent) }}\n          style={{\n            height: '100%',\n            columnWidth: '100vw',\n            columnGap: '48px',\n            columnFill: 'auto',\n            fontFamily: 'var(--reader-font-family)',\n            fontSize: 'var(--reader-font-size)',\n            lineHeight: 'var(--reader-line-height)',\n            color: 'var(--reader-text)',\n            textAlign: 'justify',\n            hyphens: 'auto',\n            wordBreak: 'break-word',\n            overflowX: 'hidden',\n            overflowY: 'hidden',\n          }}\n        />\n      </div>\n    );\n  }\n);\n\nReaderContent.displayName = 'ReaderContent';\n\nexport default ReaderContent;\n"],"names":["List","createLucideIcon","d","key","TextAlignJustify","TextAlignStart","DEFAULT_READER_SETTINGS","fontSize","lineHeight","theme","fontFamily","margins","textAlign","columns","continuousScroll","FONT_SIZE_MAP","xsmall","small","medium","large","xlarge","LINE_HEIGHT_MAP","compact","normal","relaxed","THEME_COLORS","light","background","text","secondary","border","accent","sepia","green","dark","FONT_FAMILY_MAP","name","css","baskerville","bookerly","georgia","palatino","MARGIN_MAP","narrow","wide","STORAGE_KEY","useReaderSettings","settings","setSettings","useState","stored","localStorage","getItem","migrated","oldSettings","migrateSettings","JSON","parse","e","useEffect","setItem","stringify","updateSetting","useCallback","value","prev","resetSettings","cssVars","useMemo","themeClass","ReaderHeader","title","chapterTitle","onBack","onToggleSettings","onToggleTOC","visible","jsxs","className","style","position","top","left","right","height","borderBottom","display","alignItems","justifyContent","padding","zIndex","transition","transform","opacity","children","gap","jsx","onClick","color","cursor","borderRadius","ArrowLeft","size","overflow","fontWeight","margin","whiteSpace","textOverflow","maxWidth","Settings","ReaderFooter","currentPage","totalPages","percentComplete","bottom","borderTop","flexDirection","width","marginBottom","ReaderNavigation","onPrevious","onNext","onCenter","isFirstPage","isLastPage","showArrows","Fragment","stopPropagation","paddingLeft","role","ChevronLeft","paddingRight","ChevronRight","ReaderSettingsPanel","onClose","activeTab","setActiveTab","fontSizes","currentSizeIndex","indexOf","inset","animation","borderLeft","id","label","map","tab","flex","X","overflowY","flexWrap","keys","fontKey","minWidth","marginTop","type","min","max","length","onChange","parseInt","target","appearance","_","i","spacing","textTransform","themeKey","boxShadow","charAt","toUpperCase","slice","AlignLeft","AlignJustify","Object","marginLeft","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","defaultValue","disabled","TableOfContents","chapters","currentChapterId","onSelectChapter","borderRight","BookOpen","listStyle","chapter","level","onMouseEnter","currentTarget","onMouseLeave","flexShrink","KindleReader","contentId","htmlContent","navigate","useNavigate","containerRef","useRef","viewportRef","contentRef","showUI","setShowUI","showSettings","setShowSettings","showTOC","setShowTOC","setChapters","setCurrentPage","setTotalPages","pageWidth","setPageWidth","columnWidth","setColumnWidth","processedContent","doc","DOMParser","parseFromString","querySelectorAll","forEach","heading","index","body","innerHTML","injectChapterIds","detectedChapters","tagName","toLowerCase","_a","textContent","trim","elementId","push","pageIndex","detectChapters","calculateDimensions","viewport","current","content","viewportWidth","clientWidth","calculatedColumnWidth","Math","floor","requestAnimationFrame","scrollWidth","pages","ceil","timer","setTimeout","handleResize","window","addEventListener","clearTimeout","removeEventListener","goToPage","page","validPage","nextPage","prevPage","goToStart","goToEnd","currentChapter","getCurrentChapter","handleSelectChapter","toggleUI","handleBack","elementRef","options","onSwipeLeft","onSwipeRight","onSwipeUp","onSwipeDown","threshold","velocityThreshold","enabled","touchStartRef","touchEndRef","handleTouchStart","touch","touches","x","clientX","y","clientY","time","Date","now","handleTouchMove","deltaX","deltaY","abs","preventDefault","handleTouchEnd","start","end","deltaTime","velocityX","velocityY","element","passive","useSwipeGesture","onFirst","onLast","onEscape","handleKeyDown","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","ctrlKey","metaKey","useKeyboardNavigation","round","themeStyles","contentMaxWidth","ref","touchAction","dangerouslySetInnerHTML","__html","sanitizeHtml","boxSizing","columnGap","columnFill","hyphens","WebkitHyphens","wordBreak","ReaderPage","useParams","setContent","loading","setLoading","error","setError","progressUpdateTimer","async","data","libraryApi","getFullContent","err","Error","message","loadContent","progress","updateProgress","catch","borderTopColor","sanitizedContent","DOMPurify","sanitize","content_html","ALLOWED_TAGS","ALLOWED_ATTR","FORBID_TAGS","FORBID_ATTR","ALLOW_DATA_ATTR","forwardRef","overflowX","displayName"],"mappings":"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","x_google_ignoreList":[0,1,2]}