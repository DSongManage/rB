import{j as e}from"./web3auth-BGmWjNJV.js";import{r as t,L as n}from"./router-CzH47hF_.js";import{s as r}from"./sanitize-MG3ZWMPS.js";import{c as o,f as i,i as a,j as s,A as l,X as d}from"./index-BCf7wtEB.js";import{i as c,t as u,j as p,k as x,l as f,m as g,n as h}from"./socialApi-C46NGVdO.js";import{T as b}from"./thumbs-up-iaqEjqR5.js";import{P as y}from"./pen-g1k-T_fw.js";import{T as m}from"./trash-2-D7Vaw14M.js";import{C as j,a as v}from"./chevron-up-drjfOJWh.js";import{S as k}from"./send-Dz6YqcCH.js";import{C as w}from"./check-sw_pz7T1.js";import{C as S}from"./circle-alert-ByvynoCm.js";
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=o("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),z=o("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]),R=o("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function L({contentId:n,initialLiked:r=!1,initialCount:o=0,size:i="md",showCount:a=!0,className:s="",onAuthRequired:l,isAuthenticated:d=!0}){const{liked:p,likeCount:x,isLoading:f,toggle:g}=function(e,n={}){const[r,o]=t.useState(n.initialLiked??!1),[i,a]=t.useState(n.initialCount??0),[s,l]=t.useState(!1),[d,p]=t.useState(null),x=t.useRef(!1),f=t.useRef(0),g=t.useCallback(async()=>{try{const t=await c(e);o(t.liked),a(t.like_count),p(null)}catch(t){}},[e]),h=t.useCallback(async()=>{if(x.current)return;const t=Date.now();if(t-f.current<500)return;f.current=t,x.current=!0;const n=r,s=i;o(!r),a(r?i-1:i+1),p(null),l(!0);try{const t=await u(e);o(t.liked),a(t.like_count)}catch(d){o(n),a(s);const e=d instanceof Error?d.message:"Failed to toggle like";e.includes("throttle")||p(e)}finally{l(!1),x.current=!1}},[e,r,i]);return t.useEffect(()=>{void 0!==n.initialLiked&&o(n.initialLiked),void 0!==n.initialCount&&a(n.initialCount)},[n.initialLiked,n.initialCount]),{liked:r,likeCount:i,isLoading:s,error:d,toggle:h,refresh:g}}(n,{initialLiked:r,initialCount:o}),h={sm:{icon:18,padding:"6px 10px",fontSize:12},md:{icon:22,padding:"8px 14px",fontSize:14},lg:{icon:26,padding:"10px 18px",fontSize:16}}[i];return e.jsxs("button",{onClick:async e=>{e.preventDefault(),e.stopPropagation(),d?await g():null==l||l()},disabled:f,className:s,style:{display:"inline-flex",alignItems:"center",gap:8,padding:h.padding,background:p?"rgba(59, 130, 246, 0.15)":"rgba(255, 255, 255, 0.05)",border:"1px solid "+(p?"rgba(59, 130, 246, 0.3)":"rgba(255, 255, 255, 0.1)"),borderRadius:10,cursor:f?"not-allowed":"pointer",opacity:f?.6:1,transition:"all 0.2s ease"},onMouseEnter:e=>{f||(e.currentTarget.style.background=p?"rgba(59, 130, 246, 0.25)":"rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="scale(1.05)")},onMouseLeave:e=>{e.currentTarget.style.background=p?"rgba(59, 130, 246, 0.15)":"rgba(255, 255, 255, 0.05)",e.currentTarget.style.transform="scale(1)"},"aria-label":p?"Unlike":"Like",children:[e.jsx(b,{size:h.icon,fill:p?"#3b82f6":"transparent",color:p?"#3b82f6":"#94a3b8",style:{transition:"all 0.2s ease"}}),a&&e.jsx("span",{style:{fontSize:h.fontSize,fontWeight:600,color:p?"#3b82f6":"#cbd5e1"},children:x>0?x.toLocaleString():"Like"})]})}function T({comment:r,onReply:o,onEdit:i,onDelete:a,onLoadReplies:s,isAuthenticated:l=!1,currentUsername:d,depth:c=0,maxDepth:u=3}){const[p,x]=t.useState(!1),[f,g]=t.useState(!1),[h,b]=t.useState(""),[w,S]=t.useState(r.text),[C,R]=t.useState(!1),[L,I]=t.useState(!1),[A,W]=t.useState([]),[_,E]=t.useState(!1),D=async()=>{if(!L&&r.replies_count>0){E(!0);try{const e=await s(r.id);W(e)}finally{E(!1)}}I(!L)},M=l&&c<u,$=Math.min(20*c,60),P={display:"inline-flex",alignItems:"center",gap:4,background:"transparent",border:"none",padding:"4px 8px",borderRadius:6,fontSize:12,color:"#64748b",cursor:"pointer",transition:"all 0.15s ease"};return e.jsxs("div",{style:{marginLeft:`${$}px`},children:[e.jsx("div",{style:{padding:"12px 0"},children:e.jsxs("div",{style:{display:"flex",gap:12},children:[r.author_avatar?e.jsx("img",{src:r.author_avatar,alt:r.author_username,style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",flexShrink:0}}):e.jsx("div",{style:{width:36,height:36,borderRadius:"50%",background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:14,fontWeight:600,flexShrink:0},children:r.author_username.charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap",marginBottom:4},children:[e.jsxs(n,{to:`/profile/${r.author_username}`,style:{fontWeight:600,color:"#f1f5f9",textDecoration:"none",fontSize:13},children:["@",r.author_username]}),e.jsx("span",{style:{fontSize:11,color:"#64748b"},children:(e=>{const t=new Date,n=new Date(e),r=Math.floor((t.getTime()-n.getTime())/1e3);return r<60?"just now":r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:r<2592e3?`${Math.floor(r/86400)}d ago`:n.toLocaleDateString()})(r.created_at)}),r.edited&&e.jsx("span",{style:{fontSize:11,color:"#475569"},children:"(edited)"})]}),f?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),w.trim()){R(!0);try{await i(r.id,w),g(!1)}finally{R(!1)}}},style:{marginTop:8},children:[e.jsx("textarea",{value:w,onChange:e=>S(e.target.value),rows:2,disabled:C,style:{width:"100%",padding:"10px 12px",background:"#0f172a",border:"1px solid #334155",borderRadius:8,color:"#f1f5f9",fontSize:13,resize:"none",outline:"none"}}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("button",{type:"submit",disabled:C||!w.trim(),style:{padding:"6px 12px",background:"#8b5cf6",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:500,cursor:"pointer",opacity:C||!w.trim()?.5:1},children:C?"Saving...":"Save"}),e.jsx("button",{type:"button",onClick:()=>{g(!1),S(r.text)},style:{padding:"6px 12px",background:"#334155",border:"none",borderRadius:6,color:"#94a3b8",fontSize:12,fontWeight:500,cursor:"pointer"},children:"Cancel"})]})]}):e.jsx("p",{style:{color:"#cbd5e1",fontSize:14,lineHeight:1.6,margin:0,whiteSpace:"pre-wrap"},children:r.text}),!f&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginTop:8},children:[M&&e.jsxs("button",{onClick:()=>x(!p),style:P,onMouseEnter:e=>e.currentTarget.style.color="#a78bfa",onMouseLeave:e=>e.currentTarget.style.color="#64748b",children:[e.jsx(z,{size:14}),"Reply"]}),r.can_edit&&e.jsxs("button",{onClick:()=>g(!0),style:P,onMouseEnter:e=>e.currentTarget.style.color="#a78bfa",onMouseLeave:e=>e.currentTarget.style.color="#64748b",children:[e.jsx(y,{size:14}),"Edit"]}),r.can_delete&&e.jsxs("button",{onClick:async()=>{confirm("Are you sure you want to delete this comment?")&&await a(r.id)},style:P,onMouseEnter:e=>e.currentTarget.style.color="#ef4444",onMouseLeave:e=>e.currentTarget.style.color="#64748b",children:[e.jsx(m,{size:14}),"Delete"]}),r.replies_count>0&&e.jsx("button",{onClick:D,style:{...P,color:"#8b5cf6"},children:L?e.jsxs(e.Fragment,{children:[e.jsx(j,{size:14}),"Hide replies"]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:14}),_?"Loading...":`${r.replies_count} replies`]})})]}),p&&e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),h.trim()){R(!0);try{await o(h,r.id),b(""),x(!1),await D()}finally{R(!1)}}},style:{marginTop:12},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"flex-end"},children:[e.jsx("textarea",{value:h,onChange:e=>b(e.target.value),placeholder:`Reply to @${r.author_username}...`,rows:2,disabled:C,style:{flex:1,padding:"10px 12px",background:"#0f172a",border:"1px solid #334155",borderRadius:8,color:"#f1f5f9",fontSize:13,resize:"none",outline:"none"}}),e.jsx("button",{type:"submit",disabled:C||!h.trim(),style:{padding:"10px 14px",background:h.trim()?"#8b5cf6":"#334155",border:"none",borderRadius:8,color:h.trim()?"#fff":"#64748b",cursor:C||!h.trim()?"not-allowed":"pointer"},children:e.jsx(k,{size:16})})]}),e.jsx("button",{type:"button",onClick:()=>{x(!1),b("")},style:{background:"transparent",border:"none",color:"#64748b",fontSize:12,cursor:"pointer",marginTop:6},children:"Cancel"})]})]})]})}),L&&A.length>0&&e.jsx("div",{style:{borderLeft:"2px solid #1e293b",marginLeft:18},children:A.map(t=>e.jsx(T,{comment:t,onReply:o,onEdit:i,onDelete:a,onLoadReplies:s,isAuthenticated:l,currentUsername:d,depth:c+1,maxDepth:u},t.id))})]})}function I({contentId:n,isAuthenticated:r=!1,currentUsername:o,onAuthRequired:a}){const[s,l]=t.useState(""),[d,c]=t.useState(!1),{comments:u,isLoading:b,error:y,hasMore:m,totalCount:j,loadMore:v,addComment:w,editComment:S,removeComment:C,loadReplies:z}=function(e){const[n,r]=t.useState([]),[o,i]=t.useState(!1),[a,s]=t.useState(null),[l,d]=t.useState(1),[c,u]=t.useState(!1),[b,y]=t.useState(0),m=t.useRef(!1),j=t.useRef(!1),v=t.useCallback(async(t,n=!1)=>{if(!m.current){m.current=!0,i(!0),s(null);try{const o=await p(e,t,!0);r(e=>n?[...e,...o.results]:o.results),u(null!==o.next),y(o.count),d(t)}catch(o){const e=o instanceof Error?o.message:"Failed to load comments";e.includes("throttle")||s(e)}finally{i(!1),m.current=!1}}},[e]),k=t.useCallback(async()=>{await v(1,!1)},[v]),w=t.useCallback(async()=>{o||!c||m.current||await v(l+1,!0)},[v,o,c,l]),S=t.useCallback(async(t,n)=>{const o=await x(e,t,n);return n?r(e=>e.map(e=>e.id===n?{...e,replies_count:e.replies_count+1}:e)):(r(e=>[o,...e]),y(e=>e+1)),o},[e]),C=t.useCallback(async(e,t)=>{const n=await f(e,t);r(t=>t.map(t=>t.id===e?n:t))},[]),z=t.useCallback(async e=>{await g(e),r(t=>t.filter(t=>t.id!==e)),y(e=>e-1)},[]),R=t.useCallback(async e=>await h(e),[]);return t.useEffect(()=>{j.current||(j.current=!0,v(1,!1))},[e]),t.useEffect(()=>()=>{j.current=!1},[e]),{comments:n,isLoading:o,error:a,hasMore:c,totalCount:b,loadMore:w,refresh:k,addComment:S,editComment:C,removeComment:z,loadReplies:R}}(n),R=async(e,t)=>{await w(e,t)};return e.jsxs("div",{style:{background:"#0f172a",borderRadius:16,border:"1px solid #1e293b",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #1e293b",display:"flex",alignItems:"center",gap:10},children:[e.jsx(i,{size:20,color:"#8b5cf6"}),e.jsx("h3",{style:{margin:0,fontSize:18,fontWeight:700,color:"#f1f5f9"},children:"Comments"}),j>0&&e.jsx("span",{style:{background:"#1e293b",color:"#94a3b8",padding:"4px 10px",borderRadius:12,fontSize:13,fontWeight:500},children:j})]}),e.jsxs("div",{style:{padding:"20px 24px"},children:[e.jsx("form",{onSubmit:async e=>{if(e.preventDefault(),r){if(s.trim()){c(!0);try{await w(s),l("")}finally{c(!1)}}}else null==a||a()},style:{marginBottom:24},children:e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:"50%",background:r?"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)":"#334155",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:16,fontWeight:600,flexShrink:0},children:o?o.charAt(0).toUpperCase():"?"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("textarea",{value:s,onChange:e=>l(e.target.value),placeholder:r?"Share your thoughts...":"Sign in to leave a comment",rows:3,disabled:!r||d,onClick:()=>{r||null==a||a()},style:{width:"100%",padding:"12px 14px",background:"#1e293b",border:"1px solid #334155",borderRadius:12,color:"#f1f5f9",fontSize:14,resize:"none",outline:"none",transition:"border-color 0.2s",cursor:r?"text":"pointer"},onFocus:e=>{r&&(e.target.style.borderColor="#8b5cf6")},onBlur:e=>e.target.style.borderColor="#334155"}),r&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:e.jsxs("button",{type:"submit",disabled:d||!s.trim(),style:{display:"flex",alignItems:"center",gap:8,padding:"10px 20px",background:s.trim()?"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)":"#334155",border:"none",borderRadius:10,color:s.trim()?"#fff":"#64748b",fontSize:14,fontWeight:600,cursor:d||!s.trim()?"not-allowed":"pointer",opacity:d?.7:1,transition:"all 0.2s ease"},children:[e.jsx(k,{size:16}),d?"Posting...":"Post Comment"]})})]})]})}),y&&e.jsx("p",{style:{fontSize:13,color:"#ef4444",marginBottom:16,padding:"10px 14px",background:"rgba(239, 68, 68, 0.1)",borderRadius:8},children:y}),b&&0===u.length?e.jsx("div",{style:{textAlign:"center",padding:"32px 0",color:"#64748b",fontSize:14},children:"Loading comments..."}):0===u.length?e.jsx("div",{style:{textAlign:"center",padding:"32px 0",color:"#64748b",fontSize:14},children:"No comments yet. Be the first to comment!"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{children:u.map(t=>e.jsx("div",{style:{borderBottom:"1px solid #1e293b"},children:e.jsx(T,{comment:t,onReply:R,onEdit:S,onDelete:C,onLoadReplies:z,isAuthenticated:r,currentUsername:o})},t.id))}),m&&e.jsx("button",{onClick:v,disabled:b,style:{width:"100%",marginTop:16,padding:"12px",background:"transparent",border:"1px solid #334155",borderRadius:10,color:"#8b5cf6",fontSize:14,fontWeight:600,cursor:b?"not-allowed":"pointer",opacity:b?.6:1,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(139, 92, 246, 0.1)",e.currentTarget.style.borderColor="#8b5cf6"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.borderColor="#334155"},children:b?"Loading...":"Load More Comments"})]})]})]})}function A({chapterId:n,contentId:r,price:o,alreadyOwned:i=!1,compact:l=!1,onSuccess:d,className:c=""}){const{addToCart:u,cart:p,error:x,isInCart:f}=a(),[g,h]=t.useState(!1),[b,y]=t.useState(null),[m,j]=t.useState(!1),v=f(n||r||0,n?"chapter":"content"),k=!!(p&&p.item_count>=p.max_items);return i?e.jsxs("button",{disabled:!0,className:`rb-cart-btn rb-cart-btn--owned ${c}`,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:l?"6px 12px":"10px 16px",backgroundColor:"var(--bg-success, #064e3b)",color:"var(--text-success, #10b981)",border:"1px solid var(--border-success, #10b981)",borderRadius:"8px",cursor:"not-allowed",fontSize:l?"13px":"14px",fontWeight:500},children:[e.jsx(w,{size:l?14:16}),"Owned"]}):v||m?e.jsxs("button",{disabled:!0,className:`rb-cart-btn rb-cart-btn--in-cart ${c}`,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:l?"6px 12px":"10px 16px",backgroundColor:"var(--bg-info, #1e3a5f)",color:"var(--text-info, #60a5fa)",border:"1px solid var(--border-info, #3b82f6)",borderRadius:"8px",cursor:"not-allowed",fontSize:l?"13px":"14px",fontWeight:500},children:[e.jsx(w,{size:l?14:16}),m?"Added!":"In Cart"]}):e.jsxs("div",{style:{display:"inline-flex",flexDirection:"column",gap:"4px"},children:[e.jsxs("button",{onClick:async function(){if(i||v||k||g)return;h(!0),y(null),await u(n,r)?(j(!0),setTimeout(()=>j(!1),2e3),null==d||d()):y(x||"Failed to add to cart"),h(!1)},disabled:g||k,className:`rb-cart-btn rb-cart-btn--add ${c}`,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:l?"6px 12px":"10px 16px",backgroundColor:g||k?"var(--bg-disabled, #475569)":"var(--accent, #3b82f6)",color:"white",border:"none",borderRadius:"8px",cursor:g||k?"not-allowed":"pointer",fontSize:l?"13px":"14px",fontWeight:500,transition:"all 0.2s ease"},children:[e.jsx(s,{size:l?14:16}),g?"Adding...":l?`$${o}`:`Add to Cart - $${o}`]}),b&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"var(--text-error, #ef4444)",fontSize:"12px"},children:[e.jsx(S,{size:12}),b]}),k&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"var(--text-warning, #f59e0b)",fontSize:"12px"},children:[e.jsx(S,{size:12}),"Cart full (max ",null==p?void 0:p.max_items,")"]})]})}function W({open:o,onClose:i,teaserUrl:a,contentType:s,contentId:c,price:u,editions:p,isCollaborative:x=!1,collaborators:f=[],creatorUsername:g,creatorAvatar:h,title:b,likeCount:y=0,userHasLiked:m=!1,commentCount:j=0}){const v=s||"book",[k,w]=t.useState(""),[S,z]=t.useState(!0),[T,W]=t.useState(!1),[_,E]=t.useState(!1),[D,M]=t.useState(!1),[$,P]=t.useState();t.useEffect(()=>{o&&fetch(`${l}/api/auth/status/`,{credentials:"include"}).then(e=>e.ok?e.json():null).then(e=>{M(!!(null==e?void 0:e.username)),P(null==e?void 0:e.username)}).catch(()=>{})},[o]),t.useEffect(()=>{const e=e=>{"Escape"===e.key&&o&&i()};return o&&(window.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{window.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[o,i]),t.useEffect(()=>{let e=!0;return o&&"book"===v&&a?(z(!0),fetch(a,{credentials:"include"}).then(e=>e.ok?e.text():"").then(t=>{e&&(w(String(t||"")),z(!1))}).catch(()=>{e&&(w("<p>Preview unavailable</p>"),z(!1))})):z(!1),()=>{e=!1}},[o,v,a]);const F=t.useMemo(()=>r(k),[k]),N=void 0!==p&&p>0,B=u&&u>0?`$${u.toFixed(2)}`:"Free";return o?e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.9)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:20},onClick:e=>{e.target===e.currentTarget&&i()},children:e.jsxs("div",{style:{display:"flex",gap:0,maxWidth:1200,width:"100%",height:"90vh",maxHeight:800},children:[e.jsxs("div",{style:{flex:1,background:"#0f172a",borderRadius:"16px 0 0 16px",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderBottom:"1px solid #1e293b",background:"#0b1220"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{color:"#f1f5f9",fontWeight:600,fontSize:16},children:b||"Preview"}),void 0!==p&&e.jsx("span",{style:{background:p>0?"rgba(16, 185, 129, 0.15)":"rgba(239, 68, 68, 0.15)",color:p>0?"#10b981":"#ef4444",padding:"4px 10px",borderRadius:6,fontSize:12,fontWeight:600},children:p>0?`${p} available`:"Sold out"})]}),e.jsx("button",{onClick:i,style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(d,{size:24})})]}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:16},children:["book"===v&&e.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto",padding:16,background:"#0b1220",borderRadius:8,position:"relative"},children:S?e.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:"Loading preview..."}):F?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"content-display",dangerouslySetInnerHTML:{__html:F}}),e.jsx("div",{style:{position:"absolute",inset:0,pointerEvents:"none",display:"flex",flexWrap:"wrap",alignContent:"flex-start",justifyContent:"center",gap:"60px 80px",padding:40,overflow:"hidden"},children:Array.from({length:30}).map((t,n)=>e.jsx("div",{style:{color:"rgba(148, 163, 184, 0.08)",fontSize:16,fontWeight:600,transform:"rotate(-25deg)",whiteSpace:"nowrap",userSelect:"none",letterSpacing:2},children:"renaissBlock"},n))})]}):e.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:"No preview available"})}),"art"===v&&e.jsxs("div",{style:{display:"grid",placeItems:"center",height:"100%",position:"relative"},children:[e.jsx("img",{src:a,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:8}}),e.jsx("div",{style:{position:"absolute",inset:0,pointerEvents:"none",display:"flex",flexWrap:"wrap",alignContent:"center",justifyContent:"center",gap:"40px 60px",overflow:"hidden"},children:Array.from({length:40}).map((t,n)=>e.jsx("div",{style:{color:"rgba(255, 255, 255, 0.2)",fontSize:14,fontWeight:700,transform:"rotate(-30deg)",whiteSpace:"nowrap",userSelect:"none",letterSpacing:3,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:"renaissBlock"},n))})]}),"film"===v&&e.jsx("video",{src:a,controls:!0,style:{width:"100%",height:"100%",borderRadius:8}}),"music"===v&&e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx("audio",{src:a,controls:!0,style:{width:"100%",maxWidth:500}})})]}),c&&N&&e.jsxs("div",{style:{padding:"16px 20px",borderTop:"1px solid #1e293b",background:"#0b1220",display:"flex",alignItems:"center",justifyContent:"center",gap:12},children:[D&&u&&u>0&&e.jsx(A,{contentId:c,price:u.toFixed(2)}),e.jsx("button",{onClick:async()=>{if(c){W(!0);try{const e=function(){const e=document.cookie.match(/csrftoken=([^;]+)/);return e?e[1]:""}(),t=await fetch(`${l}/api/checkout/session/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":e},credentials:"include",body:JSON.stringify({content_id:c})}),n=await t.json();if(!t.ok)return void("NOT_MINTED"===(null==n?void 0:n.code)?alert("Content not available for purchase"):"SOLD_OUT"===(null==n?void 0:n.code)?alert("This content is sold out"):"ALREADY_OWNED"===(null==n?void 0:n.code)?alert("You already own this content"):"NO_BUYER_WALLET"===(null==n?void 0:n.code)?alert("Please set up your wallet in your profile before purchasing"):"NO_CREATOR_WALLET"===(null==n?void 0:n.code)?alert("Creator wallet not configured. Please contact support."):"STRIPE_ERROR"===(null==n?void 0:n.code)?alert("Payment system error. Please try again."):alert((null==n?void 0:n.error)||"Checkout failed"));(null==n?void 0:n.checkout_url)?window.location.href=n.checkout_url:alert("No checkout URL received")}catch{alert("Failed to initiate checkout. Please try again.")}finally{W(!1)}}},disabled:T,style:{background:T?"#475569":"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"#fff",border:"none",borderRadius:10,padding:"14px 40px",cursor:T?"not-allowed":"pointer",fontSize:16,fontWeight:700,transition:"all 0.2s"},children:T?"Processing...":`Buy Now ${B}`})]})]}),e.jsxs("div",{style:{width:_?380:72,background:"#0b1220",borderRadius:"0 16px 16px 0",borderLeft:"1px solid #1e293b",display:"flex",flexDirection:"column",transition:"width 0.3s ease",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px 0",gap:8,borderBottom:_?"1px solid #1e293b":"none"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[c&&e.jsx(L,{contentId:c,initialCount:y,initialLiked:m,isAuthenticated:D,onAuthRequired:()=>window.location.href="/auth",size:"lg",showCount:!1}),e.jsx("span",{style:{fontSize:12,color:"#94a3b8",fontWeight:500},children:y>0?y.toLocaleString():"Like"})]}),e.jsxs("button",{onClick:()=>E(!_),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,background:_?"rgba(139, 92, 246, 0.15)":"transparent",border:"none",padding:"12px 16px",borderRadius:12,cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(C,{size:28,color:_?"#a78bfa":"#94a3b8",fill:_?"#a78bfa":"transparent"}),e.jsx("span",{style:{fontSize:12,color:_?"#a78bfa":"#94a3b8",fontWeight:500},children:j>0?j.toLocaleString():"Comments"})]}),e.jsxs("button",{onClick:async()=>{const e=`${window.location.origin}/content/${c}`;if(navigator.share)try{await navigator.share({title:b||"Check this out",url:e})}catch{}else await navigator.clipboard.writeText(e),alert("Link copied to clipboard!")},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,background:"transparent",border:"none",padding:"12px 16px",borderRadius:12,cursor:"pointer"},children:[e.jsx(R,{size:28,color:"#94a3b8"}),e.jsx("span",{style:{fontSize:12,color:"#94a3b8",fontWeight:500},children:"Share"})]})]}),(g||x&&f.length>0)&&e.jsxs("div",{style:{padding:"16px 12px",borderBottom:_?"1px solid #1e293b":"none"},children:[g&&e.jsxs(n,{to:`/profile/${g}`,onClick:e=>e.stopPropagation(),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8,textDecoration:"none",marginBottom:x?12:0},children:[e.jsx("div",{style:{width:44,height:44,borderRadius:"50%",background:h?`url(${h}) center/cover`:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:18,fontWeight:600},children:!h&&g.charAt(0).toUpperCase()}),e.jsxs("span",{style:{fontSize:12,color:"#60a5fa",fontWeight:600,textAlign:"center",wordBreak:"break-word"},children:["@",g]})]}),x&&f.length>0&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:10,color:"#64748b",textTransform:"uppercase",fontWeight:600},children:"Collaborators"}),f.slice(0,3).map(t=>e.jsxs(n,{to:`/profile/${t.username}`,onClick:e=>e.stopPropagation(),style:{fontSize:11,color:"#60a5fa",textDecoration:"none"},children:["@",t.username]},t.username)),f.length>3&&e.jsxs("span",{style:{fontSize:11,color:"#64748b"},children:["+",f.length-3," more"]})]})]}),_&&c&&e.jsx("div",{style:{flex:1,overflow:"auto",padding:16},children:e.jsx(I,{contentId:c,isAuthenticated:D,currentUsername:$,onAuthRequired:()=>window.location.href="/auth"})})]})]})}):null}export{A,W as P};
//# sourceMappingURL=PreviewModal-CpYjlQN_.js.map
