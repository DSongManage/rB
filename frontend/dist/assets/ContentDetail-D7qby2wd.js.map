{"version":3,"file":"ContentDetail-D7qby2wd.js","sources":["../../node_modules/lucide-react/dist/esm/icons/play.js","../../src/components/social/RatingSection.tsx","../../src/hooks/useContentRatings.ts","../../src/pages/ContentDetail.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z\",\n      key: \"10ikf1\"\n    }\n  ]\n];\nconst Play = createLucideIcon(\"play\", __iconNode);\n\nexport { __iconNode, Play as default };\n//# sourceMappingURL=play.js.map\n","/**\n * RatingSection Component\n *\n * Modern ratings display with dark theme styling.\n */\n\nimport React, { useState } from 'react';\nimport { Star, ChevronDown, ChevronUp, Sparkles } from 'lucide-react';\nimport { Link } from 'react-router-dom';\nimport StarRating from './StarRating';\nimport RatingForm from './RatingForm';\nimport { useContentRatings } from '../../hooks/useContentRatings';\nimport { ContentRating } from '../../services/socialApi';\n\ninterface RatingSectionProps {\n  contentId: number;\n  initialAverageRating?: number | null;\n  initialRatingCount?: number;\n  isAuthenticated?: boolean;\n  onAuthRequired?: () => void;\n}\n\nfunction RatingItem({ rating }: { rating: ContentRating }) {\n  const timeAgo = (date: string) => {\n    const now = new Date();\n    const then = new Date(date);\n    const diff = Math.floor((now.getTime() - then.getTime()) / 1000);\n\n    if (diff < 60) return 'just now';\n    if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n    if (diff < 2592000) return `${Math.floor(diff / 86400)}d ago`;\n    return then.toLocaleDateString();\n  };\n\n  return (\n    <div style={{\n      padding: '16px 0',\n      borderBottom: '1px solid #1e293b',\n    }}>\n      <div style={{ display: 'flex', gap: 12 }}>\n        {rating.user_avatar ? (\n          <img\n            src={rating.user_avatar}\n            alt={rating.username}\n            style={{\n              width: 40,\n              height: 40,\n              borderRadius: '50%',\n              objectFit: 'cover',\n              flexShrink: 0,\n            }}\n          />\n        ) : (\n          <div style={{\n            width: 40,\n            height: 40,\n            borderRadius: '50%',\n            background: 'linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: '#fff',\n            fontSize: 16,\n            fontWeight: 600,\n            flexShrink: 0,\n          }}>\n            {rating.username.charAt(0).toUpperCase()}\n          </div>\n        )}\n        <div style={{ flex: 1, minWidth: 0 }}>\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 10,\n            marginBottom: 4,\n            flexWrap: 'wrap',\n          }}>\n            <Link\n              to={`/profile/${rating.username}`}\n              style={{\n                fontWeight: 600,\n                color: '#f1f5f9',\n                textDecoration: 'none',\n                fontSize: 14,\n              }}\n            >\n              @{rating.username}\n            </Link>\n            <StarRating rating={rating.rating} size=\"sm\" readonly />\n            <span style={{ fontSize: 12, color: '#64748b' }}>\n              {timeAgo(rating.created_at)}\n            </span>\n          </div>\n          {rating.review_text && (\n            <p style={{\n              color: '#cbd5e1',\n              fontSize: 14,\n              lineHeight: 1.6,\n              margin: 0,\n            }}>\n              {rating.review_text}\n            </p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function RatingSection({\n  contentId,\n  initialAverageRating,\n  initialRatingCount = 0,\n  isAuthenticated = true,\n  onAuthRequired,\n}: RatingSectionProps) {\n  const [showForm, setShowForm] = useState(false);\n  const [showAll, setShowAll] = useState(false);\n\n  const {\n    ratings,\n    myRating,\n    isLoading,\n    isSubmitting,\n    error,\n    averageRating,\n    totalCount,\n    submitMyRating,\n  } = useContentRatings(contentId, {\n    initialAverageRating,\n    initialRatingCount,\n  });\n\n  const displayedRatings = showAll ? ratings : ratings.slice(0, 3);\n\n  const handleSubmit = async (rating: number, reviewText?: string) => {\n    if (!isAuthenticated) {\n      onAuthRequired?.();\n      return;\n    }\n    await submitMyRating(rating, reviewText);\n    setShowForm(false);\n  };\n\n  return (\n    <div style={{\n      background: '#0f172a',\n      borderRadius: 16,\n      border: '1px solid #1e293b',\n      overflow: 'hidden',\n    }}>\n      {/* Header */}\n      <div style={{\n        padding: '20px 24px',\n        borderBottom: '1px solid #1e293b',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n      }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>\n          <Star size={20} fill=\"#fbbf24\" color=\"#fbbf24\" />\n          <h3 style={{\n            margin: 0,\n            fontSize: 18,\n            fontWeight: 700,\n            color: '#f1f5f9',\n          }}>\n            Ratings & Reviews\n          </h3>\n        </div>\n\n        {/* Average Rating Badge */}\n        {averageRating !== null && averageRating > 0 && (\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            background: 'rgba(251, 191, 36, 0.1)',\n            padding: '8px 14px',\n            borderRadius: 10,\n            border: '1px solid rgba(251, 191, 36, 0.2)',\n          }}>\n            <Star size={18} fill=\"#fbbf24\" color=\"#fbbf24\" />\n            <span style={{\n              fontSize: 18,\n              fontWeight: 700,\n              color: '#fbbf24',\n            }}>\n              {averageRating.toFixed(1)}\n            </span>\n            <span style={{ color: '#64748b', fontSize: 13 }}>\n              ({totalCount})\n            </span>\n          </div>\n        )}\n      </div>\n\n      {/* Content */}\n      <div style={{ padding: '20px 24px' }}>\n        {/* Your Rating Section */}\n        {isAuthenticated && !myRating && (\n          <div style={{ marginBottom: 24 }}>\n            {showForm ? (\n              <div style={{\n                background: '#1e293b',\n                borderRadius: 12,\n                padding: 20,\n              }}>\n                <div style={{\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  alignItems: 'center',\n                  marginBottom: 16,\n                }}>\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n                    <Sparkles size={18} color=\"#fbbf24\" />\n                    <h4 style={{\n                      margin: 0,\n                      fontSize: 16,\n                      fontWeight: 600,\n                      color: '#f1f5f9',\n                    }}>\n                      Write a Review\n                    </h4>\n                  </div>\n                  <button\n                    onClick={() => setShowForm(false)}\n                    style={{\n                      background: 'transparent',\n                      border: 'none',\n                      color: '#64748b',\n                      fontSize: 13,\n                      cursor: 'pointer',\n                    }}\n                  >\n                    Cancel\n                  </button>\n                </div>\n                <RatingForm\n                  onSubmit={handleSubmit}\n                  isSubmitting={isSubmitting}\n                />\n              </div>\n            ) : (\n              <button\n                onClick={() => setShowForm(true)}\n                style={{\n                  width: '100%',\n                  padding: '14px 20px',\n                  background: 'transparent',\n                  border: '2px dashed #334155',\n                  borderRadius: 12,\n                  color: '#94a3b8',\n                  fontSize: 14,\n                  fontWeight: 500,\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: 8,\n                  transition: 'all 0.2s ease',\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.borderColor = '#8b5cf6';\n                  e.currentTarget.style.color = '#a78bfa';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.borderColor = '#334155';\n                  e.currentTarget.style.color = '#94a3b8';\n                }}\n              >\n                <Star size={18} />\n                Rate this content\n              </button>\n            )}\n          </div>\n        )}\n\n        {/* Your Existing Rating */}\n        {myRating && (\n          <div style={{\n            marginBottom: 24,\n            background: 'rgba(139, 92, 246, 0.1)',\n            border: '1px solid rgba(139, 92, 246, 0.2)',\n            borderRadius: 12,\n            padding: 16,\n          }}>\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 12,\n              marginBottom: myRating.review_text ? 8 : 0,\n            }}>\n              <span style={{ fontSize: 13, color: '#a78bfa', fontWeight: 500 }}>\n                Your rating:\n              </span>\n              <StarRating rating={myRating.rating} size=\"sm\" readonly />\n            </div>\n            {myRating.review_text && (\n              <p style={{\n                margin: 0,\n                fontSize: 14,\n                color: '#c4b5fd',\n                lineHeight: 1.5,\n              }}>\n                {myRating.review_text}\n              </p>\n            )}\n          </div>\n        )}\n\n        {/* Error Message */}\n        {error && (\n          <p style={{\n            fontSize: 13,\n            color: '#ef4444',\n            marginBottom: 16,\n            padding: '10px 14px',\n            background: 'rgba(239, 68, 68, 0.1)',\n            borderRadius: 8,\n          }}>\n            {error}\n          </p>\n        )}\n\n        {/* Ratings List */}\n        {isLoading && ratings.length === 0 ? (\n          <div style={{\n            textAlign: 'center',\n            padding: '32px 0',\n            color: '#64748b',\n            fontSize: 14,\n          }}>\n            Loading ratings...\n          </div>\n        ) : ratings.length === 0 ? (\n          <div style={{\n            textAlign: 'center',\n            padding: '32px 0',\n            color: '#64748b',\n            fontSize: 14,\n          }}>\n            No ratings yet. Be the first to rate!\n          </div>\n        ) : (\n          <>\n            <div>\n              {displayedRatings.map((rating, index) => (\n                <div\n                  key={rating.id}\n                  style={{\n                    borderBottom: index === displayedRatings.length - 1 ? 'none' : undefined,\n                  }}\n                >\n                  <RatingItem rating={rating} />\n                </div>\n              ))}\n            </div>\n\n            {ratings.length > 3 && (\n              <button\n                onClick={() => setShowAll(!showAll)}\n                style={{\n                  width: '100%',\n                  marginTop: 16,\n                  padding: '12px',\n                  background: 'transparent',\n                  border: 'none',\n                  color: '#8b5cf6',\n                  fontSize: 14,\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: 6,\n                }}\n              >\n                {showAll ? (\n                  <>\n                    Show Less <ChevronUp size={18} />\n                  </>\n                ) : (\n                  <>\n                    Show All ({ratings.length}) <ChevronDown size={18} />\n                  </>\n                )}\n              </button>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default RatingSection;\n","/**\n * useContentRatings Hook\n *\n * Manages ratings for content.\n * Includes deduplication to prevent infinite loops and rate limiting.\n */\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport {\n  ContentRating,\n  getContentRatings,\n  getMyRating,\n  submitRating,\n} from '../services/socialApi';\n\ninterface UseContentRatingsReturn {\n  ratings: ContentRating[];\n  myRating: ContentRating | null;\n  isLoading: boolean;\n  isSubmitting: boolean;\n  error: string | null;\n  hasMore: boolean;\n  totalCount: number;\n  averageRating: number | null;\n  loadMore: () => Promise<void>;\n  refresh: () => Promise<void>;\n  submitMyRating: (rating: number, reviewText?: string) => Promise<void>;\n}\n\ninterface UseContentRatingsOptions {\n  initialAverageRating?: number | null;\n  initialRatingCount?: number;\n}\n\nexport function useContentRatings(\n  contentId: number,\n  options: UseContentRatingsOptions = {}\n): UseContentRatingsReturn {\n  const [ratings, setRatings] = useState<ContentRating[]>([]);\n  const [myRating, setMyRating] = useState<ContentRating | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(false);\n  const [totalCount, setTotalCount] = useState(options.initialRatingCount ?? 0);\n  const [averageRating, setAverageRating] = useState<number | null>(\n    options.initialAverageRating ?? null\n  );\n\n  // Refs to prevent duplicate fetches and infinite loops\n  const fetchingRatings = useRef(false);\n  const fetchingMyRating = useRef(false);\n  const initialLoadDone = useRef(false);\n\n  const fetchRatings = useCallback(async (pageNum: number, append: boolean = false) => {\n    if (fetchingRatings.current) return;\n    fetchingRatings.current = true;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await getContentRatings(contentId, pageNum);\n      setRatings(prev => {\n        const newRatings = append ? [...prev, ...response.results] : response.results;\n        // Calculate average from the new ratings\n        if (newRatings.length > 0) {\n          const avg = newRatings.reduce((sum, r) => sum + r.rating, 0) / newRatings.length;\n          setAverageRating(Math.round(avg * 10) / 10);\n        }\n        return newRatings;\n      });\n      setHasMore(response.next !== null);\n      setTotalCount(response.count);\n      setPage(pageNum);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to load ratings';\n      if (!message.includes('throttle')) {\n        setError(message);\n      }\n    } finally {\n      setIsLoading(false);\n      fetchingRatings.current = false;\n    }\n  }, [contentId]); // Only depend on contentId!\n\n  const fetchMyRating = useCallback(async () => {\n    if (fetchingMyRating.current) return;\n    fetchingMyRating.current = true;\n\n    try {\n      const rating = await getMyRating(contentId);\n      setMyRating(rating);\n    } catch (err) {\n      // Silently fail - user might not be authenticated\n    } finally {\n      fetchingMyRating.current = false;\n    }\n  }, [contentId]);\n\n  const refresh = useCallback(async () => {\n    await Promise.all([\n      fetchRatings(1, false),\n      fetchMyRating(),\n    ]);\n  }, [fetchRatings, fetchMyRating]);\n\n  const loadMore = useCallback(async () => {\n    if (isLoading || !hasMore || fetchingRatings.current) return;\n    await fetchRatings(page + 1, true);\n  }, [fetchRatings, isLoading, hasMore, page]);\n\n  const submitMyRating = useCallback(async (rating: number, reviewText?: string): Promise<void> => {\n    setIsSubmitting(true);\n    setError(null);\n\n    try {\n      const newRating = await submitRating(contentId, rating, reviewText);\n      setMyRating(newRating);\n\n      // Update ratings list\n      setRatings(prev => {\n        const existing = prev.findIndex(r => r.id === newRating.id);\n        if (existing >= 0) {\n          return prev.map(r => (r.id === newRating.id ? newRating : r));\n        } else {\n          return [newRating, ...prev];\n        }\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to submit rating');\n      throw err;\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [contentId]);\n\n  // Initial load - only once per contentId\n  useEffect(() => {\n    if (!initialLoadDone.current) {\n      initialLoadDone.current = true;\n      fetchRatings(1, false);\n      fetchMyRating();\n    }\n  }, [contentId]);\n\n  // Reset when contentId changes\n  useEffect(() => {\n    return () => {\n      initialLoadDone.current = false;\n    };\n  }, [contentId]);\n\n  // Sync with options (but don't trigger fetches)\n  useEffect(() => {\n    if (options.initialAverageRating !== undefined && averageRating === null) {\n      setAverageRating(options.initialAverageRating);\n    }\n    if (options.initialRatingCount !== undefined && totalCount === 0) {\n      setTotalCount(options.initialRatingCount);\n    }\n  }, [options.initialAverageRating, options.initialRatingCount]);\n\n  return {\n    ratings,\n    myRating,\n    isLoading,\n    isSubmitting,\n    error,\n    hasMore,\n    totalCount,\n    averageRating,\n    loadMore,\n    refresh,\n    submitMyRating,\n  };\n}\n\nexport default useContentRatings;\n","import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport { ArrowLeft, Play, ChevronDown, ChevronUp, User } from 'lucide-react';\nimport PreviewModal from '../components/PreviewModal';\nimport AddToCartButton from '../components/AddToCartButton';\nimport { API_URL } from '../config';\nimport { RatingSection } from '../components/social/RatingSection';\n\n// Format genre for display\nfunction formatGenre(genre: string): string {\n  const genreMap: Record<string, string> = {\n    'fantasy': 'Fantasy',\n    'scifi': 'Sci-Fi',\n    'nonfiction': 'Non-Fiction',\n    'drama': 'Drama',\n    'comedy': 'Comedy',\n    'other': 'Other',\n  };\n  return genreMap[genre] || genre;\n}\n\n// Format date for display\nfunction formatDate(dateString: string): string {\n  const date = new Date(dateString);\n  return date.toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n  });\n}\n\nexport default function ContentDetail(){\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [data, setData] = useState<any>(null);\n  const [modalOpen, setModalOpen] = useState(false); // Start closed so user sees page first\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [collaboratorsExpanded, setCollaboratorsExpanded] = useState(false);\n\n  useEffect(()=>{\n    if (!id) return;\n    const abortController = new AbortController();\n\n    // Fetch content and auth status in parallel\n    Promise.all([\n      fetch(`${API_URL}/api/content/${id}/preview/`, {\n        credentials: 'include',\n        signal: abortController.signal,\n      }).then(r=> r.ok ? r.json() : null),\n      fetch(`${API_URL}/api/auth/status/`, {\n        credentials: 'include',\n        signal: abortController.signal,\n      }).then(r => r.ok ? r.json() : null)\n    ])\n      .then(([contentData, authData]) => {\n        setData(contentData);\n        setIsAuthenticated(!!authData?.username);\n      })\n      .catch(err => {\n        if (err.name !== 'AbortError') {\n          console.error('Failed to fetch content preview:', err);\n        }\n      });\n\n    // Track content view (fire-and-forget, no need to abort)\n    fetch(`${API_URL}/api/content/${id}/view/`, {\n      method: 'POST',\n      credentials: 'include',\n    }).catch(() => {});\n\n    return () => abortController.abort();\n  }, [id]);\n\n  const handleCloseModal = () => {\n    setModalOpen(false);\n  };\n\n  const handleOpenPreview = () => {\n    setModalOpen(true);\n  };\n\n  if (!id) return null;\n  if (!data) return (\n    <div style={{\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      minHeight: 400,\n      color: '#94a3b8',\n      fontSize: 16,\n    }}>\n      Loading...\n    </div>\n  );\n\n  // For books, always use the teaser API endpoint (not the cover image)\n  // For other types (art, film, music), use the teaser_link directly\n  const teaserUrl = data?.content_type === 'book'\n    ? `${API_URL}/api/content/${id}/teaser/`\n    : data?.teaser_link;\n\n  // Transform collaborators to match PreviewModal's expected format\n  const collaborators = data?.collaborators?.map((c: any) => ({\n    username: c.username,\n    role: c.role,\n    revenuePercentage: c.revenue_percentage,\n  })) || [];\n\n  const handleAuthRequired = () => {\n    navigate('/auth');\n  };\n\n  const priceNum = typeof data?.price_usd === 'string' ? parseFloat(data.price_usd) : data?.price_usd;\n  const priceText = priceNum && priceNum > 0 ? `$${priceNum.toFixed(2)}` : 'Free';\n  const editionsNum = data?.editions;\n  const editionsText = editionsNum && editionsNum > 0\n    ? `${editionsNum} edition${editionsNum > 1 ? 's' : ''} available`\n    : 'Sold out';\n\n  return (\n    <div style={{maxWidth:900, margin:'0 auto', padding:'24px 16px'}}>\n      {/* Back button */}\n      <button\n        onClick={() => navigate(-1)}\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: 8,\n          background: 'transparent',\n          border: 'none',\n          color: '#94a3b8',\n          cursor: 'pointer',\n          marginBottom: 20,\n          padding: 0,\n          fontSize: 14,\n        }}\n      >\n        <ArrowLeft size={18} />\n        Back\n      </button>\n\n      {/* Content Hero Section */}\n      <div style={{\n        display: 'grid',\n        gridTemplateColumns: '300px 1fr',\n        gap: 24,\n        marginBottom: 32,\n      }}>\n        {/* Thumbnail with Preview Button */}\n        <div style={{ position: 'relative' }}>\n          <div\n            style={{\n              width: '100%',\n              aspectRatio: '3/4',\n              borderRadius: 12,\n              overflow: 'hidden',\n              background: '#1e293b',\n              cursor: 'pointer',\n              position: 'relative',\n            }}\n            onClick={handleOpenPreview}\n          >\n            {data?.teaser_link ? (\n              <img\n                src={data.teaser_link}\n                alt={data.title}\n                style={{\n                  width: '100%',\n                  height: '100%',\n                  objectFit: 'cover',\n                }}\n                onError={(e: React.SyntheticEvent<HTMLImageElement>) => {\n                  e.currentTarget.style.display = 'none';\n                }}\n              />\n            ) : (\n              <div style={{\n                width: '100%',\n                height: '100%',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                color: '#fff',\n                fontSize: 48,\n                fontWeight: 700,\n              }}>\n                {data?.title?.charAt(0) || '?'}\n              </div>\n            )}\n            {/* Play/Preview overlay */}\n            <div style={{\n              position: 'absolute',\n              inset: 0,\n              background: 'rgba(0,0,0,0.4)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              opacity: 0,\n              transition: 'opacity 0.2s',\n            }}\n            onMouseEnter={(e) => e.currentTarget.style.opacity = '1'}\n            onMouseLeave={(e) => e.currentTarget.style.opacity = '0'}\n            >\n              <div style={{\n                background: 'rgba(255,255,255,0.9)',\n                borderRadius: '50%',\n                width: 64,\n                height: 64,\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n              }}>\n                <Play size={32} fill=\"#1e293b\" color=\"#1e293b\" />\n              </div>\n            </div>\n          </div>\n          <button\n            onClick={handleOpenPreview}\n            style={{\n              width: '100%',\n              marginTop: 12,\n              padding: '12px 20px',\n              background: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',\n              color: '#fff',\n              border: 'none',\n              borderRadius: 8,\n              fontWeight: 600,\n              fontSize: 14,\n              cursor: 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              gap: 8,\n            }}\n          >\n            <Play size={18} />\n            View Preview\n          </button>\n\n          {/* Add to Cart Button - shows if available for purchase */}\n          {isAuthenticated && editionsNum > 0 && priceNum > 0 && (\n            <div style={{ marginTop: 12, width: '100%' }}>\n              <AddToCartButton\n                contentId={parseInt(id!)}\n                price={priceNum.toFixed(2)}\n                alreadyOwned={data?.user_owns}\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Content Info */}\n        <div>\n          {/* Title */}\n          <h1 style={{ color: '#f1f5f9', fontSize: 28, fontWeight: 700, margin: 0, marginBottom: 16 }}>\n            {data?.title}\n          </h1>\n\n          {/* Creator with Avatar */}\n          {data?.creator_username && (\n            <Link\n              to={`/profile/${data.creator_username}`}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: 12,\n                marginBottom: 16,\n                textDecoration: 'none',\n              }}\n            >\n              {/* Avatar */}\n              <div style={{\n                width: 48,\n                height: 48,\n                borderRadius: '50%',\n                overflow: 'hidden',\n                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                flexShrink: 0,\n              }}>\n                {data.creator_avatar ? (\n                  <img\n                    src={data.creator_avatar}\n                    alt={data.creator_username}\n                    style={{ width: '100%', height: '100%', objectFit: 'cover' }}\n                  />\n                ) : (\n                  <User size={24} color=\"#fff\" />\n                )}\n              </div>\n              <div>\n                <div style={{ color: '#60a5fa', fontSize: 15, fontWeight: 600 }}>\n                  @{data.creator_username}\n                </div>\n                {data.created_at && (\n                  <div style={{ color: '#64748b', fontSize: 12 }}>\n                    Published {formatDate(data.created_at)}\n                  </div>\n                )}\n              </div>\n            </Link>\n          )}\n\n          {/* Collaborators - Expandable */}\n          {data?.is_collaborative && collaborators.length > 0 && (\n            <div style={{ marginBottom: 16 }}>\n              <button\n                onClick={() => setCollaboratorsExpanded(!collaboratorsExpanded)}\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8,\n                  background: '#1e293b',\n                  border: '1px solid #334155',\n                  borderRadius: 8,\n                  padding: '8px 12px',\n                  color: '#94a3b8',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                  width: 'fit-content',\n                }}\n              >\n                <span>\n                  By{' '}\n                  <span style={{ color: '#60a5fa' }}>@{collaborators[0]?.username}</span>\n                  {collaborators.length > 1 && (\n                    <span> & {collaborators.length - 1} other{collaborators.length > 2 ? 's' : ''}</span>\n                  )}\n                </span>\n                {collaborators.length > 1 && (\n                  collaboratorsExpanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />\n                )}\n              </button>\n              {collaboratorsExpanded && (\n                <div style={{\n                  display: 'flex',\n                  flexWrap: 'wrap',\n                  gap: 8,\n                  marginTop: 8,\n                  paddingLeft: 8,\n                }}>\n                  {collaborators.map((c: any) => (\n                    <Link\n                      key={c.username}\n                      to={`/profile/${c.username}`}\n                      style={{\n                        background: '#0f172a',\n                        border: '1px solid #334155',\n                        borderRadius: 6,\n                        padding: '6px 12px',\n                        fontSize: 12,\n                        color: '#60a5fa',\n                        textDecoration: 'none',\n                      }}\n                    >\n                      @{c.username}\n                      <span style={{ color: '#64748b', marginLeft: 4 }}>({c.role})</span>\n                      <span style={{ color: '#10b981', marginLeft: 4 }}>{c.revenuePercentage}%</span>\n                    </Link>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Price and Editions */}\n          <div style={{\n            display: 'flex',\n            gap: 16,\n            marginBottom: 20,\n          }}>\n            <div style={{\n              background: priceNum > 0 ? 'rgba(16,185,129,0.15)' : 'rgba(148,163,184,0.15)',\n              border: priceNum > 0 ? '1px solid rgba(16,185,129,0.3)' : '1px solid rgba(148,163,184,0.3)',\n              padding: '8px 16px',\n              borderRadius: 8,\n            }}>\n              <div style={{ color: '#64748b', fontSize: 11, textTransform: 'uppercase', marginBottom: 2 }}>Price</div>\n              <div style={{ color: priceNum > 0 ? '#10b981' : '#94a3b8', fontSize: 18, fontWeight: 700 }}>{priceText}</div>\n            </div>\n            <div style={{\n              background: editionsNum > 0 ? 'rgba(59,130,246,0.15)' : 'rgba(239,68,68,0.15)',\n              border: editionsNum > 0 ? '1px solid rgba(59,130,246,0.3)' : '1px solid rgba(239,68,68,0.3)',\n              padding: '8px 16px',\n              borderRadius: 8,\n            }}>\n              <div style={{ color: '#64748b', fontSize: 11, textTransform: 'uppercase', marginBottom: 2 }}>Availability</div>\n              <div style={{ color: editionsNum > 0 ? '#60a5fa' : '#ef4444', fontSize: 14, fontWeight: 600 }}>{editionsText}</div>\n            </div>\n          </div>\n\n          {/* Content Type & Genre Badges */}\n          <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap', marginBottom: 16 }}>\n            <div style={{\n              display: 'inline-block',\n              background: 'rgba(139,92,246,0.15)',\n              border: '1px solid rgba(139,92,246,0.3)',\n              color: '#a78bfa',\n              padding: '4px 12px',\n              borderRadius: 6,\n              fontSize: 12,\n              fontWeight: 600,\n              textTransform: 'capitalize',\n            }}>\n              {data?.content_type}\n            </div>\n            {data?.genre && data.genre !== 'other' && (\n              <div style={{\n                display: 'inline-block',\n                background: 'rgba(59,130,246,0.15)',\n                border: '1px solid rgba(59,130,246,0.3)',\n                color: '#60a5fa',\n                padding: '4px 12px',\n                borderRadius: 6,\n                fontSize: 12,\n                fontWeight: 600,\n              }}>\n                {formatGenre(data.genre)}\n              </div>\n            )}\n          </div>\n\n          {/* Synopsis/Description for Books */}\n          {data?.content_type === 'book' && data?.description && (\n            <div style={{\n              background: 'rgba(59, 130, 246, 0.08)',\n              border: '1px solid rgba(59, 130, 246, 0.2)',\n              borderRadius: 12,\n              padding: 16,\n              marginBottom: 16,\n            }}>\n              <div style={{\n                fontSize: 12,\n                fontWeight: 600,\n                color: '#60a5fa',\n                textTransform: 'uppercase',\n                letterSpacing: '0.05em',\n                marginBottom: 8,\n              }}>\n                Synopsis\n              </div>\n              <p style={{\n                color: '#e2e8f0',\n                fontSize: 14,\n                lineHeight: 1.7,\n                margin: 0,\n              }}>\n                {data.description}\n              </p>\n            </div>\n          )}\n\n          {/* Series Info */}\n          {data?.series_info && (\n            <div style={{\n              background: 'rgba(139, 92, 246, 0.08)',\n              border: '1px solid rgba(139, 92, 246, 0.2)',\n              borderRadius: 12,\n              padding: 16,\n              marginBottom: 16,\n            }}>\n              <div style={{\n                fontSize: 12,\n                fontWeight: 600,\n                color: '#a78bfa',\n                textTransform: 'uppercase',\n                letterSpacing: '0.05em',\n                marginBottom: 8,\n              }}>\n                Part of Series\n              </div>\n              <div style={{\n                color: '#e2e8f0',\n                fontSize: 15,\n                fontWeight: 600,\n              }}>\n                {data.series_info.title}\n              </div>\n              {data.series_info.book_count > 1 && (\n                <div style={{\n                  color: '#94a3b8',\n                  fontSize: 12,\n                  marginTop: 4,\n                }}>\n                  {data.series_info.book_count} books in this series\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Author's Note */}\n          {data?.authors_note && (\n            <div style={{\n              background: 'rgba(30, 41, 59, 0.5)',\n              border: '1px solid #334155',\n              borderRadius: 12,\n              padding: 16,\n              marginBottom: 16,\n            }}>\n              <div style={{\n                fontSize: 12,\n                fontWeight: 600,\n                color: '#94a3b8',\n                textTransform: 'uppercase',\n                letterSpacing: '0.05em',\n                marginBottom: 8,\n              }}>\n                From the Author\n              </div>\n              <p style={{\n                color: '#e2e8f0',\n                fontSize: 14,\n                lineHeight: 1.6,\n                margin: 0,\n                fontStyle: 'italic',\n              }}>\n                \"{data.authors_note}\"\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Preview Modal */}\n      <PreviewModal\n        open={modalOpen}\n        onClose={handleCloseModal}\n        teaserUrl={teaserUrl}\n        contentType={data?.content_type}\n        contentId={parseInt(id)}\n        price={data?.price_usd}\n        editions={data?.editions}\n        isCollaborative={data?.is_collaborative}\n        collaborators={collaborators}\n        creatorUsername={data?.creator_username}\n        creatorAvatar={data?.creator_avatar}\n        title={data?.title}\n        likeCount={data?.like_count || 0}\n        userHasLiked={data?.user_has_liked || false}\n        commentCount={data?.comment_count || 0}\n      />\n\n      {/* Ratings Section */}\n      <RatingSection\n        contentId={parseInt(id)}\n        isAuthenticated={isAuthenticated}\n        onAuthRequired={handleAuthRequired}\n      />\n    </div>\n  );\n}\n\n\n"],"names":["Play","createLucideIcon","d","key","RatingItem","rating","jsx","style","padding","borderBottom","children","display","gap","user_avatar","src","alt","username","width","height","borderRadius","objectFit","flexShrink","background","alignItems","justifyContent","color","fontSize","fontWeight","charAt","toUpperCase","jsxs","flex","minWidth","marginBottom","flexWrap","Link","to","textDecoration","StarRating","size","readonly","date","now","Date","then","diff","Math","floor","getTime","toLocaleDateString","timeAgo","created_at","review_text","lineHeight","margin","RatingSection","contentId","initialAverageRating","initialRatingCount","isAuthenticated","onAuthRequired","showForm","setShowForm","useState","showAll","setShowAll","ratings","myRating","isLoading","isSubmitting","error","averageRating","totalCount","submitMyRating","options","setRatings","setMyRating","setIsLoading","setIsSubmitting","setError","page","setPage","hasMore","setHasMore","setTotalCount","setAverageRating","fetchingRatings","useRef","fetchingMyRating","initialLoadDone","fetchRatings","useCallback","async","pageNum","append","current","response","getContentRatings","prev","newRatings","results","length","avg","reduce","sum","r","round","next","count","err","message","Error","includes","fetchMyRating","getMyRating","refresh","Promise","all","loadMore","reviewText","newRating","submitRating","findIndex","id","map","useEffect","useContentRatings","displayedRatings","slice","border","overflow","Star","fill","toFixed","Sparkles","onClick","cursor","RatingForm","onSubmit","transition","onMouseEnter","e","currentTarget","borderColor","onMouseLeave","textAlign","Fragment","index","marginTop","ChevronUp","ChevronDown","ContentDetail","useParams","navigate","useNavigate","data","setData","modalOpen","setModalOpen","setIsAuthenticated","collaboratorsExpanded","setCollaboratorsExpanded","abortController","AbortController","fetch","API_URL","credentials","signal","ok","json","contentData","authData","catch","name","method","abort","handleOpenPreview","minHeight","teaserUrl","content_type","teaser_link","collaborators","_a","c","role","revenuePercentage","revenue_percentage","priceNum","price_usd","parseFloat","priceText","editionsNum","editions","editionsText","maxWidth","ArrowLeft","gridTemplateColumns","position","aspectRatio","title","onError","_b","inset","opacity","AddToCartButton","parseInt","price","alreadyOwned","user_owns","creator_username","creator_avatar","User","dateString","year","month","day","is_collaborative","_c","paddingLeft","marginLeft","textTransform","genre","fantasy","scifi","nonfiction","drama","comedy","other","description","letterSpacing","series_info","book_count","authors_note","fontStyle","PreviewModal","open","onClose","contentType","isCollaborative","creatorUsername","creatorAvatar","likeCount","like_count","userHasLiked","user_has_liked","commentCount","comment_count"],"mappings":"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","x_google_ignoreList":[0]}