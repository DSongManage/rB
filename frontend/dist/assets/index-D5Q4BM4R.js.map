{"version":3,"mappings":"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","names":["g","globalThis","window","global","Buffer","process","on","emitter","EventEmitter","bind","once","off","emit","removeListener","removeAllListeners","listeners","env","API_URL","libraryApi","getLibrary","response","fetch","API_BASE","method","credentials","ok","Error","statusText","json","getFullContent","contentId","status","updateProgress","progressPercentage","lastPosition","csrfToken","async","data","error","getFreshCsrfToken","headers","body","JSON","stringify","content_id","progress_percentage","last_position","getProgress","getAllProgress","getComicReaderData","getComicPreviewData","LibraryItemCard","memo","item","onClick","Math","round","progress","relativeTime","dateString","date","Date","diffMs","getTime","diffSecs","floor","diffMins","diffHours","diffDays","getRelativeTime","last_read_at","jsxs","Link","to","id","className","style","display","gap","padding","background","border","borderRadius","textDecoration","color","transition","cursor","onMouseEnter","e","currentTarget","borderColor","onMouseLeave","children","position","width","height","flexShrink","overflow","jsx","src","thumbnail","alt","title","objectFit","onError","bottom","left","right","flex","flexDirection","justifyContent","minWidth","fontWeight","fontSize","marginBottom","textOverflow","whiteSpace","creator","alignItems","toPascalCase","string","camelCase","replace","match","p1","p2","toUpperCase","toLowerCase","toCamelCase","charAt","slice","mergeClasses","classes","filter","index","array","Boolean","trim","indexOf","join","hasA11yProp","props","prop","startsWith","defaultAttributes","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","Icon","forwardRef","size","absoluteStrokeWidth","iconNode","rest","ref","createElement","Number","map","tag","attrs","Array","isArray","createLucideIcon","iconName","Component","displayName","ArrowUpDown","d","key","Bell","BookMarked","BookOpen","ChevronDown","ChevronLeft","ChevronRight","ChevronUp","CircleCheckBig","Clock","cx","cy","r","DollarSign","x1","x2","y1","y2","FilePen","Film","x","y","rx","Image","ry","Library","LogOut","MailOpen","Mail","Menu","MessageSquare","Music","PartyPopper","Search","ShoppingCart","User","Users","X","useAuth","authState","setAuthState","useState","user","loading","isAuthenticated","checkAuth","useCallback","authenticated","logout","csrfResponse","csrfData","refreshAuth","prev","useEffect","LibrarySidebar","isExpanded","onExpandedChange","library","setLibrary","setLoading","setError","selectedTab","setSelectedTab","sortBy","setSortBy","localStorage","getItem","searchQuery","setSearchQuery","loadLibrary","err","message","top","borderRight","zIndex","writingMode","marginTop","totalItems","Object","values","reduce","sum","items","length","currentItems","sort","a","b","localeCompare","purchased_at","includes","continueReadingItems","flat","borderBottom","type","placeholder","value","onChange","target","outline","overflowX","tab","count","_a","isActive","disabled","opacity","handleSortChange","newSort","setItem","overflowY","textAlign","borderTop","flexWrap","footerLinkStyle","href","getFullYear","MobileLibraryCard","placeholderSvg","aspectRatio","TAB_ICONS","books","art","comics","film","music","MobileLibrary","isCollapsed","setIsCollapsed","newState","String","LibraryIcon","margin","Fragment","gridTemplateColumns","WebkitOverflowScrolling","paddingBottom","scrollbarWidth","msOverflowStyle","getState","innerWidth","isMobile","isPhone","isTablet","isDesktop","screenWidth","useMobile","state","setState","handleResize","addEventListener","removeEventListener","ProtectedRoute","setIsAuthenticated","location","useLocation","Navigate","from","ErrorBoundary","constructor","super","__publicField","this","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","render","fallback","minHeight","handleRetry","notifications","unreadCount","lastChecked","isPolling","lastError","knownNotificationIds","Set","initialLoadComplete","CONFIG","POLLING_INTERVAL","MAX_RETRIES","RETRY_DELAY","getCsrfToken","apiRequest","url","options","fullUrl","errorData","catch","getNotifications","n","read","forEach","add","events","pollingInterval","retryCount","retryTimeout","pollNotifications","previouslyKnownIds","newNotifications","has","stopPolling","setTimeout","startPolling","setInterval","clearInterval","clearTimeout","Map","event","handler","set","get","handlers","delete","clear","getTimeAgo","now","seconds","toLocaleDateString","getNotificationIcon","invitation","invitation_response","comment","approval","section_update","revenue_proposal","mint_ready","getNotificationColor","notificationService","getUnreadNotifications","getUnreadCount","markNotificationRead","notificationId","notification","find","max","markAllNotificationsRead","deleteNotification","removeFromLocalState","findIndex","wasUnread","splice","getNotificationStats","stats","total","unread","by_type","setPollingInterval","intervalMs","getCachedNotifications","getCachedUnreadCount","reset","useNotifications","autoStart","onNewNotification","setNotifications","setUnreadCount","isLoading","setIsLoading","setIsPolling","refresh","markAsRead","markAllAsRead","deleteNotificationCallback","startPollingCallback","stopPollingCallback","getStats","unsubUpdated","unsubUnreadCount","unsubNew","newNotifs","unsubPollingStarted","unsubPollingStopped","unsubPollingError","NotificationItem","onDelete","onViewInvite","icon","iconProps","CheckCircle","FileEdit","getNotificationLucideIcon","timeAgo","created_at","isInvitation","role","tabIndex","onKeyDown","preventDefault","borderLeft","lineHeight","from_user","username","stopPropagation","boxShadow","handleResponse","errorMessage","detail","collaborationApi","createCollaborativeProject","deleteCollaborativeProject","projectId","splits","getApprovalStatus","project","getCollaborativeProject","pendingApprovals","collaborators","c","approved_current_version","approved_revenue_split","is_fully_approved","pending_approvals","createProjectSection","formData","FormData","append","toString","section_type","content_html","media_file","order","updateProjectSection","deleteProjectSection","addComment","attachments","content","section","parent_comment","mentions","file","getComments","sectionId","commentId","deleteComment","emoji","removeReaction","reactionId","reaction_id","getCommentsBySection","includeResolved","getUnresolvedCommentCount","resolved","priceUsd","price_usd","settings","forceMint","force_mint","proposalId","ratedUserId","rated_user_id","userId","pageId","deleteComicPage","newPosition","new_position","panelId","deleteComicPanel","uploadPanelArtwork","artworkFile","panels","bubbleId","deleteSpeechBubble","bubbles","lineId","deleteDividerLine","lines","clearExisting","page","clear_existing","seriesId","deleteComicSeries","getComicIssues","params","queryParams","URLSearchParams","series","issueId","deleteComicIssue","uploadArtworkToLibrary","deleteArtworkFromLibrary","artworkId","InviteResponseModal","open","onClose","notificationMessage","navigate","useNavigate","setProject","myRole","setMyRole","mode","setMode","proposedPercentage","setProposedPercentage","counterMessage","setCounterMessage","submitting","setSubmitting","success","setSuccess","invitedRole","revenue_percentage","loadProject","handleDecline","declineInvitation","created_by","othersPercentage","hasCounterProposal","proposed_percentage","abs","placeItems","maxWidth","maxHeight","book","video","content_type","description","textTransform","contract_tasks","task","deadline","weekday","month","day","year","label","can_edit_text","can_edit_images","can_edit_audio","can_edit_video","perm","acceptInvitation","min","step","parseInt","resize","counterProposeInvite","NotificationDropdown","isOpen","anchorEl","panelRef","useRef","inviteModalOpen","setInviteModalOpen","selectedInvite","setSelectedInvite","recentNotifications","handleViewInvite","handleClickOutside","current","contains","timer","document","handleEscape","action_url","project_id","handleNotificationClick","handleDelete","NotificationBell","setIsOpen","isAnimating","setIsAnimating","bellRef","useUnreadCount","unsubscribe","animation","transformOrigin","NotificationToast","onDismiss","autoDismissMs","isExiting","setIsExiting","handleDismiss","transform","NotificationToastContainer","toasts","setToasts","pointerEvents","FeedbackModal","feedback","setFeedback","email","setEmail","submitted","setSubmitted","onSubmit","required","rows","fontFamily","BetaBadge","variant","showTestMode","letterSpacing","marginLeft","TestModeBanner","showFeedback","setShowFeedback","BetaWelcomeModal","paddingLeft","BetaOnboarding","showWelcome","setShowWelcome","hasSeenWelcome","lastSeenUserId","Footer","currentYear","linkStyle","paddingTop","COOKIE_CONSENT_KEY","CookieBanner","isVisible","setIsVisible","showCustomize","setShowCustomize","preferences","setPreferences","necessary","analytics","marketing","saveConsent","prefs","timestamp","toISOString","handleRejectNonEssential","checked","CartContext","createContext","CartProvider","cart","setCart","getCSRFToken","res","refreshCart","Provider","addToCart","chapterId","chapter_id","removeFromCart","itemId","clearCart","checkout","checkout_url","isInCart","some","item_id","useCart","context","useContext","CartIcon","itemCount","item_count","backgroundColor","RECENT_SEARCHES_KEY","SearchAutocomplete","onSearch","query","setQuery","suggestions","setSuggestions","recentSearches","setRecentSearches","selectedIndex","setSelectedIndex","inputRef","containerRef","stored","parse","encodeURIComponent","then","finally","handleSearch","search","updated","s","saveRecentSearch","showDropdown","onFocus","selected","_b","blur","autoComplete","creator_username","removeRecentSearch","HomePage","lazy","__vitePreload","import","__VITE_PRELOAD__","SearchPage","StudioPage","DashboardPage","ProfilePage","AuthPage","WalletInfoPage","BetaLanding","CollaboratorsPage","PublicProfilePage","ContentDetail","PurchaseSuccessPage","ReaderPage","m","default","CollaborationDashboard","CollaborativeProjectPage","NotificationsPage","FollowingFeedPage","CartPage","CartSuccessPage","PayoutSettingsPage","TermsOfServicePage","PrivacyPolicyPage","ContentPolicyPage","DMCAPolicyPage","CreatorAgreementPage","PageLoader","Header","isAuthed","setIsAuthed","setUsername","avatarUrl","setAvatarUrl","mobileMenuOpen","setMobileMenuOpen","pathname","React","authed","avatar_url","interval","t","j","App","libraryExpanded","setLibraryExpanded","showLibrarySidebar","test","showMobileLibrary","isReaderPage","showFooter","isPublicRoute","route","Suspense","Routes","Route","path","element","marginRight","ReactDOM","createRoot","getElementById","StrictMode","BrowserRouter"],"ignoreList":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],"sources":["../../src/polyfills.ts","../../src/config.ts","../../src/services/libraryApi.ts","../../src/components/LibraryItemCard.tsx","../../node_modules/lucide-react/dist/esm/shared/src/utils.js","../../node_modules/lucide-react/dist/esm/defaultAttributes.js","../../node_modules/lucide-react/dist/esm/Icon.js","../../node_modules/lucide-react/dist/esm/createLucideIcon.js","../../node_modules/lucide-react/dist/esm/icons/arrow-up-down.js","../../node_modules/lucide-react/dist/esm/icons/bell.js","../../node_modules/lucide-react/dist/esm/icons/book-marked.js","../../node_modules/lucide-react/dist/esm/icons/book-open.js","../../node_modules/lucide-react/dist/esm/icons/chevron-down.js","../../node_modules/lucide-react/dist/esm/icons/chevron-left.js","../../node_modules/lucide-react/dist/esm/icons/chevron-right.js","../../node_modules/lucide-react/dist/esm/icons/chevron-up.js","../../node_modules/lucide-react/dist/esm/icons/circle-check-big.js","../../node_modules/lucide-react/dist/esm/icons/clock.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/file-pen.js","../../node_modules/lucide-react/dist/esm/icons/film.js","../../node_modules/lucide-react/dist/esm/icons/image.js","../../node_modules/lucide-react/dist/esm/icons/library.js","../../node_modules/lucide-react/dist/esm/icons/log-out.js","../../node_modules/lucide-react/dist/esm/icons/mail-open.js","../../node_modules/lucide-react/dist/esm/icons/mail.js","../../node_modules/lucide-react/dist/esm/icons/menu.js","../../node_modules/lucide-react/dist/esm/icons/message-square.js","../../node_modules/lucide-react/dist/esm/icons/music.js","../../node_modules/lucide-react/dist/esm/icons/party-popper.js","../../node_modules/lucide-react/dist/esm/icons/search.js","../../node_modules/lucide-react/dist/esm/icons/shopping-cart.js","../../node_modules/lucide-react/dist/esm/icons/user.js","../../node_modules/lucide-react/dist/esm/icons/users.js","../../node_modules/lucide-react/dist/esm/icons/x.js","../../src/hooks/useAuth.ts","../../src/components/LibrarySidebar.tsx","../../src/components/MobileLibraryCard.tsx","../../src/components/MobileLibrary.tsx","../../src/hooks/useMobile.ts","../../src/components/ProtectedRoute.tsx","../../src/components/ErrorBoundary.tsx","../../src/services/notificationService.ts","../../src/hooks/useNotifications.ts","../../src/components/notifications/NotificationItem.tsx","../../src/services/collaborationApi.ts","../../src/components/collaboration/InviteResponseModal.tsx","../../src/components/notifications/NotificationDropdown.tsx","../../src/components/notifications/NotificationBell.tsx","../../src/components/notifications/NotificationToast.tsx","../../src/components/notifications/NotificationToastContainer.tsx","../../src/components/FeedbackModal.tsx","../../src/components/BetaBadge.tsx","../../src/components/BetaOnboarding.tsx","../../src/components/legal/Footer.tsx","../../src/components/legal/CookieBanner.tsx","../../src/contexts/CartContext.tsx","../../src/components/CartIcon.tsx","../../src/components/SearchAutocomplete.tsx","../../src/App.tsx","../../src/index.tsx"],"sourcesContent":["// Global polyfills for browser runtime (Vite)\nimport { Buffer } from 'buffer';\nimport process from 'process';\nimport { EventEmitter } from 'events';\n\nconst g: any = (typeof globalThis !== 'undefined' ? globalThis : window) as any;\n\n// Polyfill global\nif (!g.global) g.global = g;\n\n// Polyfill Buffer\nif (!g.Buffer) g.Buffer = Buffer;\n\n// Polyfill process with EventEmitter methods\nif (!g.process) {\n  g.process = process;\n}\n\n// Ensure process has EventEmitter methods (for end-of-stream)\nif (g.process && !g.process.on) {\n  const emitter = new EventEmitter();\n  g.process.on = emitter.on.bind(emitter);\n  g.process.once = emitter.once.bind(emitter);\n  g.process.off = emitter.off.bind(emitter);\n  g.process.emit = emitter.emit.bind(emitter);\n  g.process.removeListener = emitter.removeListener.bind(emitter);\n  g.process.removeAllListeners = emitter.removeAllListeners.bind(emitter);\n  g.process.listeners = emitter.listeners.bind(emitter);\n}\n\nif (!g.process.env) g.process.env = {};\n","// API Configuration\n// In development, use empty string to leverage Vite's proxy (same-origin requests)\n// This ensures cookies work correctly regardless of localhost vs 127.0.0.1\n// In production, use the full API URL from environment\nconst isDev = import.meta.env.DEV;\nexport const API_URL = isDev ? '' : (import.meta.env.VITE_API_URL || '');\n\nexport const appConfig = {\n  showTeasers: import.meta.env.VITE_SHOW_TEASERS !== 'false',\n};\n","/**\n * Library API Service\n *\n * Provides functions for accessing user's library and reading progress.\n */\n\nimport { API_URL as API_BASE } from '../config';\n\nexport interface LibraryItem {\n  id: number;\n  title: string;\n  creator: string;\n  thumbnail: string;\n  content_type: string;\n  purchased_at: string;\n  progress: number;\n  last_read_at: string | null;\n}\n\nexport interface Library {\n  books: LibraryItem[];\n  art: LibraryItem[];\n  film: LibraryItem[];\n  music: LibraryItem[];\n  comics: LibraryItem[];\n}\n\n// Comic Reader Data Types\nexport interface DividerLineData {\n  id: number;\n  line_type: 'straight' | 'bezier';\n  start_x: number;\n  start_y: number;\n  end_x: number;\n  end_y: number;\n  control1_x?: number;\n  control1_y?: number;\n  control2_x?: number;\n  control2_y?: number;\n  thickness: number;\n  color: string;\n  order: number;\n}\n\nexport interface SpeechBubbleData {\n  id: number;\n  bubble_type: string;\n  x_percent: number;\n  y_percent: number;\n  width_percent: number;\n  height_percent: number;\n  z_index: number;\n  text: string;\n  font_family: string;\n  font_size: number;\n  font_color: string;\n  font_weight: string;\n  font_style: string;\n  text_align: string;\n  background_color: string;\n  border_color: string;\n  border_width: number;\n  pointer_direction: string;\n  pointer_position: number;\n  order: number;\n}\n\nexport interface ComicPanelData {\n  id: number;\n  x_percent: number;\n  y_percent: number;\n  width_percent: number;\n  height_percent: number;\n  z_index: number;\n  border_style: string;\n  border_width: number;\n  border_color: string;\n  border_radius: number;\n  background_color: string;\n  rotation: number;\n  skew_x: number;\n  skew_y: number;\n  artwork?: string;\n  artwork_fit: string;\n  order: number;\n  speech_bubbles: SpeechBubbleData[];\n}\n\nexport interface ComicPageData {\n  id: number;\n  page_number: number;\n  page_format: string;\n  canvas_width: number;\n  canvas_height: number;\n  background_image?: string;\n  background_color: string;\n  panels: ComicPanelData[];\n  divider_lines: DividerLineData[];\n  // Line-based layout fields\n  orientation?: string;\n  gutter_mode?: string;\n  default_gutter_width?: number;\n  default_line_color?: string;\n  layout_version?: number;\n}\n\nexport interface ComicReaderData {\n  content_id: number;\n  title: string;\n  creator: string;\n  total_pages: number;\n  pages: ComicPageData[];\n}\n\nexport interface ComicPreviewData {\n  content_id: number;\n  title: string;\n  creator: string;\n  total_pages: number;\n  preview_pages: number;\n  pages: ComicPageData[];\n  is_preview: boolean;\n}\n\nexport interface FullContent {\n  id: number;\n  title: string;\n  content_html: string;\n  creator: string;\n  content_type: string;\n  owned: boolean;\n  teaser_link?: string | null;\n}\n\nexport interface ReadingProgress {\n  id?: number;\n  user?: number;\n  content: number;\n  progress_percentage: number;\n  last_position: string;\n  last_read_at?: string;\n  created_at?: string;\n}\n\n/**\n * Get fresh CSRF token from API\n * This is more reliable than reading from cookies\n */\nasync function getFreshCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_BASE}/api/auth/csrf/`, {\n      credentials: 'include',\n    });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to fetch CSRF token:', error);\n    return '';\n  }\n}\n\nexport const libraryApi = {\n  /**\n   * Get user's library grouped by content type\n   */\n  async getLibrary(): Promise<Library> {\n    const response = await fetch(`${API_BASE}/api/library/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch library: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get full content for owned items\n   */\n  async getFullContent(contentId: number): Promise<FullContent> {\n    const response = await fetch(`${API_BASE}/api/content/${contentId}/full/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      if (response.status === 403) {\n        throw new Error('You do not own this content');\n      }\n      throw new Error(`Failed to fetch content: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Update reading progress for content\n   */\n  async updateProgress(\n    contentId: number,\n    progressPercentage: number,\n    lastPosition: string = ''\n  ): Promise<ReadingProgress> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/reading-progress/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({\n        content_id: contentId,\n        progress_percentage: progressPercentage,\n        last_position: lastPosition,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to update progress: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get reading progress for specific content\n   */\n  async getProgress(contentId: number): Promise<ReadingProgress> {\n    const response = await fetch(`${API_BASE}/api/reading-progress/${contentId}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch progress: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get all reading progress for user\n   */\n  async getAllProgress(): Promise<ReadingProgress[]> {\n    const response = await fetch(`${API_BASE}/api/reading-progress/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch all progress: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get comic reader data (pages, panels, speech bubbles) for owned comics\n   */\n  async getComicReaderData(contentId: number): Promise<ComicReaderData> {\n    const response = await fetch(`${API_BASE}/api/content/${contentId}/comic-reader-data/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      if (response.status === 403) {\n        throw new Error('You do not own this content');\n      }\n      if (response.status === 404) {\n        throw new Error('Comic data not found');\n      }\n      throw new Error(`Failed to fetch comic data: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get comic preview data (limited pages for non-owners)\n   */\n  async getComicPreviewData(contentId: number): Promise<ComicPreviewData> {\n    const response = await fetch(`${API_BASE}/api/content/${contentId}/comic-preview/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      if (response.status === 404) {\n        throw new Error('Comic data not found');\n      }\n      throw new Error(`Failed to fetch comic preview: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n};\n","import React, { memo } from 'react';\nimport { Link } from 'react-router-dom';\nimport type { LibraryItem } from '../services/libraryApi';\n\ninterface LibraryItemCardProps {\n  item: LibraryItem;\n  onClick?: () => void;\n}\n\n// Helper to format relative time\nfunction getRelativeTime(dateString: string | null): string | null {\n  if (!dateString) return null;\n\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffSecs = Math.floor(diffMs / 1000);\n  const diffMins = Math.floor(diffSecs / 60);\n  const diffHours = Math.floor(diffMins / 60);\n  const diffDays = Math.floor(diffHours / 24);\n\n  if (diffSecs < 60) return 'Just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  if (diffHours < 24) return `${diffHours}h ago`;\n  if (diffDays === 1) return 'Yesterday';\n  if (diffDays < 7) return `${diffDays}d ago`;\n  if (diffDays < 30) return `${Math.floor(diffDays / 7)}w ago`;\n  return `${Math.floor(diffDays / 30)}mo ago`;\n}\n\nfunction LibraryItemCardComponent({ item, onClick }: LibraryItemCardProps) {\n  const progressPercentage = Math.round(item.progress);\n  const relativeTime = getRelativeTime(item.last_read_at);\n\n  return (\n    <Link\n      to={`/reader/${item.id}`}\n      className=\"library-item-card\"\n      onClick={onClick}\n      style={{\n        display: 'flex',\n        gap: 12,\n        padding: 12,\n        background: '#0b1220',\n        border: '1px solid #2a3444',\n        borderRadius: 8,\n        textDecoration: 'none',\n        color: 'inherit',\n        transition: 'all 0.2s ease',\n        cursor: 'pointer',\n      }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.background = '#111827';\n        e.currentTarget.style.borderColor = '#374151';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = '#0b1220';\n        e.currentTarget.style.borderColor = '#2a3444';\n      }}\n    >\n      {/* Thumbnail */}\n      <div\n        style={{\n          position: 'relative',\n          width: 80,\n          height: 80,\n          flexShrink: 0,\n          borderRadius: 6,\n          overflow: 'hidden',\n          background: '#0e1320',\n        }}\n      >\n        <img\n          src={item.thumbnail || 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"80\" height=\"80\"%3E%3Crect fill=\"%23111827\" width=\"80\" height=\"80\"/%3E%3Ctext fill=\"%2394a3b8\" font-family=\"sans-serif\" font-size=\"12\" x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dominant-baseline=\"middle\"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E'}\n          alt={item.title}\n          style={{\n            width: '100%',\n            height: '100%',\n            objectFit: 'cover',\n          }}\n          onError={(e: React.SyntheticEvent<HTMLImageElement>) => {\n            e.currentTarget.src = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"80\" height=\"80\"%3E%3Crect fill=\"%23111827\" width=\"80\" height=\"80\"/%3E%3Ctext fill=\"%2394a3b8\" font-family=\"sans-serif\" font-size=\"12\" x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dominant-baseline=\"middle\"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E';\n          }}\n        />\n        {/* Progress bar - always show */}\n        <div\n          style={{\n            position: 'absolute',\n            bottom: 0,\n            left: 0,\n            right: 0,\n            height: 4,\n            background: 'rgba(0,0,0,0.5)',\n          }}\n        >\n          <div\n            style={{\n              height: '100%',\n              width: `${item.progress}%`,\n              background: progressPercentage === 100 ? '#10b981' : '#f59e0b',\n              transition: 'width 0.3s ease',\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Content info */}\n      <div\n        style={{\n          flex: 1,\n          display: 'flex',\n          flexDirection: 'column',\n          justifyContent: 'space-between',\n          minWidth: 0,\n        }}\n      >\n        <div>\n          <div\n            style={{\n              fontWeight: 600,\n              fontSize: 14,\n              color: '#e5e7eb',\n              marginBottom: 4,\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap',\n            }}\n          >\n            {item.title}\n          </div>\n          <div\n            style={{\n              fontSize: 12,\n              color: '#94a3b8',\n            }}\n          >\n            {item.creator}\n          </div>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n          <span\n            style={{\n              fontSize: 11,\n              color: progressPercentage === 100 ? '#10b981' : progressPercentage > 0 ? '#f59e0b' : '#64748b',\n              fontWeight: 600,\n            }}\n          >\n            {progressPercentage === 100 ? 'Finished' : progressPercentage > 0 ? `${progressPercentage}% complete` : 'Not started'}\n          </span>\n          {relativeTime && progressPercentage > 0 && (\n            <span style={{ fontSize: 10, color: '#64748b' }}>\n               {relativeTime}\n            </span>\n          )}\n        </div>\n      </div>\n    </Link>\n  );\n}\n\nexport const LibraryItemCard = memo(LibraryItemCardComponent);\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst toCamelCase = (string) => string.replace(\n  /^([A-Z])|[\\s-_]+(\\w)/g,\n  (match, p1, p2) => p2 ? p2.toUpperCase() : p1.toLowerCase()\n);\nconst toPascalCase = (string) => {\n  const camelCase = toCamelCase(string);\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n};\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\nconst hasA11yProp = (props) => {\n  for (const prop in props) {\n    if (prop.startsWith(\"aria-\") || prop === \"role\" || prop === \"title\") {\n      return true;\n    }\n  }\n};\n\nexport { hasA11yProp, mergeClasses, toCamelCase, toKebabCase, toPascalCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses, hasA11yProp } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => createElement(\n    \"svg\",\n    {\n      ref,\n      ...defaultAttributes,\n      width: size,\n      height: size,\n      stroke: color,\n      strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n      className: mergeClasses(\"lucide\", className),\n      ...!children && !hasA11yProp(rest) && { \"aria-hidden\": \"true\" },\n      ...rest\n    },\n    [\n      ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n      ...Array.isArray(children) ? children : [children]\n    ]\n  )\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className\n      ),\n      ...props\n    })\n  );\n  Component.displayName = toPascalCase(iconName);\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m21 16-4 4-4-4\", key: \"f6ql7i\" }],\n  [\"path\", { d: \"M17 20V4\", key: \"1ejh1v\" }],\n  [\"path\", { d: \"m3 8 4-4 4 4\", key: \"11wl7u\" }],\n  [\"path\", { d: \"M7 4v16\", key: \"1glfcx\" }]\n];\nconst ArrowUpDown = createLucideIcon(\"arrow-up-down\", __iconNode);\n\nexport { __iconNode, ArrowUpDown as default };\n//# sourceMappingURL=arrow-up-down.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10.268 21a2 2 0 0 0 3.464 0\", key: \"vwvbt9\" }],\n  [\n    \"path\",\n    {\n      d: \"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326\",\n      key: \"11g9vi\"\n    }\n  ]\n];\nconst Bell = createLucideIcon(\"bell\", __iconNode);\n\nexport { __iconNode, Bell as default };\n//# sourceMappingURL=bell.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 2v8l3-3 3 3V2\", key: \"sqw3rj\" }],\n  [\n    \"path\",\n    {\n      d: \"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20\",\n      key: \"k3hazp\"\n    }\n  ]\n];\nconst BookMarked = createLucideIcon(\"book-marked\", __iconNode);\n\nexport { __iconNode, BookMarked as default };\n//# sourceMappingURL=book-marked.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 7v14\", key: \"1akyts\" }],\n  [\n    \"path\",\n    {\n      d: \"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z\",\n      key: \"ruj8y\"\n    }\n  ]\n];\nconst BookOpen = createLucideIcon(\"book-open\", __iconNode);\n\nexport { __iconNode, BookOpen as default };\n//# sourceMappingURL=book-open.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m6 9 6 6 6-6\", key: \"qrunsl\" }]];\nconst ChevronDown = createLucideIcon(\"chevron-down\", __iconNode);\n\nexport { __iconNode, ChevronDown as default };\n//# sourceMappingURL=chevron-down.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]];\nconst ChevronLeft = createLucideIcon(\"chevron-left\", __iconNode);\n\nexport { __iconNode, ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]];\nconst ChevronRight = createLucideIcon(\"chevron-right\", __iconNode);\n\nexport { __iconNode, ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m18 15-6-6-6 6\", key: \"153udz\" }]];\nconst ChevronUp = createLucideIcon(\"chevron-up\", __iconNode);\n\nexport { __iconNode, ChevronUp as default };\n//# sourceMappingURL=chevron-up.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21.801 10A10 10 0 1 1 17 3.335\", key: \"yps3ct\" }],\n  [\"path\", { d: \"m9 11 3 3L22 4\", key: \"1pflzl\" }]\n];\nconst CircleCheckBig = createLucideIcon(\"circle-check-big\", __iconNode);\n\nexport { __iconNode, CircleCheckBig as default };\n//# sourceMappingURL=circle-check-big.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 6v6l4 2\", key: \"mmk7yg\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Clock = createLucideIcon(\"clock\", __iconNode);\n\nexport { __iconNode, Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34\",\n      key: \"o6klzx\"\n    }\n  ],\n  [\"path\", { d: \"M14 2v5a1 1 0 0 0 1 1h5\", key: \"wfsgrz\" }],\n  [\n    \"path\",\n    {\n      d: \"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z\",\n      key: \"zhnas1\"\n    }\n  ]\n];\nconst FilePen = createLucideIcon(\"file-pen\", __iconNode);\n\nexport { __iconNode, FilePen as default };\n//# sourceMappingURL=file-pen.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", key: \"afitv7\" }],\n  [\"path\", { d: \"M7 3v18\", key: \"bbkbws\" }],\n  [\"path\", { d: \"M3 7.5h4\", key: \"zfgn84\" }],\n  [\"path\", { d: \"M3 12h18\", key: \"1i2n21\" }],\n  [\"path\", { d: \"M3 16.5h4\", key: \"1230mu\" }],\n  [\"path\", { d: \"M17 3v18\", key: \"in4fa5\" }],\n  [\"path\", { d: \"M17 7.5h4\", key: \"myr1c1\" }],\n  [\"path\", { d: \"M17 16.5h4\", key: \"go4c1d\" }]\n];\nconst Film = createLucideIcon(\"film\", __iconNode);\n\nexport { __iconNode, Film as default };\n//# sourceMappingURL=film.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", ry: \"2\", key: \"1m3agn\" }],\n  [\"circle\", { cx: \"9\", cy: \"9\", r: \"2\", key: \"af1f0g\" }],\n  [\"path\", { d: \"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\", key: \"1xmnt7\" }]\n];\nconst Image = createLucideIcon(\"image\", __iconNode);\n\nexport { __iconNode, Image as default };\n//# sourceMappingURL=image.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m16 6 4 14\", key: \"ji33uf\" }],\n  [\"path\", { d: \"M12 6v14\", key: \"1n7gus\" }],\n  [\"path\", { d: \"M8 8v12\", key: \"1gg7y9\" }],\n  [\"path\", { d: \"M4 4v16\", key: \"6qkkli\" }]\n];\nconst Library = createLucideIcon(\"library\", __iconNode);\n\nexport { __iconNode, Library as default };\n//# sourceMappingURL=library.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m16 17 5-5-5-5\", key: \"1bji2h\" }],\n  [\"path\", { d: \"M21 12H9\", key: \"dn1m92\" }],\n  [\"path\", { d: \"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\", key: \"1uf3rs\" }]\n];\nconst LogOut = createLucideIcon(\"log-out\", __iconNode);\n\nexport { __iconNode, LogOut as default };\n//# sourceMappingURL=log-out.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z\",\n      key: \"1jhwl8\"\n    }\n  ],\n  [\"path\", { d: \"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10\", key: \"1qfld7\" }]\n];\nconst MailOpen = createLucideIcon(\"mail-open\", __iconNode);\n\nexport { __iconNode, MailOpen as default };\n//# sourceMappingURL=mail-open.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7\", key: \"132q7q\" }],\n  [\"rect\", { x: \"2\", y: \"4\", width: \"20\", height: \"16\", rx: \"2\", key: \"izxlao\" }]\n];\nconst Mail = createLucideIcon(\"mail\", __iconNode);\n\nexport { __iconNode, Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4 5h16\", key: \"1tepv9\" }],\n  [\"path\", { d: \"M4 12h16\", key: \"1lakjw\" }],\n  [\"path\", { d: \"M4 19h16\", key: \"1djgab\" }]\n];\nconst Menu = createLucideIcon(\"menu\", __iconNode);\n\nexport { __iconNode, Menu as default };\n//# sourceMappingURL=menu.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z\",\n      key: \"18887p\"\n    }\n  ]\n];\nconst MessageSquare = createLucideIcon(\"message-square\", __iconNode);\n\nexport { __iconNode, MessageSquare as default };\n//# sourceMappingURL=message-square.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M9 18V5l12-2v13\", key: \"1jmyc2\" }],\n  [\"circle\", { cx: \"6\", cy: \"18\", r: \"3\", key: \"fqmcym\" }],\n  [\"circle\", { cx: \"18\", cy: \"16\", r: \"3\", key: \"1hluhg\" }]\n];\nconst Music = createLucideIcon(\"music\", __iconNode);\n\nexport { __iconNode, Music as default };\n//# sourceMappingURL=music.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M5.8 11.3 2 22l10.7-3.79\", key: \"gwxi1d\" }],\n  [\"path\", { d: \"M4 3h.01\", key: \"1vcuye\" }],\n  [\"path\", { d: \"M22 8h.01\", key: \"1mrtc2\" }],\n  [\"path\", { d: \"M15 2h.01\", key: \"1cjtqr\" }],\n  [\"path\", { d: \"M22 20h.01\", key: \"1mrys2\" }],\n  [\n    \"path\",\n    {\n      d: \"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10\",\n      key: \"hbicv8\"\n    }\n  ],\n  [\n    \"path\",\n    { d: \"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17\", key: \"1i94pl\" }\n  ],\n  [\"path\", { d: \"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7\", key: \"1cofks\" }],\n  [\n    \"path\",\n    {\n      d: \"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z\",\n      key: \"4kbmks\"\n    }\n  ]\n];\nconst PartyPopper = createLucideIcon(\"party-popper\", __iconNode);\n\nexport { __iconNode, PartyPopper as default };\n//# sourceMappingURL=party-popper.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m21 21-4.34-4.34\", key: \"14j7rj\" }],\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }]\n];\nconst Search = createLucideIcon(\"search\", __iconNode);\n\nexport { __iconNode, Search as default };\n//# sourceMappingURL=search.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"8\", cy: \"21\", r: \"1\", key: \"jimo8o\" }],\n  [\"circle\", { cx: \"19\", cy: \"21\", r: \"1\", key: \"13723u\" }],\n  [\n    \"path\",\n    {\n      d: \"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12\",\n      key: \"9zh506\"\n    }\n  ]\n];\nconst ShoppingCart = createLucideIcon(\"shopping-cart\", __iconNode);\n\nexport { __iconNode, ShoppingCart as default };\n//# sourceMappingURL=shopping-cart.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\", key: \"975kel\" }],\n  [\"circle\", { cx: \"12\", cy: \"7\", r: \"4\", key: \"17ys0d\" }]\n];\nconst User = createLucideIcon(\"user\", __iconNode);\n\nexport { __iconNode, User as default };\n//# sourceMappingURL=user.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\", key: \"1yyitq\" }],\n  [\"path\", { d: \"M16 3.128a4 4 0 0 1 0 7.744\", key: \"16gr8j\" }],\n  [\"path\", { d: \"M22 21v-2a4 4 0 0 0-3-3.87\", key: \"kshegd\" }],\n  [\"circle\", { cx: \"9\", cy: \"7\", r: \"4\", key: \"nufk8\" }]\n];\nconst Users = createLucideIcon(\"users\", __iconNode);\n\nexport { __iconNode, Users as default };\n//# sourceMappingURL=users.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n];\nconst X = createLucideIcon(\"x\", __iconNode);\n\nexport { __iconNode, X as default };\n//# sourceMappingURL=x.js.map\n","import { useState, useEffect, useCallback } from 'react';\nimport { API_URL } from '../config';\n\n/**\n * Authentication hook\n *\n * Provides authentication state and methods for the entire app.\n * Checks auth status on mount and provides loading state.\n */\n\ninterface User {\n  id: number;\n  username: string;\n  email?: string;\n  display_name?: string;\n  avatar?: string;\n}\n\ninterface AuthState {\n  user: User | null;\n  loading: boolean;\n  isAuthenticated: boolean;\n}\n\nexport const useAuth = () => {\n  const [authState, setAuthState] = useState<AuthState>({\n    user: null,\n    loading: true,\n    isAuthenticated: false,\n  });\n\n  const checkAuth = useCallback(async () => {\n    try {\n      const response = await fetch(`${API_URL}/api/auth/status/`, {\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        setAuthState({\n          user: null,\n          loading: false,\n          isAuthenticated: false,\n        });\n        return;\n      }\n\n      const data = await response.json();\n\n      if (data?.authenticated && data?.user) {\n        setAuthState({\n          user: data.user,\n          loading: false,\n          isAuthenticated: true,\n        });\n      } else {\n        setAuthState({\n          user: null,\n          loading: false,\n          isAuthenticated: false,\n        });\n      }\n    } catch (error) {\n      console.error('[useAuth] Auth check failed:', error);\n      setAuthState({\n        user: null,\n        loading: false,\n        isAuthenticated: false,\n      });\n    }\n  }, []);\n\n  const logout = useCallback(async () => {\n    try {\n      // Get CSRF token\n      const csrfResponse = await fetch(`${API_URL}/api/auth/csrf/`, {\n        credentials: 'include',\n      });\n      const csrfData = await csrfResponse.json();\n      const csrfToken = csrfData?.csrfToken || '';\n\n      // Logout\n      await fetch(`${API_URL}/api/auth/logout/`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': csrfToken,\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n      });\n\n      // Update state\n      setAuthState({\n        user: null,\n        loading: false,\n        isAuthenticated: false,\n      });\n    } catch (error) {\n      console.error('Logout failed:', error);\n    }\n  }, []);\n\n  const refreshAuth = useCallback(() => {\n    setAuthState(prev => ({ ...prev, loading: true }));\n    checkAuth();\n  }, [checkAuth]);\n\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  return {\n    user: authState.user,\n    loading: authState.loading,\n    isAuthenticated: authState.isAuthenticated,\n    logout,\n    refreshAuth,\n  };\n};\n\nexport default useAuth;\n","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { libraryApi, type Library } from '../services/libraryApi';\nimport { LibraryItemCard } from './LibraryItemCard';\nimport { ChevronRight, ChevronLeft, BookOpen, Image, BookMarked, Film, Music, ArrowUpDown, Search, X } from 'lucide-react';\nimport { useAuth } from '../hooks/useAuth';\n\ninterface LibrarySidebarProps {\n  isExpanded: boolean;\n  onExpandedChange: (expanded: boolean) => void;\n}\n\ntype SortOption = 'recent' | 'progress' | 'az';\n\nexport function LibrarySidebar({ isExpanded, onExpandedChange }: LibrarySidebarProps) {\n  const [library, setLibrary] = useState<Library | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedTab, setSelectedTab] = useState<keyof Library>('books');\n  const [sortBy, setSortBy] = useState<SortOption>(() => {\n    const saved = localStorage.getItem('library-sort');\n    return (saved as SortOption) || 'recent';\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n  const { isAuthenticated } = useAuth();\n\n  // Save sort preference to localStorage\n  const handleSortChange = (newSort: SortOption) => {\n    setSortBy(newSort);\n    localStorage.setItem('library-sort', newSort);\n  };\n\n  useEffect(() => {\n    // Only load library if user is authenticated\n    if (isAuthenticated) {\n      loadLibrary();\n    } else {\n      // Reset state if user is not authenticated\n      setLibrary(null);\n      setLoading(false);\n      setError(null);\n    }\n  }, [isAuthenticated]);\n\n  const loadLibrary = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await libraryApi.getLibrary();\n      setLibrary(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load library');\n      console.error('Library load error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Don't render anything if not authenticated\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  if (!isExpanded) {\n    return (\n      <div\n        style={{\n          position: 'fixed',\n          left: 0,\n          top: 72,\n          bottom: 0,\n          width: 48,\n          background: '#0b1220',\n          borderRight: '1px solid #2a3444',\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          padding: '12px 0',\n          zIndex: 40,\n        }}\n      >\n        <button\n          onClick={() => onExpandedChange(true)}\n          style={{\n            background: 'transparent',\n            border: 'none',\n            color: '#94a3b8',\n            cursor: 'pointer',\n            padding: 8,\n            borderRadius: 8,\n            transition: 'all 0.2s ease',\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.background = '#111827';\n            e.currentTarget.style.color = '#e5e7eb';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.background = 'transparent';\n            e.currentTarget.style.color = '#94a3b8';\n          }}\n          aria-label=\"Expand library\"\n        >\n          <ChevronRight size={20} />\n        </button>\n        <div\n          style={{\n            writingMode: 'vertical-rl',\n            fontSize: 12,\n            fontWeight: 600,\n            color: '#94a3b8',\n            marginTop: 16,\n          }}\n        >\n          LIBRARY\n        </div>\n      </div>\n    );\n  }\n\n  const totalItems = library\n    ? Object.values(library).reduce((sum, items) => sum + items.length, 0)\n    : 0;\n\n  // Apply sorting to current items\n  const sortItems = (items: Library['books']) => {\n    return [...items].sort((a, b) => {\n      switch (sortBy) {\n        case 'progress':\n          return b.progress - a.progress;\n        case 'az':\n          return a.title.localeCompare(b.title);\n        case 'recent':\n        default:\n          // Sort by last_read_at first, then purchased_at\n          if (a.last_read_at && b.last_read_at) {\n            return new Date(b.last_read_at).getTime() - new Date(a.last_read_at).getTime();\n          }\n          if (a.last_read_at) return -1;\n          if (b.last_read_at) return 1;\n          return new Date(b.purchased_at).getTime() - new Date(a.purchased_at).getTime();\n      }\n    });\n  };\n\n  const currentItems = library?.[selectedTab]\n    ? sortItems(library[selectedTab]).filter(item =>\n        searchQuery === '' || item.title.toLowerCase().includes(searchQuery.toLowerCase())\n      )\n    : [];\n\n  // Get in-progress items (1-99% progress) for Continue Reading section\n  const continueReadingItems = library\n    ? Object.values(library)\n        .flat()\n        .filter(item => item.progress > 0 && item.progress < 100)\n        .sort((a, b) => {\n          // Sort by last_read_at (most recent first)\n          if (a.last_read_at && b.last_read_at) {\n            return new Date(b.last_read_at).getTime() - new Date(a.last_read_at).getTime();\n          }\n          if (a.last_read_at) return -1;\n          if (b.last_read_at) return 1;\n          return b.progress - a.progress; // Fallback: higher progress first\n        })\n        .slice(0, 3)\n    : [];\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        left: 0,\n        top: 72,\n        bottom: 0,\n        width: 320,\n        background: '#0b1220',\n        borderRight: '1px solid #2a3444',\n        display: 'flex',\n        flexDirection: 'column',\n        zIndex: 40,\n        transition: 'width 0.3s ease',\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          padding: 16,\n          borderBottom: '1px solid #2a3444',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n        }}\n      >\n        <div>\n          <div\n            style={{\n              fontSize: 16,\n              fontWeight: 700,\n              color: '#e5e7eb',\n            }}\n          >\n            My Library\n          </div>\n          <div\n            style={{\n              fontSize: 12,\n              color: '#94a3b8',\n              marginTop: 2,\n            }}\n          >\n            {totalItems} {totalItems === 1 ? 'item' : 'items'}\n          </div>\n        </div>\n        <button\n          onClick={() => onExpandedChange(false)}\n          style={{\n            background: 'transparent',\n            border: 'none',\n            color: '#94a3b8',\n            cursor: 'pointer',\n            padding: 8,\n            borderRadius: 8,\n            transition: 'all 0.2s ease',\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.background = '#111827';\n            e.currentTarget.style.color = '#e5e7eb';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.background = 'transparent';\n            e.currentTarget.style.color = '#94a3b8';\n          }}\n          aria-label=\"Collapse library\"\n        >\n          <ChevronLeft size={20} />\n        </button>\n      </div>\n\n      {/* Search */}\n      <div\n        style={{\n          padding: '8px 16px',\n          borderBottom: '1px solid #2a3444',\n        }}\n      >\n        <div\n          style={{\n            position: 'relative',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <Search size={14} style={{ position: 'absolute', left: 10, color: '#64748b' }} />\n          <input\n            type=\"text\"\n            placeholder=\"Search library...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            style={{\n              width: '100%',\n              background: '#111827',\n              border: '1px solid #2a3444',\n              borderRadius: 8,\n              padding: '8px 32px 8px 32px',\n              fontSize: 13,\n              color: '#e5e7eb',\n              outline: 'none',\n            }}\n          />\n          {searchQuery && (\n            <button\n              onClick={() => setSearchQuery('')}\n              style={{\n                position: 'absolute',\n                right: 8,\n                background: 'transparent',\n                border: 'none',\n                color: '#64748b',\n                cursor: 'pointer',\n                padding: 2,\n                display: 'flex',\n                alignItems: 'center',\n              }}\n            >\n              <X size={14} />\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Continue Reading Section */}\n      {continueReadingItems.length > 0 && (\n        <div\n          style={{\n            padding: '12px 16px',\n            borderBottom: '1px solid #2a3444',\n          }}\n        >\n          <div\n            style={{\n              fontSize: 12,\n              fontWeight: 600,\n              color: '#f59e0b',\n              marginBottom: 10,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 6,\n            }}\n          >\n            <BookOpen size={14} />\n            Continue Reading\n          </div>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\n            {continueReadingItems.map((item) => (\n              <LibraryItemCard key={`continue-${item.id}`} item={item} />\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Tabs */}\n      <div\n        className=\"library-tabs-scroll\"\n        style={{\n          display: 'flex',\n          gap: 4,\n          padding: '12px 16px',\n          borderBottom: '1px solid #2a3444',\n          overflowX: 'auto',\n        }}\n      >\n        {(['books', 'art', 'comics'] as const).map((tab) => {\n          const count = library?.[tab]?.length || 0;\n          const isActive = selectedTab === tab;\n          const Icon = tab === 'books' ? BookOpen : tab === 'art' ? Image : BookMarked;\n          return (\n            <button\n              key={tab}\n              onClick={() => setSelectedTab(tab)}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: 6,\n                background: isActive ? '#f59e0b' : '#111827',\n                border: '1px solid',\n                borderColor: isActive ? '#f59e0b' : '#2a3444',\n                color: isActive ? '#111827' : '#cbd5e1',\n                padding: '6px 12px',\n                borderRadius: 18,\n                fontSize: 12,\n                fontWeight: 600,\n                cursor: 'pointer',\n                whiteSpace: 'nowrap',\n                transition: 'all 0.2s ease',\n              }}\n              onMouseEnter={(e) => {\n                if (!isActive) {\n                  e.currentTarget.style.background = '#1f2937';\n                  e.currentTarget.style.borderColor = '#374151';\n                }\n              }}\n              onMouseLeave={(e) => {\n                if (!isActive) {\n                  e.currentTarget.style.background = '#111827';\n                  e.currentTarget.style.borderColor = '#2a3444';\n                }\n              }}\n            >\n              <Icon size={14} />\n              {tab.charAt(0).toUpperCase() + tab.slice(1)} ({count})\n            </button>\n          );\n        })}\n        {/* Coming Soon tabs */}\n        {(['film', 'music'] as const).map((tab) => (\n          <button\n            key={tab}\n            disabled\n            style={{\n              background: '#111827',\n              border: '1px solid #2a3444',\n              color: '#64748b',\n              padding: '6px 12px',\n              borderRadius: 18,\n              fontSize: 12,\n              fontWeight: 600,\n              cursor: 'not-allowed',\n              whiteSpace: 'nowrap',\n              opacity: 0.5,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 4,\n            }}\n          >\n            {tab.charAt(0).toUpperCase() + tab.slice(1)}\n            <span style={{\n              fontSize: 8,\n              background: '#f59e0b',\n              color: '#000',\n              padding: '1px 3px',\n              borderRadius: 2,\n              fontWeight: 700,\n            }}>\n              SOON\n            </span>\n          </button>\n        ))}\n      </div>\n\n      {/* Sort dropdown */}\n      <div\n        style={{\n          padding: '8px 16px',\n          borderBottom: '1px solid #2a3444',\n          display: 'flex',\n          alignItems: 'center',\n          gap: 8,\n        }}\n      >\n        <ArrowUpDown size={14} style={{ color: '#64748b' }} />\n        <select\n          value={sortBy}\n          onChange={(e) => handleSortChange(e.target.value as SortOption)}\n          style={{\n            background: '#111827',\n            border: '1px solid #2a3444',\n            borderRadius: 6,\n            padding: '4px 8px',\n            fontSize: 12,\n            color: '#cbd5e1',\n            cursor: 'pointer',\n            flex: 1,\n          }}\n        >\n          <option value=\"recent\">Recent</option>\n          <option value=\"progress\">Progress</option>\n          <option value=\"az\">A-Z</option>\n        </select>\n      </div>\n\n      {/* Content */}\n      <div\n        className=\"library-sidebar-content\"\n        style={{\n          flex: 1,\n          overflowY: 'auto',\n          padding: 16,\n        }}\n      >\n        {loading && (\n          <div\n            style={{\n              textAlign: 'center',\n              padding: 32,\n              color: '#94a3b8',\n              fontSize: 14,\n            }}\n          >\n            Loading library...\n          </div>\n        )}\n\n        {error && (\n          <div\n            style={{\n              background: '#ef444420',\n              border: '1px solid #ef4444',\n              borderRadius: 8,\n              padding: 16,\n              color: '#fca5a5',\n              fontSize: 14,\n            }}\n          >\n            {error}\n            <button\n              onClick={loadLibrary}\n              style={{\n                marginTop: 8,\n                background: '#ef4444',\n                color: '#fff',\n                padding: '6px 12px',\n                fontSize: 12,\n              }}\n            >\n              Retry\n            </button>\n          </div>\n        )}\n\n        {!loading && !error && currentItems.length === 0 && (\n          <div\n            style={{\n              textAlign: 'center',\n              padding: 32,\n              color: '#94a3b8',\n              fontSize: 14,\n            }}\n          >\n            {searchQuery\n                  ? `No results for \"${searchQuery}\"`\n                  : `No ${selectedTab} in your library yet.`}\n          </div>\n        )}\n\n        {!loading && !error && currentItems.length > 0 && (\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>\n            {currentItems.map((item) => (\n              <LibraryItemCard key={item.id} item={item} />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Footer Links - YouTube style */}\n      <div\n        style={{\n          padding: '12px 16px',\n          borderTop: '1px solid #2a3444',\n          flexShrink: 0,\n        }}\n      >\n        {/* Legal Links Row */}\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '6px 12px',\n            marginBottom: 8,\n          }}\n        >\n          <Link to=\"/legal/terms\" style={footerLinkStyle}>Terms</Link>\n          <Link to=\"/legal/privacy\" style={footerLinkStyle}>Privacy</Link>\n          <Link to=\"/legal/content-policy\" style={footerLinkStyle}>Content Policy</Link>\n          <Link to=\"/legal/dmca\" style={footerLinkStyle}>DMCA</Link>\n        </div>\n        {/* Support Links Row */}\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '6px 12px',\n            marginBottom: 10,\n          }}\n        >\n          <a href=\"mailto:support@renaissblock.com\" style={footerLinkStyle}>Contact</a>\n          <a href=\"mailto:dmca@renaissblock.com\" style={footerLinkStyle}>Report Copyright</a>\n        </div>\n        {/* Copyright */}\n        <div\n          style={{\n            fontSize: 11,\n            color: '#64748b',\n          }}\n        >\n           {new Date().getFullYear()} renaissBlock\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst footerLinkStyle: React.CSSProperties = {\n  fontSize: 11,\n  color: '#64748b',\n  textDecoration: 'none',\n  transition: 'color 0.2s',\n};\n// Add hover effect via onMouseEnter/Leave in the JSX or use CSS classes\n","import React, { memo } from 'react';\nimport { Link } from 'react-router-dom';\nimport type { LibraryItem } from '../services/libraryApi';\n\ninterface MobileLibraryCardProps {\n  item: LibraryItem;\n}\n\n// Helper to format relative time\nfunction getRelativeTime(dateString: string | null): string | null {\n  if (!dateString) return null;\n\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffSecs = Math.floor(diffMs / 1000);\n  const diffMins = Math.floor(diffSecs / 60);\n  const diffHours = Math.floor(diffMins / 60);\n  const diffDays = Math.floor(diffHours / 24);\n\n  if (diffSecs < 60) return 'Just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  if (diffHours < 24) return `${diffHours}h ago`;\n  if (diffDays === 1) return 'Yesterday';\n  if (diffDays < 7) return `${diffDays}d ago`;\n  if (diffDays < 30) return `${Math.floor(diffDays / 7)}w ago`;\n  return `${Math.floor(diffDays / 30)}mo ago`;\n}\n\nfunction MobileLibraryCardComponent({ item }: MobileLibraryCardProps) {\n  const progressPercentage = Math.round(item.progress);\n  const relativeTime = getRelativeTime(item.last_read_at);\n  const placeholderSvg = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"200\"%3E%3Crect fill=\"%23111827\" width=\"200\" height=\"200\"/%3E%3Ctext fill=\"%2394a3b8\" font-family=\"sans-serif\" font-size=\"48\" x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dominant-baseline=\"middle\"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E';\n\n  return (\n    <Link\n      to={`/reader/${item.id}`}\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        background: '#0b1220',\n        border: '1px solid #2a3444',\n        borderRadius: 12,\n        overflow: 'hidden',\n        textDecoration: 'none',\n        color: 'inherit',\n        transition: 'transform 0.2s ease, box-shadow 0.2s ease',\n      }}\n    >\n      {/* Square thumbnail with progress overlay */}\n      <div\n        style={{\n          position: 'relative',\n          aspectRatio: '1',\n          background: '#0e1320',\n        }}\n      >\n        <img\n          src={item.thumbnail || placeholderSvg}\n          alt={item.title}\n          style={{\n            width: '100%',\n            height: '100%',\n            objectFit: 'cover',\n          }}\n          onError={(e: React.SyntheticEvent<HTMLImageElement>) => {\n            e.currentTarget.src = placeholderSvg;\n          }}\n        />\n        {/* Progress bar - always show */}\n        <div\n          style={{\n            position: 'absolute',\n            bottom: 0,\n            left: 0,\n            right: 0,\n            height: 4,\n            background: 'rgba(0,0,0,0.6)',\n          }}\n        >\n          <div\n            style={{\n              height: '100%',\n              width: `${item.progress}%`,\n              background: progressPercentage === 100 ? '#10b981' : '#f59e0b',\n              transition: 'width 0.3s ease',\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Title and progress info */}\n      <div style={{ padding: 10 }}>\n        <div\n          style={{\n            fontWeight: 600,\n            fontSize: 13,\n            color: '#e5e7eb',\n            marginBottom: 4,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          {item.title}\n        </div>\n        <div\n          style={{\n            fontSize: 11,\n            color: '#94a3b8',\n            marginBottom: 4,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          {item.creator}\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>\n          <span\n            style={{\n              fontSize: 11,\n              color: progressPercentage === 100 ? '#10b981' : progressPercentage > 0 ? '#f59e0b' : '#64748b',\n              fontWeight: 500,\n            }}\n          >\n            {progressPercentage === 100 ? 'Finished' : progressPercentage > 0 ? `${progressPercentage}%` : 'Not started'}\n          </span>\n          {relativeTime && progressPercentage > 0 && (\n            <span style={{ fontSize: 10, color: '#64748b' }}>\n               {relativeTime}\n            </span>\n          )}\n        </div>\n      </div>\n    </Link>\n  );\n}\n\nexport const MobileLibraryCard = memo(MobileLibraryCardComponent);\n","import React, { useState, useEffect } from 'react';\nimport { libraryApi, type Library } from '../services/libraryApi';\nimport { MobileLibraryCard } from './MobileLibraryCard';\nimport { BookOpen, Image, BookMarked, Film, Music, ArrowUpDown, Search, X, ChevronDown, ChevronUp, Library as LibraryIcon } from 'lucide-react';\nimport { useAuth } from '../hooks/useAuth';\n\ntype SortOption = 'recent' | 'progress' | 'az';\n\nconst TAB_ICONS = {\n  books: BookOpen,\n  art: Image,\n  comics: BookMarked,\n  film: Film,\n  music: Music,\n};\n\nexport function MobileLibrary() {\n  const [library, setLibrary] = useState<Library | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedTab, setSelectedTab] = useState<'books' | 'art' | 'comics'>('books');\n  const [sortBy, setSortBy] = useState<SortOption>(() => {\n    const saved = localStorage.getItem('library-sort');\n    return (saved as SortOption) || 'recent';\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isCollapsed, setIsCollapsed] = useState<boolean>(() => {\n    const saved = localStorage.getItem('mobile-library-collapsed');\n    return saved === 'true';\n  });\n  const { isAuthenticated } = useAuth();\n\n  // Save collapsed preference\n  const toggleCollapsed = () => {\n    const newState = !isCollapsed;\n    setIsCollapsed(newState);\n    localStorage.setItem('mobile-library-collapsed', String(newState));\n  };\n\n  // Save sort preference to localStorage\n  const handleSortChange = (newSort: SortOption) => {\n    setSortBy(newSort);\n    localStorage.setItem('library-sort', newSort);\n  };\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      loadLibrary();\n    } else {\n      setLibrary(null);\n      setLoading(false);\n      setError(null);\n    }\n  }, [isAuthenticated]);\n\n  const loadLibrary = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await libraryApi.getLibrary();\n      setLibrary(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load library');\n      console.error('Library load error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  const totalItems = library\n    ? Object.values(library).reduce((sum, items) => sum + items.length, 0)\n    : 0;\n\n  // Apply sorting to current items\n  const sortItems = (items: Library['books']) => {\n    return [...items].sort((a, b) => {\n      switch (sortBy) {\n        case 'progress':\n          return b.progress - a.progress;\n        case 'az':\n          return a.title.localeCompare(b.title);\n        case 'recent':\n        default:\n          // Sort by last_read_at first, then purchased_at\n          if (a.last_read_at && b.last_read_at) {\n            return new Date(b.last_read_at).getTime() - new Date(a.last_read_at).getTime();\n          }\n          if (a.last_read_at) return -1;\n          if (b.last_read_at) return 1;\n          return new Date(b.purchased_at).getTime() - new Date(a.purchased_at).getTime();\n      }\n    });\n  };\n\n  const currentItems = library?.[selectedTab]\n    ? sortItems(library[selectedTab]).filter(item =>\n        searchQuery === '' || item.title.toLowerCase().includes(searchQuery.toLowerCase())\n      )\n    : [];\n\n  // Get in-progress items (1-99% progress) for Continue Reading section\n  const continueReadingItems = library\n    ? Object.values(library)\n        .flat()\n        .filter(item => item.progress > 0 && item.progress < 100)\n        .sort((a, b) => {\n          // Sort by last_read_at (most recent first)\n          if (a.last_read_at && b.last_read_at) {\n            return new Date(b.last_read_at).getTime() - new Date(a.last_read_at).getTime();\n          }\n          if (a.last_read_at) return -1;\n          if (b.last_read_at) return 1;\n          return b.progress - a.progress; // Fallback: higher progress first\n        })\n        .slice(0, 3)\n    : [];\n\n  // If library is empty, don't show the section\n  if (!loading && !error && totalItems === 0) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        background: '#0a0f1a',\n        padding: isCollapsed ? '12px 16px' : '20px 16px',\n        marginBottom: 16,\n        transition: 'padding 0.2s ease',\n      }}\n    >\n      {/* Collapsible Header */}\n      <button\n        onClick={toggleCollapsed}\n        style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          width: '100%',\n          background: 'transparent',\n          border: 'none',\n          padding: 0,\n          cursor: 'pointer',\n          marginBottom: isCollapsed ? 0 : 16,\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>\n          <LibraryIcon size={20} style={{ color: '#f59e0b' }} />\n          <div style={{ textAlign: 'left' }}>\n            <h2\n              style={{\n                fontSize: 16,\n                fontWeight: 700,\n                color: '#e5e7eb',\n                margin: 0,\n              }}\n            >\n              My Library\n            </h2>\n            {isCollapsed && (\n              <div style={{ fontSize: 12, color: '#94a3b8', marginTop: 2 }}>\n                {totalItems} {totalItems === 1 ? 'item' : 'items'}  Tap to expand\n              </div>\n            )}\n          </div>\n        </div>\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: 8,\n          color: '#94a3b8',\n        }}>\n          {!isCollapsed && (\n            <span style={{ fontSize: 12 }}>\n              {totalItems} {totalItems === 1 ? 'item' : 'items'}\n            </span>\n          )}\n          {isCollapsed ? <ChevronDown size={20} /> : <ChevronUp size={20} />}\n        </div>\n      </button>\n\n      {/* Collapsible Content */}\n      {!isCollapsed && (\n        <>\n\n      {/* Search */}\n      <div style={{ marginBottom: 16 }}>\n        <div\n          style={{\n            position: 'relative',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <Search size={16} style={{ position: 'absolute', left: 12, color: '#64748b' }} />\n          <input\n            type=\"text\"\n            placeholder=\"Search library...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            style={{\n              width: '100%',\n              background: '#111827',\n              border: '1px solid #2a3444',\n              borderRadius: 10,\n              padding: '10px 36px 10px 40px',\n              fontSize: 14,\n              color: '#e5e7eb',\n              outline: 'none',\n            }}\n          />\n          {searchQuery && (\n            <button\n              onClick={() => setSearchQuery('')}\n              style={{\n                position: 'absolute',\n                right: 10,\n                background: 'transparent',\n                border: 'none',\n                color: '#64748b',\n                cursor: 'pointer',\n                padding: 4,\n                display: 'flex',\n                alignItems: 'center',\n              }}\n            >\n              <X size={16} />\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Continue Reading Section */}\n      {continueReadingItems.length > 0 && (\n        <div style={{ marginBottom: 16 }}>\n          <div\n            style={{\n              fontSize: 13,\n              fontWeight: 600,\n              color: '#f59e0b',\n              marginBottom: 10,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 6,\n            }}\n          >\n            <BookOpen size={16} />\n            Continue Reading\n          </div>\n          <div\n            style={{\n              display: 'grid',\n              gridTemplateColumns: 'repeat(2, 1fr)',\n              gap: 12,\n            }}\n          >\n            {continueReadingItems.map((item) => (\n              <MobileLibraryCard key={`continue-${item.id}`} item={item} />\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Horizontal scrollable tabs */}\n      <div\n        style={{\n          display: 'flex',\n          gap: 8,\n          overflowX: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          paddingBottom: 8,\n          marginBottom: 16,\n          scrollbarWidth: 'none',\n          msOverflowStyle: 'none',\n        }}\n      >\n        {/* Active content tabs */}\n        {(['books', 'art', 'comics'] as const).map((tab) => {\n          const count = library?.[tab]?.length || 0;\n          const isActive = selectedTab === tab;\n          const Icon = TAB_ICONS[tab];\n\n          return (\n            <button\n              key={tab}\n              onClick={() => setSelectedTab(tab)}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: 6,\n                background: isActive ? '#f59e0b' : '#111827',\n                border: '1px solid',\n                borderColor: isActive ? '#f59e0b' : '#2a3444',\n                color: isActive ? '#111827' : '#cbd5e1',\n                padding: '10px 16px',\n                borderRadius: 20,\n                fontSize: 13,\n                fontWeight: 600,\n                cursor: 'pointer',\n                whiteSpace: 'nowrap',\n                flexShrink: 0,\n                transition: 'all 0.2s ease',\n              }}\n            >\n              <Icon size={16} />\n              {tab.charAt(0).toUpperCase() + tab.slice(1)}\n              <span\n                style={{\n                  background: isActive ? 'rgba(0,0,0,0.2)' : '#2a3444',\n                  padding: '2px 8px',\n                  borderRadius: 10,\n                  fontSize: 11,\n                }}\n              >\n                {count}\n              </span>\n            </button>\n          );\n        })}\n        {/* Coming Soon tabs */}\n        {(['film', 'music'] as const).map((tab) => {\n          const Icon = TAB_ICONS[tab];\n          return (\n            <button\n              key={tab}\n              disabled\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: 6,\n                background: '#111827',\n                border: '1px solid #2a3444',\n                color: '#64748b',\n                padding: '10px 16px',\n                borderRadius: 20,\n                fontSize: 13,\n                fontWeight: 600,\n                cursor: 'not-allowed',\n                whiteSpace: 'nowrap',\n                flexShrink: 0,\n                opacity: 0.6,\n              }}\n            >\n              <Icon size={16} />\n              {tab.charAt(0).toUpperCase() + tab.slice(1)}\n              <span\n                style={{\n                  background: '#2a3444',\n                  padding: '2px 6px',\n                  borderRadius: 10,\n                  fontSize: 10,\n                }}\n              >\n                Soon\n              </span>\n            </button>\n          );\n        })}\n      </div>\n\n      {/* Sort dropdown */}\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: 8,\n          marginBottom: 16,\n        }}\n      >\n        <ArrowUpDown size={14} style={{ color: '#64748b' }} />\n        <select\n          value={sortBy}\n          onChange={(e) => handleSortChange(e.target.value as SortOption)}\n          style={{\n            background: '#111827',\n            border: '1px solid #2a3444',\n            borderRadius: 8,\n            padding: '6px 10px',\n            fontSize: 13,\n            color: '#cbd5e1',\n            cursor: 'pointer',\n          }}\n        >\n          <option value=\"recent\">Recent</option>\n          <option value=\"progress\">Progress</option>\n          <option value=\"az\">A-Z</option>\n        </select>\n      </div>\n\n      {/* Content */}\n      {loading && (\n        <div\n          style={{\n            textAlign: 'center',\n            padding: 32,\n            color: '#94a3b8',\n            fontSize: 14,\n          }}\n        >\n          Loading library...\n        </div>\n      )}\n\n      {error && (\n        <div\n          style={{\n            background: '#ef444420',\n            border: '1px solid #ef4444',\n            borderRadius: 12,\n            padding: 16,\n            color: '#fca5a5',\n            fontSize: 14,\n          }}\n        >\n          {error}\n          <button\n            onClick={loadLibrary}\n            style={{\n              marginTop: 8,\n              display: 'block',\n              background: '#ef4444',\n              color: '#fff',\n              border: 'none',\n              padding: '8px 16px',\n              borderRadius: 8,\n              fontSize: 13,\n              fontWeight: 600,\n              cursor: 'pointer',\n            }}\n          >\n            Retry\n          </button>\n        </div>\n      )}\n\n      {!loading && !error && currentItems.length === 0 && (\n        <div\n          style={{\n            textAlign: 'center',\n            padding: 32,\n            color: '#94a3b8',\n            fontSize: 14,\n          }}\n        >\n          {searchQuery\n              ? `No results for \"${searchQuery}\"`\n              : `No ${selectedTab} in your library yet.`}\n        </div>\n      )}\n\n      {!loading && !error && currentItems.length > 0 && (\n        <div\n          style={{\n            display: 'grid',\n            gridTemplateColumns: 'repeat(2, 1fr)',\n            gap: 12,\n          }}\n        >\n          {currentItems.map((item) => (\n            <MobileLibraryCard key={item.id} item={item} />\n          ))}\n        </div>\n      )}\n        </>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\n\nexport interface MobileState {\n  isMobile: boolean;      // <= 768px\n  isPhone: boolean;       // <= 480px\n  isTablet: boolean;      // 481px - 768px\n  isDesktop: boolean;     // > 768px\n  screenWidth: number;\n}\n\nfunction getState(): MobileState {\n  const width = typeof window !== 'undefined' ? window.innerWidth : 1024;\n  return {\n    isMobile: width <= 768,\n    isPhone: width <= 480,\n    isTablet: width > 480 && width <= 768,\n    isDesktop: width > 768,\n    screenWidth: width,\n  };\n}\n\nexport function useMobile(): MobileState {\n  const [state, setState] = useState<MobileState>(getState);\n\n  useEffect(() => {\n    const handleResize = () => setState(getState());\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  return state;\n}\n","import React, { useEffect, useState } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { API_URL } from '../config';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n}\n\nexport default function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean | null>(null);\n  const location = useLocation();\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const response = await fetch(`${API_URL}/api/auth/status/`, { credentials: 'include' });\n      const data = await response.json();\n      setIsAuthenticated(!!data?.authenticated);\n    } catch {\n      setIsAuthenticated(false);\n    }\n  };\n\n  // Loading state\n  if (isAuthenticated === null) {\n    return (\n      <div style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: '60vh',\n        color: '#94a3b8',\n        fontSize: 16,\n      }}>\n        Checking authentication...\n      </div>\n    );\n  }\n\n  // Not authenticated - redirect to auth page\n  if (!isAuthenticated) {\n    return <Navigate to=\"/auth\" state={{ from: location }} replace />;\n  }\n\n  // Authenticated - render children\n  return <>{children}</>;\n}\n","import React, { Component, ErrorInfo, ReactNode } from 'react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n}\n\n/**\n * Error Boundary component to catch and handle React errors gracefully.\n * Prevents the entire app from crashing when a component throws an error.\n */\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n  }\n\n  handleRetry = (): void => {\n    this.setState({ hasError: false, error: null });\n  };\n\n  render(): ReactNode {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          minHeight: '200px',\n          padding: '40px',\n          textAlign: 'center',\n          color: 'var(--text, #e5e7eb)',\n        }}>\n          <h2 style={{ marginBottom: '16px', color: 'var(--text, #e5e7eb)' }}>\n            Something went wrong\n          </h2>\n          <p style={{ marginBottom: '24px', color: 'var(--text-muted, #94a3b8)' }}>\n            An error occurred while loading this section.\n          </p>\n          <button\n            onClick={this.handleRetry}\n            style={{\n              padding: '10px 24px',\n              background: 'var(--accent, #f59e0b)',\n              color: '#111',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontWeight: 600,\n            }}\n          >\n            Try Again\n          </button>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n","/**\n * Real-time Notification Service\n * Handles collaboration notifications, activity tracking, and real-time updates\n */\n\nimport { API_URL } from '../config';\n\n// ============================================================================\n// TypeScript Interfaces\n// ============================================================================\n\nexport type NotificationType =\n  | 'invitation'\n  | 'invitation_response'\n  | 'comment'\n  | 'approval'\n  | 'section_update'\n  | 'revenue_proposal'\n  | 'mint_ready';\n\nexport interface NotificationUser {\n  id: number;\n  username: string;\n  avatar?: string;\n}\n\nexport interface Notification {\n  id: number;\n  type: NotificationType;\n  title: string;\n  message: string;\n  project_id?: number;\n  from_user: NotificationUser;\n  created_at: string;\n  read: boolean;\n  action_url?: string;\n}\n\nexport interface NotificationStats {\n  total: number;\n  unread: number;\n  by_type: Record<NotificationType, number>;\n}\n\n// ============================================================================\n// Event System for Real-time Updates\n// ============================================================================\n\ntype NotificationEventHandler = (data: any) => void;\n\nclass NotificationEventEmitter {\n  private listeners: Map<string, Set<NotificationEventHandler>> = new Map();\n\n  on(event: string, handler: NotificationEventHandler): () => void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(handler);\n\n    // Return unsubscribe function\n    return () => this.off(event, handler);\n  }\n\n  off(event: string, handler: NotificationEventHandler): void {\n    const handlers = this.listeners.get(event);\n    if (handlers) {\n      handlers.delete(handler);\n    }\n  }\n\n  emit(event: string, data: any): void {\n    const handlers = this.listeners.get(event);\n    if (handlers) {\n      handlers.forEach(handler => {\n        try {\n          handler(data);\n        } catch (error) {\n          console.error(`Error in notification event handler for ${event}:`, error);\n        }\n      });\n    }\n  }\n\n  clear(): void {\n    this.listeners.clear();\n  }\n}\n\n// ============================================================================\n// Local State Management\n// ============================================================================\n\ninterface NotificationState {\n  notifications: Notification[];\n  unreadCount: number;\n  lastChecked: Date | null;\n  isPolling: boolean;\n  lastError: Error | null;\n  knownNotificationIds: Set<number>; // Track IDs of notifications we've seen\n  initialLoadComplete: boolean; // Prevent toast spam on first load\n}\n\nconst state: NotificationState = {\n  notifications: [],\n  unreadCount: 0,\n  lastChecked: null,\n  isPolling: false,\n  lastError: null,\n  knownNotificationIds: new Set(),\n  initialLoadComplete: false,\n};\n\n// ============================================================================\n// Configuration\n// ============================================================================\n\nconst CONFIG = {\n  POLLING_INTERVAL: 30000, // 30 seconds\n  MAX_RETRIES: 3,\n  RETRY_DELAY: 5000, // 5 seconds\n  REQUEST_TIMEOUT: 10000, // 10 seconds\n};\n\n// ============================================================================\n// API Helper Functions\n// ============================================================================\n\nasync function getCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to get CSRF token:', error);\n    return '';\n  }\n}\n\nasync function apiRequest<T>(\n  url: string,\n  options: RequestInit = {}\n): Promise<T> {\n  // Prepend API_URL if url is relative (starts with /)\n  const fullUrl = url.startsWith('/') ? `${API_URL}${url}` : url;\n\n  const response = await fetch(fullUrl, {\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    },\n    ...options,\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json().catch(() => ({}));\n    throw new Error(errorData?.error || `API request failed: ${response.status}`);\n  }\n\n  return response.json();\n}\n\n// ============================================================================\n// Core API Functions\n// ============================================================================\n\n/**\n * Fetch all notifications for the current user\n */\nexport async function getNotifications(): Promise<Notification[]> {\n  try {\n    const notifications = await apiRequest<Notification[]>('/api/notifications/');\n    state.notifications = notifications;\n    state.unreadCount = notifications.filter(n => !n.read).length;\n    state.lastChecked = new Date();\n    state.lastError = null;\n\n    // Track known notification IDs (for detecting truly new notifications)\n    notifications.forEach(n => state.knownNotificationIds.add(n.id));\n\n    events.emit('notifications:updated', { notifications, unreadCount: state.unreadCount });\n\n    return notifications;\n  } catch (error) {\n    state.lastError = error as Error;\n    console.error('Failed to fetch notifications:', error);\n    throw error;\n  }\n}\n\n/**\n * Get only unread notifications\n */\nexport async function getUnreadNotifications(): Promise<Notification[]> {\n  const allNotifications = await getNotifications();\n  return allNotifications.filter(n => !n.read);\n}\n\n/**\n * Get unread notification count\n */\nexport async function getUnreadCount(): Promise<number> {\n  try {\n    const notifications = await getNotifications();\n    const count = notifications.filter(n => !n.read).length;\n    state.unreadCount = count;\n\n    events.emit('notifications:unread-count', { count });\n\n    return count;\n  } catch (error) {\n    console.error('Failed to get unread count:', error);\n    return state.unreadCount; // Return cached count on error\n  }\n}\n\n/**\n * Mark a single notification as read\n */\nexport async function markNotificationRead(notificationId: number): Promise<void> {\n  try {\n    const csrfToken = await getCsrfToken();\n\n    await apiRequest(`/api/notifications/${notificationId}/mark-read/`, {\n      method: 'POST',\n      headers: {\n        'X-CSRFToken': csrfToken,\n      },\n    });\n\n    // Update local state\n    const notification = state.notifications.find(n => n.id === notificationId);\n    if (notification && !notification.read) {\n      notification.read = true;\n      state.unreadCount = Math.max(0, state.unreadCount - 1);\n\n      events.emit('notifications:updated', {\n        notifications: state.notifications,\n        unreadCount: state.unreadCount\n      });\n      events.emit('notifications:unread-count', { count: state.unreadCount });\n    }\n  } catch (error) {\n    console.error('Failed to mark notification as read:', error);\n    throw error;\n  }\n}\n\n/**\n * Mark all notifications as read\n */\nexport async function markAllNotificationsRead(): Promise<void> {\n  try {\n    const csrfToken = await getCsrfToken();\n\n    await apiRequest('/api/notifications/mark-all-read/', {\n      method: 'POST',\n      headers: {\n        'X-CSRFToken': csrfToken,\n      },\n    });\n\n    // Update local state\n    state.notifications.forEach(n => n.read = true);\n    state.unreadCount = 0;\n\n    events.emit('notifications:updated', {\n      notifications: state.notifications,\n      unreadCount: 0\n    });\n    events.emit('notifications:unread-count', { count: 0 });\n  } catch (error) {\n    console.error('Failed to mark all notifications as read:', error);\n    throw error;\n  }\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(notificationId: number): Promise<void> {\n  // Helper to update local state after delete\n  const removeFromLocalState = () => {\n    const index = state.notifications.findIndex(n => n.id === notificationId);\n    if (index !== -1) {\n      const wasUnread = !state.notifications[index].read;\n      state.notifications.splice(index, 1);\n\n      if (wasUnread) {\n        state.unreadCount = Math.max(0, state.unreadCount - 1);\n      }\n\n      // Also remove from known IDs\n      state.knownNotificationIds.delete(notificationId);\n\n      events.emit('notifications:updated', {\n        notifications: state.notifications,\n        unreadCount: state.unreadCount\n      });\n      events.emit('notifications:unread-count', { count: state.unreadCount });\n    }\n  };\n\n  try {\n    const csrfToken = await getCsrfToken();\n\n    const fullUrl = `${API_URL}/api/notifications/${notificationId}/`;\n    const response = await fetch(fullUrl, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n      },\n    });\n\n    // Handle 404 gracefully - notification doesn't exist or already deleted\n    // Still remove from local state since it's effectively \"gone\"\n    if (response.status === 404) {\n      console.warn(`Notification ${notificationId} not found on server, removing from local state`);\n      removeFromLocalState();\n      return;\n    }\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete notification: ${response.status}`);\n    }\n\n    // Successfully deleted - update local state\n    removeFromLocalState();\n  } catch (error) {\n    console.error('Failed to delete notification:', error);\n    // On network error, still try to remove from local state for better UX\n    removeFromLocalState();\n    throw error;\n  }\n}\n\n/**\n * Get notification statistics\n */\nexport async function getNotificationStats(): Promise<NotificationStats> {\n  const notifications = await getNotifications();\n\n  const stats: NotificationStats = {\n    total: notifications.length,\n    unread: notifications.filter(n => !n.read).length,\n    by_type: {\n      invitation: 0,\n      invitation_response: 0,\n      comment: 0,\n      approval: 0,\n      section_update: 0,\n      revenue_proposal: 0,\n      mint_ready: 0,\n    },\n  };\n\n  notifications.forEach(n => {\n    stats.by_type[n.type] = (stats.by_type[n.type] || 0) + 1;\n  });\n\n  return stats;\n}\n\n// ============================================================================\n// Real-time Polling System\n// ============================================================================\n\nlet pollingInterval: NodeJS.Timeout | null = null;\nlet retryCount = 0;\nlet retryTimeout: NodeJS.Timeout | null = null;\n\n/**\n * Poll for new notifications\n */\nasync function pollNotifications(): Promise<void> {\n  if (!state.isPolling) return;\n\n  try {\n    // Store IDs of previously known notifications before fetching\n    const previouslyKnownIds = new Set(state.knownNotificationIds);\n\n    await getNotifications();\n\n    // Only emit 'notifications:new' after initial load is complete\n    // This prevents a flood of toasts when the page first loads\n    if (state.initialLoadComplete) {\n      // Find truly NEW notifications (IDs we haven't seen before)\n      const newNotifications = state.notifications.filter(\n        n => !previouslyKnownIds.has(n.id) && !n.read\n      );\n\n      if (newNotifications.length > 0) {\n        events.emit('notifications:new', {\n          notifications: newNotifications,\n          count: newNotifications.length\n        });\n      }\n    } else {\n      // Mark initial load as complete after first successful fetch\n      state.initialLoadComplete = true;\n    }\n\n    // Reset retry count on success\n    retryCount = 0;\n  } catch (error) {\n    console.error('Polling error:', error);\n    retryCount++;\n\n    if (retryCount >= CONFIG.MAX_RETRIES) {\n      console.error('Max retries reached, stopping polling');\n      stopPolling();\n      events.emit('notifications:polling-error', { error, retryCount });\n    } else {\n      // Schedule retry\n      if (retryTimeout) clearTimeout(retryTimeout);\n      retryTimeout = setTimeout(() => {\n        pollNotifications();\n      }, CONFIG.RETRY_DELAY);\n    }\n  }\n}\n\n/**\n * Start polling for notifications\n */\nexport function startPolling(): void {\n  if (state.isPolling) {\n    console.warn('Notification polling already started');\n    return;\n  }\n\n  console.log('Starting notification polling...');\n  state.isPolling = true;\n  retryCount = 0;\n\n  // Initial fetch\n  pollNotifications();\n\n  // Set up polling interval\n  pollingInterval = setInterval(pollNotifications, CONFIG.POLLING_INTERVAL);\n\n  events.emit('notifications:polling-started', {});\n}\n\n/**\n * Stop polling for notifications\n */\nexport function stopPolling(): void {\n  if (!state.isPolling) {\n    return;\n  }\n\n  console.log('Stopping notification polling...');\n  state.isPolling = false;\n\n  if (pollingInterval) {\n    clearInterval(pollingInterval);\n    pollingInterval = null;\n  }\n\n  if (retryTimeout) {\n    clearTimeout(retryTimeout);\n    retryTimeout = null;\n  }\n\n  events.emit('notifications:polling-stopped', {});\n}\n\n/**\n * Check if polling is active\n */\nexport function isPolling(): boolean {\n  return state.isPolling;\n}\n\n/**\n * Update polling interval\n */\nexport function setPollingInterval(intervalMs: number): void {\n  CONFIG.POLLING_INTERVAL = intervalMs;\n\n  if (state.isPolling) {\n    stopPolling();\n    startPolling();\n  }\n}\n\n// ============================================================================\n// Event System Export\n// ============================================================================\n\nexport const events = new NotificationEventEmitter();\n\n/**\n * Available events:\n * - 'notifications:updated' - Fired when notifications list is updated\n * - 'notifications:unread-count' - Fired when unread count changes\n * - 'notifications:new' - Fired when new notifications are received\n * - 'notifications:polling-started' - Fired when polling starts\n * - 'notifications:polling-stopped' - Fired when polling stops\n * - 'notifications:polling-error' - Fired when polling encounters errors\n */\n\n// ============================================================================\n// State Access Functions\n// ============================================================================\n\n/**\n * Get current notification state\n */\nexport function getState(): Readonly<NotificationState> {\n  return { ...state };\n}\n\n/**\n * Get cached notifications (without API call)\n */\nexport function getCachedNotifications(): Notification[] {\n  return [...state.notifications];\n}\n\n/**\n * Get cached unread count (without API call)\n */\nexport function getCachedUnreadCount(): number {\n  return state.unreadCount;\n}\n\n/**\n * Clear local state and stop polling\n */\nexport function reset(): void {\n  stopPolling();\n  state.notifications = [];\n  state.unreadCount = 0;\n  state.lastChecked = null;\n  state.lastError = null;\n  state.knownNotificationIds.clear();\n  state.initialLoadComplete = false;\n  events.clear();\n}\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Get human-readable time ago string\n */\nexport function getTimeAgo(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const seconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n\n  if (seconds < 60) return 'just now';\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\n  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;\n  if (seconds < 604800) return `${Math.floor(seconds / 86400)}d ago`;\n  return date.toLocaleDateString();\n}\n\n/**\n * Get notification icon based on type\n */\nexport function getNotificationIcon(type: NotificationType): string {\n  const icons: Record<NotificationType, string> = {\n    invitation: '',\n    invitation_response: '',\n    comment: '',\n    approval: '',\n    section_update: '',\n    revenue_proposal: '',\n    mint_ready: '',\n  };\n  return icons[type] || '';\n}\n\n/**\n * Get notification color based on type\n */\nexport function getNotificationColor(type: NotificationType): string {\n  const colors: Record<NotificationType, string> = {\n    invitation: '#3b82f6', // blue\n    invitation_response: '#8b5cf6', // purple\n    comment: '#06b6d4', // cyan\n    approval: '#10b981', // green\n    section_update: '#f59e0b', // amber\n    revenue_proposal: '#eab308', // yellow\n    mint_ready: '#ec4899', // pink\n  };\n  return colors[type] || '#6b7280';\n}\n\n// ============================================================================\n// Export Default Service\n// ============================================================================\n\nexport default {\n  // API Functions\n  getNotifications,\n  getUnreadNotifications,\n  getUnreadCount,\n  markNotificationRead,\n  markAllNotificationsRead,\n  deleteNotification,\n  getNotificationStats,\n\n  // Polling Functions\n  startPolling,\n  stopPolling,\n  isPolling,\n  setPollingInterval,\n\n  // State Functions\n  getState,\n  getCachedNotifications,\n  getCachedUnreadCount,\n  reset,\n\n  // Event System\n  events,\n\n  // Utilities\n  getTimeAgo,\n  getNotificationIcon,\n  getNotificationColor,\n};\n","/**\n * React Hook for Notification System\n * Provides easy integration with notificationService in React components\n */\n\nimport { useEffect, useState, useCallback } from 'react';\nimport notificationService, {\n  Notification,\n  NotificationStats,\n  events,\n} from '../services/notificationService';\n\ninterface UseNotificationsOptions {\n  autoStart?: boolean; // Auto-start polling when hook mounts\n  onNewNotification?: (notifications: Notification[]) => void; // Callback for new notifications\n}\n\ninterface UseNotificationsReturn {\n  notifications: Notification[];\n  unreadCount: number;\n  isLoading: boolean;\n  isPolling: boolean;\n  error: Error | null;\n\n  // Actions\n  refresh: () => Promise<void>;\n  markAsRead: (notificationId: number) => Promise<void>;\n  markAllAsRead: () => Promise<void>;\n  deleteNotification: (notificationId: number) => Promise<void>;\n  startPolling: () => void;\n  stopPolling: () => void;\n  getStats: () => Promise<NotificationStats>;\n}\n\n/**\n * Custom hook for managing notifications\n */\nexport function useNotifications(\n  options: UseNotificationsOptions = {}\n): UseNotificationsReturn {\n  const { autoStart = false, onNewNotification } = options;\n\n  // State\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [unreadCount, setUnreadCount] = useState<number>(0);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [isPolling, setIsPolling] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  // Refresh notifications\n  const refresh = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const data = await notificationService.getNotifications();\n      setNotifications(data);\n      setUnreadCount(data.filter(n => !n.read).length);\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to refresh notifications:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Mark notification as read\n  const markAsRead = useCallback(async (notificationId: number) => {\n    try {\n      await notificationService.markNotificationRead(notificationId);\n      // State will be updated via event listener\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to mark notification as read:', err);\n      throw err;\n    }\n  }, []);\n\n  // Mark all notifications as read\n  const markAllAsRead = useCallback(async () => {\n    try {\n      await notificationService.markAllNotificationsRead();\n      // State will be updated via event listener\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to mark all notifications as read:', err);\n      throw err;\n    }\n  }, []);\n\n  // Delete notification\n  const deleteNotificationCallback = useCallback(async (notificationId: number) => {\n    try {\n      await notificationService.deleteNotification(notificationId);\n      // State will be updated via event listener\n    } catch (err) {\n      // Don't throw - the service handles 404 gracefully and updates local state\n      // Other errors are logged but we don't want to block the UI\n      console.error('Failed to delete notification:', err);\n    }\n  }, []);\n\n  // Start polling\n  const startPollingCallback = useCallback(() => {\n    notificationService.startPolling();\n    setIsPolling(true);\n  }, []);\n\n  // Stop polling\n  const stopPollingCallback = useCallback(() => {\n    notificationService.stopPolling();\n    setIsPolling(false);\n  }, []);\n\n  // Get statistics\n  const getStats = useCallback(async () => {\n    try {\n      return await notificationService.getNotificationStats();\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to get notification stats:', err);\n      throw err;\n    }\n  }, []);\n\n  // Subscribe to notification events\n  useEffect(() => {\n    // Handle notifications updated\n    const unsubUpdated = events.on('notifications:updated', ({ notifications, unreadCount }) => {\n      setNotifications(notifications);\n      setUnreadCount(unreadCount);\n    });\n\n    // Handle unread count changes\n    const unsubUnreadCount = events.on('notifications:unread-count', ({ count }) => {\n      setUnreadCount(count);\n    });\n\n    // Handle new notifications\n    const unsubNew = events.on('notifications:new', ({ notifications: newNotifs }) => {\n      if (onNewNotification) {\n        onNewNotification(newNotifs);\n      }\n    });\n\n    // Handle polling state changes\n    const unsubPollingStarted = events.on('notifications:polling-started', () => {\n      setIsPolling(true);\n    });\n\n    const unsubPollingStopped = events.on('notifications:polling-stopped', () => {\n      setIsPolling(false);\n    });\n\n    // Handle polling errors\n    const unsubPollingError = events.on('notifications:polling-error', ({ error }) => {\n      setError(error);\n      setIsPolling(false);\n    });\n\n    // Cleanup subscriptions\n    return () => {\n      unsubUpdated();\n      unsubUnreadCount();\n      unsubNew();\n      unsubPollingStarted();\n      unsubPollingStopped();\n      unsubPollingError();\n    };\n  }, [onNewNotification]);\n\n  // Auto-start polling if enabled\n  useEffect(() => {\n    if (autoStart) {\n      startPollingCallback();\n      refresh();\n    }\n\n    return () => {\n      if (autoStart) {\n        stopPollingCallback();\n      }\n    };\n  }, [autoStart, startPollingCallback, stopPollingCallback, refresh]);\n\n  return {\n    notifications,\n    unreadCount,\n    isLoading,\n    isPolling,\n    error,\n\n    refresh,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification: deleteNotificationCallback,\n    startPolling: startPollingCallback,\n    stopPolling: stopPollingCallback,\n    getStats,\n  };\n}\n\n/**\n * Simple hook to just get unread count\n */\nexport function useUnreadCount(autoStart = false): {\n  unreadCount: number;\n  refresh: () => Promise<void>;\n} {\n  const [unreadCount, setUnreadCount] = useState<number>(0);\n\n  const refresh = useCallback(async () => {\n    try {\n      const count = await notificationService.getUnreadCount();\n      setUnreadCount(count);\n    } catch (err) {\n      console.error('Failed to get unread count:', err);\n    }\n  }, []);\n\n  useEffect(() => {\n    const unsubUnreadCount = events.on('notifications:unread-count', ({ count }) => {\n      setUnreadCount(count);\n    });\n\n    if (autoStart) {\n      refresh();\n    }\n\n    return () => {\n      unsubUnreadCount();\n    };\n  }, [autoStart, refresh]);\n\n  return { unreadCount, refresh };\n}\n\nexport default useNotifications;\n","/**\n * NotificationItem Component\n * Reusable component for individual notifications\n */\n\nimport React, { memo } from 'react';\nimport {\n  Mail,\n  MailOpen,\n  MessageSquare,\n  CheckCircle,\n  FileEdit,\n  DollarSign,\n  PartyPopper,\n  Bell,\n} from 'lucide-react';\nimport {\n  Notification,\n  NotificationType,\n  getTimeAgo,\n  getNotificationColor,\n} from '../../services/notificationService';\n\n// Get Lucide icon component based on notification type\nfunction getNotificationLucideIcon(type: NotificationType): React.ReactNode {\n  const iconProps = { size: 20 };\n\n  switch (type) {\n    case 'invitation':\n      return <Mail {...iconProps} />;\n    case 'invitation_response':\n      return <MailOpen {...iconProps} />;\n    case 'comment':\n      return <MessageSquare {...iconProps} />;\n    case 'approval':\n      return <CheckCircle {...iconProps} />;\n    case 'section_update':\n      return <FileEdit {...iconProps} />;\n    case 'revenue_proposal':\n      return <DollarSign {...iconProps} />;\n    case 'mint_ready':\n      return <PartyPopper {...iconProps} />;\n    default:\n      return <Bell {...iconProps} />;\n  }\n}\n\ninterface NotificationItemProps {\n  notification: Notification;\n  onClick: () => void;\n  onDelete: (e: React.MouseEvent) => void;\n  onViewInvite?: (notification: Notification) => void;\n}\n\nfunction NotificationItemComponent({ notification, onClick, onDelete, onViewInvite }: NotificationItemProps) {\n  const icon = getNotificationLucideIcon(notification.type);\n  const color = getNotificationColor(notification.type);\n  const timeAgo = getTimeAgo(notification.created_at);\n  const isInvitation = notification.type === 'invitation';\n\n  return (\n    <div\n      onClick={onClick}\n      role=\"button\"\n      tabIndex={0}\n      aria-label={`${notification.read ? 'Read' : 'Unread'} notification: ${notification.title}`}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onClick();\n        }\n      }}\n      style={{\n        padding: '12px 20px',\n        cursor: 'pointer',\n        background: notification.read ? 'transparent' : '#0b1220',\n        borderLeft: `3px solid ${notification.read ? 'transparent' : color}`,\n        transition: 'all 0.2s',\n        position: 'relative',\n      }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.background = '#1e293b';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = notification.read ? 'transparent' : '#0b1220';\n      }}\n    >\n      <div style={{ display: 'flex', gap: 12 }}>\n        {/* Icon */}\n        <div\n          style={{\n            width: 40,\n            height: 40,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            background: `${color}20`,\n            borderRadius: 8,\n            flexShrink: 0,\n            color: color,\n          }}\n          aria-hidden=\"true\"\n        >\n          {icon}\n        </div>\n\n        {/* Content */}\n        <div style={{ flex: 1, minWidth: 0 }}>\n          <div\n            style={{\n              fontSize: 13,\n              fontWeight: 600,\n              color: '#e5e7eb',\n              marginBottom: 4,\n              lineHeight: 1.4,\n            }}\n          >\n            {notification.title}\n          </div>\n          <div\n            style={{\n              fontSize: 12,\n              color: '#94a3b8',\n              marginBottom: 6,\n              lineHeight: 1.5,\n            }}\n          >\n            {notification.message}\n          </div>\n          <div\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              fontSize: 11,\n              color: '#64748b',\n            }}\n          >\n            <span>@{notification.from_user.username}</span>\n            <span></span>\n            <span>{timeAgo}</span>\n          </div>\n\n          {/* View Invite button for invitation notifications */}\n          {isInvitation && onViewInvite && (\n            <button\n              onClick={(e) => {\n                e.stopPropagation();\n                onViewInvite(notification);\n              }}\n              style={{\n                marginTop: 10,\n                background: '#f59e0b',\n                color: '#000',\n                border: 'none',\n                padding: '8px 16px',\n                borderRadius: 6,\n                fontSize: 12,\n                fontWeight: 700,\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                gap: 6,\n                transition: 'all 0.2s',\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.background = '#fbbf24';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.background = '#f59e0b';\n              }}\n            >\n              View Invite \n            </button>\n          )}\n        </div>\n\n        {/* Delete button */}\n        <button\n          onClick={onDelete}\n          aria-label=\"Delete notification\"\n          style={{\n            background: 'transparent',\n            border: 'none',\n            color: '#64748b',\n            cursor: 'pointer',\n            padding: 4,\n            borderRadius: 4,\n            fontSize: 18,\n            width: 28,\n            height: 28,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexShrink: 0,\n            opacity: 0.6,\n            transition: 'all 0.2s',\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.background = '#1e293b';\n            e.currentTarget.style.color = '#ef4444';\n            e.currentTarget.style.opacity = '1';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.background = 'transparent';\n            e.currentTarget.style.color = '#64748b';\n            e.currentTarget.style.opacity = '0.6';\n          }}\n        >\n          \n        </button>\n      </div>\n\n      {/* Unread indicator */}\n      {!notification.read && (\n        <div\n          aria-label=\"Unread\"\n          style={{\n            position: 'absolute',\n            top: 18,\n            right: 20,\n            width: 8,\n            height: 8,\n            background: color,\n            borderRadius: '50%',\n            boxShadow: `0 0 8px ${color}`,\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\nexport const NotificationItem = memo(NotificationItemComponent);\n\nexport default NotificationItem;\n","/**\n * Collaboration API Service\n *\n * Provides functions for managing collaborative projects, invitations,\n * sections, and communication between collaborators.\n */\n\nimport { API_URL as API_BASE } from '../config';\n\n// ===== TypeScript Interfaces =====\n\nexport interface CopyrightPreview {\n  copyright_line: string;\n  blockchain_message: string;\n  full_text: string;\n}\n\nexport interface CollaborativeProject {\n  id: number;\n  title: string;\n  content_type: 'book' | 'music' | 'video' | 'art' | 'comic';\n  description: string;\n  status: 'draft' | 'active' | 'ready_for_mint' | 'minted' | 'cancelled';\n  milestones: Milestone[];\n  price_usd: number;\n  editions: number;\n  teaser_percent: number;\n  watermark_preview: boolean;\n  authors_note?: string;\n  estimated_earnings?: { [userId: number]: number };\n  copyright_preview?: CopyrightPreview;\n  created_by: number;\n  created_by_username: string;\n  created_at: string;\n  updated_at: string;\n  collaborators: CollaboratorRole[];\n  sections: ProjectSection[];\n  recent_comments: ProjectComment[];\n  is_fully_approved: boolean;\n  total_collaborators: number;\n  progress_percentage: number;\n  is_solo: boolean;\n  cover_image?: string | null;\n}\n\nexport interface CollaborativeProjectListItem {\n  id: number;\n  title: string;\n  content_type: string;\n  status: string;\n  created_by: number;\n  created_by_username: string;\n  total_collaborators: number;\n  created_at: string;\n  updated_at: string;\n  price_usd: number;\n  is_solo: boolean;\n  cover_image?: string | null;\n}\n\n// Contract task interface for task-based collaboration\nexport interface ContractTask {\n  id: number;\n  title: string;\n  description: string;\n  deadline: string;\n  status: 'pending' | 'in_progress' | 'complete' | 'signed_off' | 'cancelled';\n  order: number;\n  marked_complete_at?: string;\n  marked_complete_by?: number;\n  marked_complete_by_username?: string;\n  completion_notes?: string;\n  signed_off_at?: string;\n  signed_off_by?: number;\n  signed_off_by_username?: string;\n  signoff_notes?: string;\n  rejection_notes?: string;\n  rejected_at?: string;\n  is_overdue: boolean;\n  days_until_deadline?: number;\n  created_at: string;\n  updated_at: string;\n}\n\n// Role definition for standard roles\nexport interface RoleDefinition {\n  id: number;\n  name: string;\n  category: 'creator' | 'contributor' | 'reviewer' | 'technical' | 'management';\n  description: string;\n  applicable_to_book: boolean;\n  applicable_to_art: boolean;\n  applicable_to_music: boolean;\n  applicable_to_video: boolean;\n  default_permissions: {\n    create: string[];\n    edit: { scope: string; types: string[] };\n    review: string[];\n  };\n  ui_components: string[];\n  icon: string;\n  color: string;\n  is_active: boolean;\n}\n\nexport interface CollaboratorRole {\n  id: number;\n  user: number;\n  username: string;\n  display_name: string;\n  avatar_url?: string;\n  role: string;\n  revenue_percentage: number;\n  status: 'invited' | 'accepted' | 'declined' | 'exited';\n  invited_at: string;\n  accepted_at?: string;\n  // Legacy permission flags (still supported)\n  can_edit_text: boolean;\n  can_edit_images: boolean;\n  can_edit_audio: boolean;\n  can_edit_video: boolean;\n  can_edit: string[];\n  // New role-based permission fields\n  role_definition_id?: number;\n  role_definition_details?: RoleDefinition;\n  permissions?: {\n    create?: string[];\n    edit?: { scope: string; types: string[] };\n    review?: string[];\n  };\n  effective_role_name?: string;\n  effective_permissions?: {\n    create: string[];\n    edit: { scope: string; types: string[] };\n    review: string[];\n  };\n  ui_components?: string[];\n  // Approval tracking\n  approved_current_version: boolean;\n  approved_revenue_split: boolean;\n  // Counter-proposal fields\n  proposed_percentage?: number;\n  counter_message?: string;\n  // Deadline and accountability fields\n  delivery_deadline?: string;\n  deadline_extended_at?: string;\n  deadline_extension_reason?: string;\n  sections_due?: number[];\n  // Multi-party governance fields\n  is_lead: boolean;\n  can_invite_others: boolean;\n  voting_weight: number;\n  // Contract task fields\n  contract_tasks: ContractTask[];\n  tasks_total: number;\n  tasks_signed_off: number;\n  all_tasks_complete: boolean;\n  has_active_breach: boolean;\n  cancellation_eligible: boolean;\n  contract_version: number;\n  contract_locked_at?: string;\n}\n\nexport interface ProjectSection {\n  id: number;\n  section_type: 'text' | 'image' | 'audio' | 'video';\n  title: string;\n  content_html?: string;\n  synopsis?: string;\n  media_file?: string;\n  owner: number;\n  owner_username: string;\n  order: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CommentReaction {\n  id: number;\n  user_id: number;\n  username: string;\n  emoji: string;\n}\n\nexport interface ProjectComment {\n  id: number;\n  author: number;\n  author_username: string;\n  author_avatar: string;\n  content: string;\n  parent_comment?: number;\n  section?: number;\n  section_title?: string;\n  resolved: boolean;\n  resolved_by?: number;\n  resolved_by_username?: string;\n  resolved_at?: string;\n  created_at: string;\n  updated_at?: string;\n  edited: boolean;\n  edit_history?: Array<{\n    content: string;\n    edited_at: string;\n  }>;\n  replies_count: number;\n  replies?: ProjectComment[];\n  reactions?: CommentReaction[];\n  attachments?: Array<{\n    id: number;\n    filename: string;\n    file_url: string;\n    file_size: number;\n  }>;\n  mentions?: number[]; // User IDs mentioned in the comment\n}\n\nexport interface Milestone {\n  id?: string;\n  title: string;\n  description?: string;\n  due_date?: string;\n  completed: boolean;\n}\n\nexport interface RevenueSplit {\n  user_id: number;\n  percentage: number;\n}\n\nexport interface InviteCollaboratorData {\n  user_id: number;\n  role: string;\n  revenue_percentage: number;\n  can_edit_text?: boolean;\n  can_edit_images?: boolean;\n  can_edit_audio?: boolean;\n  can_edit_video?: boolean;\n}\n\nexport interface CreateProjectData {\n  title: string;\n  content_type: 'book' | 'music' | 'video' | 'art' | 'comic';\n  description?: string;\n  milestones?: Milestone[];\n  is_solo?: boolean;\n}\n\nexport interface CreateSectionData {\n  project: number;\n  section_type: 'text' | 'image' | 'audio' | 'video';\n  title: string;\n  content_html?: string;\n  media_file?: File;\n  order?: number;\n}\n\nexport interface CreateCommentData {\n  project: number;\n  content: string;\n  section?: number;\n  parent_comment?: number;\n  mentions?: number[];\n  attachments?: File[];\n}\n\n// ===== Helper Functions =====\n\n/**\n * Get fresh CSRF token from API\n * This is more reliable than reading from cookies\n */\nasync function getFreshCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_BASE}/api/auth/csrf/`, {\n      credentials: 'include',\n    });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to fetch CSRF token:', error);\n    return '';\n  }\n}\n\n/**\n * Handle API errors with detailed messages\n */\nasync function handleResponse<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    let errorMessage = `Request failed: ${response.statusText}`;\n    try {\n      const errorData = await response.json();\n      if (errorData.error) {\n        errorMessage = errorData.error;\n      } else if (errorData.detail) {\n        errorMessage = errorData.detail;\n      }\n    } catch {\n      // Response body not JSON, use status text\n    }\n    throw new Error(errorMessage);\n  }\n  return response.json();\n}\n\n// ===== API Functions =====\n\nexport const collaborationApi = {\n  // ===== Project Management =====\n\n  /**\n   * Create a new collaborative project\n   */\n  async createCollaborativeProject(data: CreateProjectData): Promise<CollaborativeProject> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Get all collaborative projects for current user\n   */\n  async getCollaborativeProjects(): Promise<CollaborativeProjectListItem[]> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<CollaborativeProjectListItem[]>(response);\n  },\n\n  /**\n   * Get single project with full details\n   */\n  async getCollaborativeProject(id: number): Promise<CollaborativeProject> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/${id}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Get all pending collaboration invites for the current user\n   * Returns projects where user has status='invited'\n   */\n  async getPendingInvites(): Promise<{ project: CollaborativeProject; invite: CollaboratorRole }[]> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/pending_invites/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<{ project: CollaborativeProject; invite: CollaboratorRole }[]>(response);\n  },\n\n  /**\n   * Update collaborative project\n   */\n  async updateCollaborativeProject(\n    id: number,\n    data: Partial<CreateProjectData>\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Delete collaborative project\n   */\n  async deleteCollaborativeProject(id: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete project: ${response.statusText}`);\n    }\n  },\n\n  // ===== Collaboration Actions =====\n\n  /**\n   * Invite a collaborator to the project\n   */\n  async inviteCollaborator(\n    projectId: number,\n    data: InviteCollaboratorData\n  ): Promise<CollaboratorRole> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/invite_collaborator/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<CollaboratorRole>(response);\n  },\n\n  /**\n   * Accept invitation to collaborate\n   */\n  async acceptInvitation(projectId: number): Promise<CollaboratorRole> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/accept_invitation/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<CollaboratorRole>(response);\n  },\n\n  /**\n   * Decline invitation to collaborate\n   */\n  async declineInvitation(projectId: number): Promise<{ message: string }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/decline_invitation/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Submit counter-proposal for collaboration invitation\n   */\n  async counterProposeInvite(\n    projectId: number,\n    data: { proposed_percentage: number; message: string }\n  ): Promise<{ message: string; invitation: CollaboratorRole }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/counter_propose/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<{ message: string; invitation: CollaboratorRole }>(response);\n  },\n\n  /**\n   * Respond to a counter-proposal (accept or decline)\n   * Only project creator can call this\n   */\n  async respondToCounterProposal(\n    projectId: number,\n    data: { collaborator_id: number; action: 'accept' | 'decline'; message?: string }\n  ): Promise<{ message: string; project: CollaborativeProject }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/respond-to-counter-proposal/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<{ message: string; project: CollaborativeProject }>(response);\n  },\n\n  /**\n   * Propose new revenue split percentages\n   */\n  async proposeRevenueSplit(\n    projectId: number,\n    splits: RevenueSplit[]\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/propose_revenue_split/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ splits }),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  // ===== Approval System =====\n\n  /**\n   * Approve current version for minting\n   */\n  async approveCurrentVersion(projectId: number): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/approve_version/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Get approval status for a project\n   */\n  async getApprovalStatus(projectId: number): Promise<{\n    is_fully_approved: boolean;\n    pending_approvals: string[];\n  }> {\n    const project = await this.getCollaborativeProject(projectId);\n\n    const pendingApprovals = project.collaborators\n      .filter(\n        (c) =>\n          c.status === 'accepted' &&\n          (!c.approved_current_version || !c.approved_revenue_split)\n      )\n      .map((c) => c.username);\n\n    return {\n      is_fully_approved: project.is_fully_approved,\n      pending_approvals: pendingApprovals,\n    };\n  },\n\n  /**\n   * Get project preview (combined sections)\n   */\n  async getProjectPreview(projectId: number): Promise<{\n    title: string;\n    content_type: string;\n    sections: any[];\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/preview/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse(response);\n  },\n\n  // ===== Section Management =====\n\n  /**\n   * Create a new project section\n   */\n  async createProjectSection(data: CreateSectionData): Promise<ProjectSection> {\n    const formData = new FormData();\n    formData.append('project', data.project.toString());\n    formData.append('section_type', data.section_type);\n    formData.append('title', data.title);\n    if (data.content_html) {\n      formData.append('content_html', data.content_html);\n    }\n    if (data.media_file) {\n      formData.append('media_file', data.media_file);\n    }\n    if (data.order !== undefined) {\n      formData.append('order', data.order.toString());\n    }\n\n    const response = await fetch(`${API_BASE}/api/project-sections/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: formData,\n    });\n\n    return handleResponse<ProjectSection>(response);\n  },\n\n  /**\n   * Update project section\n   */\n  async updateProjectSection(\n    id: number,\n    data: Partial<CreateSectionData>\n  ): Promise<ProjectSection> {\n    const formData = new FormData();\n    if (data.section_type) {\n      formData.append('section_type', data.section_type);\n    }\n    if (data.title) {\n      formData.append('title', data.title);\n    }\n    if (data.content_html !== undefined) {\n      formData.append('content_html', data.content_html);\n    }\n    if (data.media_file) {\n      formData.append('media_file', data.media_file);\n    }\n    if (data.order !== undefined) {\n      formData.append('order', data.order.toString());\n    }\n\n    const response = await fetch(`${API_BASE}/api/project-sections/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: formData,\n    });\n\n    return handleResponse<ProjectSection>(response);\n  },\n\n  /**\n   * Delete project section\n   */\n  async deleteProjectSection(id: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/project-sections/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete section: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Get all sections for a project\n   */\n  async getProjectSections(projectId: number): Promise<ProjectSection[]> {\n    const response = await fetch(\n      `${API_BASE}/api/project-sections/?project=${projectId}`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse<ProjectSection[]>(response);\n  },\n\n  // ===== Communication =====\n\n  /**\n   * Add a comment to project or section\n   */\n  async addComment(data: CreateCommentData): Promise<ProjectComment> {\n    // Use FormData if there are attachments\n    if (data.attachments && data.attachments.length > 0) {\n      const formData = new FormData();\n      formData.append('project', data.project.toString());\n      formData.append('content', data.content);\n      if (data.section) formData.append('section', data.section.toString());\n      if (data.parent_comment) formData.append('parent_comment', data.parent_comment.toString());\n      if (data.mentions) formData.append('mentions', JSON.stringify(data.mentions));\n\n      data.attachments.forEach((file, index) => {\n        formData.append(`attachment_${index}`, file);\n      });\n\n      const response = await fetch(`${API_BASE}/api/project-comments/`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: formData,\n      });\n\n      return handleResponse<ProjectComment>(response);\n    }\n\n    // Regular JSON request without attachments\n    const response = await fetch(`${API_BASE}/api/project-comments/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Get comments for a project or section\n   */\n  async getComments(projectId: number, sectionId?: number): Promise<ProjectComment[]> {\n    let url = `${API_BASE}/api/project-comments/?project=${projectId}`;\n    if (sectionId) {\n      url += `&section=${sectionId}`;\n    }\n\n    const response = await fetch(url, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<ProjectComment[]>(response);\n  },\n\n  /**\n   * Resolve a comment\n   */\n  async resolveComment(commentId: number): Promise<ProjectComment> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/resolve/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Unresolve a comment\n   */\n  async unresolveComment(commentId: number): Promise<ProjectComment> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/unresolve/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Update a comment\n   */\n  async updateComment(commentId: number, content: string): Promise<ProjectComment> {\n    const response = await fetch(`${API_BASE}/api/project-comments/${commentId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ content }),\n    });\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Delete a comment\n   */\n  async deleteComment(commentId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/project-comments/${commentId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete comment: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Add reaction to a comment\n   */\n  async addReaction(commentId: number, emoji: string): Promise<CommentReaction> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/add-reaction/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ emoji }),\n      }\n    );\n\n    return handleResponse<CommentReaction>(response);\n  },\n\n  /**\n   * Remove reaction from a comment\n   */\n  async removeReaction(commentId: number, reactionId: number): Promise<void> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/remove-reaction/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ reaction_id: reactionId }),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(`Failed to remove reaction: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Get comment thread (with replies)\n   */\n  async getCommentThread(commentId: number): Promise<ProjectComment> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/thread/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Get comments by section\n   */\n  async getCommentsBySection(\n    projectId: number,\n    includeResolved: boolean = false\n  ): Promise<{ [sectionId: string]: ProjectComment[] }> {\n    let url = `${API_BASE}/api/project-comments/by-section/?project=${projectId}`;\n    if (includeResolved) {\n      url += '&include_resolved=true';\n    }\n\n    const response = await fetch(url, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<{ [sectionId: string]: ProjectComment[] }>(response);\n  },\n\n  /**\n   * Get unresolved comment count\n   */\n  async getUnresolvedCommentCount(projectId: number): Promise<number> {\n    const comments = await this.getComments(projectId);\n    return comments.filter(c => !c.resolved).length;\n  },\n\n  // ===== Minting Workflow =====\n\n  /**\n   * Request approval from specific collaborators\n   */\n  async requestApproval(\n    projectId: number,\n    data: {\n      collaborator_ids: number[];\n      message?: string;\n      deadline_days?: number;\n    }\n  ): Promise<{ message: string; notifications_sent: number }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/request_approval/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<{ message: string; notifications_sent: number }>(response);\n  },\n\n  /**\n   * Approve project (both content and revenue split)\n   */\n  async approveProject(\n    projectId: number,\n    data: {\n      approve_content: boolean;\n      approve_revenue: boolean;\n      feedback?: string;\n    }\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/approve_project/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Set the NFT price for a project (project owner only)\n   */\n  async setPrice(\n    projectId: number,\n    priceUsd: number\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/set_price/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ price_usd: priceUsd }),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Update customization settings (price, editions, teaser)\n   * Only project owner can update these settings.\n   * Updating these settings resets revenue split approvals.\n   */\n  async updateCustomization(\n    projectId: number,\n    settings: {\n      price_usd?: number;\n      editions?: number;\n      teaser_percent?: number;\n      watermark_preview?: boolean;\n      authors_note?: string;\n    }\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/update_customization/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(settings),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Mint project as NFT\n   */\n  async mintProject(\n    projectId: number,\n    forceMint: boolean = false\n  ): Promise<{\n    success: boolean;\n    nft_id: string;\n    token_id: string;\n    contract_address: string;\n    ipfs_hash: string;\n    transaction_hash: string;\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/mint/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ force_mint: forceMint }),\n      }\n    );\n\n    return handleResponse<{\n      success: boolean;\n      nft_id: string;\n      token_id: string;\n      contract_address: string;\n      ipfs_hash: string;\n      transaction_hash: string;\n    }>(response);\n  },\n\n  /**\n   * Get minting status for a project\n   */\n  async getMintingStatus(projectId: number): Promise<{\n    status: 'not_started' | 'validating' | 'uploading' | 'creating_contract' | 'minting' | 'completed' | 'error';\n    stage: string;\n    progress: number;\n    error?: string;\n    nft_data?: {\n      id: string;\n      token_id: string;\n      contract_address: string;\n      ipfs_hash: string;\n    };\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/minting-status/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse(response);\n  },\n\n  /**\n   * Cancel approval (reset approval status)\n   */\n  async cancelApproval(projectId: number): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/cancel_approval/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  // ===== Proposals & Voting =====\n\n  /**\n   * Get all proposals for a project\n   */\n  async getProposals(projectId: number): Promise<Proposal[]> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse<Proposal[]>(response);\n  },\n\n  /**\n   * Create a new proposal\n   */\n  async createProposal(\n    projectId: number,\n    data: CreateProposalData\n  ): Promise<Proposal> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<Proposal>(response);\n  },\n\n  /**\n   * Cast a vote on a proposal\n   */\n  async castVote(\n    projectId: number,\n    proposalId: number,\n    data: { vote: 'approve' | 'reject' | 'abstain'; comment?: string }\n  ): Promise<ProposalVote> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/${proposalId}/vote/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<ProposalVote>(response);\n  },\n\n  /**\n   * Cancel a proposal (only proposer or owner can cancel)\n   */\n  async cancelProposal(projectId: number, proposalId: number): Promise<{ message: string }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/${proposalId}/cancel/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<{ message: string }>(response);\n  },\n\n  // ===== Collaborator Ratings =====\n\n  /**\n   * Submit a rating for a collaborator\n   */\n  async rateCollaborator(\n    projectId: number,\n    ratedUserId: number,\n    data: CollaboratorRatingData\n  ): Promise<CollaboratorRating> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/rate_collaborator/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ rated_user_id: ratedUserId, ...data }),\n      }\n    );\n\n    return handleResponse<CollaboratorRating>(response);\n  },\n\n  /**\n   * Get ratings for a user\n   */\n  async getUserRatings(userId: number): Promise<{\n    ratings: CollaboratorRating[];\n    average_scores: {\n      quality: number;\n      deadline: number;\n      communication: number;\n      would_collab_again: number;\n      overall: number;\n    };\n    total_projects: number;\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/users/${userId}/ratings/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse(response);\n  },\n\n  // ===== Comic Page Management =====\n\n  /**\n   * Get all pages for a comic project\n   */\n  async getComicPages(projectId: number): Promise<ComicPage[]> {\n    const response = await fetch(\n      `${API_BASE}/api/comic-pages/?project=${projectId}`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n    return handleResponse<ComicPage[]>(response);\n  },\n\n  /**\n   * Get a single comic page with panels and bubbles\n   */\n  async getComicPage(pageId: number): Promise<ComicPage> {\n    const response = await fetch(\n      `${API_BASE}/api/comic-pages/${pageId}/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n    return handleResponse<ComicPage>(response);\n  },\n\n  /**\n   * Create a new comic page\n   */\n  async createComicPage(data: CreateComicPageData): Promise<ComicPage> {\n    const response = await fetch(`${API_BASE}/api/comic-pages/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicPage>(response);\n  },\n\n  /**\n   * Update a comic page\n   */\n  async updateComicPage(pageId: number, data: Partial<CreateComicPageData>): Promise<ComicPage> {\n    const response = await fetch(`${API_BASE}/api/comic-pages/${pageId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicPage>(response);\n  },\n\n  /**\n   * Delete a comic page\n   */\n  async deleteComicPage(pageId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/comic-pages/${pageId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete page: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Reorder a comic page\n   */\n  async reorderComicPage(pageId: number, newPosition: number): Promise<{ status: string; new_position: number }> {\n    const response = await fetch(`${API_BASE}/api/comic-pages/${pageId}/reorder/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ new_position: newPosition }),\n    });\n    return handleResponse(response);\n  },\n\n  // ===== Comic Panel Management =====\n\n  /**\n   * Get all panels for a comic page\n   */\n  async getComicPanels(pageId: number): Promise<ComicPanel[]> {\n    const response = await fetch(\n      `${API_BASE}/api/comic-panels/?page=${pageId}`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n    return handleResponse<ComicPanel[]>(response);\n  },\n\n  /**\n   * Create a new comic panel\n   */\n  async createComicPanel(data: CreateComicPanelData): Promise<ComicPanel> {\n    const response = await fetch(`${API_BASE}/api/comic-panels/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicPanel>(response);\n  },\n\n  /**\n   * Update a comic panel\n   */\n  async updateComicPanel(panelId: number, data: Partial<CreateComicPanelData>): Promise<ComicPanel> {\n    const response = await fetch(`${API_BASE}/api/comic-panels/${panelId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicPanel>(response);\n  },\n\n  /**\n   * Delete a comic panel\n   */\n  async deleteComicPanel(panelId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/comic-panels/${panelId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete panel: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Upload artwork to a panel\n   */\n  async uploadPanelArtwork(panelId: number, artworkFile: File): Promise<ComicPanel> {\n    const formData = new FormData();\n    formData.append('artwork', artworkFile);\n\n    const response = await fetch(`${API_BASE}/api/comic-panels/${panelId}/upload_artwork/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: formData,\n    });\n    return handleResponse<ComicPanel>(response);\n  },\n\n  /**\n   * Batch update panel positions (for drag operations)\n   */\n  async batchUpdatePanelPositions(\n    panels: Array<{\n      id: number;\n      x_percent?: number;\n      y_percent?: number;\n      width_percent?: number;\n      height_percent?: number;\n      z_index?: number;\n      rotation?: number;\n    }>\n  ): Promise<{ updated: number[] }> {\n    const response = await fetch(`${API_BASE}/api/comic-panels/batch_update_positions/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ panels }),\n    });\n    return handleResponse(response);\n  },\n\n  // ===== Speech Bubble Management =====\n\n  /**\n   * Get all speech bubbles for a panel\n   */\n  async getSpeechBubbles(panelId: number): Promise<SpeechBubble[]> {\n    const response = await fetch(\n      `${API_BASE}/api/speech-bubbles/?panel=${panelId}`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n    return handleResponse<SpeechBubble[]>(response);\n  },\n\n  /**\n   * Create a new speech bubble\n   */\n  async createSpeechBubble(data: CreateSpeechBubbleData): Promise<SpeechBubble> {\n    const response = await fetch(`${API_BASE}/api/speech-bubbles/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<SpeechBubble>(response);\n  },\n\n  /**\n   * Update a speech bubble\n   */\n  async updateSpeechBubble(bubbleId: number, data: Partial<CreateSpeechBubbleData>): Promise<SpeechBubble> {\n    const response = await fetch(`${API_BASE}/api/speech-bubbles/${bubbleId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<SpeechBubble>(response);\n  },\n\n  /**\n   * Delete a speech bubble\n   */\n  async deleteSpeechBubble(bubbleId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/speech-bubbles/${bubbleId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete bubble: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Batch create speech bubbles\n   */\n  async batchCreateSpeechBubbles(bubbles: CreateSpeechBubbleData[]): Promise<{ created: SpeechBubble[] }> {\n    const response = await fetch(`${API_BASE}/api/speech-bubbles/batch_create/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ bubbles }),\n    });\n    return handleResponse(response);\n  },\n\n  /**\n   * Batch update speech bubble positions\n   */\n  async batchUpdateBubblePositions(\n    bubbles: Array<{\n      id: number;\n      x_percent?: number;\n      y_percent?: number;\n      width_percent?: number;\n      height_percent?: number;\n      z_index?: number;\n    }>\n  ): Promise<{ updated: number[] }> {\n    const response = await fetch(`${API_BASE}/api/speech-bubbles/batch_update_positions/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ bubbles }),\n    });\n    return handleResponse(response);\n  },\n\n  // ===== Divider Line Management (Line-based Panel Layout) =====\n\n  /**\n   * Get divider lines for a page\n   */\n  async getDividerLines(pageId: number): Promise<DividerLine[]> {\n    const response = await fetch(`${API_BASE}/api/divider-lines/?page=${pageId}`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    return handleResponse<DividerLine[]>(response);\n  },\n\n  /**\n   * Create a new divider line\n   */\n  async createDividerLine(data: CreateDividerLineData): Promise<DividerLine> {\n    const response = await fetch(`${API_BASE}/api/divider-lines/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<DividerLine>(response);\n  },\n\n  /**\n   * Update a divider line\n   */\n  async updateDividerLine(lineId: number, data: Partial<CreateDividerLineData>): Promise<DividerLine> {\n    const response = await fetch(`${API_BASE}/api/divider-lines/${lineId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<DividerLine>(response);\n  },\n\n  /**\n   * Delete a divider line\n   */\n  async deleteDividerLine(lineId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/divider-lines/${lineId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete divider line: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Batch create divider lines (for applying templates)\n   */\n  async batchCreateDividerLines(\n    pageId: number,\n    lines: Omit<CreateDividerLineData, 'page'>[],\n    clearExisting: boolean = false\n  ): Promise<{ created: DividerLine[] }> {\n    const response = await fetch(`${API_BASE}/api/divider-lines/batch_create/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ page: pageId, lines, clear_existing: clearExisting }),\n    });\n    return handleResponse(response);\n  },\n\n  /**\n   * Batch update divider lines\n   */\n  async batchUpdateDividerLines(\n    lines: Array<{\n      id: number;\n      line_type?: LineType;\n      start_x?: number;\n      start_y?: number;\n      end_x?: number;\n      end_y?: number;\n      control1_x?: number;\n      control1_y?: number;\n      control2_x?: number;\n      control2_y?: number;\n      thickness?: number;\n      color?: string;\n      order?: number;\n    }>\n  ): Promise<{ updated: number[] }> {\n    const response = await fetch(`${API_BASE}/api/divider-lines/batch_update/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ lines }),\n    });\n    return handleResponse(response);\n  },\n\n  // ===== Comic Series Management =====\n\n  /**\n   * Get all comic series for current user\n   */\n  async getComicSeries(): Promise<ComicSeriesListItem[]> {\n    const response = await fetch(`${API_BASE}/api/comic-series/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    return handleResponse<ComicSeriesListItem[]>(response);\n  },\n\n  /**\n   * Get a single comic series with details\n   */\n  async getComicSeriesDetail(seriesId: number): Promise<ComicSeries> {\n    const response = await fetch(`${API_BASE}/api/comic-series/${seriesId}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    return handleResponse<ComicSeries>(response);\n  },\n\n  /**\n   * Create a new comic series\n   */\n  async createComicSeries(data: CreateComicSeriesData): Promise<ComicSeries> {\n    const response = await fetch(`${API_BASE}/api/comic-series/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicSeries>(response);\n  },\n\n  /**\n   * Update a comic series\n   */\n  async updateComicSeries(seriesId: number, data: Partial<CreateComicSeriesData>): Promise<ComicSeries> {\n    const response = await fetch(`${API_BASE}/api/comic-series/${seriesId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicSeries>(response);\n  },\n\n  /**\n   * Delete a comic series\n   */\n  async deleteComicSeries(seriesId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/comic-series/${seriesId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete series: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Publish an entire comic series\n   */\n  async publishComicSeries(seriesId: number): Promise<{ content_id: number; message: string }> {\n    const response = await fetch(`${API_BASE}/api/comic-series/${seriesId}/publish/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    return handleResponse(response);\n  },\n\n  // ===== Comic Issue Management =====\n\n  /**\n   * Get all comic issues (optionally filtered by series or project)\n   */\n  async getComicIssues(params?: { series?: number; project?: number }): Promise<ComicIssueListItem[]> {\n    let url = `${API_BASE}/api/comic-issues/`;\n    if (params) {\n      const queryParams = new URLSearchParams();\n      if (params.series) queryParams.append('series', params.series.toString());\n      if (params.project) queryParams.append('project', params.project.toString());\n      if (queryParams.toString()) url += `?${queryParams.toString()}`;\n    }\n    const response = await fetch(url, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    return handleResponse<ComicIssueListItem[]>(response);\n  },\n\n  /**\n   * Get a single comic issue with pages\n   */\n  async getComicIssueDetail(issueId: number): Promise<ComicIssue> {\n    const response = await fetch(`${API_BASE}/api/comic-issues/${issueId}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    return handleResponse<ComicIssue>(response);\n  },\n\n  /**\n   * Create a new comic issue\n   */\n  async createComicIssue(data: CreateComicIssueData): Promise<ComicIssue> {\n    const response = await fetch(`${API_BASE}/api/comic-issues/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicIssue>(response);\n  },\n\n  /**\n   * Update a comic issue\n   */\n  async updateComicIssue(issueId: number, data: Partial<CreateComicIssueData>): Promise<ComicIssue> {\n    const response = await fetch(`${API_BASE}/api/comic-issues/${issueId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n    return handleResponse<ComicIssue>(response);\n  },\n\n  /**\n   * Delete a comic issue\n   */\n  async deleteComicIssue(issueId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/comic-issues/${issueId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete issue: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Prepare a comic issue for minting (validates and generates preview)\n   */\n  async prepareComicIssue(issueId: number): Promise<{ ready: boolean; preview_data: any; errors?: string[] }> {\n    const response = await fetch(`${API_BASE}/api/comic-issues/${issueId}/prepare/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    return handleResponse(response);\n  },\n\n  /**\n   * Publish a single comic issue\n   */\n  async publishComicIssue(issueId: number): Promise<{ content_id: number; message: string }> {\n    const response = await fetch(`${API_BASE}/api/comic-issues/${issueId}/publish/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    return handleResponse(response);\n  },\n\n  /**\n   * Get pages for a specific issue\n   */\n  async getComicIssuePages(issueId: number): Promise<ComicPage[]> {\n    const response = await fetch(`${API_BASE}/api/comic-pages/?issue=${issueId}`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    return handleResponse<ComicPage[]>(response);\n  },\n\n  // ===== Artwork Library =====\n\n  /**\n   * Get all artwork in a project's library\n   */\n  async getArtworkLibrary(projectId: number): Promise<ArtworkLibraryItem[]> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/artwork-library/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n    return handleResponse<ArtworkLibraryItem[]>(response);\n  },\n\n  /**\n   * Upload artwork to project library\n   */\n  async uploadArtworkToLibrary(\n    projectId: number,\n    file: File,\n    title?: string\n  ): Promise<ArtworkLibraryItem> {\n    const formData = new FormData();\n    formData.append('file', file);\n    if (title) formData.append('title', title);\n\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/artwork-library/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: formData,\n      }\n    );\n    return handleResponse<ArtworkLibraryItem>(response);\n  },\n\n  /**\n   * Delete artwork from project library\n   */\n  async deleteArtworkFromLibrary(artworkId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/artwork-library/${artworkId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to delete artwork: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Apply artwork from library to a panel\n   */\n  async applyArtworkToPanel(\n    artworkId: number,\n    data: {\n      panel_id?: number;\n      page_id?: number;\n      bounds?: { x: number; y: number; width: number; height: number };\n    }\n  ): Promise<ComicPanel> {\n    const response = await fetch(\n      `${API_BASE}/api/artwork-library/${artworkId}/apply-to-panel/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n    return handleResponse<ComicPanel>(response);\n  },\n};\n\n// ===== Additional TypeScript Interfaces =====\n\nexport interface Proposal {\n  id: number;\n  proposal_type: string;\n  title: string;\n  description: string;\n  proposal_data: Record<string, any>;\n  status: 'pending' | 'approved' | 'rejected' | 'expired' | 'cancelled';\n  voting_threshold: 'majority' | 'unanimous' | 'owner_decides';\n  proposer_id: number;\n  proposer_username: string;\n  expires_at?: string;\n  resolved_at?: string;\n  created_at: string;\n  votes: ProposalVote[];\n  vote_counts: {\n    approve: number;\n    reject: number;\n    abstain: number;\n    total: number;\n  };\n  total_voters: number;\n}\n\nexport interface ProposalVote {\n  id: number;\n  voter_id: number;\n  voter_username: string;\n  vote: 'approve' | 'reject' | 'abstain';\n  comment?: string;\n  voted_at: string;\n}\n\nexport interface CreateProposalData {\n  proposal_type: string;\n  title: string;\n  description?: string;\n  proposal_data: Record<string, any>;\n  voting_threshold?: 'majority' | 'unanimous' | 'owner_decides';\n  expires_in_days?: number;\n}\n\nexport interface CollaboratorRating {\n  id: number;\n  project_id: number;\n  project_title: string;\n  rater_id: number;\n  rater_username: string;\n  rated_user_id: number;\n  rated_user_username: string;\n  quality_score: number;\n  deadline_score: number;\n  communication_score: number;\n  would_collab_again: number;\n  average_score: number;\n  private_note?: string;\n  public_feedback?: string;\n  created_at: string;\n}\n\nexport interface CollaboratorRatingData {\n  quality_score: number;\n  deadline_score: number;\n  communication_score: number;\n  would_collab_again: number;\n  private_note?: string;\n  public_feedback?: string;\n}\n\n// ===== Comic Book Collaboration Interfaces =====\n\nexport type BubbleType = 'oval' | 'thought' | 'shout' | 'whisper' | 'narrative' | 'caption' | 'radio' | 'burst';\nexport type PointerDirection = 'none' | 'top' | 'bottom' | 'left' | 'right' | 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\nexport type BorderStyle = 'solid' | 'dashed' | 'none' | 'jagged' | 'wavy';\nexport type ArtworkFit = 'contain' | 'cover' | 'fill';\nexport type PageFormat = 'standard' | 'manga' | 'webtoon' | 'custom';\n\nexport interface SpeechBubble {\n  id: number;\n  panel: number;\n  bubble_type: BubbleType;\n  x_percent: number;\n  y_percent: number;\n  width_percent: number;\n  height_percent: number;\n  z_index: number;\n  text: string;\n  font_family: string;\n  font_size: number;\n  font_color: string;\n  font_weight: 'normal' | 'bold';\n  font_style: 'normal' | 'italic';\n  text_align: 'left' | 'center' | 'right';\n  background_color: string;\n  border_color: string;\n  border_width: number;\n  pointer_direction: PointerDirection;\n  pointer_position: number;\n  writer?: number;\n  writer_username?: string;\n  order: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface ComicPanel {\n  id: number;\n  page: number;\n  x_percent: number;\n  y_percent: number;\n  width_percent: number;\n  height_percent: number;\n  z_index: number;\n  border_style: BorderStyle;\n  border_width: number;\n  border_color: string;\n  border_radius: number;\n  background_color: string;\n  rotation: number;\n  skew_x: number;  // Horizontal skew for diagonal effect (-45 to 45)\n  skew_y: number;  // Vertical skew for diagonal effect (-45 to 45)\n  artwork?: string;\n  artwork_fit: ArtworkFit;\n  artist?: number;\n  artist_username?: string;\n  order: number;\n  speech_bubbles: SpeechBubble[];\n  created_at: string;\n  updated_at: string;\n}\n\n// Divider Line types for line-based panel layout\nexport type LineType = 'straight' | 'bezier';\n\nexport interface DividerLine {\n  id: number;\n  page: number;\n  line_type: LineType;\n  start_x: number;\n  start_y: number;\n  end_x: number;\n  end_y: number;\n  control1_x?: number | null;\n  control1_y?: number | null;\n  control2_x?: number | null;\n  control2_y?: number | null;\n  thickness?: number | null;\n  color?: string | null;\n  order: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CreateDividerLineData {\n  page: number;\n  line_type?: LineType;\n  start_x: number;\n  start_y: number;\n  end_x: number;\n  end_y: number;\n  control1_x?: number;\n  control1_y?: number;\n  control2_x?: number;\n  control2_y?: number;\n  thickness?: number;\n  color?: string;\n}\n\n// Page orientation types\nexport type PageOrientation = 'portrait' | 'landscape' | 'square' | 'webtoon' | 'manga_b5' | 'social_square' | 'social_story';\n\nexport interface ComicPage {\n  id: number;\n  project?: number | null;\n  issue?: number | null;\n  page_number: number;\n  page_format: PageFormat;\n  canvas_width: number;\n  canvas_height: number;\n  background_image?: string;\n  background_color: string;\n  // Line-based layout fields\n  orientation: PageOrientation;\n  gutter_mode: boolean;\n  default_gutter_width: number;\n  default_line_color: string;\n  layout_version: number;\n  // Content\n  panels: ComicPanel[];\n  divider_lines: DividerLine[];\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface ComicPageListItem {\n  id: number;\n  project: number;\n  page_number: number;\n  page_format: PageFormat;\n  panel_count: number;\n}\n\nexport interface CreateComicPageData {\n  project?: number;\n  issue?: number;\n  page_format?: PageFormat;\n  canvas_width?: number;\n  canvas_height?: number;\n  background_color?: string;\n}\n\nexport interface CreateComicPanelData {\n  page: number;\n  x_percent?: number;\n  y_percent?: number;\n  width_percent?: number;\n  height_percent?: number;\n  z_index?: number;\n  border_style?: BorderStyle;\n  border_width?: number;\n  border_color?: string;\n  border_radius?: number;\n  background_color?: string;\n  rotation?: number;\n  skew_x?: number;\n  skew_y?: number;\n  artwork_fit?: ArtworkFit;\n}\n\nexport interface CreateSpeechBubbleData {\n  panel: number;\n  bubble_type?: BubbleType;\n  x_percent?: number;\n  y_percent?: number;\n  width_percent?: number;\n  height_percent?: number;\n  z_index?: number;\n  text?: string;\n  font_family?: string;\n  font_size?: number;\n  font_color?: string;\n  font_weight?: 'normal' | 'bold';\n  font_style?: 'normal' | 'italic';\n  text_align?: 'left' | 'center' | 'right';\n  background_color?: string;\n  border_color?: string;\n  border_width?: number;\n  pointer_direction?: PointerDirection;\n  pointer_position?: number;\n}\n\n// ===== Comic Series & Issue Interfaces =====\n\nexport interface ComicSeries {\n  id: number;\n  creator: number;\n  creator_username: string;\n  title: string;\n  synopsis: string;\n  cover_image?: string | null;\n  is_published: boolean;\n  published_content?: number | null;\n  issue_count: number;\n  total_pages: number;\n  created_at: string;\n  updated_at: string;\n  issues?: ComicIssue[];\n}\n\nexport interface ComicSeriesListItem {\n  id: number;\n  creator: number;\n  creator_username: string;\n  title: string;\n  cover_image?: string | null;\n  is_published: boolean;\n  issue_count: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface ComicIssue {\n  id: number;\n  series?: number | null;\n  series_title?: string | null;\n  project?: number | null;\n  project_title?: string | null;\n  title: string;\n  issue_number: number;\n  synopsis: string;\n  cover_image?: string | null;\n  price: number;\n  is_published: boolean;\n  is_listed: boolean;\n  published_content?: number | null;\n  page_count: number;\n  created_at: string;\n  updated_at: string;\n  pages?: ComicPage[];\n}\n\nexport interface ComicIssueListItem {\n  id: number;\n  series?: number | null;\n  project?: number | null;\n  title: string;\n  issue_number: number;\n  cover_image?: string | null;\n  price: number;\n  is_published: boolean;\n  is_listed: boolean;\n  page_count: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CreateComicSeriesData {\n  title: string;\n  synopsis?: string;\n}\n\nexport interface CreateComicIssueData {\n  series?: number;\n  project?: number;\n  title: string;\n  issue_number?: number;\n  synopsis?: string;\n  price?: number;\n}\n\n// ===== Artwork Library Interfaces =====\n\nexport interface ArtworkLibraryItem {\n  id: number;\n  project: number;\n  file: string;\n  file_url: string;\n  thumbnail?: string;\n  thumbnail_url: string;\n  title: string;\n  filename: string;\n  width: number;\n  height: number;\n  file_size: number;\n  uploader: number;\n  uploader_username: string;\n  usage_count: number;\n  created_at: string;\n  updated_at: string;\n}\n","/**\n * InviteResponseModal Component\n *\n * Displays collaboration invite details and allows the recipient to\n * Accept, Decline, or Counter-Propose.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Clock } from 'lucide-react';\nimport {\n  collaborationApi,\n  CollaborativeProject,\n  CollaboratorRole\n} from '../../services/collaborationApi';\n\ninterface InviteResponseModalProps {\n  open: boolean;\n  onClose: () => void;\n  projectId: number;\n  notificationMessage?: string;\n}\n\ntype ModalMode = 'view' | 'counter-propose';\n\nexport function InviteResponseModal({\n  open,\n  onClose,\n  projectId,\n  notificationMessage\n}: InviteResponseModalProps) {\n  const navigate = useNavigate();\n\n  // State\n  const [loading, setLoading] = useState(true);\n  const [project, setProject] = useState<CollaborativeProject | null>(null);\n  const [myRole, setMyRole] = useState<CollaboratorRole | null>(null);\n  const [mode, setMode] = useState<ModalMode>('view');\n  const [proposedPercentage, setProposedPercentage] = useState(50);\n  const [counterMessage, setCounterMessage] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n\n  // Load project details\n  useEffect(() => {\n    if (!open || !projectId) return;\n\n    const loadProject = async () => {\n      setLoading(true);\n      setError('');\n      try {\n        const data = await collaborationApi.getCollaborativeProject(projectId);\n        setProject(data);\n\n        // Find current user's role (the one with status='invited')\n        const invitedRole = data.collaborators.find(\n          (c: CollaboratorRole) => c.status === 'invited'\n        );\n        if (invitedRole) {\n          setMyRole(invitedRole);\n          setProposedPercentage(invitedRole.revenue_percentage);\n        }\n      } catch (err: any) {\n        setError(err.message || 'Failed to load project details');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadProject();\n  }, [open, projectId]);\n\n  // Reset state when closed\n  useEffect(() => {\n    if (!open) {\n      setMode('view');\n      setCounterMessage('');\n      setError('');\n      setSuccess('');\n    }\n  }, [open]);\n\n  if (!open) return null;\n\n  const handleAccept = async () => {\n    setSubmitting(true);\n    setError('');\n    try {\n      await collaborationApi.acceptInvitation(projectId);\n      setSuccess('Invite accepted! Redirecting to project...');\n      setTimeout(() => {\n        onClose();\n        navigate(`/collaborations/${projectId}`);\n      }, 1500);\n    } catch (err: any) {\n      setError(err.message || 'Failed to accept invitation');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleDecline = async () => {\n    setSubmitting(true);\n    setError('');\n    try {\n      await collaborationApi.declineInvitation(projectId);\n      setSuccess('Invite declined.');\n      setTimeout(() => {\n        onClose();\n      }, 1500);\n    } catch (err: any) {\n      setError(err.message || 'Failed to decline invitation');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleCounterPropose = async () => {\n    if (!counterMessage.trim()) {\n      setError('Please add a message explaining your counter-proposal');\n      return;\n    }\n\n    setSubmitting(true);\n    setError('');\n    try {\n      await collaborationApi.counterProposeInvite(projectId, {\n        proposed_percentage: proposedPercentage,\n        message: counterMessage,\n      });\n\n      setSuccess('Counter-proposal sent! Waiting for response...');\n      setTimeout(() => {\n        onClose();\n      }, 2000);\n    } catch (err: any) {\n      setError(err.message || 'Failed to send counter-proposal');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get project creator info\n  const creator = project?.collaborators.find(\n    (c: CollaboratorRole) => c.user === project.created_by\n  );\n\n  // Calculate others' share\n  const othersPercentage = myRole ? 100 - myRole.revenue_percentage : 0;\n\n  // Check if there's a pending counter-proposal (user already submitted one)\n  const hasCounterProposal = myRole &&\n    myRole.proposed_percentage !== null &&\n    myRole.proposed_percentage !== undefined &&\n    Math.abs(Number(myRole.proposed_percentage) - Number(myRole.revenue_percentage)) > 0.001;\n\n  const contentTypeLabels: Record<string, string> = {\n    book: 'Book',\n    music: 'Music',\n    video: 'Video',\n    art: 'Art',\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0,0,0,0.9)',\n        display: 'grid',\n        placeItems: 'center',\n        zIndex: 1000,\n        padding: 20,\n      }}\n      onClick={(e) => {\n        if (e.target === e.currentTarget && !submitting) onClose();\n      }}\n    >\n      <div\n        style={{\n          background: '#0f172a',\n          border: '1px solid #334155',\n          borderRadius: 16,\n          width: '100%',\n          maxWidth: 600,\n          maxHeight: '90vh',\n          overflow: 'auto',\n          boxShadow: '0 20px 25px -5px rgba(0,0,0,0.5)',\n        }}\n      >\n        {/* Header */}\n        <div\n          style={{\n            padding: 24,\n            borderBottom: '1px solid #334155',\n            background: 'linear-gradient(135deg, #1e293b 0%, #0f172a 100%)',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'flex-start',\n          }}\n        >\n          <div>\n            <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 8 }}>\n              <span style={{ fontSize: 24 }}></span>\n              <h2 style={{ margin: 0, color: '#f8fafc', fontSize: 20, fontWeight: 600 }}>\n                Collaboration Invite\n              </h2>\n            </div>\n            {creator && (\n              <p style={{ margin: 0, color: '#94a3b8', fontSize: 14 }}>\n                from <span style={{ color: '#f59e0b' }}>@{creator.username}</span>\n              </p>\n            )}\n          </div>\n          <button\n            onClick={onClose}\n            disabled={submitting}\n            style={{\n              background: 'transparent',\n              border: 'none',\n              color: '#94a3b8',\n              fontSize: 24,\n              cursor: submitting ? 'not-allowed' : 'pointer',\n              padding: 4,\n            }}\n          >\n            \n          </button>\n        </div>\n\n        {/* Content */}\n        <div style={{ padding: 24 }}>\n          {loading ? (\n            <div style={{ textAlign: 'center', padding: 40, color: '#94a3b8' }}>\n              Loading project details...\n            </div>\n          ) : error && !project ? (\n            <div style={{ textAlign: 'center', padding: 40, color: '#ef4444' }}>\n              {error}\n            </div>\n          ) : project && myRole ? (\n            mode === 'view' ? (\n              <>\n                {/* Project Info */}\n                <div style={{ marginBottom: 24 }}>\n                  <div\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: 12,\n                      marginBottom: 12,\n                    }}\n                  >\n                    <span\n                      style={{\n                        background: '#f59e0b20',\n                        color: '#f59e0b',\n                        padding: '4px 12px',\n                        borderRadius: 6,\n                        fontSize: 12,\n                        fontWeight: 600,\n                      }}\n                    >\n                      {contentTypeLabels[project.content_type] || project.content_type}\n                    </span>\n                    <span style={{ color: '#64748b', fontSize: 13 }}>\n                      {project.status === 'draft' ? 'Draft' : 'Active'}\n                    </span>\n                  </div>\n                  <h3 style={{ margin: 0, color: '#f8fafc', fontSize: 24, fontWeight: 700 }}>\n                    {project.title}\n                  </h3>\n                  {project.description && (\n                    <p style={{ margin: '8px 0 0', color: '#94a3b8', fontSize: 14, lineHeight: 1.6 }}>\n                      {project.description}\n                    </p>\n                  )}\n                </div>\n\n                {/* Your Role */}\n                <div\n                  style={{\n                    background: '#1e293b',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 20,\n                  }}\n                >\n                  <div style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, marginBottom: 8, textTransform: 'uppercase' }}>\n                    Your Role\n                  </div>\n                  <div style={{ color: '#f8fafc', fontSize: 18, fontWeight: 600 }}>\n                    {myRole.role || 'Collaborator'}\n                  </div>\n                </div>\n\n                {/* Contract Tasks */}\n                {myRole.contract_tasks && myRole.contract_tasks.length > 0 && (\n                  <div\n                    style={{\n                      background: '#1e293b',\n                      borderRadius: 12,\n                      padding: 16,\n                      marginBottom: 20,\n                    }}\n                  >\n                    <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>\n                      <span style={{ fontSize: 18 }}></span>\n                      <span style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, textTransform: 'uppercase' }}>\n                        Your Contract Tasks ({myRole.contract_tasks.length})\n                      </span>\n                    </div>\n\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: 10 }}>\n                      {myRole.contract_tasks.map((task: any, index: number) => (\n                        <div\n                          key={task.id || index}\n                          style={{\n                            background: '#0f172a',\n                            borderRadius: 8,\n                            padding: 14,\n                            borderLeft: '3px solid #f59e0b',\n                          }}\n                        >\n                          <div style={{ color: '#f8fafc', fontSize: 14, fontWeight: 600 }}>\n                            {task.title}\n                          </div>\n                          {task.description && (\n                            <div style={{ color: '#94a3b8', fontSize: 13, marginTop: 6, lineHeight: 1.5 }}>\n                              {task.description}\n                            </div>\n                          )}\n                          <div\n                            style={{\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: 6,\n                              marginTop: 10,\n                              color: '#f59e0b',\n                              fontSize: 12,\n                              fontWeight: 500,\n                            }}\n                          >\n                            <span></span>\n                            <span>\n                              Due: {new Date(task.deadline).toLocaleDateString('en-US', {\n                                weekday: 'short',\n                                month: 'short',\n                                day: 'numeric',\n                                year: 'numeric',\n                              })}\n                            </span>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n\n                    <div\n                      style={{\n                        marginTop: 16,\n                        padding: 12,\n                        background: 'rgba(245, 158, 11, 0.1)',\n                        borderRadius: 8,\n                        display: 'flex',\n                        alignItems: 'flex-start',\n                        gap: 10,\n                      }}\n                    >\n                      <span style={{ fontSize: 16 }}></span>\n                      <div style={{ color: '#f59e0b', fontSize: 12, lineHeight: 1.5 }}>\n                        <strong>Contract Terms:</strong> By accepting, you commit to completing these tasks\n                        by their deadlines. Tasks become binding and can only be changed via mutual agreement.\n                        Missing deadlines may affect the collaboration.\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Pitch Message */}\n                {notificationMessage && (\n                  <div\n                    style={{\n                      background: '#1e293b',\n                      borderRadius: 12,\n                      padding: 16,\n                      marginBottom: 20,\n                      borderLeft: '3px solid #3b82f6',\n                    }}\n                  >\n                    <div style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, marginBottom: 8, textTransform: 'uppercase' }}>\n                      Message from @{creator?.username}\n                    </div>\n                    <div style={{ color: '#cbd5e1', fontSize: 14, lineHeight: 1.6, whiteSpace: 'pre-wrap' }}>\n                      {notificationMessage}\n                    </div>\n                  </div>\n                )}\n\n                {/* Revenue Split */}\n                <div\n                  style={{\n                    background: '#1e293b',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 20,\n                  }}\n                >\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>\n                    <span style={{ fontSize: 18 }}></span>\n                    <span style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, textTransform: 'uppercase' }}>\n                      Revenue Split\n                    </span>\n                  </div>\n\n                  {/* Split bar */}\n                  <div style={{ display: 'flex', gap: 4, marginBottom: 8 }}>\n                    <div\n                      style={{\n                        flex: myRole.revenue_percentage,\n                        background: '#f59e0b',\n                        height: 40,\n                        borderRadius: '8px 0 0 8px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        color: '#000',\n                        fontWeight: 700,\n                        fontSize: 14,\n                        minWidth: 60,\n                      }}\n                    >\n                      You: {myRole.revenue_percentage}%\n                    </div>\n                    <div\n                      style={{\n                        flex: othersPercentage,\n                        background: '#334155',\n                        height: 40,\n                        borderRadius: '0 8px 8px 0',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        color: '#cbd5e1',\n                        fontWeight: 600,\n                        fontSize: 14,\n                        minWidth: 60,\n                      }}\n                    >\n                      Others: {othersPercentage}%\n                    </div>\n                  </div>\n                </div>\n\n                {/* Permissions */}\n                <div\n                  style={{\n                    background: '#1e293b',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 20,\n                  }}\n                >\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>\n                    <span style={{ fontSize: 18 }}></span>\n                    <span style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, textTransform: 'uppercase' }}>\n                      Your Permissions\n                    </span>\n                  </div>\n                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8 }}>\n                    {[\n                      { key: 'can_edit_text', label: 'Text', value: myRole.can_edit_text },\n                      { key: 'can_edit_images', label: 'Images', value: myRole.can_edit_images },\n                      { key: 'can_edit_audio', label: 'Audio', value: myRole.can_edit_audio },\n                      { key: 'can_edit_video', label: 'Video', value: myRole.can_edit_video },\n                    ].map((perm) => (\n                      <span\n                        key={perm.key}\n                        style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: 6,\n                          padding: '6px 12px',\n                          borderRadius: 6,\n                          background: perm.value ? '#10b98120' : '#64748b20',\n                          color: perm.value ? '#10b981' : '#64748b',\n                          fontSize: 13,\n                          fontWeight: 500,\n                        }}\n                      >\n                        {perm.value ? '' : ''} {perm.label}\n                      </span>\n                    ))}\n                  </div>\n                </div>\n\n                {/* On-Chain Notice */}\n                <div\n                  style={{\n                    background: 'linear-gradient(135deg, #7c3aed20 0%, #3b82f620 100%)',\n                    border: '1px solid #7c3aed40',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 24,\n                  }}\n                >\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 8 }}>\n                    <span style={{ fontSize: 18 }}></span>\n                    <span style={{ color: '#a78bfa', fontSize: 13, fontWeight: 600 }}>\n                      On-Chain Agreement\n                    </span>\n                  </div>\n                  <p style={{ margin: 0, color: '#c4b5fd', fontSize: 13, lineHeight: 1.6 }}>\n                    By accepting, you agree to the revenue split above. When this project is minted as an NFT,\n                    the split will be enforced via smart contract. USDC payments will be distributed automatically.\n                  </p>\n                </div>\n\n                {/* Error/Success Messages */}\n                {error && (\n                  <div\n                    style={{\n                      background: '#ef444420',\n                      border: '1px solid #ef4444',\n                      color: '#fca5a5',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {error}\n                  </div>\n                )}\n                {success && (\n                  <div\n                    style={{\n                      background: '#10b98120',\n                      border: '1px solid #10b981',\n                      color: '#6ee7b7',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {success}\n                  </div>\n                )}\n\n                {/* Action Buttons */}\n                {hasCounterProposal ? (\n                  /* Pending Counter-Proposal State */\n                  <div style={{\n                    background: 'linear-gradient(135deg, #f59e0b10 0%, #fbbf2410 100%)',\n                    border: '1px solid #f59e0b40',\n                    borderRadius: 12,\n                    padding: 20,\n                    textAlign: 'center',\n                  }}>\n                    <div style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      gap: 10,\n                      marginBottom: 12,\n                    }}>\n                      <Clock size={22} style={{ color: '#f59e0b' }} />\n                      <span style={{ color: '#f59e0b', fontSize: 16, fontWeight: 600 }}>\n                        Counter-Proposal Pending\n                      </span>\n                    </div>\n                    <p style={{ margin: 0, color: '#fbbf24', fontSize: 14, lineHeight: 1.6 }}>\n                      You proposed <strong>{myRole?.proposed_percentage}%</strong> revenue split\n                      (original offer: {myRole?.revenue_percentage}%).\n                    </p>\n                    <p style={{ margin: '8px 0 0', color: '#94a3b8', fontSize: 13 }}>\n                      Waiting for @{creator?.username} to respond to your counter-proposal.\n                    </p>\n\n                    {/* Still allow declining while waiting */}\n                    <button\n                      onClick={handleDecline}\n                      disabled={submitting}\n                      style={{\n                        marginTop: 16,\n                        padding: '10px 24px',\n                        borderRadius: 8,\n                        border: '1px solid #ef4444',\n                        background: 'transparent',\n                        color: '#ef4444',\n                        fontSize: 13,\n                        fontWeight: 600,\n                        cursor: submitting ? 'not-allowed' : 'pointer',\n                        opacity: submitting ? 0.6 : 1,\n                      }}\n                    >\n                      Withdraw & Decline\n                    </button>\n                  </div>\n                ) : (\n                  /* Normal Action Buttons */\n                  <div style={{ display: 'flex', gap: 12 }}>\n                    <button\n                      onClick={handleDecline}\n                      disabled={submitting}\n                      style={{\n                        flex: 1,\n                        padding: '14px 20px',\n                        borderRadius: 10,\n                        border: '1px solid #ef4444',\n                        background: 'transparent',\n                        color: '#ef4444',\n                        fontSize: 14,\n                        fontWeight: 600,\n                        cursor: submitting ? 'not-allowed' : 'pointer',\n                        opacity: submitting ? 0.6 : 1,\n                      }}\n                    >\n                      Decline\n                    </button>\n                    <button\n                      onClick={() => setMode('counter-propose')}\n                      disabled={submitting}\n                      style={{\n                        flex: 1,\n                        padding: '14px 20px',\n                        borderRadius: 10,\n                        border: '1px solid #3b82f6',\n                        background: 'transparent',\n                        color: '#3b82f6',\n                        fontSize: 14,\n                        fontWeight: 600,\n                        cursor: submitting ? 'not-allowed' : 'pointer',\n                        opacity: submitting ? 0.6 : 1,\n                      }}\n                    >\n                      Counter-Propose\n                    </button>\n                    <button\n                      onClick={handleAccept}\n                      disabled={submitting}\n                      style={{\n                        flex: 1.5,\n                        padding: '14px 20px',\n                        borderRadius: 10,\n                        border: 'none',\n                        background: '#10b981',\n                        color: '#fff',\n                        fontSize: 14,\n                        fontWeight: 700,\n                        cursor: submitting ? 'not-allowed' : 'pointer',\n                        opacity: submitting ? 0.6 : 1,\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        gap: 8,\n                      }}\n                    >\n                      {submitting ? 'Processing...' : ' Accept Invite'}\n                    </button>\n                  </div>\n                )}\n              </>\n            ) : (\n              /* Counter-Propose Mode */\n              <>\n                <button\n                  onClick={() => setMode('view')}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: '#94a3b8',\n                    fontSize: 14,\n                    cursor: 'pointer',\n                    padding: 0,\n                    marginBottom: 16,\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 8,\n                  }}\n                >\n                   Back to invite\n                </button>\n\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 24 }}>\n                  <span style={{ fontSize: 24 }}></span>\n                  <h3 style={{ margin: 0, color: '#f8fafc', fontSize: 20, fontWeight: 600 }}>\n                    Propose Different Terms\n                  </h3>\n                </div>\n\n                {/* Proposed Split */}\n                <div style={{ marginBottom: 24 }}>\n                  <label\n                    style={{\n                      display: 'block',\n                      color: '#94a3b8',\n                      fontSize: 13,\n                      fontWeight: 600,\n                      marginBottom: 12,\n                    }}\n                  >\n                    Suggested Revenue Split: {proposedPercentage}% for you\n                  </label>\n                  <input\n                    type=\"range\"\n                    min={5}\n                    max={95}\n                    step={5}\n                    value={proposedPercentage}\n                    onChange={(e) => setProposedPercentage(parseInt(e.target.value))}\n                    style={{ width: '100%', marginBottom: 8 }}\n                  />\n                  <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: 12, color: '#64748b' }}>\n                    <span>Current offer: {myRole.revenue_percentage}%</span>\n                    <span>Proposing: {proposedPercentage}%</span>\n                  </div>\n\n                  {/* Visual diff */}\n                  {proposedPercentage !== myRole.revenue_percentage && (\n                    <div\n                      style={{\n                        marginTop: 12,\n                        padding: 12,\n                        background: '#1e293b',\n                        borderRadius: 8,\n                        fontSize: 13,\n                      }}\n                    >\n                      <span style={{ color: '#94a3b8' }}>Change: </span>\n                      <span\n                        style={{\n                          color: proposedPercentage > myRole.revenue_percentage ? '#10b981' : '#ef4444',\n                          fontWeight: 600,\n                        }}\n                      >\n                        {myRole.revenue_percentage}%  {proposedPercentage}%\n                        ({proposedPercentage > myRole.revenue_percentage ? '+' : ''}\n                        {proposedPercentage - myRole.revenue_percentage}%)\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                {/* Message */}\n                <div style={{ marginBottom: 24 }}>\n                  <label\n                    style={{\n                      display: 'block',\n                      color: '#94a3b8',\n                      fontSize: 13,\n                      fontWeight: 600,\n                      marginBottom: 8,\n                    }}\n                  >\n                    Message to @{creator?.username}\n                  </label>\n                  <textarea\n                    value={counterMessage}\n                    onChange={(e) => setCounterMessage(e.target.value)}\n                    placeholder=\"Explain why you'd like a different split...\"\n                    style={{\n                      width: '100%',\n                      minHeight: 120,\n                      background: '#1e293b',\n                      border: '1px solid #334155',\n                      borderRadius: 8,\n                      padding: 12,\n                      color: '#f8fafc',\n                      fontSize: 14,\n                      resize: 'vertical',\n                    }}\n                  />\n                  <div style={{ fontSize: 11, color: '#64748b', marginTop: 4 }}>\n                    {counterMessage.length}/500 characters\n                  </div>\n                </div>\n\n                {/* Error/Success */}\n                {error && (\n                  <div\n                    style={{\n                      background: '#ef444420',\n                      border: '1px solid #ef4444',\n                      color: '#fca5a5',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {error}\n                  </div>\n                )}\n                {success && (\n                  <div\n                    style={{\n                      background: '#10b98120',\n                      border: '1px solid #10b981',\n                      color: '#6ee7b7',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {success}\n                  </div>\n                )}\n\n                {/* Actions */}\n                <div style={{ display: 'flex', gap: 12 }}>\n                  <button\n                    onClick={() => setMode('view')}\n                    disabled={submitting}\n                    style={{\n                      flex: 1,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: '1px solid #334155',\n                      background: 'transparent',\n                      color: '#cbd5e1',\n                      fontSize: 14,\n                      fontWeight: 600,\n                      cursor: submitting ? 'not-allowed' : 'pointer',\n                    }}\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleCounterPropose}\n                    disabled={submitting || !counterMessage.trim() || counterMessage.length > 500}\n                    style={{\n                      flex: 2,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: 'none',\n                      background: '#3b82f6',\n                      color: '#fff',\n                      fontSize: 14,\n                      fontWeight: 700,\n                      cursor:\n                        submitting || !counterMessage.trim() || counterMessage.length > 500\n                          ? 'not-allowed'\n                          : 'pointer',\n                      opacity:\n                        submitting || !counterMessage.trim() || counterMessage.length > 500\n                          ? 0.6\n                          : 1,\n                    }}\n                  >\n                    {submitting ? 'Sending...' : 'Send Counter-Offer'}\n                  </button>\n                </div>\n              </>\n            )\n          ) : (\n            <div style={{ textAlign: 'center', padding: 40, color: '#94a3b8' }}>\n              No invite found for this project.\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default InviteResponseModal;\n","/**\n * NotificationDropdown Component\n * Dropdown panel showing recent notifications (last 10)\n */\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useNotifications } from '../../hooks/useNotifications';\nimport { Notification } from '../../services/notificationService';\nimport NotificationItem from './NotificationItem';\nimport { InviteResponseModal } from '../collaboration/InviteResponseModal';\n\ninterface NotificationDropdownProps {\n  isOpen: boolean;\n  onClose: () => void;\n  anchorEl?: HTMLElement | null;\n}\n\nexport function NotificationDropdown({ isOpen, onClose, anchorEl }: NotificationDropdownProps) {\n  const navigate = useNavigate();\n  const panelRef = useRef<HTMLDivElement>(null);\n\n  // State for invite modal\n  const [inviteModalOpen, setInviteModalOpen] = useState(false);\n  const [selectedInvite, setSelectedInvite] = useState<Notification | null>(null);\n\n  const {\n    notifications,\n    unreadCount,\n    isLoading,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification,\n    refresh,\n  } = useNotifications();\n\n  // Get last 10 notifications\n  const recentNotifications = notifications.slice(0, 10);\n\n  // Handle viewing an invite\n  const handleViewInvite = async (notification: Notification) => {\n    // Mark as read\n    if (!notification.read) {\n      await markAsRead(notification.id);\n    }\n    setSelectedInvite(notification);\n    setInviteModalOpen(true);\n  };\n\n  // Close invite modal\n  const handleCloseInviteModal = () => {\n    setInviteModalOpen(false);\n    setSelectedInvite(null);\n    refresh(); // Refresh notifications after modal closes\n  };\n\n  // Close panel when clicking outside\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        panelRef.current &&\n        !panelRef.current.contains(event.target as Node) &&\n        anchorEl &&\n        !anchorEl.contains(event.target as Node)\n      ) {\n        onClose();\n      }\n    };\n\n    const timer = setTimeout(() => {\n      document.addEventListener('mousedown', handleClickOutside);\n    }, 100);\n\n    return () => {\n      clearTimeout(timer);\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, onClose, anchorEl]);\n\n  // Close on escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen, onClose]);\n\n  // Refresh notifications when panel opens\n  useEffect(() => {\n    if (isOpen) {\n      refresh();\n    }\n  }, [isOpen, refresh]);\n\n  const handleNotificationClick = async (notification: any) => {\n    // Mark as read\n    if (!notification.read) {\n      await markAsRead(notification.id);\n    }\n\n    // Navigate to action URL if provided\n    if (notification.action_url) {\n      navigate(notification.action_url);\n      onClose();\n    } else if (notification.project_id) {\n      navigate(`/collaborations/${notification.project_id}`);\n      onClose();\n    }\n  };\n\n  const handleMarkAllRead = async () => {\n    try {\n      await markAllAsRead();\n    } catch (error) {\n      console.error('Failed to mark all as read:', error);\n    }\n  };\n\n  const handleDelete = async (e: React.MouseEvent, notificationId: number) => {\n    e.stopPropagation();\n    try {\n      await deleteNotification(notificationId);\n    } catch (error) {\n      console.error('Failed to delete notification:', error);\n    }\n  };\n\n  const handleViewAll = () => {\n    navigate('/notifications');\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      ref={panelRef}\n      role=\"dialog\"\n      aria-label=\"Notifications\"\n      aria-modal=\"false\"\n      style={{\n        position: 'absolute',\n        top: '100%',\n        right: 0,\n        marginTop: 8,\n        width: 'min(420px, calc(100vw - 32px))',\n        maxHeight: 600,\n        background: '#0f172a',\n        border: '1px solid #1f2937',\n        borderRadius: 12,\n        boxShadow: '0 10px 40px rgba(0, 0, 0, 0.5)',\n        zIndex: 3000,\n        display: 'flex',\n        flexDirection: 'column',\n        overflow: 'hidden',\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          padding: '16px 20px',\n          borderBottom: '1px solid #1f2937',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\n          <h3 style={{ fontSize: 16, fontWeight: 700, color: '#e5e7eb', margin: 0 }}>\n            Notifications\n          </h3>\n          {unreadCount > 0 && (\n            <div\n              aria-label={`${unreadCount} unread`}\n              style={{\n                background: '#ef4444',\n                color: '#fff',\n                fontSize: 11,\n                fontWeight: 700,\n                padding: '2px 8px',\n                borderRadius: 10,\n                minWidth: 20,\n                textAlign: 'center',\n              }}\n            >\n              {unreadCount}\n            </div>\n          )}\n        </div>\n\n        {recentNotifications.length > 0 && unreadCount > 0 && (\n          <button\n            onClick={handleMarkAllRead}\n            aria-label=\"Mark all as read\"\n            style={{\n              background: 'transparent',\n              color: '#3b82f6',\n              border: 'none',\n              fontSize: 12,\n              fontWeight: 600,\n              cursor: 'pointer',\n              padding: '4px 8px',\n              borderRadius: 4,\n              transition: 'all 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = '#1e293b';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = 'transparent';\n            }}\n          >\n            Mark All Read\n          </button>\n        )}\n      </div>\n\n      {/* Content */}\n      <div\n        style={{\n          flex: 1,\n          overflowY: 'auto',\n          maxHeight: 500,\n        }}\n      >\n        {isLoading && recentNotifications.length === 0 ? (\n          <div\n            style={{\n              padding: 40,\n              textAlign: 'center',\n              color: '#94a3b8',\n              fontSize: 14,\n            }}\n          >\n            Loading notifications...\n          </div>\n        ) : recentNotifications.length === 0 ? (\n          <div\n            style={{\n              padding: 40,\n              textAlign: 'center',\n              color: '#94a3b8',\n            }}\n          >\n            <div style={{ fontSize: 48, marginBottom: 12 }} aria-hidden=\"true\">\n              \n            </div>\n            <div style={{ fontSize: 14, fontWeight: 600, marginBottom: 4 }}>\n              No notifications yet\n            </div>\n            <div style={{ fontSize: 12, color: '#64748b' }}>\n              We'll notify you when there's activity on your collaborations\n            </div>\n          </div>\n        ) : (\n          <div style={{ padding: '8px 0' }}>\n            {recentNotifications.map((notification) => (\n              <NotificationItem\n                key={notification.id}\n                notification={notification}\n                onClick={() => handleNotificationClick(notification)}\n                onDelete={(e) => handleDelete(e, notification.id)}\n                onViewInvite={handleViewInvite}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Footer - Always show View All link */}\n      {recentNotifications.length > 0 && (\n        <div\n          style={{\n            padding: '12px 20px',\n            borderTop: '1px solid #1f2937',\n            display: 'flex',\n            gap: 8,\n          }}\n        >\n          <button\n            onClick={handleViewAll}\n            aria-label=\"View all notifications\"\n            style={{\n              background: 'transparent',\n              color: '#3b82f6',\n              border: 'none',\n              fontSize: 13,\n              fontWeight: 600,\n              cursor: 'pointer',\n              padding: '6px 12px',\n              borderRadius: 6,\n              flex: 1,\n              transition: 'all 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = '#1e293b';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = 'transparent';\n            }}\n          >\n            View All ({notifications.length})\n          </button>\n        </div>\n      )}\n\n      {/* Invite Response Modal */}\n      {selectedInvite && selectedInvite.project_id && (\n        <InviteResponseModal\n          open={inviteModalOpen}\n          onClose={handleCloseInviteModal}\n          projectId={selectedInvite.project_id}\n          notificationMessage={selectedInvite.message}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default NotificationDropdown;\n","/**\n * NotificationBell Component\n * Bell icon with unread count badge for navbar\n */\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Bell } from 'lucide-react';\nimport { useUnreadCount } from '../../hooks/useNotifications';\nimport { events } from '../../services/notificationService';\nimport { useMobile } from '../../hooks/useMobile';\nimport NotificationDropdown from './NotificationDropdown';\n\nexport function NotificationBell() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const bellRef = useRef<HTMLButtonElement>(null);\n  const { unreadCount } = useUnreadCount();\n  const { isMobile } = useMobile();\n  const navigate = useNavigate();\n\n  // Animate bell when new notifications arrive\n  useEffect(() => {\n    const unsubscribe = events.on('notifications:new', () => {\n      setIsAnimating(true);\n      setTimeout(() => setIsAnimating(false), 1000);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const handleClick = () => {\n    // On mobile, navigate directly to the notifications page\n    if (isMobile) {\n      navigate('/notifications');\n    } else {\n      // On desktop, toggle the dropdown\n      setIsOpen(!isOpen);\n    }\n  };\n\n  return (\n    <div style={{ position: 'relative' }}>\n      <button\n        ref={bellRef}\n        onClick={handleClick}\n        aria-label={`Notifications${unreadCount > 0 ? ` (${unreadCount} unread)` : ''}`}\n        aria-expanded={isOpen}\n        aria-haspopup=\"true\"\n        className=\"rb-nav-link\"\n        title=\"Notifications\"\n      >\n        <span style={{ position: 'relative', display: 'flex', alignItems: 'center' }}>\n          <Bell\n            size={20}\n            style={{\n              animation: isAnimating ? 'ring 1s ease-in-out' : 'none',\n              transformOrigin: 'top center',\n            }}\n          />\n          {unreadCount > 0 && (\n            <span\n              style={{\n                position: 'absolute',\n                top: -6,\n                right: -8,\n                background: '#ef4444',\n                color: '#fff',\n                fontSize: 10,\n                fontWeight: 700,\n                padding: '2px 5px',\n                borderRadius: 10,\n                minWidth: 16,\n                textAlign: 'center',\n                boxShadow: '0 0 8px rgba(239, 68, 68, 0.5)',\n              }}\n              aria-label={`${unreadCount} unread notifications`}\n            >\n              {unreadCount}\n            </span>\n          )}\n        </span>\n        <span>Alerts</span>\n      </button>\n\n      <NotificationDropdown\n        isOpen={isOpen}\n        onClose={() => setIsOpen(false)}\n        anchorEl={bellRef.current}\n      />\n\n      {/* Keyframes for bell animation */}\n      <style>{`\n        @keyframes ring {\n          0%, 100% { transform: rotate(0deg); }\n          10%, 30%, 50%, 70% { transform: rotate(15deg); }\n          20%, 40%, 60%, 80% { transform: rotate(-15deg); }\n          90% { transform: rotate(5deg); }\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default NotificationBell;\n","/**\n * NotificationToast Component\n * Toast notification with auto-dismiss and action buttons\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Notification,\n  getNotificationIcon,\n  getNotificationColor,\n} from '../../services/notificationService';\n\ninterface NotificationToastProps {\n  notification: Notification;\n  onDismiss: () => void;\n  autoDismissMs?: number;\n}\n\nexport function NotificationToast({\n  notification,\n  onDismiss,\n  autoDismissMs = 5000,\n}: NotificationToastProps) {\n  const navigate = useNavigate();\n  const [isExiting, setIsExiting] = useState(false);\n  const icon = getNotificationIcon(notification.type);\n  const color = getNotificationColor(notification.type);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      handleDismiss();\n    }, autoDismissMs);\n\n    return () => clearTimeout(timer);\n  }, [autoDismissMs]);\n\n  const handleDismiss = () => {\n    setIsExiting(true);\n    setTimeout(() => {\n      onDismiss();\n    }, 300); // Match animation duration\n  };\n\n  const handleView = () => {\n    if (notification.action_url) {\n      navigate(notification.action_url);\n    } else if (notification.project_id) {\n      navigate(`/collaborations/${notification.project_id}`);\n    }\n    handleDismiss();\n  };\n\n  return (\n    <div\n      role=\"alert\"\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n      style={{\n        width: 380,\n        background: '#1e293b',\n        border: `1px solid ${color}40`,\n        borderLeft: `4px solid ${color}`,\n        borderRadius: 8,\n        boxShadow: '0 10px 40px rgba(0, 0, 0, 0.3)',\n        overflow: 'hidden',\n        marginBottom: 12,\n        animation: isExiting\n          ? 'slideOut 0.3s ease-out forwards'\n          : 'slideIn 0.3s ease-out',\n      }}\n    >\n      {/* Progress bar */}\n      <div\n        style={{\n          height: 3,\n          background: `linear-gradient(90deg, ${color} 0%, transparent 100%)`,\n          animation: `progress ${autoDismissMs}ms linear forwards`,\n        }}\n      />\n\n      <div style={{ padding: '16px' }}>\n        {/* Header */}\n        <div style={{ display: 'flex', alignItems: 'flex-start', gap: 12, marginBottom: 12 }}>\n          <div\n            style={{\n              fontSize: 24,\n              width: 40,\n              height: 40,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              background: `${color}20`,\n              borderRadius: 8,\n              flexShrink: 0,\n            }}\n            aria-hidden=\"true\"\n          >\n            {icon}\n          </div>\n\n          <div style={{ flex: 1, minWidth: 0 }}>\n            <div\n              style={{\n                fontSize: 14,\n                fontWeight: 700,\n                color: '#e5e7eb',\n                marginBottom: 4,\n                lineHeight: 1.3,\n              }}\n            >\n              {notification.title}\n            </div>\n            <div\n              style={{\n                fontSize: 13,\n                color: '#94a3b8',\n                lineHeight: 1.4,\n              }}\n            >\n              {notification.message}\n            </div>\n          </div>\n\n          <button\n            onClick={handleDismiss}\n            aria-label=\"Dismiss notification\"\n            style={{\n              background: 'transparent',\n              border: 'none',\n              color: '#64748b',\n              cursor: 'pointer',\n              padding: 4,\n              fontSize: 20,\n              lineHeight: 1,\n              transition: 'color 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.color = '#e5e7eb';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.color = '#64748b';\n            }}\n          >\n            \n          </button>\n        </div>\n\n        {/* Actions */}\n        <div style={{ display: 'flex', gap: 8 }}>\n          {(notification.action_url || notification.project_id) && (\n            <button\n              onClick={handleView}\n              style={{\n                background: color,\n                color: '#fff',\n                border: 'none',\n                borderRadius: 6,\n                padding: '6px 16px',\n                fontSize: 13,\n                fontWeight: 600,\n                cursor: 'pointer',\n                transition: 'all 0.2s',\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.opacity = '0.9';\n                e.currentTarget.style.transform = 'translateY(-1px)';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.opacity = '1';\n                e.currentTarget.style.transform = 'translateY(0)';\n              }}\n            >\n              View\n            </button>\n          )}\n          <button\n            onClick={handleDismiss}\n            style={{\n              background: 'transparent',\n              color: '#94a3b8',\n              border: '1px solid #334155',\n              borderRadius: 6,\n              padding: '6px 16px',\n              fontSize: 13,\n              fontWeight: 600,\n              cursor: 'pointer',\n              transition: 'all 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = '#334155';\n              e.currentTarget.style.color = '#e5e7eb';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = 'transparent';\n              e.currentTarget.style.color = '#94a3b8';\n            }}\n          >\n            Dismiss\n          </button>\n        </div>\n      </div>\n\n      {/* Animations */}\n      <style>{`\n        @keyframes slideIn {\n          from {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n\n        @keyframes slideOut {\n          from {\n            transform: translateX(0);\n            opacity: 1;\n          }\n          to {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n        }\n\n        @keyframes progress {\n          from {\n            transform: scaleX(1);\n          }\n          to {\n            transform: scaleX(0);\n          }\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default NotificationToast;\n","/**\n * NotificationToastContainer Component\n * Manages and displays multiple toast notifications in a stack\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { events, Notification } from '../../services/notificationService';\nimport NotificationToast from './NotificationToast';\n\nexport function NotificationToastContainer() {\n  const [toasts, setToasts] = useState<Notification[]>([]);\n\n  useEffect(() => {\n    // Subscribe to new notifications event\n    const unsubscribe = events.on('notifications:new', ({ notifications }) => {\n      // Add new notifications to toast queue\n      setToasts((prev) => [...prev, ...notifications]);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const handleDismiss = (notificationId: number) => {\n    setToasts((prev) => prev.filter((n) => n.id !== notificationId));\n  };\n\n  if (toasts.length === 0) return null;\n\n  return (\n    <div\n      aria-live=\"polite\"\n      aria-atomic=\"false\"\n      style={{\n        position: 'fixed',\n        top: 80,\n        right: 20,\n        zIndex: 9999,\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'flex-end',\n        pointerEvents: 'none',\n      }}\n    >\n      <div style={{ pointerEvents: 'auto' }}>\n        {toasts.map((notification) => (\n          <NotificationToast\n            key={notification.id}\n            notification={notification}\n            onDismiss={() => handleDismiss(notification.id)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default NotificationToastContainer;\n","import React, { useState } from 'react';\nimport { API_URL } from '../config';\n\ninterface FeedbackModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function FeedbackModal({ isOpen, onClose }: FeedbackModalProps) {\n  const [feedback, setFeedback] = useState('');\n  const [email, setEmail] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [submitted, setSubmitted] = useState(false);\n  const [error, setError] = useState('');\n\n  if (!isOpen) return null;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setSubmitting(true);\n    setError('');\n\n    try {\n      // Send feedback to backend\n      const response = await fetch(`${API_URL}/api/feedback/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          feedback: feedback,\n          email: email || 'anonymous',\n        }),\n      });\n\n      if (response.ok) {\n        setSubmitted(true);\n        setFeedback('');\n        setEmail('');\n        setTimeout(() => {\n          onClose();\n          setSubmitted(false);\n        }, 2000);\n      } else {\n        setError('Failed to submit feedback. Please try again.');\n      }\n    } catch (err) {\n      console.error('Feedback error:', err);\n      setError('Network error. Please try again later.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0, 0, 0, 0.8)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n        padding: '20px',\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: '#1a1f2e',\n          border: '1px solid #2a3444',\n          borderRadius: '16px',\n          padding: '32px',\n          maxWidth: '500px',\n          width: '100%',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5)',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {submitted ? (\n          <div style={{ textAlign: 'center' }}>\n            <div style={{ fontSize: '48px', marginBottom: '16px' }}></div>\n            <h2 style={{ fontSize: '24px', fontWeight: 700, color: '#10b981', margin: '0 0 8px 0' }}>\n              Thank You!\n            </h2>\n            <p style={{ fontSize: '14px', color: '#94a3b8', margin: 0 }}>\n              Your feedback helps us improve renaissBlock\n            </p>\n          </div>\n        ) : (\n          <>\n            {/* Header */}\n            <div style={{ marginBottom: '24px' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>\n                <h2 style={{ fontSize: '24px', fontWeight: 700, color: '#e5e7eb', margin: 0 }}>\n                  Beta Feedback\n                </h2>\n                <button\n                  onClick={onClose}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: '#94a3b8',\n                    fontSize: '24px',\n                    cursor: 'pointer',\n                    padding: '0',\n                    lineHeight: 1,\n                  }}\n                >\n                  \n                </button>\n              </div>\n              <p style={{ fontSize: '14px', color: '#94a3b8', margin: 0 }}>\n                Help us improve by sharing your thoughts, bugs, or feature requests\n              </p>\n            </div>\n\n            {/* Form */}\n            <form onSubmit={handleSubmit} style={{ display: 'grid', gap: '16px' }}>\n              <div>\n                <label style={{ display: 'block', fontSize: '13px', color: '#cbd5e1', marginBottom: '8px', fontWeight: 600 }}>\n                  Your Feedback *\n                </label>\n                <textarea\n                  value={feedback}\n                  onChange={(e) => setFeedback(e.target.value)}\n                  placeholder=\"Tell us what you think! Include bugs, feature requests, or general feedback...\"\n                  required\n                  rows={6}\n                  style={{\n                    width: '100%',\n                    padding: '12px',\n                    background: '#0f1419',\n                    border: '1px solid #2a3444',\n                    borderRadius: '8px',\n                    color: '#e5e7eb',\n                    fontSize: '14px',\n                    fontFamily: 'inherit',\n                    resize: 'vertical',\n                  }}\n                />\n              </div>\n\n              <div>\n                <label style={{ display: 'block', fontSize: '13px', color: '#cbd5e1', marginBottom: '8px', fontWeight: 600 }}>\n                  Email (optional)\n                </label>\n                <input\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  placeholder=\"your@email.com (if you'd like a response)\"\n                  style={{\n                    width: '100%',\n                    padding: '12px',\n                    background: '#0f1419',\n                    border: '1px solid #2a3444',\n                    borderRadius: '8px',\n                    color: '#e5e7eb',\n                    fontSize: '14px',\n                  }}\n                />\n              </div>\n\n              {error && (\n                <div style={{\n                  padding: '12px',\n                  background: '#fee2e2',\n                  color: '#dc2626',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                }}>\n                  {error}\n                </div>\n              )}\n\n              <button\n                type=\"submit\"\n                disabled={submitting || !feedback.trim()}\n                style={{\n                  background: submitting ? '#94a3b8' : 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n                  color: '#000',\n                  border: 'none',\n                  padding: '14px 24px',\n                  borderRadius: '8px',\n                  fontSize: '16px',\n                  fontWeight: 700,\n                  cursor: submitting ? 'not-allowed' : 'pointer',\n                  width: '100%',\n                }}\n              >\n                {submitting ? 'Submitting...' : 'Submit Feedback'}\n              </button>\n            </form>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default FeedbackModal;\n","import React, { useState } from 'react';\nimport FeedbackModal from './FeedbackModal';\nimport { MessageSquare } from 'lucide-react';\n\ninterface BetaBadgeProps {\n  variant?: 'header' | 'inline' | 'full';\n  showTestMode?: boolean;\n}\n\nexport function BetaBadge({ variant = 'header', showTestMode = true }: BetaBadgeProps) {\n  if (variant === 'header') {\n    return (\n      <span\n        style={{\n          display: 'inline-flex',\n          alignItems: 'center',\n          background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n          padding: '2px 8px',\n          borderRadius: '4px',\n          fontSize: '10px',\n          fontWeight: 700,\n          color: '#000',\n          letterSpacing: '0.3px',\n        }}\n      >\n        Beta\n      </span>\n    );\n  }\n\n  if (variant === 'inline') {\n    return (\n      <span\n        style={{\n          display: 'inline-block',\n          background: '#f59e0b',\n          color: '#000',\n          padding: '2px 8px',\n          borderRadius: '4px',\n          fontSize: '11px',\n          fontWeight: 700,\n          letterSpacing: '0.5px',\n          marginLeft: '8px',\n        }}\n      >\n        BETA\n      </span>\n    );\n  }\n\n  if (variant === 'full') {\n    return (\n      <div\n        style={{\n          background: 'linear-gradient(135deg, #f59e0b15 0%, #d9770615 100%)',\n          border: '1px solid #f59e0b40',\n          borderRadius: '12px',\n          padding: '16px 20px',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '16px',\n        }}\n      >\n        <div\n          style={{\n            background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n            padding: '8px 16px',\n            borderRadius: '8px',\n            fontSize: '14px',\n            fontWeight: 700,\n            color: '#000',\n            letterSpacing: '0.5px',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          BETA\n        </div>\n        <div style={{ flex: 1 }}>\n          <div style={{ fontSize: '14px', fontWeight: 600, color: '#e5e7eb', marginBottom: '4px' }}>\n            You're in the Beta!\n          </div>\n          <div style={{ fontSize: '13px', color: '#94a3b8', lineHeight: 1.4 }}>\n            Help us improve by{' '}\n            <a\n              href=\"mailto:feedback@renaissblock.com\"\n              style={{\n                color: '#f59e0b',\n                textDecoration: 'none',\n                fontWeight: 600,\n              }}\n            >\n              sharing feedback\n            </a>\n            . All transactions are in test mode.\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n}\n\nexport function TestModeBanner() {\n  const [showFeedback, setShowFeedback] = useState(false);\n\n  return (\n    <>\n      <button\n        onClick={() => setShowFeedback(true)}\n        style={{\n          position: 'fixed',\n          bottom: 20,\n          right: 20,\n          background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n          color: '#000',\n          border: 'none',\n          padding: '12px 20px',\n          borderRadius: '30px',\n          fontSize: '14px',\n          fontWeight: 700,\n          cursor: 'pointer',\n          zIndex: 1000,\n          boxShadow: '0 4px 12px rgba(245, 158, 11, 0.4)',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '8px',\n          transition: 'transform 0.2s, box-shadow 0.2s',\n        }}\n        onMouseEnter={(e) => {\n          e.currentTarget.style.transform = 'scale(1.05)';\n          e.currentTarget.style.boxShadow = '0 6px 16px rgba(245, 158, 11, 0.5)';\n        }}\n        onMouseLeave={(e) => {\n          e.currentTarget.style.transform = 'scale(1)';\n          e.currentTarget.style.boxShadow = '0 4px 12px rgba(245, 158, 11, 0.4)';\n        }}\n        title=\"Send feedback about the beta\"\n      >\n        <MessageSquare size={18} />\n        Feedback\n      </button>\n      <FeedbackModal isOpen={showFeedback} onClose={() => setShowFeedback(false)} />\n    </>\n  );\n}\n\nexport function BetaWelcomeModal({ onClose }: { onClose: () => void }) {\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0, 0, 0, 0.8)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n        padding: '20px',\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: '#1a1f2e',\n          border: '1px solid #2a3444',\n          borderRadius: '16px',\n          padding: '32px',\n          maxWidth: '500px',\n          width: '100%',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5)',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div style={{ textAlign: 'center', marginBottom: '24px' }}>\n          <div\n            style={{\n              display: 'inline-block',\n              background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n              padding: '12px 24px',\n              borderRadius: '12px',\n              fontSize: '18px',\n              fontWeight: 700,\n              color: '#000',\n              letterSpacing: '1px',\n              marginBottom: '16px',\n            }}\n          >\n            BETA TESTER\n          </div>\n          <h2 style={{ fontSize: '24px', fontWeight: 700, color: '#e5e7eb', margin: '0 0 8px 0' }}>\n            Welcome to renaissBlock Beta!\n          </h2>\n          <p style={{ fontSize: '14px', color: '#94a3b8', margin: 0 }}>\n            You're one of the first creators to experience the future\n          </p>\n        </div>\n\n        {/* Content */}\n        <div style={{ marginBottom: '24px' }}>\n          <div style={{ marginBottom: '16px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 600, color: '#f59e0b', marginBottom: '8px' }}>\n               Test Mode Active\n            </div>\n            <ul style={{ fontSize: '13px', color: '#cbd5e1', margin: '0', paddingLeft: '20px', lineHeight: 1.6 }}>\n              <li>No real money charged (use test card: 4242 4242 4242 4242)</li>\n              <li>Blockchain features use Solana devnet (fake SOL)</li>\n              <li>Some features still being polished</li>\n            </ul>\n          </div>\n\n          <div style={{ marginBottom: '16px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 600, color: '#f59e0b', marginBottom: '8px' }}>\n               What to Try\n            </div>\n            <ul style={{ fontSize: '13px', color: '#cbd5e1', margin: '0', paddingLeft: '20px', lineHeight: 1.6 }}>\n              <li>Create and publish your first content</li>\n              <li>Collaborate with other beta testers</li>\n              <li>Test the purchase and reading experience</li>\n            </ul>\n          </div>\n\n          <div\n            style={{\n              background: '#f59e0b20',\n              border: '1px solid #f59e0b40',\n              borderRadius: '8px',\n              padding: '12px',\n              marginTop: '16px',\n            }}\n          >\n            <div style={{ fontSize: '13px', color: '#fbbf24', fontWeight: 600, marginBottom: '4px' }}>\n               Beta Perks\n            </div>\n            <p style={{ fontSize: '12px', color: '#cbd5e1', margin: 0, lineHeight: 1.5 }}>\n              As a beta tester, you'll get early access to new features and special recognition when we launch!\n            </p>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div style={{ textAlign: 'center' }}>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n              color: '#000',\n              border: 'none',\n              padding: '12px 32px',\n              borderRadius: '8px',\n              fontSize: '14px',\n              fontWeight: 700,\n              cursor: 'pointer',\n              width: '100%',\n              marginBottom: '12px',\n            }}\n          >\n            Let's Go! \n          </button>\n          <div style={{ fontSize: '12px', color: '#64748b' }}>\n            Questions?{' '}\n            <a\n              href=\"mailto:feedback@renaissblock.com\"\n              style={{ color: '#f59e0b', textDecoration: 'none', fontWeight: 600 }}\n            >\n              feedback@renaissblock.com\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { BetaWelcomeModal } from './BetaBadge';\nimport { useAuth } from '../hooks/useAuth';\n\n/**\n * BetaOnboarding Component\n *\n * Shows welcome modal to new beta users on first login\n * Stores completion in localStorage to avoid showing again\n */\nexport function BetaOnboarding() {\n  const { isAuthenticated, user } = useAuth();\n  const [showWelcome, setShowWelcome] = useState(false);\n\n  useEffect(() => {\n    if (!isAuthenticated || !user) {\n      return;\n    }\n\n    // Check if user has seen the welcome modal\n    const hasSeenWelcome = localStorage.getItem('beta_welcome_seen');\n    const lastSeenUserId = localStorage.getItem('beta_welcome_user_id');\n\n    // Show welcome if:\n    // 1. Never seen before, OR\n    // 2. Different user than last time (account switching)\n    if (!hasSeenWelcome || lastSeenUserId !== String(user.id)) {\n      // Small delay to let the app load first\n      setTimeout(() => {\n        setShowWelcome(true);\n      }, 1000);\n    }\n  }, [isAuthenticated, user]);\n\n  const handleClose = () => {\n    if (user) {\n      localStorage.setItem('beta_welcome_seen', 'true');\n      localStorage.setItem('beta_welcome_user_id', String(user.id));\n    }\n    setShowWelcome(false);\n  };\n\n  return (\n    <>\n      {showWelcome && <BetaWelcomeModal onClose={handleClose} />}\n    </>\n  );\n}\n\nexport default BetaOnboarding;\n","/**\n * Footer component with legal links.\n */\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nexport function Footer() {\n  const currentYear = new Date().getFullYear();\n\n  return (\n    <footer style={{\n      marginTop: 'auto',\n      padding: '24px 20px',\n      borderTop: '1px solid var(--border, #334155)',\n      background: 'var(--bg-secondary, #1e293b)',\n    }}>\n      <div style={{\n        maxWidth: 1200,\n        margin: '0 auto',\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-between',\n        alignItems: 'flex-start',\n        gap: 32,\n      }}>\n        {/* Brand */}\n        <div style={{ minWidth: 200 }}>\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 10,\n            marginBottom: 8,\n          }}>\n            <img\n              src=\"/rb-logo.png\"\n              alt=\"renaissBlock\"\n              style={{\n                height: 28,\n                width: 'auto',\n                borderRadius: 4,\n              }}\n            />\n            <span style={{\n              fontSize: 16,\n              fontWeight: 700,\n              color: 'var(--text, #e5e7eb)',\n            }}>\n              renaissBlock\n            </span>\n          </div>\n          <div style={{\n            fontSize: 13,\n            color: 'var(--text-muted, #94a3b8)',\n          }}>\n            A platform for serious creators.\n          </div>\n        </div>\n\n        {/* Legal Links */}\n        <div style={{ minWidth: 150 }}>\n          <div style={{\n            fontSize: 13,\n            fontWeight: 600,\n            color: 'var(--text, #e5e7eb)',\n            marginBottom: 12,\n            textTransform: 'uppercase',\n            letterSpacing: '0.5px',\n          }}>\n            Legal\n          </div>\n          <nav style={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 8,\n          }}>\n            <Link to=\"/legal/terms\" style={linkStyle}>Terms of Service</Link>\n            <Link to=\"/legal/privacy\" style={linkStyle}>Privacy Policy</Link>\n            <Link to=\"/legal/content-policy\" style={linkStyle}>Content Policy</Link>\n            <Link to=\"/legal/dmca\" style={linkStyle}>DMCA / Copyright</Link>\n            <Link to=\"/legal/creator-agreement\" style={linkStyle}>Creator Agreement</Link>\n          </nav>\n        </div>\n\n        {/* Support Links */}\n        <div style={{ minWidth: 150 }}>\n          <div style={{\n            fontSize: 13,\n            fontWeight: 600,\n            color: 'var(--text, #e5e7eb)',\n            marginBottom: 12,\n            textTransform: 'uppercase',\n            letterSpacing: '0.5px',\n          }}>\n            Support\n          </div>\n          <nav style={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 8,\n          }}>\n            <a href=\"mailto:support@renaissblock.com\" style={linkStyle}>Contact Us</a>\n            <a href=\"mailto:dmca@renaissblock.com\" style={linkStyle}>Report Copyright</a>\n            <a href=\"mailto:reports@renaissblock.com\" style={linkStyle}>Report Content</a>\n          </nav>\n        </div>\n\n        {/* Copyright */}\n        <div style={{\n          width: '100%',\n          paddingTop: 16,\n          borderTop: '1px solid var(--border, #334155)',\n          marginTop: 8,\n        }}>\n          <div style={{\n            fontSize: 12,\n            color: 'var(--text-muted, #94a3b8)',\n            textAlign: 'center',\n          }}>\n            &copy; {currentYear} renaissBlock. All rights reserved.\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n\nconst linkStyle: React.CSSProperties = {\n  fontSize: 13,\n  color: 'var(--text-muted, #94a3b8)',\n  textDecoration: 'none',\n  transition: 'color 0.2s',\n};\n\nexport default Footer;\n","/**\n * Cookie consent banner for GDPR/CCPA compliance.\n * Shows on first visit and stores preference in localStorage.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { X } from 'lucide-react';\n\nconst COOKIE_CONSENT_KEY = 'rb_cookie_consent';\n\ninterface CookiePreferences {\n  necessary: boolean; // Always true\n  analytics: boolean;\n  marketing: boolean;\n}\n\nexport function CookieBanner() {\n  const [isVisible, setIsVisible] = useState(false);\n  const [showCustomize, setShowCustomize] = useState(false);\n  const [preferences, setPreferences] = useState<CookiePreferences>({\n    necessary: true,\n    analytics: false,\n    marketing: false,\n  });\n\n  useEffect(() => {\n    // Check if user has already made a choice\n    const consent = localStorage.getItem(COOKIE_CONSENT_KEY);\n    if (!consent) {\n      // Small delay to prevent flash on page load\n      const timer = setTimeout(() => setIsVisible(true), 1000);\n      return () => clearTimeout(timer);\n    }\n  }, []);\n\n  const saveConsent = (prefs: CookiePreferences) => {\n    localStorage.setItem(COOKIE_CONSENT_KEY, JSON.stringify({\n      ...prefs,\n      timestamp: new Date().toISOString(),\n    }));\n    setIsVisible(false);\n  };\n\n  const handleAcceptAll = () => {\n    saveConsent({\n      necessary: true,\n      analytics: true,\n      marketing: true,\n    });\n  };\n\n  const handleRejectNonEssential = () => {\n    saveConsent({\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    });\n  };\n\n  const handleSavePreferences = () => {\n    saveConsent(preferences);\n  };\n\n  if (!isVisible) return null;\n\n  return (\n    <div style={{\n      position: 'fixed',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      zIndex: 9999,\n      background: 'var(--bg, #0f172a)',\n      borderTop: '1px solid var(--border, #334155)',\n      padding: '16px 20px',\n      boxShadow: '0 -4px 20px rgba(0, 0, 0, 0.3)',\n    }}>\n      <div style={{\n        maxWidth: 1200,\n        margin: '0 auto',\n      }}>\n        {!showCustomize ? (\n          // Simple banner\n          <div style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            alignItems: 'center',\n            gap: 16,\n            justifyContent: 'space-between',\n          }}>\n            <div style={{ flex: '1 1 400px' }}>\n              <p style={{\n                margin: 0,\n                fontSize: 14,\n                color: 'var(--text, #e5e7eb)',\n              }}>\n                We use cookies to improve your experience.{' '}\n                <Link\n                  to=\"/legal/privacy\"\n                  style={{ color: 'var(--accent, #f59e0b)' }}\n                >\n                  Learn more in our Privacy Policy\n                </Link>\n              </p>\n            </div>\n            <div style={{\n              display: 'flex',\n              gap: 8,\n              flexWrap: 'wrap',\n            }}>\n              <button\n                onClick={() => setShowCustomize(true)}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: '1px solid var(--border, #334155)',\n                  background: 'transparent',\n                  color: 'var(--text, #e5e7eb)',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                }}\n              >\n                Customize\n              </button>\n              <button\n                onClick={handleRejectNonEssential}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: '1px solid var(--border, #334155)',\n                  background: 'transparent',\n                  color: 'var(--text, #e5e7eb)',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                }}\n              >\n                Reject Non-Essential\n              </button>\n              <button\n                onClick={handleAcceptAll}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: 'none',\n                  background: 'var(--accent, #f59e0b)',\n                  color: '#000',\n                  fontSize: 13,\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                }}\n              >\n                Accept All\n              </button>\n            </div>\n          </div>\n        ) : (\n          // Customize view\n          <div>\n            <div style={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              marginBottom: 16,\n            }}>\n              <h3 style={{\n                margin: 0,\n                fontSize: 16,\n                fontWeight: 600,\n                color: 'var(--text, #e5e7eb)',\n              }}>\n                Cookie Preferences\n              </h3>\n              <button\n                onClick={() => setShowCustomize(false)}\n                style={{\n                  background: 'none',\n                  border: 'none',\n                  padding: 4,\n                  cursor: 'pointer',\n                  color: 'var(--text-muted, #94a3b8)',\n                }}\n              >\n                <X size={18} />\n              </button>\n            </div>\n\n            <div style={{\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 12,\n              marginBottom: 16,\n            }}>\n              <label style={{\n                display: 'flex',\n                gap: 12,\n                alignItems: 'flex-start',\n                padding: 12,\n                background: 'var(--bg-secondary, #1e293b)',\n                borderRadius: 6,\n              }}>\n                <input\n                  type=\"checkbox\"\n                  checked={true}\n                  disabled\n                  style={{ marginTop: 3 }}\n                />\n                <div>\n                  <div style={{ fontWeight: 500, color: 'var(--text, #e5e7eb)', marginBottom: 2 }}>\n                    Necessary Cookies\n                  </div>\n                  <div style={{ fontSize: 13, color: 'var(--text-muted, #94a3b8)' }}>\n                    Required for the website to function. Cannot be disabled.\n                  </div>\n                </div>\n              </label>\n\n              <label style={{\n                display: 'flex',\n                gap: 12,\n                alignItems: 'flex-start',\n                padding: 12,\n                background: 'var(--bg-secondary, #1e293b)',\n                borderRadius: 6,\n                cursor: 'pointer',\n              }}>\n                <input\n                  type=\"checkbox\"\n                  checked={preferences.analytics}\n                  onChange={(e) => setPreferences(prev => ({ ...prev, analytics: e.target.checked }))}\n                  style={{ marginTop: 3 }}\n                />\n                <div>\n                  <div style={{ fontWeight: 500, color: 'var(--text, #e5e7eb)', marginBottom: 2 }}>\n                    Analytics Cookies\n                  </div>\n                  <div style={{ fontSize: 13, color: 'var(--text-muted, #94a3b8)' }}>\n                    Help us understand how you use the site to improve it.\n                  </div>\n                </div>\n              </label>\n\n              <label style={{\n                display: 'flex',\n                gap: 12,\n                alignItems: 'flex-start',\n                padding: 12,\n                background: 'var(--bg-secondary, #1e293b)',\n                borderRadius: 6,\n                cursor: 'pointer',\n              }}>\n                <input\n                  type=\"checkbox\"\n                  checked={preferences.marketing}\n                  onChange={(e) => setPreferences(prev => ({ ...prev, marketing: e.target.checked }))}\n                  style={{ marginTop: 3 }}\n                />\n                <div>\n                  <div style={{ fontWeight: 500, color: 'var(--text, #e5e7eb)', marginBottom: 2 }}>\n                    Marketing Cookies\n                  </div>\n                  <div style={{ fontSize: 13, color: 'var(--text-muted, #94a3b8)' }}>\n                    Used to show you relevant content and ads.\n                  </div>\n                </div>\n              </label>\n            </div>\n\n            <div style={{ display: 'flex', justifyContent: 'flex-end', gap: 8 }}>\n              <button\n                onClick={handleRejectNonEssential}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: '1px solid var(--border, #334155)',\n                  background: 'transparent',\n                  color: 'var(--text, #e5e7eb)',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                }}\n              >\n                Reject All\n              </button>\n              <button\n                onClick={handleSavePreferences}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: 'none',\n                  background: 'var(--accent, #f59e0b)',\n                  color: '#000',\n                  fontSize: 13,\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                }}\n              >\n                Save Preferences\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default CookieBanner;\n","/**\n * Cart Context - Shopping cart state management\n *\n * Provides cart state and operations to all components.\n * Persists cart via backend API (database-backed).\n */\n\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { API_URL } from '../config';\n\ninterface CartItem {\n  id: number;\n  type: 'chapter' | 'content';\n  item_id: number;\n  title: string;\n  creator_username: string;\n  unit_price: string;\n  added_at: string;\n  book_title?: string;\n  chapter_order?: number;\n  cover_url?: string;\n}\n\ninterface BreakdownDisplay {\n  subtotal: string;\n  credit_card_fee: string;\n  buyer_total: string;\n  savings: string;\n  item_count: number;\n}\n\ninterface Cart {\n  id: number;\n  status: string;\n  item_count: number;\n  max_items: number;\n  items: CartItem[];\n  subtotal?: string;\n  credit_card_fee?: string;\n  total?: string;\n  savings_vs_individual?: string;\n  breakdown_display?: BreakdownDisplay;\n}\n\ninterface CartContextType {\n  cart: Cart | null;\n  loading: boolean;\n  error: string | null;\n  addToCart: (chapterId?: number, contentId?: number) => Promise<boolean>;\n  removeFromCart: (itemId: number) => Promise<boolean>;\n  clearCart: () => Promise<void>;\n  checkout: () => Promise<string | null>;\n  refreshCart: () => Promise<void>;\n  isInCart: (itemId: number, type: 'chapter' | 'content') => boolean;\n}\n\nconst CartContext = createContext<CartContextType | undefined>(undefined);\n\nexport function CartProvider({ children }: { children: React.ReactNode }) {\n  const [cart, setCart] = useState<Cart | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const getCSRFToken = async () => {\n    try {\n      const res = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' });\n      const data = await res.json();\n      return data?.csrfToken || '';\n    } catch {\n      return '';\n    }\n  };\n\n  const refreshCart = useCallback(async () => {\n    try {\n      const res = await fetch(`${API_URL}/api/cart/`, { credentials: 'include' });\n      if (res.ok) {\n        const data = await res.json();\n        setCart(data);\n        setError(null);\n      } else if (res.status === 403) {\n        // Not authenticated\n        setCart(null);\n      }\n    } catch (e) {\n      console.error('Failed to fetch cart:', e);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    refreshCart();\n  }, [refreshCart]);\n\n  const addToCart = async (chapterId?: number, contentId?: number): Promise<boolean> => {\n    setError(null);\n    try {\n      const csrfToken = await getCSRFToken();\n      const res = await fetch(`${API_URL}/api/cart/add/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({ chapter_id: chapterId, content_id: contentId }),\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        setError(data.error || 'Failed to add to cart');\n        return false;\n      }\n\n      await refreshCart();\n      return true;\n    } catch (e) {\n      setError('Failed to add to cart');\n      return false;\n    }\n  };\n\n  const removeFromCart = async (itemId: number): Promise<boolean> => {\n    setError(null);\n    try {\n      const csrfToken = await getCSRFToken();\n      const res = await fetch(`${API_URL}/api/cart/remove/${itemId}/`, {\n        method: 'DELETE',\n        headers: { 'X-CSRFToken': csrfToken },\n        credentials: 'include',\n      });\n\n      if (res.ok) {\n        await refreshCart();\n        return true;\n      }\n      return false;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  const clearCart = async () => {\n    setError(null);\n    try {\n      const csrfToken = await getCSRFToken();\n      await fetch(`${API_URL}/api/cart/clear/`, {\n        method: 'POST',\n        headers: { 'X-CSRFToken': csrfToken },\n        credentials: 'include',\n      });\n      await refreshCart();\n    } catch (e) {\n      console.error('Failed to clear cart:', e);\n    }\n  };\n\n  const checkout = async (): Promise<string | null> => {\n    setError(null);\n    try {\n      const csrfToken = await getCSRFToken();\n      const res = await fetch(`${API_URL}/api/cart/checkout/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken,\n        },\n        credentials: 'include',\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        setError(data.error || 'Checkout failed');\n        return null;\n      }\n\n      return data.checkout_url;\n    } catch (e) {\n      setError('Checkout failed');\n      return null;\n    }\n  };\n\n  const isInCart = (itemId: number, type: 'chapter' | 'content'): boolean => {\n    if (!cart) return false;\n    return cart.items.some(\n      item => item.item_id === itemId && item.type === type\n    );\n  };\n\n  return (\n    <CartContext.Provider value={{\n      cart,\n      loading,\n      error,\n      addToCart,\n      removeFromCart,\n      clearCart,\n      checkout,\n      refreshCart,\n      isInCart,\n    }}>\n      {children}\n    </CartContext.Provider>\n  );\n}\n\nexport function useCart() {\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within CartProvider');\n  }\n  return context;\n}\n\nexport default CartContext;\n","/**\n * Cart Icon Component\n *\n * Shopping cart icon for header navigation.\n * Shows item count badge when cart has items.\n */\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { ShoppingCart } from 'lucide-react';\nimport { useCart } from '../contexts/CartContext';\n\ninterface CartIconProps {\n  className?: string;\n}\n\nexport default function CartIcon({ className = '' }: CartIconProps) {\n  const { cart, loading } = useCart();\n  const itemCount = cart?.item_count || 0;\n\n  return (\n    <Link\n      to=\"/cart\"\n      className={`rb-nav-link rb-cart-icon ${className}`}\n      title={itemCount > 0 ? `Cart (${itemCount} items)` : 'Cart'}\n      style={{\n        position: 'relative',\n        display: 'flex',\n        alignItems: 'center',\n        color: 'var(--text, #e2e8f0)',\n        textDecoration: 'none',\n      }}\n    >\n      <span style={{ position: 'relative', display: 'flex', alignItems: 'center' }}>\n        <ShoppingCart size={20} />\n        {!loading && itemCount > 0 && (\n          <span\n            style={{\n              position: 'absolute',\n              top: '-6px',\n              right: '-8px',\n              backgroundColor: 'var(--accent, #3b82f6)',\n              color: 'white',\n              fontSize: '10px',\n              fontWeight: 600,\n              minWidth: '16px',\n              height: '16px',\n              borderRadius: '50%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              padding: '0 3px',\n            }}\n          >\n            {itemCount > 99 ? '99+' : itemCount}\n          </span>\n        )}\n      </span>\n      <span>Cart</span>\n    </Link>\n  );\n}\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Search, Clock, TrendingUp, X } from 'lucide-react';\nimport { API_URL } from '../config';\n\ntype Suggestion = {\n  id: number;\n  title: string;\n  creator_username?: string;\n  content_type?: string;\n};\n\ntype Props = {\n  onSearch?: (query: string) => void;\n};\n\nconst RECENT_SEARCHES_KEY = 'rb_recent_searches';\nconst MAX_RECENT_SEARCHES = 5;\n\nexport function SearchAutocomplete({ onSearch }: Props) {\n  const [query, setQuery] = useState('');\n  const [suggestions, setSuggestions] = useState<Suggestion[]>([]);\n  const [recentSearches, setRecentSearches] = useState<string[]>([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const [loading, setLoading] = useState(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const navigate = useNavigate();\n\n  // Load recent searches from localStorage\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(RECENT_SEARCHES_KEY);\n      if (stored) {\n        setRecentSearches(JSON.parse(stored));\n      }\n    } catch {}\n  }, []);\n\n  // Save recent search\n  const saveRecentSearch = (search: string) => {\n    if (!search.trim()) return;\n    const updated = [search, ...recentSearches.filter(s => s !== search)].slice(0, MAX_RECENT_SEARCHES);\n    setRecentSearches(updated);\n    try {\n      localStorage.setItem(RECENT_SEARCHES_KEY, JSON.stringify(updated));\n    } catch {}\n  };\n\n  // Remove recent search\n  const removeRecentSearch = (search: string, e: React.MouseEvent) => {\n    e.stopPropagation();\n    const updated = recentSearches.filter(s => s !== search);\n    setRecentSearches(updated);\n    try {\n      localStorage.setItem(RECENT_SEARCHES_KEY, JSON.stringify(updated));\n    } catch {}\n  };\n\n  // Fetch suggestions (debounced)\n  useEffect(() => {\n    if (query.length < 2) {\n      setSuggestions([]);\n      return;\n    }\n\n    const timer = setTimeout(() => {\n      setLoading(true);\n      fetch(`${API_URL}/api/search/?q=${encodeURIComponent(query)}`, { credentials: 'include' })\n        .then(r => r.json())\n        .then(data => {\n          if (Array.isArray(data)) {\n            setSuggestions(data.slice(0, 6));\n          }\n        })\n        .catch(() => setSuggestions([]))\n        .finally(() => setLoading(false));\n    }, 200);\n\n    return () => clearTimeout(timer);\n  }, [query]);\n\n  // Handle click outside to close dropdown\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(e.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Handle search submission\n  const handleSearch = (searchQuery: string) => {\n    if (!searchQuery.trim()) return;\n    saveRecentSearch(searchQuery.trim());\n    setIsOpen(false);\n    setQuery(searchQuery);\n    if (onSearch) {\n      onSearch(searchQuery);\n    } else {\n      navigate(`/search?q=${encodeURIComponent(searchQuery.trim())}`);\n    }\n  };\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    const items = query.length >= 2 ? suggestions : recentSearches;\n    const totalItems = items.length;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setSelectedIndex(prev => (prev < totalItems - 1 ? prev + 1 : prev));\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setSelectedIndex(prev => (prev > 0 ? prev - 1 : -1));\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (selectedIndex >= 0 && selectedIndex < totalItems) {\n          const selected = query.length >= 2\n            ? suggestions[selectedIndex]?.title\n            : recentSearches[selectedIndex];\n          if (selected) handleSearch(selected);\n        } else {\n          handleSearch(query);\n        }\n        break;\n      case 'Escape':\n        setIsOpen(false);\n        inputRef.current?.blur();\n        break;\n    }\n  };\n\n  // Reset selection when suggestions change\n  useEffect(() => {\n    setSelectedIndex(-1);\n  }, [suggestions, recentSearches]);\n\n  const showDropdown = isOpen && (query.length >= 2 ? suggestions.length > 0 : recentSearches.length > 0);\n\n  return (\n    <div ref={containerRef} className=\"search-autocomplete\" style={{ position: 'relative', width: '100%' }}>\n      <form\n        onSubmit={(e) => { e.preventDefault(); handleSearch(query); }}\n        className=\"rb-search\"\n      >\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={query}\n          onChange={(e) => setQuery(e.target.value)}\n          onFocus={() => setIsOpen(true)}\n          onKeyDown={handleKeyDown}\n          placeholder=\"Search\"\n          autoComplete=\"off\"\n        />\n        <button type=\"submit\">\n          <Search size={18} />\n        </button>\n      </form>\n\n      {/* Dropdown */}\n      {showDropdown && (\n        <div className=\"search-dropdown\" style={{\n          position: 'absolute',\n          top: '100%',\n          left: 0,\n          right: 0,\n          marginTop: 4,\n          background: '#1e293b',\n          borderRadius: 8,\n          boxShadow: '0 4px 20px rgba(0,0,0,0.4)',\n          zIndex: 1000,\n          overflow: 'hidden',\n          border: '1px solid #334155',\n        }}>\n          {query.length >= 2 ? (\n            // Show search suggestions\n            <>\n              {suggestions.map((item, index) => (\n                <div\n                  key={item.id}\n                  onClick={() => handleSearch(item.title)}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 12,\n                    padding: '10px 16px',\n                    cursor: 'pointer',\n                    background: selectedIndex === index ? '#334155' : 'transparent',\n                  }}\n                  onMouseEnter={() => setSelectedIndex(index)}\n                >\n                  <Search size={16} style={{ color: '#64748b', flexShrink: 0 }} />\n                  <div style={{ flex: 1, minWidth: 0 }}>\n                    <div style={{\n                      color: '#f1f5f9',\n                      fontSize: 14,\n                      whiteSpace: 'nowrap',\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis',\n                    }}>\n                      {item.title}\n                    </div>\n                    {item.creator_username && (\n                      <div style={{ color: '#64748b', fontSize: 12 }}>\n                        by {item.creator_username}\n                      </div>\n                    )}\n                  </div>\n                  {item.content_type && (\n                    <span style={{\n                      fontSize: 10,\n                      padding: '2px 6px',\n                      background: '#334155',\n                      borderRadius: 4,\n                      color: '#94a3b8',\n                      textTransform: 'capitalize',\n                    }}>\n                      {item.content_type}\n                    </span>\n                  )}\n                </div>\n              ))}\n            </>\n          ) : (\n            // Show recent searches\n            <>\n              <div style={{\n                padding: '8px 16px',\n                fontSize: 12,\n                color: '#64748b',\n                borderBottom: '1px solid #334155',\n              }}>\n                Recent searches\n              </div>\n              {recentSearches.map((search, index) => (\n                <div\n                  key={search}\n                  onClick={() => handleSearch(search)}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 12,\n                    padding: '10px 16px',\n                    cursor: 'pointer',\n                    background: selectedIndex === index ? '#334155' : 'transparent',\n                  }}\n                  onMouseEnter={() => setSelectedIndex(index)}\n                >\n                  <Clock size={16} style={{ color: '#64748b', flexShrink: 0 }} />\n                  <span style={{ flex: 1, color: '#f1f5f9', fontSize: 14 }}>\n                    {search}\n                  </span>\n                  <button\n                    onClick={(e) => removeRecentSearch(search, e)}\n                    style={{\n                      background: 'none',\n                      border: 'none',\n                      padding: 4,\n                      cursor: 'pointer',\n                      color: '#64748b',\n                      display: 'flex',\n                      alignItems: 'center',\n                    }}\n                  >\n                    <X size={14} />\n                  </button>\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useEffect, useState, Suspense, lazy } from 'react';\nimport { Route, Routes, Link, useLocation, useNavigate, Navigate } from 'react-router-dom';\nimport './App.css';\nimport { CreatorSidebar } from './components/CreatorSidebar';\nimport { LibrarySidebar } from './components/LibrarySidebar';\nimport { MobileLibrary } from './components/MobileLibrary';\nimport { useMobile } from './hooks/useMobile';\nimport ProtectedRoute from './components/ProtectedRoute';\nimport ErrorBoundary from './components/ErrorBoundary';\nimport NotificationBell from './components/notifications/NotificationBell';\nimport NotificationToastContainer from './components/notifications/NotificationToastContainer';\nimport notificationService from './services/notificationService';\nimport { BetaBadge, TestModeBanner } from './components/BetaBadge';\nimport { useAuth } from './hooks/useAuth';\nimport BetaOnboarding from './components/BetaOnboarding';\nimport { Footer } from './components/legal/Footer';\nimport { CookieBanner } from './components/legal/CookieBanner';\nimport { API_URL } from './config';\nimport { CartProvider } from './contexts/CartContext';\nimport CartIcon from './components/CartIcon';\nimport {\n  User, LogOut, Menu, X, Users\n} from 'lucide-react';\nimport { SearchAutocomplete } from './components/SearchAutocomplete';\n\n// Lazy-loaded page components for code splitting\nconst HomePage = lazy(() => import('./pages/HomePage'));\nconst SearchPage = lazy(() => import('./pages/SearchPage'));\nconst StudioPage = lazy(() => import('./pages/StudioPage'));\nconst DashboardPage = lazy(() => import('./pages/DashboardPage'));\nconst ProfilePage = lazy(() => import('./pages/ProfilePageRedesigned'));\nconst AuthPage = lazy(() => import('./pages/AuthPage'));\nconst WalletInfoPage = lazy(() => import('./pages/WalletInfoPage'));\n// TermsPage replaced by TermsOfServicePage in legal pages\nconst BetaLanding = lazy(() => import('./pages/BetaLanding'));\nconst CollaboratorsPage = lazy(() => import('./pages/CollaboratorsPage'));\nconst PublicProfilePage = lazy(() => import('./pages/PublicProfilePage'));\nconst ContentDetail = lazy(() => import('./pages/ContentDetail'));\nconst PurchaseSuccessPage = lazy(() => import('./pages/PurchaseSuccessPage'));\nconst ReaderPage = lazy(() => import('./pages/ReaderPage').then(m => ({ default: m.ReaderPage })));\nconst CollaborationDashboard = lazy(() => import('./pages/CollaborationDashboard'));\nconst CollaborativeProjectPage = lazy(() => import('./pages/CollaborativeProjectPage'));\nconst NotificationsPage = lazy(() => import('./pages/NotificationsPage'));\nconst FollowingFeedPage = lazy(() => import('./pages/FollowingFeedPage'));\nconst CartPage = lazy(() => import('./pages/CartPage'));\nconst CartSuccessPage = lazy(() => import('./pages/CartSuccessPage'));\nconst PayoutSettingsPage = lazy(() => import('./pages/PayoutSettingsPage'));\n\n// Legal pages\nconst TermsOfServicePage = lazy(() => import('./pages/legal/TermsOfServicePage'));\nconst PrivacyPolicyPage = lazy(() => import('./pages/legal/PrivacyPolicyPage'));\nconst ContentPolicyPage = lazy(() => import('./pages/legal/ContentPolicyPage'));\nconst DMCAPolicyPage = lazy(() => import('./pages/legal/DMCAPolicyPage'));\nconst CreatorAgreementPage = lazy(() => import('./pages/legal/CreatorAgreementPage'));\n\n// Loading fallback component\nconst PageLoader = () => (\n  <div style={{\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: '200px',\n    color: 'var(--text-muted, #94a3b8)',\n  }}>\n    Loading...\n  </div>\n);\n\nfunction Header() {\n  const [isAuthed, setIsAuthed] = useState(false);\n  const [username, setUsername] = useState('');\n  const [avatarUrl, setAvatarUrl] = useState<string | null>(null);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // Close mobile menu on route change\n  useEffect(() => {\n    setMobileMenuOpen(false);\n  }, [location.pathname]);\n\n  const checkAuth = React.useCallback(() => {\n    fetch(`${API_URL}/api/auth/status/`, { credentials: 'include' })\n      .then(r=>r.json())\n      .then(d=> {\n        const authed = !!d?.authenticated;\n        setIsAuthed(authed);\n\n        // Store username and avatar if available\n        if (authed && d?.user?.username) {\n          setUsername(d.user.username);\n          setAvatarUrl(d.user.avatar_url || null);\n        } else {\n          setUsername('');\n          setAvatarUrl(null);\n        }\n\n        // Start/stop notification polling based on auth state\n        if (authed) {\n          if (!notificationService.isPolling()) {\n            notificationService.startPolling();\n          }\n        } else {\n          if (notificationService.isPolling()) {\n            notificationService.stopPolling();\n          }\n          notificationService.reset();\n        }\n      })\n      .catch(()=> {\n        setIsAuthed(false);\n        setUsername('');\n        setAvatarUrl(null);\n        notificationService.stopPolling();\n        notificationService.reset();\n      });\n  }, []);\n\n  useEffect(()=>{\n    checkAuth();\n    // Poll auth status every 10 seconds to catch changes\n    const interval = setInterval(checkAuth, 10000);\n    return () => {\n      clearInterval(interval);\n      // Clean up notification service on unmount\n      notificationService.stopPolling();\n    };\n  },[location.pathname, checkAuth]);\n\n  // Also refresh immediately when we land on home with potential fresh logout redirect\n  useEffect(()=>{\n    if (location.pathname === '/') {\n      checkAuth();\n    }\n  }, [location.pathname, checkAuth]);\n\n  const goLogin = () => { navigate('/auth'); };\n\n  const doLogout = async () => {\n    try {\n      const t = await fetch(`${API_URL}/api/auth/csrf/`, { credentials:'include' }).then(r=>r.json()).then(j=> j?.csrfToken || '');\n      await fetch(`${API_URL}/api/auth/logout/`, { method:'POST', credentials:'include', headers:{ 'X-CSRFToken': t, 'X-Requested-With': 'XMLHttpRequest' } });\n    } catch {}\n\n    // Stop notification polling and reset\n    notificationService.stopPolling();\n    notificationService.reset();\n\n    // Optimistically flip immediately\n    setIsAuthed(false);\n\n    // Navigate to home using React Router\n    navigate('/');\n\n    // Re-check server state after navigation\n    setTimeout(() => checkAuth(), 100);\n  };\n  return (\n    <nav className=\"rb-header\">\n      <div className=\"rb-header-left\">\n        <Link to=\"/\" className=\"rb-logo-link\">\n          <img src=\"/rb-logo.png\" alt=\"renaissBlock\" className=\"rb-logo-img\"/>\n        </Link>\n        <BetaBadge variant=\"header\" showTestMode={true} />\n      </div>\n      <div className=\"rb-header-center\">\n        <SearchAutocomplete />\n      </div>\n\n      {/* Mobile Menu Toggle */}\n      <button\n        className=\"rb-mobile-menu-toggle\"\n        onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n        aria-label=\"Toggle menu\"\n      >\n        {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}\n      </button>\n\n      {/* Navigation Links */}\n      <div className={`rb-header-right rb-nav ${mobileMenuOpen ? 'rb-nav-mobile-open' : ''}`}>\n        {isAuthed && (\n          <>\n            <CartIcon />\n            <NotificationBell />\n            <Link to=\"/collaborators\" className=\"rb-nav-link\" title=\"Find Collaborators\">\n              <Users size={20} />\n              <span>Creators</span>\n            </Link>\n            <Link to=\"/profile\" className=\"rb-nav-link rb-profile-link\" title=\"Profile\">\n              {avatarUrl ? (\n                <img\n                  src={avatarUrl}\n                  alt={username}\n                  style={{\n                    width: 28,\n                    height: 28,\n                    borderRadius: '50%',\n                    objectFit: 'cover',\n                    border: '2px solid var(--accent)',\n                  }}\n                />\n              ) : (\n                <User size={20} />\n              )}\n              <span>@{username || 'Profile'}</span>\n            </Link>\n            <button\n              onClick={doLogout}\n              className=\"rb-nav-link rb-logout-btn\"\n              title=\"Logout\"\n            >\n              <LogOut size={20} />\n              <span>Logout</span>\n            </button>\n          </>\n        )}\n        {!isAuthed && (\n          <button onClick={goLogin} className=\"rb-nav-link rb-signin-btn\">\n            <User size={20} />\n            <span>Sign in</span>\n          </button>\n        )}\n      </div>\n    </nav>\n  );\n}\n\nexport default function App() {\n  const location = useLocation();\n  const { isAuthenticated, loading } = useAuth();\n  const { isMobile } = useMobile();\n  // Library sidebar expansion state - lifted from LibrarySidebar for layout coordination\n  const [libraryExpanded, setLibraryExpanded] = useState(true);\n\n  // Legacy CreatorSidebar removed - functionality now in navbar and page tabs\n  const showCreatorSidebar = false;\n  // Only show Library sidebar when authenticated AND on home or search pages AND not mobile\n  const showLibrarySidebar = !isMobile && isAuthenticated && [/^\\/$/, /^\\/search/].some(r => r.test(location.pathname));\n  // Show mobile library on home page for authenticated mobile users\n  const showMobileLibrary = isMobile && isAuthenticated && location.pathname === '/';\n  const isReaderPage = /^\\/reader/.test(location.pathname);\n  // Hide footer on pages that have the sidebar (footer links are in sidebar instead)\n  const showFooter = !showLibrarySidebar;\n\n  // Public routes that don't require authentication\n  const publicRoutes = ['/auth', '/terms', '/wallet-info', '/beta', '/profile/', '/legal'];\n  const isPublicRoute = publicRoutes.some(route => location.pathname.startsWith(route));\n\n  // Show loading state while checking authentication\n  if (loading) {\n    return (\n      <div className=\"rb-app\" style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: '100vh',\n        background: 'var(--bg)',\n        color: 'var(--text)'\n      }}>\n        <div style={{ textAlign: 'center' }}>\n          <div style={{ fontSize: '18px', marginBottom: '8px' }}>Loading...</div>\n        </div>\n      </div>\n    );\n  }\n\n  // Show beta landing page for unauthenticated users (except on public routes)\n  if (!isAuthenticated && !isPublicRoute) {\n    return (\n      <div className=\"rb-app\">\n        <BetaLanding />\n        <NotificationToastContainer />\n      </div>\n    );\n  }\n\n  // Special handling for explicit /beta route\n  const isBetaLanding = location.pathname === '/beta';\n  if (isBetaLanding) {\n    return (\n      <div className=\"rb-app\">\n        <BetaLanding />\n        <NotificationToastContainer />\n      </div>\n    );\n  }\n\n  // Reader page gets its own full-screen layout without app chrome\n  if (isReaderPage) {\n    return (\n      <div className=\"rb-app\">\n        <ErrorBoundary>\n          <Suspense fallback={<PageLoader />}>\n            <Routes>\n              <Route path=\"/reader/:contentId\" element={<ReaderPage />} />\n            </Routes>\n          </Suspense>\n        </ErrorBoundary>\n      </div>\n    );\n  }\n\n  return (\n    <CartProvider>\n    <div className=\"rb-app\">\n      <Header />\n      {showLibrarySidebar && <LibrarySidebar isExpanded={libraryExpanded} onExpandedChange={setLibraryExpanded} />}\n      <main\n        className=\"rb-main\"\n        style={{\n          display: 'grid',\n          gridTemplateColumns: showCreatorSidebar ? '240px 1fr' : '1fr',\n          gap: 16,\n          ...(showLibrarySidebar ? {\n            marginLeft: libraryExpanded ? 320 : 48,\n            marginRight: 0,\n            width: libraryExpanded ? 'calc(100% - 320px)' : 'calc(100% - 48px)',\n          } : {}),\n          transition: 'margin-left 0.3s ease, width 0.3s ease',\n        }}\n      >\n        {showCreatorSidebar && <CreatorSidebar />}\n        <div style={{ width: '100%', minWidth: 0 }}>\n          {/* Mobile Library - shown at top of home page for mobile users */}\n          {showMobileLibrary && <MobileLibrary />}\n          <ErrorBoundary>\n            <Suspense fallback={<PageLoader />}>\n              <Routes>\n                <Route path=\"/\" element={<HomePage />} />\n                <Route path=\"/beta\" element={<BetaLanding />} />\n                <Route path=\"/login\" element={<Navigate to=\"/auth\" replace />} />\n                <Route path=\"/signup\" element={<Navigate to=\"/auth\" replace />} />\n                <Route path=\"/search\" element={<SearchPage />} />\n                <Route path=\"/studio\" element={<StudioPage />} />\n                <Route path=\"/dashboard\" element={<DashboardPage />} />\n                <Route path=\"/profile\" element={<ProfilePage />} />\n                <Route path=\"/profile/:username\" element={<PublicProfilePage />} />\n                <Route path=\"/collaborators\" element={<CollaboratorsPage />} />\n                <Route path=\"/auth\" element={<AuthPage />} />\n                <Route path=\"/wallet-info\" element={<WalletInfoPage />} />\n                <Route path=\"/terms\" element={<TermsOfServicePage />} />\n                <Route path=\"/legal/terms\" element={<TermsOfServicePage />} />\n                <Route path=\"/legal/privacy\" element={<PrivacyPolicyPage />} />\n                <Route path=\"/legal/content-policy\" element={<ContentPolicyPage />} />\n                <Route path=\"/legal/dmca\" element={<DMCAPolicyPage />} />\n                <Route path=\"/legal/creator-agreement\" element={<CreatorAgreementPage />} />\n                <Route path=\"/content/:id\" element={<ContentDetail />} />\n                <Route path=\"/purchase/success\" element={<PurchaseSuccessPage />} />\n                <Route path=\"/cart\" element={<ProtectedRoute><CartPage /></ProtectedRoute>} />\n                <Route path=\"/cart/success\" element={<ProtectedRoute><CartSuccessPage /></ProtectedRoute>} />\n                <Route path=\"/collaborations\" element={<ProtectedRoute><CollaborationDashboard /></ProtectedRoute>} />\n                <Route path=\"/collaborations/:projectId\" element={<ProtectedRoute><CollaborativeProjectPage /></ProtectedRoute>} />\n                <Route path=\"/notifications\" element={<ProtectedRoute><NotificationsPage /></ProtectedRoute>} />\n                <Route path=\"/feed\" element={<ProtectedRoute><FollowingFeedPage /></ProtectedRoute>} />\n                <Route path=\"/payout-settings\" element={<ProtectedRoute><PayoutSettingsPage /></ProtectedRoute>} />\n              </Routes>\n            </Suspense>\n          </ErrorBoundary>\n        </div>\n      </main>\n      {showFooter && <Footer />}\n      <NotificationToastContainer />\n      <CookieBanner />\n      <TestModeBanner />\n      <BetaOnboarding />\n    </div>\n    </CartProvider>\n  );\n}\n","import './polyfills';\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter } from 'react-router-dom';\n\n// Polyfills for Node globals used by some dependencies in the browser\nimport { Buffer } from 'buffer';\nimport process from 'process';\nif (!(window as any).Buffer) (window as any).Buffer = Buffer;\nif (!(window as any).process) (window as any).process = process;\n\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\nroot.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>\n);\n"],"file":"assets/index-D5Q4BM4R.js"}