{"version":3,"mappings":"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","names":["g","globalThis","window","global","Buffer","process","on","emitter","EventEmitter","bind","once","off","emit","removeListener","removeAllListeners","listeners","env","API_URL","libraryApi","getLibrary","response","fetch","API_BASE","method","credentials","ok","Error","statusText","json","getFullContent","contentId","status","updateProgress","progressPercentage","lastPosition","csrfToken","async","data","error","getFreshCsrfToken","headers","body","JSON","stringify","content_id","progress_percentage","last_position","getProgress","getAllProgress","LibraryItemCard","memo","item","onClick","Math","round","progress","jsxs","Link","to","id","className","style","display","gap","padding","background","border","borderRadius","textDecoration","color","transition","cursor","onMouseEnter","e","currentTarget","borderColor","onMouseLeave","children","position","width","height","flexShrink","overflow","jsx","src","thumbnail","alt","title","objectFit","onError","bottom","left","right","flex","flexDirection","justifyContent","minWidth","fontWeight","fontSize","marginBottom","textOverflow","whiteSpace","creator","toPascalCase","string","camelCase","replace","match","p1","p2","toUpperCase","toLowerCase","toCamelCase","charAt","slice","mergeClasses","classes","filter","index","array","Boolean","trim","indexOf","join","hasA11yProp","props","prop","startsWith","defaultAttributes","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","Icon","forwardRef","size","absoluteStrokeWidth","iconNode","rest","ref","createElement","Number","map","tag","attrs","Array","isArray","createLucideIcon","iconName","Component","displayName","Bell","d","key","ChevronLeft","ChevronRight","CircleCheckBig","Clock","cx","cy","r","DollarSign","x1","x2","y1","y2","FilePen","LogOut","MailOpen","Mail","x","y","rx","Menu","MessageSquare","PartyPopper","Search","User","Users","X","useAuth","authState","setAuthState","useState","user","loading","isAuthenticated","checkAuth","useCallback","authenticated","logout","csrfResponse","csrfData","refreshAuth","prev","useEffect","LibrarySidebar","library","setLibrary","setLoading","setError","isExpanded","setIsExpanded","selectedTab","setSelectedTab","loadLibrary","err","message","top","borderRight","alignItems","zIndex","writingMode","marginTop","totalItems","Object","values","reduce","sum","items","length","currentItems","borderBottom","overflowX","tab","count","_a","isActive","overflowY","textAlign","borderTop","flexWrap","footerLinkStyle","href","Date","getFullYear","ProtectedRoute","setIsAuthenticated","location","useLocation","Navigate","state","from","ErrorBoundary","constructor","super","__publicField","this","setState","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","render","fallback","minHeight","handleRetry","notifications","unreadCount","lastChecked","isPolling","lastError","knownNotificationIds","Set","initialLoadComplete","CONFIG","POLLING_INTERVAL","MAX_RETRIES","RETRY_DELAY","getCsrfToken","apiRequest","url","options","fullUrl","errorData","catch","getNotifications","n","read","forEach","add","events","pollingInterval","retryCount","retryTimeout","pollNotifications","previouslyKnownIds","newNotifications","has","stopPolling","setTimeout","startPolling","setInterval","clearInterval","clearTimeout","Map","event","handler","set","get","handlers","delete","clear","getTimeAgo","dateString","date","now","seconds","floor","getTime","toLocaleDateString","getNotificationIcon","type","invitation","invitation_response","comment","approval","section_update","revenue_proposal","mint_ready","getNotificationColor","notificationService","getUnreadNotifications","getUnreadCount","markNotificationRead","notificationId","notification","find","max","markAllNotificationsRead","deleteNotification","removeFromLocalState","findIndex","wasUnread","splice","getNotificationStats","stats","total","unread","by_type","setPollingInterval","intervalMs","getState","getCachedNotifications","getCachedUnreadCount","reset","useNotifications","autoStart","onNewNotification","setNotifications","setUnreadCount","isLoading","setIsLoading","setIsPolling","refresh","markAsRead","markAllAsRead","deleteNotificationCallback","startPollingCallback","stopPollingCallback","getStats","unsubUpdated","unsubUnreadCount","unsubNew","newNotifs","unsubPollingStarted","unsubPollingStopped","unsubPollingError","NotificationItem","onDelete","onViewInvite","icon","iconProps","CheckCircle","FileEdit","getNotificationLucideIcon","timeAgo","created_at","isInvitation","role","tabIndex","onKeyDown","preventDefault","borderLeft","lineHeight","from_user","username","stopPropagation","opacity","boxShadow","handleResponse","errorMessage","detail","collaborationApi","createCollaborativeProject","deleteCollaborativeProject","projectId","splits","getApprovalStatus","project","getCollaborativeProject","pendingApprovals","collaborators","c","approved_current_version","approved_revenue_split","is_fully_approved","pending_approvals","createProjectSection","formData","FormData","append","toString","section_type","content_html","media_file","order","updateProjectSection","deleteProjectSection","addComment","attachments","content","section","parent_comment","mentions","file","getComments","sectionId","commentId","deleteComment","emoji","removeReaction","reactionId","reaction_id","getCommentsBySection","includeResolved","getUnresolvedCommentCount","resolved","priceUsd","price_usd","settings","forceMint","force_mint","proposalId","ratedUserId","rated_user_id","userId","InviteResponseModal","open","onClose","notificationMessage","navigate","useNavigate","setProject","myRole","setMyRole","mode","setMode","proposedPercentage","setProposedPercentage","counterMessage","setCounterMessage","submitting","setSubmitting","success","setSuccess","invitedRole","revenue_percentage","loadProject","created_by","othersPercentage","placeItems","target","maxWidth","maxHeight","margin","disabled","Fragment","book","music","video","art","content_type","description","textTransform","contract_tasks","task","deadline","weekday","month","day","year","label","value","can_edit_text","can_edit_images","can_edit_audio","can_edit_video","perm","declineInvitation","acceptInvitation","min","step","onChange","parseInt","placeholder","resize","counterProposeInvite","proposed_percentage","NotificationDropdown","isOpen","anchorEl","panelRef","useRef","inviteModalOpen","setInviteModalOpen","selectedInvite","setSelectedInvite","recentNotifications","handleViewInvite","handleClickOutside","current","contains","timer","document","addEventListener","removeEventListener","handleEscape","action_url","project_id","handleNotificationClick","handleDelete","NotificationBell","setIsOpen","isAnimating","setIsAnimating","bellRef","useUnreadCount","unsubscribe","animation","transformOrigin","NotificationToast","onDismiss","autoDismissMs","isExiting","setIsExiting","handleDismiss","transform","NotificationToastContainer","toasts","setToasts","pointerEvents","FeedbackModal","feedback","setFeedback","email","setEmail","submitted","setSubmitted","onSubmit","required","rows","fontFamily","BetaBadge","variant","showTestMode","letterSpacing","marginLeft","TestModeBanner","showFeedback","setShowFeedback","BetaWelcomeModal","paddingLeft","BetaOnboarding","showWelcome","setShowWelcome","hasSeenWelcome","localStorage","getItem","lastSeenUserId","String","setItem","Footer","currentYear","linkStyle","paddingTop","COOKIE_CONSENT_KEY","CookieBanner","isVisible","setIsVisible","showCustomize","setShowCustomize","preferences","setPreferences","necessary","analytics","marketing","saveConsent","prefs","timestamp","toISOString","handleRejectNonEssential","checked","RECENT_SEARCHES_KEY","SearchAutocomplete","onSearch","query","setQuery","suggestions","setSuggestions","recentSearches","setRecentSearches","selectedIndex","setSelectedIndex","inputRef","containerRef","stored","parse","encodeURIComponent","then","finally","handleSearch","searchQuery","search","updated","s","saveRecentSearch","showDropdown","onFocus","selected","_b","blur","autoComplete","creator_username","removeRecentSearch","HomePage","lazy","__vitePreload","import","__VITE_PRELOAD__","SearchPage","StudioPage","DashboardPage","ProfilePage","AuthPage","WalletInfoPage","BetaLanding","CollaboratorsPage","PublicProfilePage","ContentDetail","PurchaseSuccessPage","ReaderPage","m","default","CollaborationDashboard","CollaborativeProjectPage","NotificationsPage","FollowingFeedPage","TermsOfServicePage","PrivacyPolicyPage","ContentPolicyPage","DMCAPolicyPage","CreatorAgreementPage","PageLoader","Header","isAuthed","setIsAuthed","setUsername","avatarUrl","setAvatarUrl","mobileMenuOpen","setMobileMenuOpen","React","authed","avatar_url","interval","pathname","t","j","App","showLibrarySidebar","some","test","isReaderPage","showFooter","isPublicRoute","route","Suspense","Routes","Route","path","element","gridTemplateColumns","ReactDOM","createRoot","getElementById","StrictMode","BrowserRouter"],"ignoreList":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"sources":["../../src/polyfills.ts","../../src/config.ts","../../src/services/libraryApi.ts","../../src/components/LibraryItemCard.tsx","../../node_modules/lucide-react/dist/esm/shared/src/utils.js","../../node_modules/lucide-react/dist/esm/defaultAttributes.js","../../node_modules/lucide-react/dist/esm/Icon.js","../../node_modules/lucide-react/dist/esm/createLucideIcon.js","../../node_modules/lucide-react/dist/esm/icons/bell.js","../../node_modules/lucide-react/dist/esm/icons/chevron-left.js","../../node_modules/lucide-react/dist/esm/icons/chevron-right.js","../../node_modules/lucide-react/dist/esm/icons/circle-check-big.js","../../node_modules/lucide-react/dist/esm/icons/clock.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/file-pen.js","../../node_modules/lucide-react/dist/esm/icons/log-out.js","../../node_modules/lucide-react/dist/esm/icons/mail-open.js","../../node_modules/lucide-react/dist/esm/icons/mail.js","../../node_modules/lucide-react/dist/esm/icons/menu.js","../../node_modules/lucide-react/dist/esm/icons/message-square.js","../../node_modules/lucide-react/dist/esm/icons/party-popper.js","../../node_modules/lucide-react/dist/esm/icons/search.js","../../node_modules/lucide-react/dist/esm/icons/user.js","../../node_modules/lucide-react/dist/esm/icons/users.js","../../node_modules/lucide-react/dist/esm/icons/x.js","../../src/hooks/useAuth.ts","../../src/components/LibrarySidebar.tsx","../../src/components/ProtectedRoute.tsx","../../src/components/ErrorBoundary.tsx","../../src/services/notificationService.ts","../../src/hooks/useNotifications.ts","../../src/components/notifications/NotificationItem.tsx","../../src/services/collaborationApi.ts","../../src/components/collaboration/InviteResponseModal.tsx","../../src/components/notifications/NotificationDropdown.tsx","../../src/components/notifications/NotificationBell.tsx","../../src/components/notifications/NotificationToast.tsx","../../src/components/notifications/NotificationToastContainer.tsx","../../src/components/FeedbackModal.tsx","../../src/components/BetaBadge.tsx","../../src/components/BetaOnboarding.tsx","../../src/components/legal/Footer.tsx","../../src/components/legal/CookieBanner.tsx","../../src/components/SearchAutocomplete.tsx","../../src/App.tsx","../../src/index.tsx"],"sourcesContent":["// Global polyfills for browser runtime (Vite)\nimport { Buffer } from 'buffer';\nimport process from 'process';\nimport { EventEmitter } from 'events';\n\nconst g: any = (typeof globalThis !== 'undefined' ? globalThis : window) as any;\n\n// Polyfill global\nif (!g.global) g.global = g;\n\n// Polyfill Buffer\nif (!g.Buffer) g.Buffer = Buffer;\n\n// Polyfill process with EventEmitter methods\nif (!g.process) {\n  g.process = process;\n}\n\n// Ensure process has EventEmitter methods (for end-of-stream)\nif (g.process && !g.process.on) {\n  const emitter = new EventEmitter();\n  g.process.on = emitter.on.bind(emitter);\n  g.process.once = emitter.once.bind(emitter);\n  g.process.off = emitter.off.bind(emitter);\n  g.process.emit = emitter.emit.bind(emitter);\n  g.process.removeListener = emitter.removeListener.bind(emitter);\n  g.process.removeAllListeners = emitter.removeAllListeners.bind(emitter);\n  g.process.listeners = emitter.listeners.bind(emitter);\n}\n\nif (!g.process.env) g.process.env = {};\n","// API Configuration\n// In development, use empty string to leverage Vite's proxy (same-origin requests)\n// This ensures cookies work correctly regardless of localhost vs 127.0.0.1\n// In production, use the full API URL from environment\nconst isDev = import.meta.env.DEV;\nexport const API_URL = isDev ? '' : (import.meta.env.VITE_API_URL || '');\n\nexport const appConfig = {\n  showTeasers: import.meta.env.VITE_SHOW_TEASERS !== 'false',\n};\n","/**\n * Library API Service\n *\n * Provides functions for accessing user's library and reading progress.\n */\n\nimport { API_URL as API_BASE } from '../config';\n\nexport interface LibraryItem {\n  id: number;\n  title: string;\n  creator: string;\n  thumbnail: string;\n  content_type: string;\n  purchased_at: string;\n  progress: number;\n}\n\nexport interface Library {\n  books: LibraryItem[];\n  art: LibraryItem[];\n  film: LibraryItem[];\n  music: LibraryItem[];\n}\n\nexport interface FullContent {\n  id: number;\n  title: string;\n  content_html: string;\n  creator: string;\n  content_type: string;\n  owned: boolean;\n}\n\nexport interface ReadingProgress {\n  id?: number;\n  user?: number;\n  content: number;\n  progress_percentage: number;\n  last_position: string;\n  last_read_at?: string;\n  created_at?: string;\n}\n\n/**\n * Get fresh CSRF token from API\n * This is more reliable than reading from cookies\n */\nasync function getFreshCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_BASE}/api/auth/csrf/`, {\n      credentials: 'include',\n    });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to fetch CSRF token:', error);\n    return '';\n  }\n}\n\nexport const libraryApi = {\n  /**\n   * Get user's library grouped by content type\n   */\n  async getLibrary(): Promise<Library> {\n    const response = await fetch(`${API_BASE}/api/library/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch library: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get full content for owned items\n   */\n  async getFullContent(contentId: number): Promise<FullContent> {\n    const response = await fetch(`${API_BASE}/api/content/${contentId}/full/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      if (response.status === 403) {\n        throw new Error('You do not own this content');\n      }\n      throw new Error(`Failed to fetch content: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Update reading progress for content\n   */\n  async updateProgress(\n    contentId: number,\n    progressPercentage: number,\n    lastPosition: string = ''\n  ): Promise<ReadingProgress> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/reading-progress/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({\n        content_id: contentId,\n        progress_percentage: progressPercentage,\n        last_position: lastPosition,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to update progress: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get reading progress for specific content\n   */\n  async getProgress(contentId: number): Promise<ReadingProgress> {\n    const response = await fetch(`${API_BASE}/api/reading-progress/${contentId}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch progress: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get all reading progress for user\n   */\n  async getAllProgress(): Promise<ReadingProgress[]> {\n    const response = await fetch(`${API_BASE}/api/reading-progress/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch all progress: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n};\n","import React, { memo } from 'react';\nimport { Link } from 'react-router-dom';\nimport type { LibraryItem } from '../services/libraryApi';\n\ninterface LibraryItemCardProps {\n  item: LibraryItem;\n  onClick?: () => void;\n}\n\nfunction LibraryItemCardComponent({ item, onClick }: LibraryItemCardProps) {\n  const progressPercentage = Math.round(item.progress);\n\n  return (\n    <Link\n      to={`/reader/${item.id}`}\n      className=\"library-item-card\"\n      onClick={onClick}\n      style={{\n        display: 'flex',\n        gap: 12,\n        padding: 12,\n        background: '#0b1220',\n        border: '1px solid #2a3444',\n        borderRadius: 8,\n        textDecoration: 'none',\n        color: 'inherit',\n        transition: 'all 0.2s ease',\n        cursor: 'pointer',\n      }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.background = '#111827';\n        e.currentTarget.style.borderColor = '#374151';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = '#0b1220';\n        e.currentTarget.style.borderColor = '#2a3444';\n      }}\n    >\n      {/* Thumbnail */}\n      <div\n        style={{\n          position: 'relative',\n          width: 80,\n          height: 80,\n          flexShrink: 0,\n          borderRadius: 6,\n          overflow: 'hidden',\n          background: '#0e1320',\n        }}\n      >\n        <img\n          src={item.thumbnail || 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"80\" height=\"80\"%3E%3Crect fill=\"%23111827\" width=\"80\" height=\"80\"/%3E%3Ctext fill=\"%2394a3b8\" font-family=\"sans-serif\" font-size=\"12\" x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dominant-baseline=\"middle\"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E'}\n          alt={item.title}\n          style={{\n            width: '100%',\n            height: '100%',\n            objectFit: 'cover',\n          }}\n          onError={(e: React.SyntheticEvent<HTMLImageElement>) => {\n            e.currentTarget.src = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"80\" height=\"80\"%3E%3Crect fill=\"%23111827\" width=\"80\" height=\"80\"/%3E%3Ctext fill=\"%2394a3b8\" font-family=\"sans-serif\" font-size=\"12\" x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dominant-baseline=\"middle\"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E';\n          }}\n        />\n        {/* Progress overlay */}\n        {item.progress > 0 && (\n          <div\n            style={{\n              position: 'absolute',\n              bottom: 0,\n              left: 0,\n              right: 0,\n              height: 4,\n              background: 'rgba(0,0,0,0.5)',\n            }}\n          >\n            <div\n              style={{\n                height: '100%',\n                width: `${item.progress}%`,\n                background: '#f59e0b',\n                transition: 'width 0.3s ease',\n              }}\n            />\n          </div>\n        )}\n      </div>\n\n      {/* Content info */}\n      <div\n        style={{\n          flex: 1,\n          display: 'flex',\n          flexDirection: 'column',\n          justifyContent: 'space-between',\n          minWidth: 0,\n        }}\n      >\n        <div>\n          <div\n            style={{\n              fontWeight: 600,\n              fontSize: 14,\n              color: '#e5e7eb',\n              marginBottom: 4,\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap',\n            }}\n          >\n            {item.title}\n          </div>\n          <div\n            style={{\n              fontSize: 12,\n              color: '#94a3b8',\n            }}\n          >\n            {item.creator}\n          </div>\n        </div>\n        <div\n          style={{\n            fontSize: 11,\n            color: '#10b981',\n            fontWeight: 600,\n          }}\n        >\n          {progressPercentage > 0 ? `${progressPercentage}% complete` : 'Not started'}\n        </div>\n      </div>\n    </Link>\n  );\n}\n\nexport const LibraryItemCard = memo(LibraryItemCardComponent);\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst toCamelCase = (string) => string.replace(\n  /^([A-Z])|[\\s-_]+(\\w)/g,\n  (match, p1, p2) => p2 ? p2.toUpperCase() : p1.toLowerCase()\n);\nconst toPascalCase = (string) => {\n  const camelCase = toCamelCase(string);\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n};\nconst mergeClasses = (...classes) => classes.filter((className, index, array) => {\n  return Boolean(className) && className.trim() !== \"\" && array.indexOf(className) === index;\n}).join(\" \").trim();\nconst hasA11yProp = (props) => {\n  for (const prop in props) {\n    if (prop.startsWith(\"aria-\") || prop === \"role\" || prop === \"title\") {\n      return true;\n    }\n  }\n};\n\nexport { hasA11yProp, mergeClasses, toCamelCase, toKebabCase, toPascalCase };\n//# sourceMappingURL=utils.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\nimport { mergeClasses, hasA11yProp } from './shared/src/utils.js';\n\nconst Icon = forwardRef(\n  ({\n    color = \"currentColor\",\n    size = 24,\n    strokeWidth = 2,\n    absoluteStrokeWidth,\n    className = \"\",\n    children,\n    iconNode,\n    ...rest\n  }, ref) => createElement(\n    \"svg\",\n    {\n      ref,\n      ...defaultAttributes,\n      width: size,\n      height: size,\n      stroke: color,\n      strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n      className: mergeClasses(\"lucide\", className),\n      ...!children && !hasA11yProp(rest) && { \"aria-hidden\": \"true\" },\n      ...rest\n    },\n    [\n      ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n      ...Array.isArray(children) ? children : [children]\n    ]\n  )\n);\n\nexport { Icon as default };\n//# sourceMappingURL=Icon.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from './shared/src/utils.js';\nimport Icon from './Icon.js';\n\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ className, ...props }, ref) => createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className\n      ),\n      ...props\n    })\n  );\n  Component.displayName = toPascalCase(iconName);\n  return Component;\n};\n\nexport { createLucideIcon as default };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10.268 21a2 2 0 0 0 3.464 0\", key: \"vwvbt9\" }],\n  [\n    \"path\",\n    {\n      d: \"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326\",\n      key: \"11g9vi\"\n    }\n  ]\n];\nconst Bell = createLucideIcon(\"bell\", __iconNode);\n\nexport { __iconNode, Bell as default };\n//# sourceMappingURL=bell.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m15 18-6-6 6-6\", key: \"1wnfg3\" }]];\nconst ChevronLeft = createLucideIcon(\"chevron-left\", __iconNode);\n\nexport { __iconNode, ChevronLeft as default };\n//# sourceMappingURL=chevron-left.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]];\nconst ChevronRight = createLucideIcon(\"chevron-right\", __iconNode);\n\nexport { __iconNode, ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21.801 10A10 10 0 1 1 17 3.335\", key: \"yps3ct\" }],\n  [\"path\", { d: \"m9 11 3 3L22 4\", key: \"1pflzl\" }]\n];\nconst CircleCheckBig = createLucideIcon(\"circle-check-big\", __iconNode);\n\nexport { __iconNode, CircleCheckBig as default };\n//# sourceMappingURL=circle-check-big.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 6v6l4 2\", key: \"mmk7yg\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Clock = createLucideIcon(\"clock\", __iconNode);\n\nexport { __iconNode, Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34\",\n      key: \"o6klzx\"\n    }\n  ],\n  [\"path\", { d: \"M14 2v5a1 1 0 0 0 1 1h5\", key: \"wfsgrz\" }],\n  [\n    \"path\",\n    {\n      d: \"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z\",\n      key: \"zhnas1\"\n    }\n  ]\n];\nconst FilePen = createLucideIcon(\"file-pen\", __iconNode);\n\nexport { __iconNode, FilePen as default };\n//# sourceMappingURL=file-pen.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m16 17 5-5-5-5\", key: \"1bji2h\" }],\n  [\"path\", { d: \"M21 12H9\", key: \"dn1m92\" }],\n  [\"path\", { d: \"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\", key: \"1uf3rs\" }]\n];\nconst LogOut = createLucideIcon(\"log-out\", __iconNode);\n\nexport { __iconNode, LogOut as default };\n//# sourceMappingURL=log-out.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z\",\n      key: \"1jhwl8\"\n    }\n  ],\n  [\"path\", { d: \"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10\", key: \"1qfld7\" }]\n];\nconst MailOpen = createLucideIcon(\"mail-open\", __iconNode);\n\nexport { __iconNode, MailOpen as default };\n//# sourceMappingURL=mail-open.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7\", key: \"132q7q\" }],\n  [\"rect\", { x: \"2\", y: \"4\", width: \"20\", height: \"16\", rx: \"2\", key: \"izxlao\" }]\n];\nconst Mail = createLucideIcon(\"mail\", __iconNode);\n\nexport { __iconNode, Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4 5h16\", key: \"1tepv9\" }],\n  [\"path\", { d: \"M4 12h16\", key: \"1lakjw\" }],\n  [\"path\", { d: \"M4 19h16\", key: \"1djgab\" }]\n];\nconst Menu = createLucideIcon(\"menu\", __iconNode);\n\nexport { __iconNode, Menu as default };\n//# sourceMappingURL=menu.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z\",\n      key: \"18887p\"\n    }\n  ]\n];\nconst MessageSquare = createLucideIcon(\"message-square\", __iconNode);\n\nexport { __iconNode, MessageSquare as default };\n//# sourceMappingURL=message-square.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M5.8 11.3 2 22l10.7-3.79\", key: \"gwxi1d\" }],\n  [\"path\", { d: \"M4 3h.01\", key: \"1vcuye\" }],\n  [\"path\", { d: \"M22 8h.01\", key: \"1mrtc2\" }],\n  [\"path\", { d: \"M15 2h.01\", key: \"1cjtqr\" }],\n  [\"path\", { d: \"M22 20h.01\", key: \"1mrys2\" }],\n  [\n    \"path\",\n    {\n      d: \"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10\",\n      key: \"hbicv8\"\n    }\n  ],\n  [\n    \"path\",\n    { d: \"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17\", key: \"1i94pl\" }\n  ],\n  [\"path\", { d: \"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7\", key: \"1cofks\" }],\n  [\n    \"path\",\n    {\n      d: \"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z\",\n      key: \"4kbmks\"\n    }\n  ]\n];\nconst PartyPopper = createLucideIcon(\"party-popper\", __iconNode);\n\nexport { __iconNode, PartyPopper as default };\n//# sourceMappingURL=party-popper.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m21 21-4.34-4.34\", key: \"14j7rj\" }],\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }]\n];\nconst Search = createLucideIcon(\"search\", __iconNode);\n\nexport { __iconNode, Search as default };\n//# sourceMappingURL=search.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\", key: \"975kel\" }],\n  [\"circle\", { cx: \"12\", cy: \"7\", r: \"4\", key: \"17ys0d\" }]\n];\nconst User = createLucideIcon(\"user\", __iconNode);\n\nexport { __iconNode, User as default };\n//# sourceMappingURL=user.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\", key: \"1yyitq\" }],\n  [\"path\", { d: \"M16 3.128a4 4 0 0 1 0 7.744\", key: \"16gr8j\" }],\n  [\"path\", { d: \"M22 21v-2a4 4 0 0 0-3-3.87\", key: \"kshegd\" }],\n  [\"circle\", { cx: \"9\", cy: \"7\", r: \"4\", key: \"nufk8\" }]\n];\nconst Users = createLucideIcon(\"users\", __iconNode);\n\nexport { __iconNode, Users as default };\n//# sourceMappingURL=users.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n];\nconst X = createLucideIcon(\"x\", __iconNode);\n\nexport { __iconNode, X as default };\n//# sourceMappingURL=x.js.map\n","import { useState, useEffect, useCallback } from 'react';\nimport { API_URL } from '../config';\n\n/**\n * Authentication hook\n *\n * Provides authentication state and methods for the entire app.\n * Checks auth status on mount and provides loading state.\n */\n\ninterface User {\n  id: number;\n  username: string;\n  email?: string;\n  display_name?: string;\n  avatar?: string;\n}\n\ninterface AuthState {\n  user: User | null;\n  loading: boolean;\n  isAuthenticated: boolean;\n}\n\nexport const useAuth = () => {\n  const [authState, setAuthState] = useState<AuthState>({\n    user: null,\n    loading: true,\n    isAuthenticated: false,\n  });\n\n  const checkAuth = useCallback(async () => {\n    try {\n      const response = await fetch(`${API_URL}/api/auth/status/`, {\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        setAuthState({\n          user: null,\n          loading: false,\n          isAuthenticated: false,\n        });\n        return;\n      }\n\n      const data = await response.json();\n\n      if (data?.authenticated && data?.user) {\n        setAuthState({\n          user: data.user,\n          loading: false,\n          isAuthenticated: true,\n        });\n      } else {\n        setAuthState({\n          user: null,\n          loading: false,\n          isAuthenticated: false,\n        });\n      }\n    } catch (error) {\n      console.error('[useAuth] Auth check failed:', error);\n      setAuthState({\n        user: null,\n        loading: false,\n        isAuthenticated: false,\n      });\n    }\n  }, []);\n\n  const logout = useCallback(async () => {\n    try {\n      // Get CSRF token\n      const csrfResponse = await fetch(`${API_URL}/api/auth/csrf/`, {\n        credentials: 'include',\n      });\n      const csrfData = await csrfResponse.json();\n      const csrfToken = csrfData?.csrfToken || '';\n\n      // Logout\n      await fetch(`${API_URL}/api/auth/logout/`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': csrfToken,\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n      });\n\n      // Update state\n      setAuthState({\n        user: null,\n        loading: false,\n        isAuthenticated: false,\n      });\n    } catch (error) {\n      console.error('Logout failed:', error);\n    }\n  }, []);\n\n  const refreshAuth = useCallback(() => {\n    setAuthState(prev => ({ ...prev, loading: true }));\n    checkAuth();\n  }, [checkAuth]);\n\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  return {\n    user: authState.user,\n    loading: authState.loading,\n    isAuthenticated: authState.isAuthenticated,\n    logout,\n    refreshAuth,\n  };\n};\n\nexport default useAuth;\n","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { libraryApi, type Library } from '../services/libraryApi';\nimport { LibraryItemCard } from './LibraryItemCard';\nimport { ChevronRight, ChevronLeft } from 'lucide-react';\nimport { useAuth } from '../hooks/useAuth';\n\nexport function LibrarySidebar() {\n  const [library, setLibrary] = useState<Library | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [selectedTab, setSelectedTab] = useState<keyof Library>('books');\n  const { isAuthenticated } = useAuth();\n\n  useEffect(() => {\n    // Only load library if user is authenticated\n    if (isAuthenticated) {\n      loadLibrary();\n    } else {\n      // Reset state if user is not authenticated\n      setLibrary(null);\n      setLoading(false);\n      setError(null);\n    }\n  }, [isAuthenticated]);\n\n  const loadLibrary = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await libraryApi.getLibrary();\n      setLibrary(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load library');\n      console.error('Library load error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Don't render anything if not authenticated\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  if (!isExpanded) {\n    return (\n      <div\n        style={{\n          position: 'fixed',\n          left: 0,\n          top: 72,\n          bottom: 0,\n          width: 48,\n          background: '#0b1220',\n          borderRight: '1px solid #2a3444',\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          padding: '12px 0',\n          zIndex: 40,\n        }}\n      >\n        <button\n          onClick={() => setIsExpanded(true)}\n          style={{\n            background: 'transparent',\n            border: 'none',\n            color: '#94a3b8',\n            cursor: 'pointer',\n            padding: 8,\n            borderRadius: 8,\n            transition: 'all 0.2s ease',\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.background = '#111827';\n            e.currentTarget.style.color = '#e5e7eb';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.background = 'transparent';\n            e.currentTarget.style.color = '#94a3b8';\n          }}\n          aria-label=\"Expand library\"\n        >\n          <ChevronRight size={20} />\n        </button>\n        <div\n          style={{\n            writingMode: 'vertical-rl',\n            fontSize: 12,\n            fontWeight: 600,\n            color: '#94a3b8',\n            marginTop: 16,\n          }}\n        >\n          LIBRARY\n        </div>\n      </div>\n    );\n  }\n\n  const totalItems = library\n    ? Object.values(library).reduce((sum, items) => sum + items.length, 0)\n    : 0;\n\n  const currentItems = library?.[selectedTab] || [];\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        left: 0,\n        top: 72,\n        bottom: 0,\n        width: 320,\n        background: '#0b1220',\n        borderRight: '1px solid #2a3444',\n        display: 'flex',\n        flexDirection: 'column',\n        zIndex: 40,\n        transition: 'width 0.3s ease',\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          padding: 16,\n          borderBottom: '1px solid #2a3444',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n        }}\n      >\n        <div>\n          <div\n            style={{\n              fontSize: 16,\n              fontWeight: 700,\n              color: '#e5e7eb',\n            }}\n          >\n            My Library\n          </div>\n          <div\n            style={{\n              fontSize: 12,\n              color: '#94a3b8',\n              marginTop: 2,\n            }}\n          >\n            {totalItems} {totalItems === 1 ? 'item' : 'items'}\n          </div>\n        </div>\n        <button\n          onClick={() => setIsExpanded(false)}\n          style={{\n            background: 'transparent',\n            border: 'none',\n            color: '#94a3b8',\n            cursor: 'pointer',\n            padding: 8,\n            borderRadius: 8,\n            transition: 'all 0.2s ease',\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.background = '#111827';\n            e.currentTarget.style.color = '#e5e7eb';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.background = 'transparent';\n            e.currentTarget.style.color = '#94a3b8';\n          }}\n          aria-label=\"Collapse library\"\n        >\n          <ChevronLeft size={20} />\n        </button>\n      </div>\n\n      {/* Tabs */}\n      <div\n        style={{\n          display: 'flex',\n          gap: 4,\n          padding: '12px 16px',\n          borderBottom: '1px solid #2a3444',\n          overflowX: 'auto',\n        }}\n      >\n        {(['books', 'art', 'film', 'music'] as const).map((tab) => {\n          const count = library?.[tab]?.length || 0;\n          const isActive = selectedTab === tab;\n          return (\n            <button\n              key={tab}\n              onClick={() => setSelectedTab(tab)}\n              style={{\n                background: isActive ? '#f59e0b' : '#111827',\n                border: '1px solid',\n                borderColor: isActive ? '#f59e0b' : '#2a3444',\n                color: isActive ? '#111827' : '#cbd5e1',\n                padding: '6px 12px',\n                borderRadius: 18,\n                fontSize: 12,\n                fontWeight: 600,\n                cursor: 'pointer',\n                whiteSpace: 'nowrap',\n                transition: 'all 0.2s ease',\n              }}\n              onMouseEnter={(e) => {\n                if (!isActive) {\n                  e.currentTarget.style.background = '#1f2937';\n                  e.currentTarget.style.borderColor = '#374151';\n                }\n              }}\n              onMouseLeave={(e) => {\n                if (!isActive) {\n                  e.currentTarget.style.background = '#111827';\n                  e.currentTarget.style.borderColor = '#2a3444';\n                }\n              }}\n            >\n              {tab.charAt(0).toUpperCase() + tab.slice(1)} ({count})\n            </button>\n          );\n        })}\n      </div>\n\n      {/* Content */}\n      <div\n        style={{\n          flex: 1,\n          overflowY: 'auto',\n          padding: 16,\n        }}\n      >\n        {loading && (\n          <div\n            style={{\n              textAlign: 'center',\n              padding: 32,\n              color: '#94a3b8',\n              fontSize: 14,\n            }}\n          >\n            Loading library...\n          </div>\n        )}\n\n        {error && (\n          <div\n            style={{\n              background: '#ef444420',\n              border: '1px solid #ef4444',\n              borderRadius: 8,\n              padding: 16,\n              color: '#fca5a5',\n              fontSize: 14,\n            }}\n          >\n            {error}\n            <button\n              onClick={loadLibrary}\n              style={{\n                marginTop: 8,\n                background: '#ef4444',\n                color: '#fff',\n                padding: '6px 12px',\n                fontSize: 12,\n              }}\n            >\n              Retry\n            </button>\n          </div>\n        )}\n\n        {!loading && !error && currentItems.length === 0 && (\n          <div\n            style={{\n              textAlign: 'center',\n              padding: 32,\n              color: '#94a3b8',\n              fontSize: 14,\n            }}\n          >\n            No {selectedTab} in your library yet.\n          </div>\n        )}\n\n        {!loading && !error && currentItems.length > 0 && (\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>\n            {currentItems.map((item) => (\n              <LibraryItemCard key={item.id} item={item} />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Footer Links - YouTube style */}\n      <div\n        style={{\n          padding: '12px 16px',\n          borderTop: '1px solid #2a3444',\n          flexShrink: 0,\n        }}\n      >\n        {/* Legal Links Row */}\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '6px 12px',\n            marginBottom: 8,\n          }}\n        >\n          <Link to=\"/legal/terms\" style={footerLinkStyle}>Terms</Link>\n          <Link to=\"/legal/privacy\" style={footerLinkStyle}>Privacy</Link>\n          <Link to=\"/legal/content-policy\" style={footerLinkStyle}>Content Policy</Link>\n          <Link to=\"/legal/dmca\" style={footerLinkStyle}>DMCA</Link>\n        </div>\n        {/* Support Links Row */}\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '6px 12px',\n            marginBottom: 10,\n          }}\n        >\n          <a href=\"mailto:support@renaissblock.com\" style={footerLinkStyle}>Contact</a>\n          <a href=\"mailto:dmca@renaissblock.com\" style={footerLinkStyle}>Report Copyright</a>\n        </div>\n        {/* Copyright */}\n        <div\n          style={{\n            fontSize: 11,\n            color: '#64748b',\n          }}\n        >\n           {new Date().getFullYear()} renaissBlock\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst footerLinkStyle: React.CSSProperties = {\n  fontSize: 11,\n  color: '#64748b',\n  textDecoration: 'none',\n  transition: 'color 0.2s',\n};\n// Add hover effect via onMouseEnter/Leave in the JSX or use CSS classes\n","import React, { useEffect, useState } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n}\n\nexport default function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean | null>(null);\n  const location = useLocation();\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const response = await fetch('/api/auth/status/', { credentials: 'include' });\n      const data = await response.json();\n      setIsAuthenticated(!!data?.authenticated);\n    } catch {\n      setIsAuthenticated(false);\n    }\n  };\n\n  // Loading state\n  if (isAuthenticated === null) {\n    return (\n      <div style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: '60vh',\n        color: '#94a3b8',\n        fontSize: 16,\n      }}>\n        Checking authentication...\n      </div>\n    );\n  }\n\n  // Not authenticated - redirect to auth page\n  if (!isAuthenticated) {\n    return <Navigate to=\"/auth\" state={{ from: location }} replace />;\n  }\n\n  // Authenticated - render children\n  return <>{children}</>;\n}\n","import React, { Component, ErrorInfo, ReactNode } from 'react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n}\n\n/**\n * Error Boundary component to catch and handle React errors gracefully.\n * Prevents the entire app from crashing when a component throws an error.\n */\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n  }\n\n  handleRetry = (): void => {\n    this.setState({ hasError: false, error: null });\n  };\n\n  render(): ReactNode {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          minHeight: '200px',\n          padding: '40px',\n          textAlign: 'center',\n          color: 'var(--text, #e5e7eb)',\n        }}>\n          <h2 style={{ marginBottom: '16px', color: 'var(--text, #e5e7eb)' }}>\n            Something went wrong\n          </h2>\n          <p style={{ marginBottom: '24px', color: 'var(--text-muted, #94a3b8)' }}>\n            An error occurred while loading this section.\n          </p>\n          <button\n            onClick={this.handleRetry}\n            style={{\n              padding: '10px 24px',\n              background: 'var(--accent, #f59e0b)',\n              color: '#111',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontWeight: 600,\n            }}\n          >\n            Try Again\n          </button>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n","/**\n * Real-time Notification Service\n * Handles collaboration notifications, activity tracking, and real-time updates\n */\n\nimport { API_URL } from '../config';\n\n// ============================================================================\n// TypeScript Interfaces\n// ============================================================================\n\nexport type NotificationType =\n  | 'invitation'\n  | 'invitation_response'\n  | 'comment'\n  | 'approval'\n  | 'section_update'\n  | 'revenue_proposal'\n  | 'mint_ready';\n\nexport interface NotificationUser {\n  id: number;\n  username: string;\n  avatar?: string;\n}\n\nexport interface Notification {\n  id: number;\n  type: NotificationType;\n  title: string;\n  message: string;\n  project_id?: number;\n  from_user: NotificationUser;\n  created_at: string;\n  read: boolean;\n  action_url?: string;\n}\n\nexport interface NotificationStats {\n  total: number;\n  unread: number;\n  by_type: Record<NotificationType, number>;\n}\n\n// ============================================================================\n// Event System for Real-time Updates\n// ============================================================================\n\ntype NotificationEventHandler = (data: any) => void;\n\nclass NotificationEventEmitter {\n  private listeners: Map<string, Set<NotificationEventHandler>> = new Map();\n\n  on(event: string, handler: NotificationEventHandler): () => void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(handler);\n\n    // Return unsubscribe function\n    return () => this.off(event, handler);\n  }\n\n  off(event: string, handler: NotificationEventHandler): void {\n    const handlers = this.listeners.get(event);\n    if (handlers) {\n      handlers.delete(handler);\n    }\n  }\n\n  emit(event: string, data: any): void {\n    const handlers = this.listeners.get(event);\n    if (handlers) {\n      handlers.forEach(handler => {\n        try {\n          handler(data);\n        } catch (error) {\n          console.error(`Error in notification event handler for ${event}:`, error);\n        }\n      });\n    }\n  }\n\n  clear(): void {\n    this.listeners.clear();\n  }\n}\n\n// ============================================================================\n// Local State Management\n// ============================================================================\n\ninterface NotificationState {\n  notifications: Notification[];\n  unreadCount: number;\n  lastChecked: Date | null;\n  isPolling: boolean;\n  lastError: Error | null;\n  knownNotificationIds: Set<number>; // Track IDs of notifications we've seen\n  initialLoadComplete: boolean; // Prevent toast spam on first load\n}\n\nconst state: NotificationState = {\n  notifications: [],\n  unreadCount: 0,\n  lastChecked: null,\n  isPolling: false,\n  lastError: null,\n  knownNotificationIds: new Set(),\n  initialLoadComplete: false,\n};\n\n// ============================================================================\n// Configuration\n// ============================================================================\n\nconst CONFIG = {\n  POLLING_INTERVAL: 30000, // 30 seconds\n  MAX_RETRIES: 3,\n  RETRY_DELAY: 5000, // 5 seconds\n  REQUEST_TIMEOUT: 10000, // 10 seconds\n};\n\n// ============================================================================\n// API Helper Functions\n// ============================================================================\n\nasync function getCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to get CSRF token:', error);\n    return '';\n  }\n}\n\nasync function apiRequest<T>(\n  url: string,\n  options: RequestInit = {}\n): Promise<T> {\n  // Prepend API_URL if url is relative (starts with /)\n  const fullUrl = url.startsWith('/') ? `${API_URL}${url}` : url;\n\n  const response = await fetch(fullUrl, {\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    },\n    ...options,\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json().catch(() => ({}));\n    throw new Error(errorData?.error || `API request failed: ${response.status}`);\n  }\n\n  return response.json();\n}\n\n// ============================================================================\n// Core API Functions\n// ============================================================================\n\n/**\n * Fetch all notifications for the current user\n */\nexport async function getNotifications(): Promise<Notification[]> {\n  try {\n    const notifications = await apiRequest<Notification[]>('/api/notifications/');\n    state.notifications = notifications;\n    state.unreadCount = notifications.filter(n => !n.read).length;\n    state.lastChecked = new Date();\n    state.lastError = null;\n\n    // Track known notification IDs (for detecting truly new notifications)\n    notifications.forEach(n => state.knownNotificationIds.add(n.id));\n\n    events.emit('notifications:updated', { notifications, unreadCount: state.unreadCount });\n\n    return notifications;\n  } catch (error) {\n    state.lastError = error as Error;\n    console.error('Failed to fetch notifications:', error);\n    throw error;\n  }\n}\n\n/**\n * Get only unread notifications\n */\nexport async function getUnreadNotifications(): Promise<Notification[]> {\n  const allNotifications = await getNotifications();\n  return allNotifications.filter(n => !n.read);\n}\n\n/**\n * Get unread notification count\n */\nexport async function getUnreadCount(): Promise<number> {\n  try {\n    const notifications = await getNotifications();\n    const count = notifications.filter(n => !n.read).length;\n    state.unreadCount = count;\n\n    events.emit('notifications:unread-count', { count });\n\n    return count;\n  } catch (error) {\n    console.error('Failed to get unread count:', error);\n    return state.unreadCount; // Return cached count on error\n  }\n}\n\n/**\n * Mark a single notification as read\n */\nexport async function markNotificationRead(notificationId: number): Promise<void> {\n  try {\n    const csrfToken = await getCsrfToken();\n\n    await apiRequest(`/api/notifications/${notificationId}/mark-read/`, {\n      method: 'POST',\n      headers: {\n        'X-CSRFToken': csrfToken,\n      },\n    });\n\n    // Update local state\n    const notification = state.notifications.find(n => n.id === notificationId);\n    if (notification && !notification.read) {\n      notification.read = true;\n      state.unreadCount = Math.max(0, state.unreadCount - 1);\n\n      events.emit('notifications:updated', {\n        notifications: state.notifications,\n        unreadCount: state.unreadCount\n      });\n      events.emit('notifications:unread-count', { count: state.unreadCount });\n    }\n  } catch (error) {\n    console.error('Failed to mark notification as read:', error);\n    throw error;\n  }\n}\n\n/**\n * Mark all notifications as read\n */\nexport async function markAllNotificationsRead(): Promise<void> {\n  try {\n    const csrfToken = await getCsrfToken();\n\n    await apiRequest('/api/notifications/mark-all-read/', {\n      method: 'POST',\n      headers: {\n        'X-CSRFToken': csrfToken,\n      },\n    });\n\n    // Update local state\n    state.notifications.forEach(n => n.read = true);\n    state.unreadCount = 0;\n\n    events.emit('notifications:updated', {\n      notifications: state.notifications,\n      unreadCount: 0\n    });\n    events.emit('notifications:unread-count', { count: 0 });\n  } catch (error) {\n    console.error('Failed to mark all notifications as read:', error);\n    throw error;\n  }\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(notificationId: number): Promise<void> {\n  // Helper to update local state after delete\n  const removeFromLocalState = () => {\n    const index = state.notifications.findIndex(n => n.id === notificationId);\n    if (index !== -1) {\n      const wasUnread = !state.notifications[index].read;\n      state.notifications.splice(index, 1);\n\n      if (wasUnread) {\n        state.unreadCount = Math.max(0, state.unreadCount - 1);\n      }\n\n      // Also remove from known IDs\n      state.knownNotificationIds.delete(notificationId);\n\n      events.emit('notifications:updated', {\n        notifications: state.notifications,\n        unreadCount: state.unreadCount\n      });\n      events.emit('notifications:unread-count', { count: state.unreadCount });\n    }\n  };\n\n  try {\n    const csrfToken = await getCsrfToken();\n\n    const fullUrl = `${API_URL}/api/notifications/${notificationId}/`;\n    const response = await fetch(fullUrl, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n      },\n    });\n\n    // Handle 404 gracefully - notification doesn't exist or already deleted\n    // Still remove from local state since it's effectively \"gone\"\n    if (response.status === 404) {\n      console.warn(`Notification ${notificationId} not found on server, removing from local state`);\n      removeFromLocalState();\n      return;\n    }\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete notification: ${response.status}`);\n    }\n\n    // Successfully deleted - update local state\n    removeFromLocalState();\n  } catch (error) {\n    console.error('Failed to delete notification:', error);\n    // On network error, still try to remove from local state for better UX\n    removeFromLocalState();\n    throw error;\n  }\n}\n\n/**\n * Get notification statistics\n */\nexport async function getNotificationStats(): Promise<NotificationStats> {\n  const notifications = await getNotifications();\n\n  const stats: NotificationStats = {\n    total: notifications.length,\n    unread: notifications.filter(n => !n.read).length,\n    by_type: {\n      invitation: 0,\n      invitation_response: 0,\n      comment: 0,\n      approval: 0,\n      section_update: 0,\n      revenue_proposal: 0,\n      mint_ready: 0,\n    },\n  };\n\n  notifications.forEach(n => {\n    stats.by_type[n.type] = (stats.by_type[n.type] || 0) + 1;\n  });\n\n  return stats;\n}\n\n// ============================================================================\n// Real-time Polling System\n// ============================================================================\n\nlet pollingInterval: NodeJS.Timeout | null = null;\nlet retryCount = 0;\nlet retryTimeout: NodeJS.Timeout | null = null;\n\n/**\n * Poll for new notifications\n */\nasync function pollNotifications(): Promise<void> {\n  if (!state.isPolling) return;\n\n  try {\n    // Store IDs of previously known notifications before fetching\n    const previouslyKnownIds = new Set(state.knownNotificationIds);\n\n    await getNotifications();\n\n    // Only emit 'notifications:new' after initial load is complete\n    // This prevents a flood of toasts when the page first loads\n    if (state.initialLoadComplete) {\n      // Find truly NEW notifications (IDs we haven't seen before)\n      const newNotifications = state.notifications.filter(\n        n => !previouslyKnownIds.has(n.id) && !n.read\n      );\n\n      if (newNotifications.length > 0) {\n        events.emit('notifications:new', {\n          notifications: newNotifications,\n          count: newNotifications.length\n        });\n      }\n    } else {\n      // Mark initial load as complete after first successful fetch\n      state.initialLoadComplete = true;\n    }\n\n    // Reset retry count on success\n    retryCount = 0;\n  } catch (error) {\n    console.error('Polling error:', error);\n    retryCount++;\n\n    if (retryCount >= CONFIG.MAX_RETRIES) {\n      console.error('Max retries reached, stopping polling');\n      stopPolling();\n      events.emit('notifications:polling-error', { error, retryCount });\n    } else {\n      // Schedule retry\n      if (retryTimeout) clearTimeout(retryTimeout);\n      retryTimeout = setTimeout(() => {\n        pollNotifications();\n      }, CONFIG.RETRY_DELAY);\n    }\n  }\n}\n\n/**\n * Start polling for notifications\n */\nexport function startPolling(): void {\n  if (state.isPolling) {\n    console.warn('Notification polling already started');\n    return;\n  }\n\n  console.log('Starting notification polling...');\n  state.isPolling = true;\n  retryCount = 0;\n\n  // Initial fetch\n  pollNotifications();\n\n  // Set up polling interval\n  pollingInterval = setInterval(pollNotifications, CONFIG.POLLING_INTERVAL);\n\n  events.emit('notifications:polling-started', {});\n}\n\n/**\n * Stop polling for notifications\n */\nexport function stopPolling(): void {\n  if (!state.isPolling) {\n    return;\n  }\n\n  console.log('Stopping notification polling...');\n  state.isPolling = false;\n\n  if (pollingInterval) {\n    clearInterval(pollingInterval);\n    pollingInterval = null;\n  }\n\n  if (retryTimeout) {\n    clearTimeout(retryTimeout);\n    retryTimeout = null;\n  }\n\n  events.emit('notifications:polling-stopped', {});\n}\n\n/**\n * Check if polling is active\n */\nexport function isPolling(): boolean {\n  return state.isPolling;\n}\n\n/**\n * Update polling interval\n */\nexport function setPollingInterval(intervalMs: number): void {\n  CONFIG.POLLING_INTERVAL = intervalMs;\n\n  if (state.isPolling) {\n    stopPolling();\n    startPolling();\n  }\n}\n\n// ============================================================================\n// Event System Export\n// ============================================================================\n\nexport const events = new NotificationEventEmitter();\n\n/**\n * Available events:\n * - 'notifications:updated' - Fired when notifications list is updated\n * - 'notifications:unread-count' - Fired when unread count changes\n * - 'notifications:new' - Fired when new notifications are received\n * - 'notifications:polling-started' - Fired when polling starts\n * - 'notifications:polling-stopped' - Fired when polling stops\n * - 'notifications:polling-error' - Fired when polling encounters errors\n */\n\n// ============================================================================\n// State Access Functions\n// ============================================================================\n\n/**\n * Get current notification state\n */\nexport function getState(): Readonly<NotificationState> {\n  return { ...state };\n}\n\n/**\n * Get cached notifications (without API call)\n */\nexport function getCachedNotifications(): Notification[] {\n  return [...state.notifications];\n}\n\n/**\n * Get cached unread count (without API call)\n */\nexport function getCachedUnreadCount(): number {\n  return state.unreadCount;\n}\n\n/**\n * Clear local state and stop polling\n */\nexport function reset(): void {\n  stopPolling();\n  state.notifications = [];\n  state.unreadCount = 0;\n  state.lastChecked = null;\n  state.lastError = null;\n  state.knownNotificationIds.clear();\n  state.initialLoadComplete = false;\n  events.clear();\n}\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Get human-readable time ago string\n */\nexport function getTimeAgo(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const seconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n\n  if (seconds < 60) return 'just now';\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\n  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;\n  if (seconds < 604800) return `${Math.floor(seconds / 86400)}d ago`;\n  return date.toLocaleDateString();\n}\n\n/**\n * Get notification icon based on type\n */\nexport function getNotificationIcon(type: NotificationType): string {\n  const icons: Record<NotificationType, string> = {\n    invitation: '',\n    invitation_response: '',\n    comment: '',\n    approval: '',\n    section_update: '',\n    revenue_proposal: '',\n    mint_ready: '',\n  };\n  return icons[type] || '';\n}\n\n/**\n * Get notification color based on type\n */\nexport function getNotificationColor(type: NotificationType): string {\n  const colors: Record<NotificationType, string> = {\n    invitation: '#3b82f6', // blue\n    invitation_response: '#8b5cf6', // purple\n    comment: '#06b6d4', // cyan\n    approval: '#10b981', // green\n    section_update: '#f59e0b', // amber\n    revenue_proposal: '#eab308', // yellow\n    mint_ready: '#ec4899', // pink\n  };\n  return colors[type] || '#6b7280';\n}\n\n// ============================================================================\n// Export Default Service\n// ============================================================================\n\nexport default {\n  // API Functions\n  getNotifications,\n  getUnreadNotifications,\n  getUnreadCount,\n  markNotificationRead,\n  markAllNotificationsRead,\n  deleteNotification,\n  getNotificationStats,\n\n  // Polling Functions\n  startPolling,\n  stopPolling,\n  isPolling,\n  setPollingInterval,\n\n  // State Functions\n  getState,\n  getCachedNotifications,\n  getCachedUnreadCount,\n  reset,\n\n  // Event System\n  events,\n\n  // Utilities\n  getTimeAgo,\n  getNotificationIcon,\n  getNotificationColor,\n};\n","/**\n * React Hook for Notification System\n * Provides easy integration with notificationService in React components\n */\n\nimport { useEffect, useState, useCallback } from 'react';\nimport notificationService, {\n  Notification,\n  NotificationStats,\n  events,\n} from '../services/notificationService';\n\ninterface UseNotificationsOptions {\n  autoStart?: boolean; // Auto-start polling when hook mounts\n  onNewNotification?: (notifications: Notification[]) => void; // Callback for new notifications\n}\n\ninterface UseNotificationsReturn {\n  notifications: Notification[];\n  unreadCount: number;\n  isLoading: boolean;\n  isPolling: boolean;\n  error: Error | null;\n\n  // Actions\n  refresh: () => Promise<void>;\n  markAsRead: (notificationId: number) => Promise<void>;\n  markAllAsRead: () => Promise<void>;\n  deleteNotification: (notificationId: number) => Promise<void>;\n  startPolling: () => void;\n  stopPolling: () => void;\n  getStats: () => Promise<NotificationStats>;\n}\n\n/**\n * Custom hook for managing notifications\n */\nexport function useNotifications(\n  options: UseNotificationsOptions = {}\n): UseNotificationsReturn {\n  const { autoStart = false, onNewNotification } = options;\n\n  // State\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [unreadCount, setUnreadCount] = useState<number>(0);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [isPolling, setIsPolling] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  // Refresh notifications\n  const refresh = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const data = await notificationService.getNotifications();\n      setNotifications(data);\n      setUnreadCount(data.filter(n => !n.read).length);\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to refresh notifications:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Mark notification as read\n  const markAsRead = useCallback(async (notificationId: number) => {\n    try {\n      await notificationService.markNotificationRead(notificationId);\n      // State will be updated via event listener\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to mark notification as read:', err);\n      throw err;\n    }\n  }, []);\n\n  // Mark all notifications as read\n  const markAllAsRead = useCallback(async () => {\n    try {\n      await notificationService.markAllNotificationsRead();\n      // State will be updated via event listener\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to mark all notifications as read:', err);\n      throw err;\n    }\n  }, []);\n\n  // Delete notification\n  const deleteNotificationCallback = useCallback(async (notificationId: number) => {\n    try {\n      await notificationService.deleteNotification(notificationId);\n      // State will be updated via event listener\n    } catch (err) {\n      // Don't throw - the service handles 404 gracefully and updates local state\n      // Other errors are logged but we don't want to block the UI\n      console.error('Failed to delete notification:', err);\n    }\n  }, []);\n\n  // Start polling\n  const startPollingCallback = useCallback(() => {\n    notificationService.startPolling();\n    setIsPolling(true);\n  }, []);\n\n  // Stop polling\n  const stopPollingCallback = useCallback(() => {\n    notificationService.stopPolling();\n    setIsPolling(false);\n  }, []);\n\n  // Get statistics\n  const getStats = useCallback(async () => {\n    try {\n      return await notificationService.getNotificationStats();\n    } catch (err) {\n      setError(err as Error);\n      console.error('Failed to get notification stats:', err);\n      throw err;\n    }\n  }, []);\n\n  // Subscribe to notification events\n  useEffect(() => {\n    // Handle notifications updated\n    const unsubUpdated = events.on('notifications:updated', ({ notifications, unreadCount }) => {\n      setNotifications(notifications);\n      setUnreadCount(unreadCount);\n    });\n\n    // Handle unread count changes\n    const unsubUnreadCount = events.on('notifications:unread-count', ({ count }) => {\n      setUnreadCount(count);\n    });\n\n    // Handle new notifications\n    const unsubNew = events.on('notifications:new', ({ notifications: newNotifs }) => {\n      if (onNewNotification) {\n        onNewNotification(newNotifs);\n      }\n    });\n\n    // Handle polling state changes\n    const unsubPollingStarted = events.on('notifications:polling-started', () => {\n      setIsPolling(true);\n    });\n\n    const unsubPollingStopped = events.on('notifications:polling-stopped', () => {\n      setIsPolling(false);\n    });\n\n    // Handle polling errors\n    const unsubPollingError = events.on('notifications:polling-error', ({ error }) => {\n      setError(error);\n      setIsPolling(false);\n    });\n\n    // Cleanup subscriptions\n    return () => {\n      unsubUpdated();\n      unsubUnreadCount();\n      unsubNew();\n      unsubPollingStarted();\n      unsubPollingStopped();\n      unsubPollingError();\n    };\n  }, [onNewNotification]);\n\n  // Auto-start polling if enabled\n  useEffect(() => {\n    if (autoStart) {\n      startPollingCallback();\n      refresh();\n    }\n\n    return () => {\n      if (autoStart) {\n        stopPollingCallback();\n      }\n    };\n  }, [autoStart, startPollingCallback, stopPollingCallback, refresh]);\n\n  return {\n    notifications,\n    unreadCount,\n    isLoading,\n    isPolling,\n    error,\n\n    refresh,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification: deleteNotificationCallback,\n    startPolling: startPollingCallback,\n    stopPolling: stopPollingCallback,\n    getStats,\n  };\n}\n\n/**\n * Simple hook to just get unread count\n */\nexport function useUnreadCount(autoStart = false): {\n  unreadCount: number;\n  refresh: () => Promise<void>;\n} {\n  const [unreadCount, setUnreadCount] = useState<number>(0);\n\n  const refresh = useCallback(async () => {\n    try {\n      const count = await notificationService.getUnreadCount();\n      setUnreadCount(count);\n    } catch (err) {\n      console.error('Failed to get unread count:', err);\n    }\n  }, []);\n\n  useEffect(() => {\n    const unsubUnreadCount = events.on('notifications:unread-count', ({ count }) => {\n      setUnreadCount(count);\n    });\n\n    if (autoStart) {\n      refresh();\n    }\n\n    return () => {\n      unsubUnreadCount();\n    };\n  }, [autoStart, refresh]);\n\n  return { unreadCount, refresh };\n}\n\nexport default useNotifications;\n","/**\n * NotificationItem Component\n * Reusable component for individual notifications\n */\n\nimport React, { memo } from 'react';\nimport {\n  Mail,\n  MailOpen,\n  MessageSquare,\n  CheckCircle,\n  FileEdit,\n  DollarSign,\n  PartyPopper,\n  Bell,\n} from 'lucide-react';\nimport {\n  Notification,\n  NotificationType,\n  getTimeAgo,\n  getNotificationColor,\n} from '../../services/notificationService';\n\n// Get Lucide icon component based on notification type\nfunction getNotificationLucideIcon(type: NotificationType): React.ReactNode {\n  const iconProps = { size: 20 };\n\n  switch (type) {\n    case 'invitation':\n      return <Mail {...iconProps} />;\n    case 'invitation_response':\n      return <MailOpen {...iconProps} />;\n    case 'comment':\n      return <MessageSquare {...iconProps} />;\n    case 'approval':\n      return <CheckCircle {...iconProps} />;\n    case 'section_update':\n      return <FileEdit {...iconProps} />;\n    case 'revenue_proposal':\n      return <DollarSign {...iconProps} />;\n    case 'mint_ready':\n      return <PartyPopper {...iconProps} />;\n    default:\n      return <Bell {...iconProps} />;\n  }\n}\n\ninterface NotificationItemProps {\n  notification: Notification;\n  onClick: () => void;\n  onDelete: (e: React.MouseEvent) => void;\n  onViewInvite?: (notification: Notification) => void;\n}\n\nfunction NotificationItemComponent({ notification, onClick, onDelete, onViewInvite }: NotificationItemProps) {\n  const icon = getNotificationLucideIcon(notification.type);\n  const color = getNotificationColor(notification.type);\n  const timeAgo = getTimeAgo(notification.created_at);\n  const isInvitation = notification.type === 'invitation';\n\n  return (\n    <div\n      onClick={onClick}\n      role=\"button\"\n      tabIndex={0}\n      aria-label={`${notification.read ? 'Read' : 'Unread'} notification: ${notification.title}`}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onClick();\n        }\n      }}\n      style={{\n        padding: '12px 20px',\n        cursor: 'pointer',\n        background: notification.read ? 'transparent' : '#0b1220',\n        borderLeft: `3px solid ${notification.read ? 'transparent' : color}`,\n        transition: 'all 0.2s',\n        position: 'relative',\n      }}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.background = '#1e293b';\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = notification.read ? 'transparent' : '#0b1220';\n      }}\n    >\n      <div style={{ display: 'flex', gap: 12 }}>\n        {/* Icon */}\n        <div\n          style={{\n            width: 40,\n            height: 40,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            background: `${color}20`,\n            borderRadius: 8,\n            flexShrink: 0,\n            color: color,\n          }}\n          aria-hidden=\"true\"\n        >\n          {icon}\n        </div>\n\n        {/* Content */}\n        <div style={{ flex: 1, minWidth: 0 }}>\n          <div\n            style={{\n              fontSize: 13,\n              fontWeight: 600,\n              color: '#e5e7eb',\n              marginBottom: 4,\n              lineHeight: 1.4,\n            }}\n          >\n            {notification.title}\n          </div>\n          <div\n            style={{\n              fontSize: 12,\n              color: '#94a3b8',\n              marginBottom: 6,\n              lineHeight: 1.5,\n            }}\n          >\n            {notification.message}\n          </div>\n          <div\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              fontSize: 11,\n              color: '#64748b',\n            }}\n          >\n            <span>@{notification.from_user.username}</span>\n            <span></span>\n            <span>{timeAgo}</span>\n          </div>\n\n          {/* View Invite button for invitation notifications */}\n          {isInvitation && onViewInvite && (\n            <button\n              onClick={(e) => {\n                e.stopPropagation();\n                onViewInvite(notification);\n              }}\n              style={{\n                marginTop: 10,\n                background: '#f59e0b',\n                color: '#000',\n                border: 'none',\n                padding: '8px 16px',\n                borderRadius: 6,\n                fontSize: 12,\n                fontWeight: 700,\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                gap: 6,\n                transition: 'all 0.2s',\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.background = '#fbbf24';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.background = '#f59e0b';\n              }}\n            >\n              View Invite \n            </button>\n          )}\n        </div>\n\n        {/* Delete button */}\n        <button\n          onClick={onDelete}\n          aria-label=\"Delete notification\"\n          style={{\n            background: 'transparent',\n            border: 'none',\n            color: '#64748b',\n            cursor: 'pointer',\n            padding: 4,\n            borderRadius: 4,\n            fontSize: 18,\n            width: 28,\n            height: 28,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexShrink: 0,\n            opacity: 0.6,\n            transition: 'all 0.2s',\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.background = '#1e293b';\n            e.currentTarget.style.color = '#ef4444';\n            e.currentTarget.style.opacity = '1';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.background = 'transparent';\n            e.currentTarget.style.color = '#64748b';\n            e.currentTarget.style.opacity = '0.6';\n          }}\n        >\n          \n        </button>\n      </div>\n\n      {/* Unread indicator */}\n      {!notification.read && (\n        <div\n          aria-label=\"Unread\"\n          style={{\n            position: 'absolute',\n            top: 18,\n            right: 20,\n            width: 8,\n            height: 8,\n            background: color,\n            borderRadius: '50%',\n            boxShadow: `0 0 8px ${color}`,\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\nexport const NotificationItem = memo(NotificationItemComponent);\n\nexport default NotificationItem;\n","/**\n * Collaboration API Service\n *\n * Provides functions for managing collaborative projects, invitations,\n * sections, and communication between collaborators.\n */\n\nimport { API_URL as API_BASE } from '../config';\n\n// ===== TypeScript Interfaces =====\n\nexport interface CollaborativeProject {\n  id: number;\n  title: string;\n  content_type: 'book' | 'music' | 'video' | 'art';\n  description: string;\n  status: 'draft' | 'active' | 'ready_for_mint' | 'minted' | 'cancelled';\n  milestones: Milestone[];\n  price_usd: number;\n  editions: number;\n  teaser_percent: number;\n  watermark_preview: boolean;\n  authors_note?: string;\n  estimated_earnings?: { [userId: number]: number };\n  created_by: number;\n  created_by_username: string;\n  created_at: string;\n  updated_at: string;\n  collaborators: CollaboratorRole[];\n  sections: ProjectSection[];\n  recent_comments: ProjectComment[];\n  is_fully_approved: boolean;\n  total_collaborators: number;\n  progress_percentage: number;\n}\n\nexport interface CollaborativeProjectListItem {\n  id: number;\n  title: string;\n  content_type: string;\n  status: string;\n  created_by: number;\n  created_by_username: string;\n  total_collaborators: number;\n  created_at: string;\n  price_usd: number;\n}\n\n// Contract task interface for task-based collaboration\nexport interface ContractTask {\n  id: number;\n  title: string;\n  description: string;\n  deadline: string;\n  status: 'pending' | 'in_progress' | 'complete' | 'signed_off' | 'cancelled';\n  order: number;\n  marked_complete_at?: string;\n  marked_complete_by?: number;\n  marked_complete_by_username?: string;\n  completion_notes?: string;\n  signed_off_at?: string;\n  signed_off_by?: number;\n  signed_off_by_username?: string;\n  signoff_notes?: string;\n  rejection_notes?: string;\n  rejected_at?: string;\n  is_overdue: boolean;\n  days_until_deadline?: number;\n  created_at: string;\n  updated_at: string;\n}\n\n// Role definition for standard roles\nexport interface RoleDefinition {\n  id: number;\n  name: string;\n  category: 'creator' | 'contributor' | 'reviewer' | 'technical' | 'management';\n  description: string;\n  applicable_to_book: boolean;\n  applicable_to_art: boolean;\n  applicable_to_music: boolean;\n  applicable_to_video: boolean;\n  default_permissions: {\n    create: string[];\n    edit: { scope: string; types: string[] };\n    review: string[];\n  };\n  ui_components: string[];\n  icon: string;\n  color: string;\n  is_active: boolean;\n}\n\nexport interface CollaboratorRole {\n  id: number;\n  user: number;\n  username: string;\n  display_name: string;\n  avatar_url?: string;\n  role: string;\n  revenue_percentage: number;\n  status: 'invited' | 'accepted' | 'declined' | 'exited';\n  invited_at: string;\n  accepted_at?: string;\n  // Legacy permission flags (still supported)\n  can_edit_text: boolean;\n  can_edit_images: boolean;\n  can_edit_audio: boolean;\n  can_edit_video: boolean;\n  can_edit: string[];\n  // New role-based permission fields\n  role_definition_id?: number;\n  role_definition_details?: RoleDefinition;\n  permissions?: {\n    create?: string[];\n    edit?: { scope: string; types: string[] };\n    review?: string[];\n  };\n  effective_role_name?: string;\n  effective_permissions?: {\n    create: string[];\n    edit: { scope: string; types: string[] };\n    review: string[];\n  };\n  ui_components?: string[];\n  // Approval tracking\n  approved_current_version: boolean;\n  approved_revenue_split: boolean;\n  // Counter-proposal fields\n  proposed_percentage?: number;\n  counter_message?: string;\n  // Deadline and accountability fields\n  delivery_deadline?: string;\n  deadline_extended_at?: string;\n  deadline_extension_reason?: string;\n  sections_due?: number[];\n  // Multi-party governance fields\n  is_lead: boolean;\n  can_invite_others: boolean;\n  voting_weight: number;\n  // Contract task fields\n  contract_tasks: ContractTask[];\n  tasks_total: number;\n  tasks_signed_off: number;\n  all_tasks_complete: boolean;\n  has_active_breach: boolean;\n  cancellation_eligible: boolean;\n  contract_version: number;\n  contract_locked_at?: string;\n}\n\nexport interface ProjectSection {\n  id: number;\n  section_type: 'text' | 'image' | 'audio' | 'video';\n  title: string;\n  content_html?: string;\n  media_file?: string;\n  owner: number;\n  owner_username: string;\n  order: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CommentReaction {\n  id: number;\n  user_id: number;\n  username: string;\n  emoji: string;\n}\n\nexport interface ProjectComment {\n  id: number;\n  author: number;\n  author_username: string;\n  author_avatar: string;\n  content: string;\n  parent_comment?: number;\n  section?: number;\n  section_title?: string;\n  resolved: boolean;\n  resolved_by?: number;\n  resolved_by_username?: string;\n  resolved_at?: string;\n  created_at: string;\n  updated_at?: string;\n  edited: boolean;\n  edit_history?: Array<{\n    content: string;\n    edited_at: string;\n  }>;\n  replies_count: number;\n  replies?: ProjectComment[];\n  reactions?: CommentReaction[];\n  attachments?: Array<{\n    id: number;\n    filename: string;\n    file_url: string;\n    file_size: number;\n  }>;\n  mentions?: number[]; // User IDs mentioned in the comment\n}\n\nexport interface Milestone {\n  id?: string;\n  title: string;\n  description?: string;\n  due_date?: string;\n  completed: boolean;\n}\n\nexport interface RevenueSplit {\n  user_id: number;\n  percentage: number;\n}\n\nexport interface InviteCollaboratorData {\n  user_id: number;\n  role: string;\n  revenue_percentage: number;\n  can_edit_text?: boolean;\n  can_edit_images?: boolean;\n  can_edit_audio?: boolean;\n  can_edit_video?: boolean;\n}\n\nexport interface CreateProjectData {\n  title: string;\n  content_type: 'book' | 'music' | 'video' | 'art';\n  description?: string;\n  milestones?: Milestone[];\n}\n\nexport interface CreateSectionData {\n  project: number;\n  section_type: 'text' | 'image' | 'audio' | 'video';\n  title: string;\n  content_html?: string;\n  media_file?: File;\n  order?: number;\n}\n\nexport interface CreateCommentData {\n  project: number;\n  content: string;\n  section?: number;\n  parent_comment?: number;\n  mentions?: number[];\n  attachments?: File[];\n}\n\n// ===== Helper Functions =====\n\n/**\n * Get fresh CSRF token from API\n * This is more reliable than reading from cookies\n */\nasync function getFreshCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_BASE}/api/auth/csrf/`, {\n      credentials: 'include',\n    });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to fetch CSRF token:', error);\n    return '';\n  }\n}\n\n/**\n * Handle API errors with detailed messages\n */\nasync function handleResponse<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    let errorMessage = `Request failed: ${response.statusText}`;\n    try {\n      const errorData = await response.json();\n      if (errorData.error) {\n        errorMessage = errorData.error;\n      } else if (errorData.detail) {\n        errorMessage = errorData.detail;\n      }\n    } catch {\n      // Response body not JSON, use status text\n    }\n    throw new Error(errorMessage);\n  }\n  return response.json();\n}\n\n// ===== API Functions =====\n\nexport const collaborationApi = {\n  // ===== Project Management =====\n\n  /**\n   * Create a new collaborative project\n   */\n  async createCollaborativeProject(data: CreateProjectData): Promise<CollaborativeProject> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Get all collaborative projects for current user\n   */\n  async getCollaborativeProjects(): Promise<CollaborativeProjectListItem[]> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<CollaborativeProjectListItem[]>(response);\n  },\n\n  /**\n   * Get single project with full details\n   */\n  async getCollaborativeProject(id: number): Promise<CollaborativeProject> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/${id}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Get all pending collaboration invites for the current user\n   * Returns projects where user has status='invited'\n   */\n  async getPendingInvites(): Promise<{ project: CollaborativeProject; invite: CollaboratorRole }[]> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/pending_invites/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<{ project: CollaborativeProject; invite: CollaboratorRole }[]>(response);\n  },\n\n  /**\n   * Update collaborative project\n   */\n  async updateCollaborativeProject(\n    id: number,\n    data: Partial<CreateProjectData>\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Delete collaborative project\n   */\n  async deleteCollaborativeProject(id: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/collaborative-projects/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete project: ${response.statusText}`);\n    }\n  },\n\n  // ===== Collaboration Actions =====\n\n  /**\n   * Invite a collaborator to the project\n   */\n  async inviteCollaborator(\n    projectId: number,\n    data: InviteCollaboratorData\n  ): Promise<CollaboratorRole> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/invite_collaborator/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<CollaboratorRole>(response);\n  },\n\n  /**\n   * Accept invitation to collaborate\n   */\n  async acceptInvitation(projectId: number): Promise<CollaboratorRole> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/accept_invitation/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<CollaboratorRole>(response);\n  },\n\n  /**\n   * Decline invitation to collaborate\n   */\n  async declineInvitation(projectId: number): Promise<{ message: string }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/decline_invitation/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Submit counter-proposal for collaboration invitation\n   */\n  async counterProposeInvite(\n    projectId: number,\n    data: { proposed_percentage: number; message: string }\n  ): Promise<{ message: string; invitation: CollaboratorRole }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/counter_propose/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<{ message: string; invitation: CollaboratorRole }>(response);\n  },\n\n  /**\n   * Propose new revenue split percentages\n   */\n  async proposeRevenueSplit(\n    projectId: number,\n    splits: RevenueSplit[]\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/propose_revenue_split/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ splits }),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  // ===== Approval System =====\n\n  /**\n   * Approve current version for minting\n   */\n  async approveCurrentVersion(projectId: number): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/approve_version/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Get approval status for a project\n   */\n  async getApprovalStatus(projectId: number): Promise<{\n    is_fully_approved: boolean;\n    pending_approvals: string[];\n  }> {\n    const project = await this.getCollaborativeProject(projectId);\n\n    const pendingApprovals = project.collaborators\n      .filter(\n        (c) =>\n          c.status === 'accepted' &&\n          (!c.approved_current_version || !c.approved_revenue_split)\n      )\n      .map((c) => c.username);\n\n    return {\n      is_fully_approved: project.is_fully_approved,\n      pending_approvals: pendingApprovals,\n    };\n  },\n\n  /**\n   * Get project preview (combined sections)\n   */\n  async getProjectPreview(projectId: number): Promise<{\n    title: string;\n    content_type: string;\n    sections: any[];\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/preview/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse(response);\n  },\n\n  // ===== Section Management =====\n\n  /**\n   * Create a new project section\n   */\n  async createProjectSection(data: CreateSectionData): Promise<ProjectSection> {\n    const formData = new FormData();\n    formData.append('project', data.project.toString());\n    formData.append('section_type', data.section_type);\n    formData.append('title', data.title);\n    if (data.content_html) {\n      formData.append('content_html', data.content_html);\n    }\n    if (data.media_file) {\n      formData.append('media_file', data.media_file);\n    }\n    if (data.order !== undefined) {\n      formData.append('order', data.order.toString());\n    }\n\n    const response = await fetch(`${API_BASE}/api/project-sections/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: formData,\n    });\n\n    return handleResponse<ProjectSection>(response);\n  },\n\n  /**\n   * Update project section\n   */\n  async updateProjectSection(\n    id: number,\n    data: Partial<CreateSectionData>\n  ): Promise<ProjectSection> {\n    const formData = new FormData();\n    if (data.section_type) {\n      formData.append('section_type', data.section_type);\n    }\n    if (data.title) {\n      formData.append('title', data.title);\n    }\n    if (data.content_html !== undefined) {\n      formData.append('content_html', data.content_html);\n    }\n    if (data.media_file) {\n      formData.append('media_file', data.media_file);\n    }\n    if (data.order !== undefined) {\n      formData.append('order', data.order.toString());\n    }\n\n    const response = await fetch(`${API_BASE}/api/project-sections/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: formData,\n    });\n\n    return handleResponse<ProjectSection>(response);\n  },\n\n  /**\n   * Delete project section\n   */\n  async deleteProjectSection(id: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/project-sections/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete section: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Get all sections for a project\n   */\n  async getProjectSections(projectId: number): Promise<ProjectSection[]> {\n    const response = await fetch(\n      `${API_BASE}/api/project-sections/?project=${projectId}`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse<ProjectSection[]>(response);\n  },\n\n  // ===== Communication =====\n\n  /**\n   * Add a comment to project or section\n   */\n  async addComment(data: CreateCommentData): Promise<ProjectComment> {\n    // Use FormData if there are attachments\n    if (data.attachments && data.attachments.length > 0) {\n      const formData = new FormData();\n      formData.append('project', data.project.toString());\n      formData.append('content', data.content);\n      if (data.section) formData.append('section', data.section.toString());\n      if (data.parent_comment) formData.append('parent_comment', data.parent_comment.toString());\n      if (data.mentions) formData.append('mentions', JSON.stringify(data.mentions));\n\n      data.attachments.forEach((file, index) => {\n        formData.append(`attachment_${index}`, file);\n      });\n\n      const response = await fetch(`${API_BASE}/api/project-comments/`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: formData,\n      });\n\n      return handleResponse<ProjectComment>(response);\n    }\n\n    // Regular JSON request without attachments\n    const response = await fetch(`${API_BASE}/api/project-comments/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Get comments for a project or section\n   */\n  async getComments(projectId: number, sectionId?: number): Promise<ProjectComment[]> {\n    let url = `${API_BASE}/api/project-comments/?project=${projectId}`;\n    if (sectionId) {\n      url += `&section=${sectionId}`;\n    }\n\n    const response = await fetch(url, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<ProjectComment[]>(response);\n  },\n\n  /**\n   * Resolve a comment\n   */\n  async resolveComment(commentId: number): Promise<ProjectComment> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/resolve/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Unresolve a comment\n   */\n  async unresolveComment(commentId: number): Promise<ProjectComment> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/unresolve/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Update a comment\n   */\n  async updateComment(commentId: number, content: string): Promise<ProjectComment> {\n    const response = await fetch(`${API_BASE}/api/project-comments/${commentId}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ content }),\n    });\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Delete a comment\n   */\n  async deleteComment(commentId: number): Promise<void> {\n    const response = await fetch(`${API_BASE}/api/project-comments/${commentId}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete comment: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Add reaction to a comment\n   */\n  async addReaction(commentId: number, emoji: string): Promise<CommentReaction> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/add-reaction/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ emoji }),\n      }\n    );\n\n    return handleResponse<CommentReaction>(response);\n  },\n\n  /**\n   * Remove reaction from a comment\n   */\n  async removeReaction(commentId: number, reactionId: number): Promise<void> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/remove-reaction/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ reaction_id: reactionId }),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(`Failed to remove reaction: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Get comment thread (with replies)\n   */\n  async getCommentThread(commentId: number): Promise<ProjectComment> {\n    const response = await fetch(\n      `${API_BASE}/api/project-comments/${commentId}/thread/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse<ProjectComment>(response);\n  },\n\n  /**\n   * Get comments by section\n   */\n  async getCommentsBySection(\n    projectId: number,\n    includeResolved: boolean = false\n  ): Promise<{ [sectionId: string]: ProjectComment[] }> {\n    let url = `${API_BASE}/api/project-comments/by-section/?project=${projectId}`;\n    if (includeResolved) {\n      url += '&include_resolved=true';\n    }\n\n    const response = await fetch(url, {\n      method: 'GET',\n      credentials: 'include',\n    });\n\n    return handleResponse<{ [sectionId: string]: ProjectComment[] }>(response);\n  },\n\n  /**\n   * Get unresolved comment count\n   */\n  async getUnresolvedCommentCount(projectId: number): Promise<number> {\n    const comments = await this.getComments(projectId);\n    return comments.filter(c => !c.resolved).length;\n  },\n\n  // ===== Minting Workflow =====\n\n  /**\n   * Request approval from specific collaborators\n   */\n  async requestApproval(\n    projectId: number,\n    data: {\n      collaborator_ids: number[];\n      message?: string;\n      deadline_days?: number;\n    }\n  ): Promise<{ message: string; notifications_sent: number }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/request_approval/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<{ message: string; notifications_sent: number }>(response);\n  },\n\n  /**\n   * Approve project (both content and revenue split)\n   */\n  async approveProject(\n    projectId: number,\n    data: {\n      approve_content: boolean;\n      approve_revenue: boolean;\n      feedback?: string;\n    }\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/approve_project/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Set the NFT price for a project (project owner only)\n   */\n  async setPrice(\n    projectId: number,\n    priceUsd: number\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/set_price/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ price_usd: priceUsd }),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Update customization settings (price, editions, teaser)\n   * Only project owner can update these settings.\n   * Updating these settings resets revenue split approvals.\n   */\n  async updateCustomization(\n    projectId: number,\n    settings: {\n      price_usd?: number;\n      editions?: number;\n      teaser_percent?: number;\n      watermark_preview?: boolean;\n      authors_note?: string;\n    }\n  ): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/update_customization/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(settings),\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  /**\n   * Mint project as NFT\n   */\n  async mintProject(\n    projectId: number,\n    forceMint: boolean = false\n  ): Promise<{\n    success: boolean;\n    nft_id: string;\n    token_id: string;\n    contract_address: string;\n    ipfs_hash: string;\n    transaction_hash: string;\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/mint/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ force_mint: forceMint }),\n      }\n    );\n\n    return handleResponse<{\n      success: boolean;\n      nft_id: string;\n      token_id: string;\n      contract_address: string;\n      ipfs_hash: string;\n      transaction_hash: string;\n    }>(response);\n  },\n\n  /**\n   * Get minting status for a project\n   */\n  async getMintingStatus(projectId: number): Promise<{\n    status: 'not_started' | 'validating' | 'uploading' | 'creating_contract' | 'minting' | 'completed' | 'error';\n    stage: string;\n    progress: number;\n    error?: string;\n    nft_data?: {\n      id: string;\n      token_id: string;\n      contract_address: string;\n      ipfs_hash: string;\n    };\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/minting-status/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse(response);\n  },\n\n  /**\n   * Cancel approval (reset approval status)\n   */\n  async cancelApproval(projectId: number): Promise<CollaborativeProject> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/cancel_approval/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n        'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<CollaborativeProject>(response);\n  },\n\n  // ===== Proposals & Voting =====\n\n  /**\n   * Get all proposals for a project\n   */\n  async getProposals(projectId: number): Promise<Proposal[]> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse<Proposal[]>(response);\n  },\n\n  /**\n   * Create a new proposal\n   */\n  async createProposal(\n    projectId: number,\n    data: CreateProposalData\n  ): Promise<Proposal> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<Proposal>(response);\n  },\n\n  /**\n   * Cast a vote on a proposal\n   */\n  async castVote(\n    projectId: number,\n    proposalId: number,\n    data: { vote: 'approve' | 'reject' | 'abstain'; comment?: string }\n  ): Promise<ProposalVote> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/${proposalId}/vote/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    return handleResponse<ProposalVote>(response);\n  },\n\n  /**\n   * Cancel a proposal (only proposer or owner can cancel)\n   */\n  async cancelProposal(projectId: number, proposalId: number): Promise<{ message: string }> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/proposals/${proposalId}/cancel/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n      }\n    );\n\n    return handleResponse<{ message: string }>(response);\n  },\n\n  // ===== Collaborator Ratings =====\n\n  /**\n   * Submit a rating for a collaborator\n   */\n  async rateCollaborator(\n    projectId: number,\n    ratedUserId: number,\n    data: CollaboratorRatingData\n  ): Promise<CollaboratorRating> {\n    const response = await fetch(\n      `${API_BASE}/api/collaborative-projects/${projectId}/rate_collaborator/`,\n      {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': await getFreshCsrfToken(),\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        body: JSON.stringify({ rated_user_id: ratedUserId, ...data }),\n      }\n    );\n\n    return handleResponse<CollaboratorRating>(response);\n  },\n\n  /**\n   * Get ratings for a user\n   */\n  async getUserRatings(userId: number): Promise<{\n    ratings: CollaboratorRating[];\n    average_scores: {\n      quality: number;\n      deadline: number;\n      communication: number;\n      would_collab_again: number;\n      overall: number;\n    };\n    total_projects: number;\n  }> {\n    const response = await fetch(\n      `${API_BASE}/api/users/${userId}/ratings/`,\n      {\n        method: 'GET',\n        credentials: 'include',\n      }\n    );\n\n    return handleResponse(response);\n  },\n};\n\n// ===== Additional TypeScript Interfaces =====\n\nexport interface Proposal {\n  id: number;\n  proposal_type: string;\n  title: string;\n  description: string;\n  proposal_data: Record<string, any>;\n  status: 'pending' | 'approved' | 'rejected' | 'expired' | 'cancelled';\n  voting_threshold: 'majority' | 'unanimous' | 'owner_decides';\n  proposer_id: number;\n  proposer_username: string;\n  expires_at?: string;\n  resolved_at?: string;\n  created_at: string;\n  votes: ProposalVote[];\n  vote_counts: {\n    approve: number;\n    reject: number;\n    abstain: number;\n    total: number;\n  };\n  total_voters: number;\n}\n\nexport interface ProposalVote {\n  id: number;\n  voter_id: number;\n  voter_username: string;\n  vote: 'approve' | 'reject' | 'abstain';\n  comment?: string;\n  voted_at: string;\n}\n\nexport interface CreateProposalData {\n  proposal_type: string;\n  title: string;\n  description?: string;\n  proposal_data: Record<string, any>;\n  voting_threshold?: 'majority' | 'unanimous' | 'owner_decides';\n  expires_in_days?: number;\n}\n\nexport interface CollaboratorRating {\n  id: number;\n  project_id: number;\n  project_title: string;\n  rater_id: number;\n  rater_username: string;\n  rated_user_id: number;\n  rated_user_username: string;\n  quality_score: number;\n  deadline_score: number;\n  communication_score: number;\n  would_collab_again: number;\n  average_score: number;\n  private_note?: string;\n  public_feedback?: string;\n  created_at: string;\n}\n\nexport interface CollaboratorRatingData {\n  quality_score: number;\n  deadline_score: number;\n  communication_score: number;\n  would_collab_again: number;\n  private_note?: string;\n  public_feedback?: string;\n}\n","/**\n * InviteResponseModal Component\n *\n * Displays collaboration invite details and allows the recipient to\n * Accept, Decline, or Counter-Propose.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  collaborationApi,\n  CollaborativeProject,\n  CollaboratorRole\n} from '../../services/collaborationApi';\n\ninterface InviteResponseModalProps {\n  open: boolean;\n  onClose: () => void;\n  projectId: number;\n  notificationMessage?: string;\n}\n\ntype ModalMode = 'view' | 'counter-propose';\n\nexport function InviteResponseModal({\n  open,\n  onClose,\n  projectId,\n  notificationMessage\n}: InviteResponseModalProps) {\n  const navigate = useNavigate();\n\n  // State\n  const [loading, setLoading] = useState(true);\n  const [project, setProject] = useState<CollaborativeProject | null>(null);\n  const [myRole, setMyRole] = useState<CollaboratorRole | null>(null);\n  const [mode, setMode] = useState<ModalMode>('view');\n  const [proposedPercentage, setProposedPercentage] = useState(50);\n  const [counterMessage, setCounterMessage] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n\n  // Load project details\n  useEffect(() => {\n    if (!open || !projectId) return;\n\n    const loadProject = async () => {\n      setLoading(true);\n      setError('');\n      try {\n        const data = await collaborationApi.getCollaborativeProject(projectId);\n        setProject(data);\n\n        // Find current user's role (the one with status='invited')\n        const invitedRole = data.collaborators.find(\n          (c: CollaboratorRole) => c.status === 'invited'\n        );\n        if (invitedRole) {\n          setMyRole(invitedRole);\n          setProposedPercentage(invitedRole.revenue_percentage);\n        }\n      } catch (err: any) {\n        setError(err.message || 'Failed to load project details');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadProject();\n  }, [open, projectId]);\n\n  // Reset state when closed\n  useEffect(() => {\n    if (!open) {\n      setMode('view');\n      setCounterMessage('');\n      setError('');\n      setSuccess('');\n    }\n  }, [open]);\n\n  if (!open) return null;\n\n  const handleAccept = async () => {\n    setSubmitting(true);\n    setError('');\n    try {\n      await collaborationApi.acceptInvitation(projectId);\n      setSuccess('Invite accepted! Redirecting to project...');\n      setTimeout(() => {\n        onClose();\n        navigate(`/collaborations/${projectId}`);\n      }, 1500);\n    } catch (err: any) {\n      setError(err.message || 'Failed to accept invitation');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleDecline = async () => {\n    setSubmitting(true);\n    setError('');\n    try {\n      await collaborationApi.declineInvitation(projectId);\n      setSuccess('Invite declined.');\n      setTimeout(() => {\n        onClose();\n      }, 1500);\n    } catch (err: any) {\n      setError(err.message || 'Failed to decline invitation');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleCounterPropose = async () => {\n    if (!counterMessage.trim()) {\n      setError('Please add a message explaining your counter-proposal');\n      return;\n    }\n\n    setSubmitting(true);\n    setError('');\n    try {\n      await collaborationApi.counterProposeInvite(projectId, {\n        proposed_percentage: proposedPercentage,\n        message: counterMessage,\n      });\n\n      setSuccess('Counter-proposal sent! Waiting for response...');\n      setTimeout(() => {\n        onClose();\n      }, 2000);\n    } catch (err: any) {\n      setError(err.message || 'Failed to send counter-proposal');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get project creator info\n  const creator = project?.collaborators.find(\n    (c: CollaboratorRole) => c.user === project.created_by\n  );\n\n  // Calculate others' share\n  const othersPercentage = myRole ? 100 - myRole.revenue_percentage : 0;\n\n  const contentTypeLabels: Record<string, string> = {\n    book: 'Book',\n    music: 'Music',\n    video: 'Video',\n    art: 'Art',\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0,0,0,0.9)',\n        display: 'grid',\n        placeItems: 'center',\n        zIndex: 1000,\n        padding: 20,\n      }}\n      onClick={(e) => {\n        if (e.target === e.currentTarget && !submitting) onClose();\n      }}\n    >\n      <div\n        style={{\n          background: '#0f172a',\n          border: '1px solid #334155',\n          borderRadius: 16,\n          width: '100%',\n          maxWidth: 600,\n          maxHeight: '90vh',\n          overflow: 'auto',\n          boxShadow: '0 20px 25px -5px rgba(0,0,0,0.5)',\n        }}\n      >\n        {/* Header */}\n        <div\n          style={{\n            padding: 24,\n            borderBottom: '1px solid #334155',\n            background: 'linear-gradient(135deg, #1e293b 0%, #0f172a 100%)',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'flex-start',\n          }}\n        >\n          <div>\n            <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 8 }}>\n              <span style={{ fontSize: 24 }}></span>\n              <h2 style={{ margin: 0, color: '#f8fafc', fontSize: 20, fontWeight: 600 }}>\n                Collaboration Invite\n              </h2>\n            </div>\n            {creator && (\n              <p style={{ margin: 0, color: '#94a3b8', fontSize: 14 }}>\n                from <span style={{ color: '#f59e0b' }}>@{creator.username}</span>\n              </p>\n            )}\n          </div>\n          <button\n            onClick={onClose}\n            disabled={submitting}\n            style={{\n              background: 'transparent',\n              border: 'none',\n              color: '#94a3b8',\n              fontSize: 24,\n              cursor: submitting ? 'not-allowed' : 'pointer',\n              padding: 4,\n            }}\n          >\n            \n          </button>\n        </div>\n\n        {/* Content */}\n        <div style={{ padding: 24 }}>\n          {loading ? (\n            <div style={{ textAlign: 'center', padding: 40, color: '#94a3b8' }}>\n              Loading project details...\n            </div>\n          ) : error && !project ? (\n            <div style={{ textAlign: 'center', padding: 40, color: '#ef4444' }}>\n              {error}\n            </div>\n          ) : project && myRole ? (\n            mode === 'view' ? (\n              <>\n                {/* Project Info */}\n                <div style={{ marginBottom: 24 }}>\n                  <div\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: 12,\n                      marginBottom: 12,\n                    }}\n                  >\n                    <span\n                      style={{\n                        background: '#f59e0b20',\n                        color: '#f59e0b',\n                        padding: '4px 12px',\n                        borderRadius: 6,\n                        fontSize: 12,\n                        fontWeight: 600,\n                      }}\n                    >\n                      {contentTypeLabels[project.content_type] || project.content_type}\n                    </span>\n                    <span style={{ color: '#64748b', fontSize: 13 }}>\n                      {project.status === 'draft' ? 'Draft' : 'Active'}\n                    </span>\n                  </div>\n                  <h3 style={{ margin: 0, color: '#f8fafc', fontSize: 24, fontWeight: 700 }}>\n                    {project.title}\n                  </h3>\n                  {project.description && (\n                    <p style={{ margin: '8px 0 0', color: '#94a3b8', fontSize: 14, lineHeight: 1.6 }}>\n                      {project.description}\n                    </p>\n                  )}\n                </div>\n\n                {/* Your Role */}\n                <div\n                  style={{\n                    background: '#1e293b',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 20,\n                  }}\n                >\n                  <div style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, marginBottom: 8, textTransform: 'uppercase' }}>\n                    Your Role\n                  </div>\n                  <div style={{ color: '#f8fafc', fontSize: 18, fontWeight: 600 }}>\n                    {myRole.role || 'Collaborator'}\n                  </div>\n                </div>\n\n                {/* Contract Tasks */}\n                {myRole.contract_tasks && myRole.contract_tasks.length > 0 && (\n                  <div\n                    style={{\n                      background: '#1e293b',\n                      borderRadius: 12,\n                      padding: 16,\n                      marginBottom: 20,\n                    }}\n                  >\n                    <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>\n                      <span style={{ fontSize: 18 }}></span>\n                      <span style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, textTransform: 'uppercase' }}>\n                        Your Contract Tasks ({myRole.contract_tasks.length})\n                      </span>\n                    </div>\n\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: 10 }}>\n                      {myRole.contract_tasks.map((task: any, index: number) => (\n                        <div\n                          key={task.id || index}\n                          style={{\n                            background: '#0f172a',\n                            borderRadius: 8,\n                            padding: 14,\n                            borderLeft: '3px solid #f59e0b',\n                          }}\n                        >\n                          <div style={{ color: '#f8fafc', fontSize: 14, fontWeight: 600 }}>\n                            {task.title}\n                          </div>\n                          {task.description && (\n                            <div style={{ color: '#94a3b8', fontSize: 13, marginTop: 6, lineHeight: 1.5 }}>\n                              {task.description}\n                            </div>\n                          )}\n                          <div\n                            style={{\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: 6,\n                              marginTop: 10,\n                              color: '#f59e0b',\n                              fontSize: 12,\n                              fontWeight: 500,\n                            }}\n                          >\n                            <span></span>\n                            <span>\n                              Due: {new Date(task.deadline).toLocaleDateString('en-US', {\n                                weekday: 'short',\n                                month: 'short',\n                                day: 'numeric',\n                                year: 'numeric',\n                              })}\n                            </span>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n\n                    <div\n                      style={{\n                        marginTop: 16,\n                        padding: 12,\n                        background: 'rgba(245, 158, 11, 0.1)',\n                        borderRadius: 8,\n                        display: 'flex',\n                        alignItems: 'flex-start',\n                        gap: 10,\n                      }}\n                    >\n                      <span style={{ fontSize: 16 }}></span>\n                      <div style={{ color: '#f59e0b', fontSize: 12, lineHeight: 1.5 }}>\n                        <strong>Contract Terms:</strong> By accepting, you commit to completing these tasks\n                        by their deadlines. Tasks become binding and can only be changed via mutual agreement.\n                        Missing deadlines may affect the collaboration.\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Pitch Message */}\n                {notificationMessage && (\n                  <div\n                    style={{\n                      background: '#1e293b',\n                      borderRadius: 12,\n                      padding: 16,\n                      marginBottom: 20,\n                      borderLeft: '3px solid #3b82f6',\n                    }}\n                  >\n                    <div style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, marginBottom: 8, textTransform: 'uppercase' }}>\n                      Message from @{creator?.username}\n                    </div>\n                    <div style={{ color: '#cbd5e1', fontSize: 14, lineHeight: 1.6, whiteSpace: 'pre-wrap' }}>\n                      {notificationMessage}\n                    </div>\n                  </div>\n                )}\n\n                {/* Revenue Split */}\n                <div\n                  style={{\n                    background: '#1e293b',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 20,\n                  }}\n                >\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>\n                    <span style={{ fontSize: 18 }}></span>\n                    <span style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, textTransform: 'uppercase' }}>\n                      Revenue Split\n                    </span>\n                  </div>\n\n                  {/* Split bar */}\n                  <div style={{ display: 'flex', gap: 4, marginBottom: 8 }}>\n                    <div\n                      style={{\n                        flex: myRole.revenue_percentage,\n                        background: '#f59e0b',\n                        height: 40,\n                        borderRadius: '8px 0 0 8px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        color: '#000',\n                        fontWeight: 700,\n                        fontSize: 14,\n                        minWidth: 60,\n                      }}\n                    >\n                      You: {myRole.revenue_percentage}%\n                    </div>\n                    <div\n                      style={{\n                        flex: othersPercentage,\n                        background: '#334155',\n                        height: 40,\n                        borderRadius: '0 8px 8px 0',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        color: '#cbd5e1',\n                        fontWeight: 600,\n                        fontSize: 14,\n                        minWidth: 60,\n                      }}\n                    >\n                      Others: {othersPercentage}%\n                    </div>\n                  </div>\n                </div>\n\n                {/* Permissions */}\n                <div\n                  style={{\n                    background: '#1e293b',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 20,\n                  }}\n                >\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>\n                    <span style={{ fontSize: 18 }}></span>\n                    <span style={{ color: '#94a3b8', fontSize: 12, fontWeight: 600, textTransform: 'uppercase' }}>\n                      Your Permissions\n                    </span>\n                  </div>\n                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8 }}>\n                    {[\n                      { key: 'can_edit_text', label: 'Text', value: myRole.can_edit_text },\n                      { key: 'can_edit_images', label: 'Images', value: myRole.can_edit_images },\n                      { key: 'can_edit_audio', label: 'Audio', value: myRole.can_edit_audio },\n                      { key: 'can_edit_video', label: 'Video', value: myRole.can_edit_video },\n                    ].map((perm) => (\n                      <span\n                        key={perm.key}\n                        style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: 6,\n                          padding: '6px 12px',\n                          borderRadius: 6,\n                          background: perm.value ? '#10b98120' : '#64748b20',\n                          color: perm.value ? '#10b981' : '#64748b',\n                          fontSize: 13,\n                          fontWeight: 500,\n                        }}\n                      >\n                        {perm.value ? '' : ''} {perm.label}\n                      </span>\n                    ))}\n                  </div>\n                </div>\n\n                {/* On-Chain Notice */}\n                <div\n                  style={{\n                    background: 'linear-gradient(135deg, #7c3aed20 0%, #3b82f620 100%)',\n                    border: '1px solid #7c3aed40',\n                    borderRadius: 12,\n                    padding: 16,\n                    marginBottom: 24,\n                  }}\n                >\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 8 }}>\n                    <span style={{ fontSize: 18 }}></span>\n                    <span style={{ color: '#a78bfa', fontSize: 13, fontWeight: 600 }}>\n                      On-Chain Agreement\n                    </span>\n                  </div>\n                  <p style={{ margin: 0, color: '#c4b5fd', fontSize: 13, lineHeight: 1.6 }}>\n                    By accepting, you agree to the revenue split above. When this project is minted as an NFT,\n                    the split will be enforced via smart contract. USDC payments will be distributed automatically.\n                  </p>\n                </div>\n\n                {/* Error/Success Messages */}\n                {error && (\n                  <div\n                    style={{\n                      background: '#ef444420',\n                      border: '1px solid #ef4444',\n                      color: '#fca5a5',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {error}\n                  </div>\n                )}\n                {success && (\n                  <div\n                    style={{\n                      background: '#10b98120',\n                      border: '1px solid #10b981',\n                      color: '#6ee7b7',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {success}\n                  </div>\n                )}\n\n                {/* Action Buttons */}\n                <div style={{ display: 'flex', gap: 12 }}>\n                  <button\n                    onClick={handleDecline}\n                    disabled={submitting}\n                    style={{\n                      flex: 1,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: '1px solid #ef4444',\n                      background: 'transparent',\n                      color: '#ef4444',\n                      fontSize: 14,\n                      fontWeight: 600,\n                      cursor: submitting ? 'not-allowed' : 'pointer',\n                      opacity: submitting ? 0.6 : 1,\n                    }}\n                  >\n                    Decline\n                  </button>\n                  <button\n                    onClick={() => setMode('counter-propose')}\n                    disabled={submitting}\n                    style={{\n                      flex: 1,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: '1px solid #3b82f6',\n                      background: 'transparent',\n                      color: '#3b82f6',\n                      fontSize: 14,\n                      fontWeight: 600,\n                      cursor: submitting ? 'not-allowed' : 'pointer',\n                      opacity: submitting ? 0.6 : 1,\n                    }}\n                  >\n                    Counter-Propose\n                  </button>\n                  <button\n                    onClick={handleAccept}\n                    disabled={submitting}\n                    style={{\n                      flex: 1.5,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: 'none',\n                      background: '#10b981',\n                      color: '#fff',\n                      fontSize: 14,\n                      fontWeight: 700,\n                      cursor: submitting ? 'not-allowed' : 'pointer',\n                      opacity: submitting ? 0.6 : 1,\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      gap: 8,\n                    }}\n                  >\n                    {submitting ? 'Processing...' : ' Accept Invite'}\n                  </button>\n                </div>\n              </>\n            ) : (\n              /* Counter-Propose Mode */\n              <>\n                <button\n                  onClick={() => setMode('view')}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: '#94a3b8',\n                    fontSize: 14,\n                    cursor: 'pointer',\n                    padding: 0,\n                    marginBottom: 16,\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 8,\n                  }}\n                >\n                   Back to invite\n                </button>\n\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 24 }}>\n                  <span style={{ fontSize: 24 }}></span>\n                  <h3 style={{ margin: 0, color: '#f8fafc', fontSize: 20, fontWeight: 600 }}>\n                    Propose Different Terms\n                  </h3>\n                </div>\n\n                {/* Proposed Split */}\n                <div style={{ marginBottom: 24 }}>\n                  <label\n                    style={{\n                      display: 'block',\n                      color: '#94a3b8',\n                      fontSize: 13,\n                      fontWeight: 600,\n                      marginBottom: 12,\n                    }}\n                  >\n                    Suggested Revenue Split: {proposedPercentage}% for you\n                  </label>\n                  <input\n                    type=\"range\"\n                    min={5}\n                    max={95}\n                    step={5}\n                    value={proposedPercentage}\n                    onChange={(e) => setProposedPercentage(parseInt(e.target.value))}\n                    style={{ width: '100%', marginBottom: 8 }}\n                  />\n                  <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: 12, color: '#64748b' }}>\n                    <span>Current offer: {myRole.revenue_percentage}%</span>\n                    <span>Proposing: {proposedPercentage}%</span>\n                  </div>\n\n                  {/* Visual diff */}\n                  {proposedPercentage !== myRole.revenue_percentage && (\n                    <div\n                      style={{\n                        marginTop: 12,\n                        padding: 12,\n                        background: '#1e293b',\n                        borderRadius: 8,\n                        fontSize: 13,\n                      }}\n                    >\n                      <span style={{ color: '#94a3b8' }}>Change: </span>\n                      <span\n                        style={{\n                          color: proposedPercentage > myRole.revenue_percentage ? '#10b981' : '#ef4444',\n                          fontWeight: 600,\n                        }}\n                      >\n                        {myRole.revenue_percentage}%  {proposedPercentage}%\n                        ({proposedPercentage > myRole.revenue_percentage ? '+' : ''}\n                        {proposedPercentage - myRole.revenue_percentage}%)\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                {/* Message */}\n                <div style={{ marginBottom: 24 }}>\n                  <label\n                    style={{\n                      display: 'block',\n                      color: '#94a3b8',\n                      fontSize: 13,\n                      fontWeight: 600,\n                      marginBottom: 8,\n                    }}\n                  >\n                    Message to @{creator?.username}\n                  </label>\n                  <textarea\n                    value={counterMessage}\n                    onChange={(e) => setCounterMessage(e.target.value)}\n                    placeholder=\"Explain why you'd like a different split...\"\n                    style={{\n                      width: '100%',\n                      minHeight: 120,\n                      background: '#1e293b',\n                      border: '1px solid #334155',\n                      borderRadius: 8,\n                      padding: 12,\n                      color: '#f8fafc',\n                      fontSize: 14,\n                      resize: 'vertical',\n                    }}\n                  />\n                  <div style={{ fontSize: 11, color: '#64748b', marginTop: 4 }}>\n                    {counterMessage.length}/500 characters\n                  </div>\n                </div>\n\n                {/* Error/Success */}\n                {error && (\n                  <div\n                    style={{\n                      background: '#ef444420',\n                      border: '1px solid #ef4444',\n                      color: '#fca5a5',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {error}\n                  </div>\n                )}\n                {success && (\n                  <div\n                    style={{\n                      background: '#10b98120',\n                      border: '1px solid #10b981',\n                      color: '#6ee7b7',\n                      padding: 12,\n                      borderRadius: 8,\n                      fontSize: 13,\n                      marginBottom: 16,\n                    }}\n                  >\n                    {success}\n                  </div>\n                )}\n\n                {/* Actions */}\n                <div style={{ display: 'flex', gap: 12 }}>\n                  <button\n                    onClick={() => setMode('view')}\n                    disabled={submitting}\n                    style={{\n                      flex: 1,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: '1px solid #334155',\n                      background: 'transparent',\n                      color: '#cbd5e1',\n                      fontSize: 14,\n                      fontWeight: 600,\n                      cursor: submitting ? 'not-allowed' : 'pointer',\n                    }}\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleCounterPropose}\n                    disabled={submitting || !counterMessage.trim() || counterMessage.length > 500}\n                    style={{\n                      flex: 2,\n                      padding: '14px 20px',\n                      borderRadius: 10,\n                      border: 'none',\n                      background: '#3b82f6',\n                      color: '#fff',\n                      fontSize: 14,\n                      fontWeight: 700,\n                      cursor:\n                        submitting || !counterMessage.trim() || counterMessage.length > 500\n                          ? 'not-allowed'\n                          : 'pointer',\n                      opacity:\n                        submitting || !counterMessage.trim() || counterMessage.length > 500\n                          ? 0.6\n                          : 1,\n                    }}\n                  >\n                    {submitting ? 'Sending...' : 'Send Counter-Offer'}\n                  </button>\n                </div>\n              </>\n            )\n          ) : (\n            <div style={{ textAlign: 'center', padding: 40, color: '#94a3b8' }}>\n              No invite found for this project.\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default InviteResponseModal;\n","/**\n * NotificationDropdown Component\n * Dropdown panel showing recent notifications (last 10)\n */\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useNotifications } from '../../hooks/useNotifications';\nimport { Notification } from '../../services/notificationService';\nimport NotificationItem from './NotificationItem';\nimport { InviteResponseModal } from '../collaboration/InviteResponseModal';\n\ninterface NotificationDropdownProps {\n  isOpen: boolean;\n  onClose: () => void;\n  anchorEl?: HTMLElement | null;\n}\n\nexport function NotificationDropdown({ isOpen, onClose, anchorEl }: NotificationDropdownProps) {\n  const navigate = useNavigate();\n  const panelRef = useRef<HTMLDivElement>(null);\n\n  // State for invite modal\n  const [inviteModalOpen, setInviteModalOpen] = useState(false);\n  const [selectedInvite, setSelectedInvite] = useState<Notification | null>(null);\n\n  const {\n    notifications,\n    unreadCount,\n    isLoading,\n    markAsRead,\n    markAllAsRead,\n    deleteNotification,\n    refresh,\n  } = useNotifications();\n\n  // Get last 10 notifications\n  const recentNotifications = notifications.slice(0, 10);\n\n  // Handle viewing an invite\n  const handleViewInvite = async (notification: Notification) => {\n    // Mark as read\n    if (!notification.read) {\n      await markAsRead(notification.id);\n    }\n    setSelectedInvite(notification);\n    setInviteModalOpen(true);\n  };\n\n  // Close invite modal\n  const handleCloseInviteModal = () => {\n    setInviteModalOpen(false);\n    setSelectedInvite(null);\n    refresh(); // Refresh notifications after modal closes\n  };\n\n  // Close panel when clicking outside\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        panelRef.current &&\n        !panelRef.current.contains(event.target as Node) &&\n        anchorEl &&\n        !anchorEl.contains(event.target as Node)\n      ) {\n        onClose();\n      }\n    };\n\n    const timer = setTimeout(() => {\n      document.addEventListener('mousedown', handleClickOutside);\n    }, 100);\n\n    return () => {\n      clearTimeout(timer);\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, onClose, anchorEl]);\n\n  // Close on escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen, onClose]);\n\n  // Refresh notifications when panel opens\n  useEffect(() => {\n    if (isOpen) {\n      refresh();\n    }\n  }, [isOpen, refresh]);\n\n  const handleNotificationClick = async (notification: any) => {\n    // Mark as read\n    if (!notification.read) {\n      await markAsRead(notification.id);\n    }\n\n    // Navigate to action URL if provided\n    if (notification.action_url) {\n      navigate(notification.action_url);\n      onClose();\n    } else if (notification.project_id) {\n      navigate(`/collaborations/${notification.project_id}`);\n      onClose();\n    }\n  };\n\n  const handleMarkAllRead = async () => {\n    try {\n      await markAllAsRead();\n    } catch (error) {\n      console.error('Failed to mark all as read:', error);\n    }\n  };\n\n  const handleDelete = async (e: React.MouseEvent, notificationId: number) => {\n    e.stopPropagation();\n    try {\n      await deleteNotification(notificationId);\n    } catch (error) {\n      console.error('Failed to delete notification:', error);\n    }\n  };\n\n  const handleViewAll = () => {\n    navigate('/notifications');\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      ref={panelRef}\n      role=\"dialog\"\n      aria-label=\"Notifications\"\n      aria-modal=\"false\"\n      style={{\n        position: 'absolute',\n        top: '100%',\n        right: 0,\n        marginTop: 8,\n        width: 420,\n        maxHeight: 600,\n        background: '#0f172a',\n        border: '1px solid #1f2937',\n        borderRadius: 12,\n        boxShadow: '0 10px 40px rgba(0, 0, 0, 0.5)',\n        zIndex: 3000,\n        display: 'flex',\n        flexDirection: 'column',\n        overflow: 'hidden',\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          padding: '16px 20px',\n          borderBottom: '1px solid #1f2937',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\n          <h3 style={{ fontSize: 16, fontWeight: 700, color: '#e5e7eb', margin: 0 }}>\n            Notifications\n          </h3>\n          {unreadCount > 0 && (\n            <div\n              aria-label={`${unreadCount} unread`}\n              style={{\n                background: '#ef4444',\n                color: '#fff',\n                fontSize: 11,\n                fontWeight: 700,\n                padding: '2px 8px',\n                borderRadius: 10,\n                minWidth: 20,\n                textAlign: 'center',\n              }}\n            >\n              {unreadCount}\n            </div>\n          )}\n        </div>\n\n        {recentNotifications.length > 0 && unreadCount > 0 && (\n          <button\n            onClick={handleMarkAllRead}\n            aria-label=\"Mark all as read\"\n            style={{\n              background: 'transparent',\n              color: '#3b82f6',\n              border: 'none',\n              fontSize: 12,\n              fontWeight: 600,\n              cursor: 'pointer',\n              padding: '4px 8px',\n              borderRadius: 4,\n              transition: 'all 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = '#1e293b';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = 'transparent';\n            }}\n          >\n            Mark All Read\n          </button>\n        )}\n      </div>\n\n      {/* Content */}\n      <div\n        style={{\n          flex: 1,\n          overflowY: 'auto',\n          maxHeight: 500,\n        }}\n      >\n        {isLoading && recentNotifications.length === 0 ? (\n          <div\n            style={{\n              padding: 40,\n              textAlign: 'center',\n              color: '#94a3b8',\n              fontSize: 14,\n            }}\n          >\n            Loading notifications...\n          </div>\n        ) : recentNotifications.length === 0 ? (\n          <div\n            style={{\n              padding: 40,\n              textAlign: 'center',\n              color: '#94a3b8',\n            }}\n          >\n            <div style={{ fontSize: 48, marginBottom: 12 }} aria-hidden=\"true\">\n              \n            </div>\n            <div style={{ fontSize: 14, fontWeight: 600, marginBottom: 4 }}>\n              No notifications yet\n            </div>\n            <div style={{ fontSize: 12, color: '#64748b' }}>\n              We'll notify you when there's activity on your collaborations\n            </div>\n          </div>\n        ) : (\n          <div style={{ padding: '8px 0' }}>\n            {recentNotifications.map((notification) => (\n              <NotificationItem\n                key={notification.id}\n                notification={notification}\n                onClick={() => handleNotificationClick(notification)}\n                onDelete={(e) => handleDelete(e, notification.id)}\n                onViewInvite={handleViewInvite}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Footer */}\n      {recentNotifications.length > 0 && (\n        <div\n          style={{\n            padding: '12px 20px',\n            borderTop: '1px solid #1f2937',\n            display: 'flex',\n            gap: 8,\n          }}\n        >\n          {notifications.length > 10 && (\n            <button\n              onClick={handleViewAll}\n              aria-label=\"View all notifications\"\n              style={{\n                background: 'transparent',\n                color: '#3b82f6',\n                border: 'none',\n                fontSize: 13,\n                fontWeight: 600,\n                cursor: 'pointer',\n                padding: '6px 12px',\n                borderRadius: 6,\n                flex: 1,\n                transition: 'all 0.2s',\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.background = '#1e293b';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.background = 'transparent';\n              }}\n            >\n              View All\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Invite Response Modal */}\n      {selectedInvite && selectedInvite.project_id && (\n        <InviteResponseModal\n          open={inviteModalOpen}\n          onClose={handleCloseInviteModal}\n          projectId={selectedInvite.project_id}\n          notificationMessage={selectedInvite.message}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default NotificationDropdown;\n","/**\n * NotificationBell Component\n * Bell icon with unread count badge for navbar\n */\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Bell } from 'lucide-react';\nimport { useUnreadCount } from '../../hooks/useNotifications';\nimport { events } from '../../services/notificationService';\nimport NotificationDropdown from './NotificationDropdown';\n\nexport function NotificationBell() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const bellRef = useRef<HTMLButtonElement>(null);\n  const { unreadCount } = useUnreadCount();\n\n  // Animate bell when new notifications arrive\n  useEffect(() => {\n    const unsubscribe = events.on('notifications:new', () => {\n      setIsAnimating(true);\n      setTimeout(() => setIsAnimating(false), 1000);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const toggleDropdown = () => {\n    setIsOpen(!isOpen);\n  };\n\n  return (\n    <div style={{ position: 'relative' }}>\n      <button\n        ref={bellRef}\n        onClick={toggleDropdown}\n        aria-label={`Notifications${unreadCount > 0 ? ` (${unreadCount} unread)` : ''}`}\n        aria-expanded={isOpen}\n        aria-haspopup=\"true\"\n        className=\"rb-nav-link\"\n        style={{\n          position: 'relative',\n        }}\n        title=\"Notifications\"\n      >\n        <Bell\n          size={20}\n          style={{\n            animation: isAnimating ? 'ring 1s ease-in-out' : 'none',\n            transformOrigin: 'top center',\n          }}\n        />\n        {unreadCount > 0 && (\n          <span\n            style={{\n              position: 'absolute',\n              top: 4,\n              right: 4,\n              background: '#ef4444',\n              color: '#fff',\n              fontSize: 10,\n              fontWeight: 700,\n              padding: '2px 6px',\n              borderRadius: 10,\n              minWidth: 18,\n              textAlign: 'center',\n              boxShadow: '0 0 8px rgba(239, 68, 68, 0.5)',\n            }}\n            aria-label={`${unreadCount} unread notifications`}\n          >\n            {unreadCount}\n          </span>\n        )}\n      </button>\n\n      <NotificationDropdown\n        isOpen={isOpen}\n        onClose={() => setIsOpen(false)}\n        anchorEl={bellRef.current}\n      />\n\n      {/* Keyframes for bell animation */}\n      <style>{`\n        @keyframes ring {\n          0%, 100% { transform: rotate(0deg); }\n          10%, 30%, 50%, 70% { transform: rotate(15deg); }\n          20%, 40%, 60%, 80% { transform: rotate(-15deg); }\n          90% { transform: rotate(5deg); }\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default NotificationBell;\n","/**\n * NotificationToast Component\n * Toast notification with auto-dismiss and action buttons\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Notification,\n  getNotificationIcon,\n  getNotificationColor,\n} from '../../services/notificationService';\n\ninterface NotificationToastProps {\n  notification: Notification;\n  onDismiss: () => void;\n  autoDismissMs?: number;\n}\n\nexport function NotificationToast({\n  notification,\n  onDismiss,\n  autoDismissMs = 5000,\n}: NotificationToastProps) {\n  const navigate = useNavigate();\n  const [isExiting, setIsExiting] = useState(false);\n  const icon = getNotificationIcon(notification.type);\n  const color = getNotificationColor(notification.type);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      handleDismiss();\n    }, autoDismissMs);\n\n    return () => clearTimeout(timer);\n  }, [autoDismissMs]);\n\n  const handleDismiss = () => {\n    setIsExiting(true);\n    setTimeout(() => {\n      onDismiss();\n    }, 300); // Match animation duration\n  };\n\n  const handleView = () => {\n    if (notification.action_url) {\n      navigate(notification.action_url);\n    } else if (notification.project_id) {\n      navigate(`/collaborations/${notification.project_id}`);\n    }\n    handleDismiss();\n  };\n\n  return (\n    <div\n      role=\"alert\"\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n      style={{\n        width: 380,\n        background: '#1e293b',\n        border: `1px solid ${color}40`,\n        borderLeft: `4px solid ${color}`,\n        borderRadius: 8,\n        boxShadow: '0 10px 40px rgba(0, 0, 0, 0.3)',\n        overflow: 'hidden',\n        marginBottom: 12,\n        animation: isExiting\n          ? 'slideOut 0.3s ease-out forwards'\n          : 'slideIn 0.3s ease-out',\n      }}\n    >\n      {/* Progress bar */}\n      <div\n        style={{\n          height: 3,\n          background: `linear-gradient(90deg, ${color} 0%, transparent 100%)`,\n          animation: `progress ${autoDismissMs}ms linear forwards`,\n        }}\n      />\n\n      <div style={{ padding: '16px' }}>\n        {/* Header */}\n        <div style={{ display: 'flex', alignItems: 'flex-start', gap: 12, marginBottom: 12 }}>\n          <div\n            style={{\n              fontSize: 24,\n              width: 40,\n              height: 40,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              background: `${color}20`,\n              borderRadius: 8,\n              flexShrink: 0,\n            }}\n            aria-hidden=\"true\"\n          >\n            {icon}\n          </div>\n\n          <div style={{ flex: 1, minWidth: 0 }}>\n            <div\n              style={{\n                fontSize: 14,\n                fontWeight: 700,\n                color: '#e5e7eb',\n                marginBottom: 4,\n                lineHeight: 1.3,\n              }}\n            >\n              {notification.title}\n            </div>\n            <div\n              style={{\n                fontSize: 13,\n                color: '#94a3b8',\n                lineHeight: 1.4,\n              }}\n            >\n              {notification.message}\n            </div>\n          </div>\n\n          <button\n            onClick={handleDismiss}\n            aria-label=\"Dismiss notification\"\n            style={{\n              background: 'transparent',\n              border: 'none',\n              color: '#64748b',\n              cursor: 'pointer',\n              padding: 4,\n              fontSize: 20,\n              lineHeight: 1,\n              transition: 'color 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.color = '#e5e7eb';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.color = '#64748b';\n            }}\n          >\n            \n          </button>\n        </div>\n\n        {/* Actions */}\n        <div style={{ display: 'flex', gap: 8 }}>\n          {(notification.action_url || notification.project_id) && (\n            <button\n              onClick={handleView}\n              style={{\n                background: color,\n                color: '#fff',\n                border: 'none',\n                borderRadius: 6,\n                padding: '6px 16px',\n                fontSize: 13,\n                fontWeight: 600,\n                cursor: 'pointer',\n                transition: 'all 0.2s',\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.opacity = '0.9';\n                e.currentTarget.style.transform = 'translateY(-1px)';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.opacity = '1';\n                e.currentTarget.style.transform = 'translateY(0)';\n              }}\n            >\n              View\n            </button>\n          )}\n          <button\n            onClick={handleDismiss}\n            style={{\n              background: 'transparent',\n              color: '#94a3b8',\n              border: '1px solid #334155',\n              borderRadius: 6,\n              padding: '6px 16px',\n              fontSize: 13,\n              fontWeight: 600,\n              cursor: 'pointer',\n              transition: 'all 0.2s',\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = '#334155';\n              e.currentTarget.style.color = '#e5e7eb';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = 'transparent';\n              e.currentTarget.style.color = '#94a3b8';\n            }}\n          >\n            Dismiss\n          </button>\n        </div>\n      </div>\n\n      {/* Animations */}\n      <style>{`\n        @keyframes slideIn {\n          from {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n\n        @keyframes slideOut {\n          from {\n            transform: translateX(0);\n            opacity: 1;\n          }\n          to {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n        }\n\n        @keyframes progress {\n          from {\n            transform: scaleX(1);\n          }\n          to {\n            transform: scaleX(0);\n          }\n        }\n      `}</style>\n    </div>\n  );\n}\n\nexport default NotificationToast;\n","/**\n * NotificationToastContainer Component\n * Manages and displays multiple toast notifications in a stack\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { events, Notification } from '../../services/notificationService';\nimport NotificationToast from './NotificationToast';\n\nexport function NotificationToastContainer() {\n  const [toasts, setToasts] = useState<Notification[]>([]);\n\n  useEffect(() => {\n    // Subscribe to new notifications event\n    const unsubscribe = events.on('notifications:new', ({ notifications }) => {\n      // Add new notifications to toast queue\n      setToasts((prev) => [...prev, ...notifications]);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const handleDismiss = (notificationId: number) => {\n    setToasts((prev) => prev.filter((n) => n.id !== notificationId));\n  };\n\n  if (toasts.length === 0) return null;\n\n  return (\n    <div\n      aria-live=\"polite\"\n      aria-atomic=\"false\"\n      style={{\n        position: 'fixed',\n        top: 80,\n        right: 20,\n        zIndex: 9999,\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'flex-end',\n        pointerEvents: 'none',\n      }}\n    >\n      <div style={{ pointerEvents: 'auto' }}>\n        {toasts.map((notification) => (\n          <NotificationToast\n            key={notification.id}\n            notification={notification}\n            onDismiss={() => handleDismiss(notification.id)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default NotificationToastContainer;\n","import React, { useState } from 'react';\n\ninterface FeedbackModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function FeedbackModal({ isOpen, onClose }: FeedbackModalProps) {\n  const [feedback, setFeedback] = useState('');\n  const [email, setEmail] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [submitted, setSubmitted] = useState(false);\n  const [error, setError] = useState('');\n\n  if (!isOpen) return null;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setSubmitting(true);\n    setError('');\n\n    try {\n      // Send feedback to backend\n      const response = await fetch('/api/feedback/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          feedback: feedback,\n          email: email || 'anonymous',\n        }),\n      });\n\n      if (response.ok) {\n        setSubmitted(true);\n        setFeedback('');\n        setEmail('');\n        setTimeout(() => {\n          onClose();\n          setSubmitted(false);\n        }, 2000);\n      } else {\n        setError('Failed to submit feedback. Please try again.');\n      }\n    } catch (err) {\n      console.error('Feedback error:', err);\n      setError('Network error. Please try again later.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0, 0, 0, 0.8)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n        padding: '20px',\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: '#1a1f2e',\n          border: '1px solid #2a3444',\n          borderRadius: '16px',\n          padding: '32px',\n          maxWidth: '500px',\n          width: '100%',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5)',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {submitted ? (\n          <div style={{ textAlign: 'center' }}>\n            <div style={{ fontSize: '48px', marginBottom: '16px' }}></div>\n            <h2 style={{ fontSize: '24px', fontWeight: 700, color: '#10b981', margin: '0 0 8px 0' }}>\n              Thank You!\n            </h2>\n            <p style={{ fontSize: '14px', color: '#94a3b8', margin: 0 }}>\n              Your feedback helps us improve renaissBlock\n            </p>\n          </div>\n        ) : (\n          <>\n            {/* Header */}\n            <div style={{ marginBottom: '24px' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>\n                <h2 style={{ fontSize: '24px', fontWeight: 700, color: '#e5e7eb', margin: 0 }}>\n                  Beta Feedback\n                </h2>\n                <button\n                  onClick={onClose}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: '#94a3b8',\n                    fontSize: '24px',\n                    cursor: 'pointer',\n                    padding: '0',\n                    lineHeight: 1,\n                  }}\n                >\n                  \n                </button>\n              </div>\n              <p style={{ fontSize: '14px', color: '#94a3b8', margin: 0 }}>\n                Help us improve by sharing your thoughts, bugs, or feature requests\n              </p>\n            </div>\n\n            {/* Form */}\n            <form onSubmit={handleSubmit} style={{ display: 'grid', gap: '16px' }}>\n              <div>\n                <label style={{ display: 'block', fontSize: '13px', color: '#cbd5e1', marginBottom: '8px', fontWeight: 600 }}>\n                  Your Feedback *\n                </label>\n                <textarea\n                  value={feedback}\n                  onChange={(e) => setFeedback(e.target.value)}\n                  placeholder=\"Tell us what you think! Include bugs, feature requests, or general feedback...\"\n                  required\n                  rows={6}\n                  style={{\n                    width: '100%',\n                    padding: '12px',\n                    background: '#0f1419',\n                    border: '1px solid #2a3444',\n                    borderRadius: '8px',\n                    color: '#e5e7eb',\n                    fontSize: '14px',\n                    fontFamily: 'inherit',\n                    resize: 'vertical',\n                  }}\n                />\n              </div>\n\n              <div>\n                <label style={{ display: 'block', fontSize: '13px', color: '#cbd5e1', marginBottom: '8px', fontWeight: 600 }}>\n                  Email (optional)\n                </label>\n                <input\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  placeholder=\"your@email.com (if you'd like a response)\"\n                  style={{\n                    width: '100%',\n                    padding: '12px',\n                    background: '#0f1419',\n                    border: '1px solid #2a3444',\n                    borderRadius: '8px',\n                    color: '#e5e7eb',\n                    fontSize: '14px',\n                  }}\n                />\n              </div>\n\n              {error && (\n                <div style={{\n                  padding: '12px',\n                  background: '#fee2e2',\n                  color: '#dc2626',\n                  borderRadius: '8px',\n                  fontSize: '14px',\n                }}>\n                  {error}\n                </div>\n              )}\n\n              <button\n                type=\"submit\"\n                disabled={submitting || !feedback.trim()}\n                style={{\n                  background: submitting ? '#94a3b8' : 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n                  color: '#000',\n                  border: 'none',\n                  padding: '14px 24px',\n                  borderRadius: '8px',\n                  fontSize: '16px',\n                  fontWeight: 700,\n                  cursor: submitting ? 'not-allowed' : 'pointer',\n                  width: '100%',\n                }}\n              >\n                {submitting ? 'Submitting...' : 'Submit Feedback'}\n              </button>\n            </form>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default FeedbackModal;\n","import React, { useState } from 'react';\nimport FeedbackModal from './FeedbackModal';\nimport { MessageSquare } from 'lucide-react';\n\ninterface BetaBadgeProps {\n  variant?: 'header' | 'inline' | 'full';\n  showTestMode?: boolean;\n}\n\nexport function BetaBadge({ variant = 'header', showTestMode = true }: BetaBadgeProps) {\n  if (variant === 'header') {\n    return (\n      <div\n        style={{\n          display: 'inline-flex',\n          alignItems: 'center',\n          gap: '8px',\n          background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n          padding: '4px 12px',\n          borderRadius: '6px',\n          fontSize: '12px',\n          fontWeight: 700,\n          color: '#000',\n          letterSpacing: '0.5px',\n          boxShadow: '0 2px 8px rgba(245, 158, 11, 0.3)',\n        }}\n      >\n        <span>BETA</span>\n        {showTestMode && (\n          <span\n            style={{\n              background: 'rgba(0, 0, 0, 0.2)',\n              padding: '2px 6px',\n              borderRadius: '4px',\n              fontSize: '10px',\n            }}\n          >\n            TEST MODE\n          </span>\n        )}\n      </div>\n    );\n  }\n\n  if (variant === 'inline') {\n    return (\n      <span\n        style={{\n          display: 'inline-block',\n          background: '#f59e0b',\n          color: '#000',\n          padding: '2px 8px',\n          borderRadius: '4px',\n          fontSize: '11px',\n          fontWeight: 700,\n          letterSpacing: '0.5px',\n          marginLeft: '8px',\n        }}\n      >\n        BETA\n      </span>\n    );\n  }\n\n  if (variant === 'full') {\n    return (\n      <div\n        style={{\n          background: 'linear-gradient(135deg, #f59e0b15 0%, #d9770615 100%)',\n          border: '1px solid #f59e0b40',\n          borderRadius: '12px',\n          padding: '16px 20px',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '16px',\n        }}\n      >\n        <div\n          style={{\n            background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n            padding: '8px 16px',\n            borderRadius: '8px',\n            fontSize: '14px',\n            fontWeight: 700,\n            color: '#000',\n            letterSpacing: '0.5px',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          BETA\n        </div>\n        <div style={{ flex: 1 }}>\n          <div style={{ fontSize: '14px', fontWeight: 600, color: '#e5e7eb', marginBottom: '4px' }}>\n            You're in the Beta!\n          </div>\n          <div style={{ fontSize: '13px', color: '#94a3b8', lineHeight: 1.4 }}>\n            Help us improve by{' '}\n            <a\n              href=\"mailto:feedback@renaissblock.com\"\n              style={{\n                color: '#f59e0b',\n                textDecoration: 'none',\n                fontWeight: 600,\n              }}\n            >\n              sharing feedback\n            </a>\n            . All transactions are in test mode.\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n}\n\nexport function TestModeBanner() {\n  const [showFeedback, setShowFeedback] = useState(false);\n\n  return (\n    <>\n      <button\n        onClick={() => setShowFeedback(true)}\n        style={{\n          position: 'fixed',\n          bottom: 20,\n          right: 20,\n          background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n          color: '#000',\n          border: 'none',\n          padding: '12px 20px',\n          borderRadius: '30px',\n          fontSize: '14px',\n          fontWeight: 700,\n          cursor: 'pointer',\n          zIndex: 1000,\n          boxShadow: '0 4px 12px rgba(245, 158, 11, 0.4)',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '8px',\n          transition: 'transform 0.2s, box-shadow 0.2s',\n        }}\n        onMouseEnter={(e) => {\n          e.currentTarget.style.transform = 'scale(1.05)';\n          e.currentTarget.style.boxShadow = '0 6px 16px rgba(245, 158, 11, 0.5)';\n        }}\n        onMouseLeave={(e) => {\n          e.currentTarget.style.transform = 'scale(1)';\n          e.currentTarget.style.boxShadow = '0 4px 12px rgba(245, 158, 11, 0.4)';\n        }}\n        title=\"Send feedback about the beta\"\n      >\n        <MessageSquare size={18} />\n        Feedback\n      </button>\n      <FeedbackModal isOpen={showFeedback} onClose={() => setShowFeedback(false)} />\n    </>\n  );\n}\n\nexport function BetaWelcomeModal({ onClose }: { onClose: () => void }) {\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0, 0, 0, 0.8)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n        padding: '20px',\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: '#1a1f2e',\n          border: '1px solid #2a3444',\n          borderRadius: '16px',\n          padding: '32px',\n          maxWidth: '500px',\n          width: '100%',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5)',\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div style={{ textAlign: 'center', marginBottom: '24px' }}>\n          <div\n            style={{\n              display: 'inline-block',\n              background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n              padding: '12px 24px',\n              borderRadius: '12px',\n              fontSize: '18px',\n              fontWeight: 700,\n              color: '#000',\n              letterSpacing: '1px',\n              marginBottom: '16px',\n            }}\n          >\n            BETA TESTER\n          </div>\n          <h2 style={{ fontSize: '24px', fontWeight: 700, color: '#e5e7eb', margin: '0 0 8px 0' }}>\n            Welcome to renaissBlock Beta!\n          </h2>\n          <p style={{ fontSize: '14px', color: '#94a3b8', margin: 0 }}>\n            You're one of the first creators to experience the future\n          </p>\n        </div>\n\n        {/* Content */}\n        <div style={{ marginBottom: '24px' }}>\n          <div style={{ marginBottom: '16px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 600, color: '#f59e0b', marginBottom: '8px' }}>\n               Test Mode Active\n            </div>\n            <ul style={{ fontSize: '13px', color: '#cbd5e1', margin: '0', paddingLeft: '20px', lineHeight: 1.6 }}>\n              <li>No real money charged (use test card: 4242 4242 4242 4242)</li>\n              <li>Blockchain features use Solana devnet (fake SOL)</li>\n              <li>Some features still being polished</li>\n            </ul>\n          </div>\n\n          <div style={{ marginBottom: '16px' }}>\n            <div style={{ fontSize: '14px', fontWeight: 600, color: '#f59e0b', marginBottom: '8px' }}>\n               What to Try\n            </div>\n            <ul style={{ fontSize: '13px', color: '#cbd5e1', margin: '0', paddingLeft: '20px', lineHeight: 1.6 }}>\n              <li>Create and publish your first content</li>\n              <li>Collaborate with other beta testers</li>\n              <li>Test the purchase and reading experience</li>\n            </ul>\n          </div>\n\n          <div\n            style={{\n              background: '#f59e0b20',\n              border: '1px solid #f59e0b40',\n              borderRadius: '8px',\n              padding: '12px',\n              marginTop: '16px',\n            }}\n          >\n            <div style={{ fontSize: '13px', color: '#fbbf24', fontWeight: 600, marginBottom: '4px' }}>\n               Beta Perks\n            </div>\n            <p style={{ fontSize: '12px', color: '#cbd5e1', margin: 0, lineHeight: 1.5 }}>\n              As a beta tester, you'll get early access to new features and special recognition when we launch!\n            </p>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div style={{ textAlign: 'center' }}>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n              color: '#000',\n              border: 'none',\n              padding: '12px 32px',\n              borderRadius: '8px',\n              fontSize: '14px',\n              fontWeight: 700,\n              cursor: 'pointer',\n              width: '100%',\n              marginBottom: '12px',\n            }}\n          >\n            Let's Go! \n          </button>\n          <div style={{ fontSize: '12px', color: '#64748b' }}>\n            Questions?{' '}\n            <a\n              href=\"mailto:feedback@renaissblock.com\"\n              style={{ color: '#f59e0b', textDecoration: 'none', fontWeight: 600 }}\n            >\n              feedback@renaissblock.com\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { BetaWelcomeModal } from './BetaBadge';\nimport { useAuth } from '../hooks/useAuth';\n\n/**\n * BetaOnboarding Component\n *\n * Shows welcome modal to new beta users on first login\n * Stores completion in localStorage to avoid showing again\n */\nexport function BetaOnboarding() {\n  const { isAuthenticated, user } = useAuth();\n  const [showWelcome, setShowWelcome] = useState(false);\n\n  useEffect(() => {\n    if (!isAuthenticated || !user) {\n      return;\n    }\n\n    // Check if user has seen the welcome modal\n    const hasSeenWelcome = localStorage.getItem('beta_welcome_seen');\n    const lastSeenUserId = localStorage.getItem('beta_welcome_user_id');\n\n    // Show welcome if:\n    // 1. Never seen before, OR\n    // 2. Different user than last time (account switching)\n    if (!hasSeenWelcome || lastSeenUserId !== String(user.id)) {\n      // Small delay to let the app load first\n      setTimeout(() => {\n        setShowWelcome(true);\n      }, 1000);\n    }\n  }, [isAuthenticated, user]);\n\n  const handleClose = () => {\n    if (user) {\n      localStorage.setItem('beta_welcome_seen', 'true');\n      localStorage.setItem('beta_welcome_user_id', String(user.id));\n    }\n    setShowWelcome(false);\n  };\n\n  return (\n    <>\n      {showWelcome && <BetaWelcomeModal onClose={handleClose} />}\n    </>\n  );\n}\n\nexport default BetaOnboarding;\n","/**\n * Footer component with legal links.\n */\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nexport function Footer() {\n  const currentYear = new Date().getFullYear();\n\n  return (\n    <footer style={{\n      marginTop: 'auto',\n      padding: '24px 20px',\n      borderTop: '1px solid var(--border, #334155)',\n      background: 'var(--bg-secondary, #1e293b)',\n    }}>\n      <div style={{\n        maxWidth: 1200,\n        margin: '0 auto',\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-between',\n        alignItems: 'flex-start',\n        gap: 32,\n      }}>\n        {/* Brand */}\n        <div style={{ minWidth: 200 }}>\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 10,\n            marginBottom: 8,\n          }}>\n            <img\n              src=\"/rb-logo.png\"\n              alt=\"renaissBlock\"\n              style={{\n                height: 28,\n                width: 'auto',\n                borderRadius: 4,\n              }}\n            />\n            <span style={{\n              fontSize: 16,\n              fontWeight: 700,\n              color: 'var(--text, #e5e7eb)',\n            }}>\n              renaissBlock\n            </span>\n          </div>\n          <div style={{\n            fontSize: 13,\n            color: 'var(--text-muted, #94a3b8)',\n          }}>\n            A platform for serious creators.\n          </div>\n        </div>\n\n        {/* Legal Links */}\n        <div style={{ minWidth: 150 }}>\n          <div style={{\n            fontSize: 13,\n            fontWeight: 600,\n            color: 'var(--text, #e5e7eb)',\n            marginBottom: 12,\n            textTransform: 'uppercase',\n            letterSpacing: '0.5px',\n          }}>\n            Legal\n          </div>\n          <nav style={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 8,\n          }}>\n            <Link to=\"/legal/terms\" style={linkStyle}>Terms of Service</Link>\n            <Link to=\"/legal/privacy\" style={linkStyle}>Privacy Policy</Link>\n            <Link to=\"/legal/content-policy\" style={linkStyle}>Content Policy</Link>\n            <Link to=\"/legal/dmca\" style={linkStyle}>DMCA / Copyright</Link>\n            <Link to=\"/legal/creator-agreement\" style={linkStyle}>Creator Agreement</Link>\n          </nav>\n        </div>\n\n        {/* Support Links */}\n        <div style={{ minWidth: 150 }}>\n          <div style={{\n            fontSize: 13,\n            fontWeight: 600,\n            color: 'var(--text, #e5e7eb)',\n            marginBottom: 12,\n            textTransform: 'uppercase',\n            letterSpacing: '0.5px',\n          }}>\n            Support\n          </div>\n          <nav style={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 8,\n          }}>\n            <a href=\"mailto:support@renaissblock.com\" style={linkStyle}>Contact Us</a>\n            <a href=\"mailto:dmca@renaissblock.com\" style={linkStyle}>Report Copyright</a>\n            <a href=\"mailto:reports@renaissblock.com\" style={linkStyle}>Report Content</a>\n          </nav>\n        </div>\n\n        {/* Copyright */}\n        <div style={{\n          width: '100%',\n          paddingTop: 16,\n          borderTop: '1px solid var(--border, #334155)',\n          marginTop: 8,\n        }}>\n          <div style={{\n            fontSize: 12,\n            color: 'var(--text-muted, #94a3b8)',\n            textAlign: 'center',\n          }}>\n            &copy; {currentYear} renaissBlock. All rights reserved.\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n\nconst linkStyle: React.CSSProperties = {\n  fontSize: 13,\n  color: 'var(--text-muted, #94a3b8)',\n  textDecoration: 'none',\n  transition: 'color 0.2s',\n};\n\nexport default Footer;\n","/**\n * Cookie consent banner for GDPR/CCPA compliance.\n * Shows on first visit and stores preference in localStorage.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { X } from 'lucide-react';\n\nconst COOKIE_CONSENT_KEY = 'rb_cookie_consent';\n\ninterface CookiePreferences {\n  necessary: boolean; // Always true\n  analytics: boolean;\n  marketing: boolean;\n}\n\nexport function CookieBanner() {\n  const [isVisible, setIsVisible] = useState(false);\n  const [showCustomize, setShowCustomize] = useState(false);\n  const [preferences, setPreferences] = useState<CookiePreferences>({\n    necessary: true,\n    analytics: false,\n    marketing: false,\n  });\n\n  useEffect(() => {\n    // Check if user has already made a choice\n    const consent = localStorage.getItem(COOKIE_CONSENT_KEY);\n    if (!consent) {\n      // Small delay to prevent flash on page load\n      const timer = setTimeout(() => setIsVisible(true), 1000);\n      return () => clearTimeout(timer);\n    }\n  }, []);\n\n  const saveConsent = (prefs: CookiePreferences) => {\n    localStorage.setItem(COOKIE_CONSENT_KEY, JSON.stringify({\n      ...prefs,\n      timestamp: new Date().toISOString(),\n    }));\n    setIsVisible(false);\n  };\n\n  const handleAcceptAll = () => {\n    saveConsent({\n      necessary: true,\n      analytics: true,\n      marketing: true,\n    });\n  };\n\n  const handleRejectNonEssential = () => {\n    saveConsent({\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    });\n  };\n\n  const handleSavePreferences = () => {\n    saveConsent(preferences);\n  };\n\n  if (!isVisible) return null;\n\n  return (\n    <div style={{\n      position: 'fixed',\n      bottom: 0,\n      left: 0,\n      right: 0,\n      zIndex: 9999,\n      background: 'var(--bg, #0f172a)',\n      borderTop: '1px solid var(--border, #334155)',\n      padding: '16px 20px',\n      boxShadow: '0 -4px 20px rgba(0, 0, 0, 0.3)',\n    }}>\n      <div style={{\n        maxWidth: 1200,\n        margin: '0 auto',\n      }}>\n        {!showCustomize ? (\n          // Simple banner\n          <div style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            alignItems: 'center',\n            gap: 16,\n            justifyContent: 'space-between',\n          }}>\n            <div style={{ flex: '1 1 400px' }}>\n              <p style={{\n                margin: 0,\n                fontSize: 14,\n                color: 'var(--text, #e5e7eb)',\n              }}>\n                We use cookies to improve your experience.{' '}\n                <Link\n                  to=\"/legal/privacy\"\n                  style={{ color: 'var(--accent, #f59e0b)' }}\n                >\n                  Learn more in our Privacy Policy\n                </Link>\n              </p>\n            </div>\n            <div style={{\n              display: 'flex',\n              gap: 8,\n              flexWrap: 'wrap',\n            }}>\n              <button\n                onClick={() => setShowCustomize(true)}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: '1px solid var(--border, #334155)',\n                  background: 'transparent',\n                  color: 'var(--text, #e5e7eb)',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                }}\n              >\n                Customize\n              </button>\n              <button\n                onClick={handleRejectNonEssential}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: '1px solid var(--border, #334155)',\n                  background: 'transparent',\n                  color: 'var(--text, #e5e7eb)',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                }}\n              >\n                Reject Non-Essential\n              </button>\n              <button\n                onClick={handleAcceptAll}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: 'none',\n                  background: 'var(--accent, #f59e0b)',\n                  color: '#000',\n                  fontSize: 13,\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                }}\n              >\n                Accept All\n              </button>\n            </div>\n          </div>\n        ) : (\n          // Customize view\n          <div>\n            <div style={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              marginBottom: 16,\n            }}>\n              <h3 style={{\n                margin: 0,\n                fontSize: 16,\n                fontWeight: 600,\n                color: 'var(--text, #e5e7eb)',\n              }}>\n                Cookie Preferences\n              </h3>\n              <button\n                onClick={() => setShowCustomize(false)}\n                style={{\n                  background: 'none',\n                  border: 'none',\n                  padding: 4,\n                  cursor: 'pointer',\n                  color: 'var(--text-muted, #94a3b8)',\n                }}\n              >\n                <X size={18} />\n              </button>\n            </div>\n\n            <div style={{\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 12,\n              marginBottom: 16,\n            }}>\n              <label style={{\n                display: 'flex',\n                gap: 12,\n                alignItems: 'flex-start',\n                padding: 12,\n                background: 'var(--bg-secondary, #1e293b)',\n                borderRadius: 6,\n              }}>\n                <input\n                  type=\"checkbox\"\n                  checked={true}\n                  disabled\n                  style={{ marginTop: 3 }}\n                />\n                <div>\n                  <div style={{ fontWeight: 500, color: 'var(--text, #e5e7eb)', marginBottom: 2 }}>\n                    Necessary Cookies\n                  </div>\n                  <div style={{ fontSize: 13, color: 'var(--text-muted, #94a3b8)' }}>\n                    Required for the website to function. Cannot be disabled.\n                  </div>\n                </div>\n              </label>\n\n              <label style={{\n                display: 'flex',\n                gap: 12,\n                alignItems: 'flex-start',\n                padding: 12,\n                background: 'var(--bg-secondary, #1e293b)',\n                borderRadius: 6,\n                cursor: 'pointer',\n              }}>\n                <input\n                  type=\"checkbox\"\n                  checked={preferences.analytics}\n                  onChange={(e) => setPreferences(prev => ({ ...prev, analytics: e.target.checked }))}\n                  style={{ marginTop: 3 }}\n                />\n                <div>\n                  <div style={{ fontWeight: 500, color: 'var(--text, #e5e7eb)', marginBottom: 2 }}>\n                    Analytics Cookies\n                  </div>\n                  <div style={{ fontSize: 13, color: 'var(--text-muted, #94a3b8)' }}>\n                    Help us understand how you use the site to improve it.\n                  </div>\n                </div>\n              </label>\n\n              <label style={{\n                display: 'flex',\n                gap: 12,\n                alignItems: 'flex-start',\n                padding: 12,\n                background: 'var(--bg-secondary, #1e293b)',\n                borderRadius: 6,\n                cursor: 'pointer',\n              }}>\n                <input\n                  type=\"checkbox\"\n                  checked={preferences.marketing}\n                  onChange={(e) => setPreferences(prev => ({ ...prev, marketing: e.target.checked }))}\n                  style={{ marginTop: 3 }}\n                />\n                <div>\n                  <div style={{ fontWeight: 500, color: 'var(--text, #e5e7eb)', marginBottom: 2 }}>\n                    Marketing Cookies\n                  </div>\n                  <div style={{ fontSize: 13, color: 'var(--text-muted, #94a3b8)' }}>\n                    Used to show you relevant content and ads.\n                  </div>\n                </div>\n              </label>\n            </div>\n\n            <div style={{ display: 'flex', justifyContent: 'flex-end', gap: 8 }}>\n              <button\n                onClick={handleRejectNonEssential}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: '1px solid var(--border, #334155)',\n                  background: 'transparent',\n                  color: 'var(--text, #e5e7eb)',\n                  fontSize: 13,\n                  cursor: 'pointer',\n                }}\n              >\n                Reject All\n              </button>\n              <button\n                onClick={handleSavePreferences}\n                style={{\n                  padding: '8px 16px',\n                  borderRadius: 6,\n                  border: 'none',\n                  background: 'var(--accent, #f59e0b)',\n                  color: '#000',\n                  fontSize: 13,\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                }}\n              >\n                Save Preferences\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default CookieBanner;\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Search, Clock, TrendingUp, X } from 'lucide-react';\nimport { API_URL } from '../config';\n\ntype Suggestion = {\n  id: number;\n  title: string;\n  creator_username?: string;\n  content_type?: string;\n};\n\ntype Props = {\n  onSearch?: (query: string) => void;\n};\n\nconst RECENT_SEARCHES_KEY = 'rb_recent_searches';\nconst MAX_RECENT_SEARCHES = 5;\n\nexport function SearchAutocomplete({ onSearch }: Props) {\n  const [query, setQuery] = useState('');\n  const [suggestions, setSuggestions] = useState<Suggestion[]>([]);\n  const [recentSearches, setRecentSearches] = useState<string[]>([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const [loading, setLoading] = useState(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const navigate = useNavigate();\n\n  // Load recent searches from localStorage\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(RECENT_SEARCHES_KEY);\n      if (stored) {\n        setRecentSearches(JSON.parse(stored));\n      }\n    } catch {}\n  }, []);\n\n  // Save recent search\n  const saveRecentSearch = (search: string) => {\n    if (!search.trim()) return;\n    const updated = [search, ...recentSearches.filter(s => s !== search)].slice(0, MAX_RECENT_SEARCHES);\n    setRecentSearches(updated);\n    try {\n      localStorage.setItem(RECENT_SEARCHES_KEY, JSON.stringify(updated));\n    } catch {}\n  };\n\n  // Remove recent search\n  const removeRecentSearch = (search: string, e: React.MouseEvent) => {\n    e.stopPropagation();\n    const updated = recentSearches.filter(s => s !== search);\n    setRecentSearches(updated);\n    try {\n      localStorage.setItem(RECENT_SEARCHES_KEY, JSON.stringify(updated));\n    } catch {}\n  };\n\n  // Fetch suggestions (debounced)\n  useEffect(() => {\n    if (query.length < 2) {\n      setSuggestions([]);\n      return;\n    }\n\n    const timer = setTimeout(() => {\n      setLoading(true);\n      fetch(`${API_URL}/api/search/?q=${encodeURIComponent(query)}`, { credentials: 'include' })\n        .then(r => r.json())\n        .then(data => {\n          if (Array.isArray(data)) {\n            setSuggestions(data.slice(0, 6));\n          }\n        })\n        .catch(() => setSuggestions([]))\n        .finally(() => setLoading(false));\n    }, 200);\n\n    return () => clearTimeout(timer);\n  }, [query]);\n\n  // Handle click outside to close dropdown\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(e.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Handle search submission\n  const handleSearch = (searchQuery: string) => {\n    if (!searchQuery.trim()) return;\n    saveRecentSearch(searchQuery.trim());\n    setIsOpen(false);\n    setQuery(searchQuery);\n    if (onSearch) {\n      onSearch(searchQuery);\n    } else {\n      navigate(`/search?q=${encodeURIComponent(searchQuery.trim())}`);\n    }\n  };\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    const items = query.length >= 2 ? suggestions : recentSearches;\n    const totalItems = items.length;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setSelectedIndex(prev => (prev < totalItems - 1 ? prev + 1 : prev));\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setSelectedIndex(prev => (prev > 0 ? prev - 1 : -1));\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (selectedIndex >= 0 && selectedIndex < totalItems) {\n          const selected = query.length >= 2\n            ? suggestions[selectedIndex]?.title\n            : recentSearches[selectedIndex];\n          if (selected) handleSearch(selected);\n        } else {\n          handleSearch(query);\n        }\n        break;\n      case 'Escape':\n        setIsOpen(false);\n        inputRef.current?.blur();\n        break;\n    }\n  };\n\n  // Reset selection when suggestions change\n  useEffect(() => {\n    setSelectedIndex(-1);\n  }, [suggestions, recentSearches]);\n\n  const showDropdown = isOpen && (query.length >= 2 ? suggestions.length > 0 : recentSearches.length > 0);\n\n  return (\n    <div ref={containerRef} className=\"search-autocomplete\" style={{ position: 'relative', width: '100%' }}>\n      <form\n        onSubmit={(e) => { e.preventDefault(); handleSearch(query); }}\n        className=\"rb-search\"\n      >\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={query}\n          onChange={(e) => setQuery(e.target.value)}\n          onFocus={() => setIsOpen(true)}\n          onKeyDown={handleKeyDown}\n          placeholder=\"Search\"\n          autoComplete=\"off\"\n        />\n        <button type=\"submit\">\n          <Search size={18} />\n        </button>\n      </form>\n\n      {/* Dropdown */}\n      {showDropdown && (\n        <div className=\"search-dropdown\" style={{\n          position: 'absolute',\n          top: '100%',\n          left: 0,\n          right: 0,\n          marginTop: 4,\n          background: '#1e293b',\n          borderRadius: 8,\n          boxShadow: '0 4px 20px rgba(0,0,0,0.4)',\n          zIndex: 1000,\n          overflow: 'hidden',\n          border: '1px solid #334155',\n        }}>\n          {query.length >= 2 ? (\n            // Show search suggestions\n            <>\n              {suggestions.map((item, index) => (\n                <div\n                  key={item.id}\n                  onClick={() => handleSearch(item.title)}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 12,\n                    padding: '10px 16px',\n                    cursor: 'pointer',\n                    background: selectedIndex === index ? '#334155' : 'transparent',\n                  }}\n                  onMouseEnter={() => setSelectedIndex(index)}\n                >\n                  <Search size={16} style={{ color: '#64748b', flexShrink: 0 }} />\n                  <div style={{ flex: 1, minWidth: 0 }}>\n                    <div style={{\n                      color: '#f1f5f9',\n                      fontSize: 14,\n                      whiteSpace: 'nowrap',\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis',\n                    }}>\n                      {item.title}\n                    </div>\n                    {item.creator_username && (\n                      <div style={{ color: '#64748b', fontSize: 12 }}>\n                        by {item.creator_username}\n                      </div>\n                    )}\n                  </div>\n                  {item.content_type && (\n                    <span style={{\n                      fontSize: 10,\n                      padding: '2px 6px',\n                      background: '#334155',\n                      borderRadius: 4,\n                      color: '#94a3b8',\n                      textTransform: 'capitalize',\n                    }}>\n                      {item.content_type}\n                    </span>\n                  )}\n                </div>\n              ))}\n            </>\n          ) : (\n            // Show recent searches\n            <>\n              <div style={{\n                padding: '8px 16px',\n                fontSize: 12,\n                color: '#64748b',\n                borderBottom: '1px solid #334155',\n              }}>\n                Recent searches\n              </div>\n              {recentSearches.map((search, index) => (\n                <div\n                  key={search}\n                  onClick={() => handleSearch(search)}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 12,\n                    padding: '10px 16px',\n                    cursor: 'pointer',\n                    background: selectedIndex === index ? '#334155' : 'transparent',\n                  }}\n                  onMouseEnter={() => setSelectedIndex(index)}\n                >\n                  <Clock size={16} style={{ color: '#64748b', flexShrink: 0 }} />\n                  <span style={{ flex: 1, color: '#f1f5f9', fontSize: 14 }}>\n                    {search}\n                  </span>\n                  <button\n                    onClick={(e) => removeRecentSearch(search, e)}\n                    style={{\n                      background: 'none',\n                      border: 'none',\n                      padding: 4,\n                      cursor: 'pointer',\n                      color: '#64748b',\n                      display: 'flex',\n                      alignItems: 'center',\n                    }}\n                  >\n                    <X size={14} />\n                  </button>\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useEffect, useState, Suspense, lazy } from 'react';\nimport { Route, Routes, Link, useLocation, useNavigate, Navigate } from 'react-router-dom';\nimport './App.css';\nimport { CreatorSidebar } from './components/CreatorSidebar';\nimport { LibrarySidebar } from './components/LibrarySidebar';\nimport ProtectedRoute from './components/ProtectedRoute';\nimport ErrorBoundary from './components/ErrorBoundary';\nimport NotificationBell from './components/notifications/NotificationBell';\nimport NotificationToastContainer from './components/notifications/NotificationToastContainer';\nimport notificationService from './services/notificationService';\nimport { BetaBadge, TestModeBanner } from './components/BetaBadge';\nimport { useAuth } from './hooks/useAuth';\nimport BetaOnboarding from './components/BetaOnboarding';\nimport { Footer } from './components/legal/Footer';\nimport { CookieBanner } from './components/legal/CookieBanner';\nimport { API_URL } from './config';\nimport {\n  User, LogOut, Menu, X, Users\n} from 'lucide-react';\nimport { SearchAutocomplete } from './components/SearchAutocomplete';\n\n// Lazy-loaded page components for code splitting\nconst HomePage = lazy(() => import('./pages/HomePage'));\nconst SearchPage = lazy(() => import('./pages/SearchPage'));\nconst StudioPage = lazy(() => import('./pages/StudioPage'));\nconst DashboardPage = lazy(() => import('./pages/DashboardPage'));\nconst ProfilePage = lazy(() => import('./pages/ProfilePageRedesigned'));\nconst AuthPage = lazy(() => import('./pages/AuthPage'));\nconst WalletInfoPage = lazy(() => import('./pages/WalletInfoPage'));\n// TermsPage replaced by TermsOfServicePage in legal pages\nconst BetaLanding = lazy(() => import('./pages/BetaLanding'));\nconst CollaboratorsPage = lazy(() => import('./pages/CollaboratorsPage'));\nconst PublicProfilePage = lazy(() => import('./pages/PublicProfilePage'));\nconst ContentDetail = lazy(() => import('./pages/ContentDetail'));\nconst PurchaseSuccessPage = lazy(() => import('./pages/PurchaseSuccessPage'));\nconst ReaderPage = lazy(() => import('./pages/ReaderPage').then(m => ({ default: m.ReaderPage })));\nconst CollaborationDashboard = lazy(() => import('./pages/CollaborationDashboard'));\nconst CollaborativeProjectPage = lazy(() => import('./pages/CollaborativeProjectPage'));\nconst NotificationsPage = lazy(() => import('./pages/NotificationsPage'));\nconst FollowingFeedPage = lazy(() => import('./pages/FollowingFeedPage'));\n\n// Legal pages\nconst TermsOfServicePage = lazy(() => import('./pages/legal/TermsOfServicePage'));\nconst PrivacyPolicyPage = lazy(() => import('./pages/legal/PrivacyPolicyPage'));\nconst ContentPolicyPage = lazy(() => import('./pages/legal/ContentPolicyPage'));\nconst DMCAPolicyPage = lazy(() => import('./pages/legal/DMCAPolicyPage'));\nconst CreatorAgreementPage = lazy(() => import('./pages/legal/CreatorAgreementPage'));\n\n// Loading fallback component\nconst PageLoader = () => (\n  <div style={{\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: '200px',\n    color: 'var(--text-muted, #94a3b8)',\n  }}>\n    Loading...\n  </div>\n);\n\nfunction Header() {\n  const [isAuthed, setIsAuthed] = useState(false);\n  const [username, setUsername] = useState('');\n  const [avatarUrl, setAvatarUrl] = useState<string | null>(null);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const checkAuth = React.useCallback(() => {\n    fetch(`${API_URL}/api/auth/status/`, { credentials: 'include' })\n      .then(r=>r.json())\n      .then(d=> {\n        const authed = !!d?.authenticated;\n        setIsAuthed(authed);\n\n        // Store username and avatar if available\n        if (authed && d?.user?.username) {\n          setUsername(d.user.username);\n          setAvatarUrl(d.user.avatar_url || null);\n        } else {\n          setUsername('');\n          setAvatarUrl(null);\n        }\n\n        // Start/stop notification polling based on auth state\n        if (authed) {\n          if (!notificationService.isPolling()) {\n            notificationService.startPolling();\n          }\n        } else {\n          if (notificationService.isPolling()) {\n            notificationService.stopPolling();\n          }\n          notificationService.reset();\n        }\n      })\n      .catch(()=> {\n        setIsAuthed(false);\n        setUsername('');\n        setAvatarUrl(null);\n        notificationService.stopPolling();\n        notificationService.reset();\n      });\n  }, []);\n\n  useEffect(()=>{\n    checkAuth();\n    // Poll auth status every 10 seconds to catch changes\n    const interval = setInterval(checkAuth, 10000);\n    return () => {\n      clearInterval(interval);\n      // Clean up notification service on unmount\n      notificationService.stopPolling();\n    };\n  },[location.pathname, checkAuth]);\n\n  // Also refresh immediately when we land on home with potential fresh logout redirect\n  useEffect(()=>{\n    if (location.pathname === '/') {\n      checkAuth();\n    }\n  }, [location.pathname, checkAuth]);\n\n  const goLogin = () => { navigate('/auth'); };\n\n  const doLogout = async () => {\n    try {\n      const t = await fetch(`${API_URL}/api/auth/csrf/`, { credentials:'include' }).then(r=>r.json()).then(j=> j?.csrfToken || '');\n      await fetch(`${API_URL}/api/auth/logout/`, { method:'POST', credentials:'include', headers:{ 'X-CSRFToken': t, 'X-Requested-With': 'XMLHttpRequest' } });\n    } catch {}\n\n    // Stop notification polling and reset\n    notificationService.stopPolling();\n    notificationService.reset();\n\n    // Optimistically flip immediately\n    setIsAuthed(false);\n\n    // Navigate to home using React Router\n    navigate('/');\n\n    // Re-check server state after navigation\n    setTimeout(() => checkAuth(), 100);\n  };\n  return (\n    <nav className=\"rb-header\">\n      <div className=\"rb-header-left\">\n        <Link to=\"/\" className=\"rb-logo-link\">\n          <img src=\"/rb-logo.png\" alt=\"renaissBlock\" className=\"rb-logo-img\"/>\n        </Link>\n        <BetaBadge variant=\"header\" showTestMode={true} />\n      </div>\n      <div className=\"rb-header-center\">\n        <SearchAutocomplete />\n      </div>\n\n      {/* Mobile Menu Toggle */}\n      <button\n        className=\"rb-mobile-menu-toggle\"\n        onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n        aria-label=\"Toggle menu\"\n      >\n        {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}\n      </button>\n\n      {/* Navigation Links */}\n      <div className={`rb-header-right rb-nav ${mobileMenuOpen ? 'rb-nav-mobile-open' : ''}`}>\n        {isAuthed && (\n          <>\n            <NotificationBell />\n            <Link to=\"/collaborators\" className=\"rb-nav-link\" title=\"Find Collaborators\">\n              <Users size={20} />\n            </Link>\n            <Link to=\"/profile\" className=\"rb-nav-link rb-profile-link\" title=\"Profile\">\n              {avatarUrl ? (\n                <img\n                  src={avatarUrl}\n                  alt={username}\n                  style={{\n                    width: 28,\n                    height: 28,\n                    borderRadius: '50%',\n                    objectFit: 'cover',\n                    border: '2px solid var(--accent)',\n                  }}\n                />\n              ) : (\n                <User size={20} />\n              )}\n              <span>@{username || 'Profile'}</span>\n            </Link>\n            <button\n              onClick={doLogout}\n              className=\"rb-nav-link rb-logout-btn\"\n              title=\"Logout\"\n            >\n              <LogOut size={20} />\n              <span>Logout</span>\n            </button>\n          </>\n        )}\n        {!isAuthed && (\n          <button onClick={goLogin} className=\"rb-nav-link rb-signin-btn\">\n            <User size={20} />\n            <span>Sign in</span>\n          </button>\n        )}\n      </div>\n    </nav>\n  );\n}\n\nexport default function App() {\n  const location = useLocation();\n  const { isAuthenticated, loading } = useAuth();\n\n  // Legacy CreatorSidebar removed - functionality now in navbar and page tabs\n  const showCreatorSidebar = false;\n  // Only show Library sidebar when authenticated AND on home or search pages\n  const showLibrarySidebar = isAuthenticated && [/^\\/$/, /^\\/search/].some(r => r.test(location.pathname));\n  const isReaderPage = /^\\/reader/.test(location.pathname);\n  // Hide footer on pages that have the sidebar (footer links are in sidebar instead)\n  const showFooter = !showLibrarySidebar;\n\n  // Public routes that don't require authentication\n  const publicRoutes = ['/auth', '/terms', '/wallet-info', '/beta', '/profile/', '/legal'];\n  const isPublicRoute = publicRoutes.some(route => location.pathname.startsWith(route));\n\n  // Show loading state while checking authentication\n  if (loading) {\n    return (\n      <div className=\"rb-app\" style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: '100vh',\n        background: 'var(--bg)',\n        color: 'var(--text)'\n      }}>\n        <div style={{ textAlign: 'center' }}>\n          <div style={{ fontSize: '18px', marginBottom: '8px' }}>Loading...</div>\n        </div>\n      </div>\n    );\n  }\n\n  // Show beta landing page for unauthenticated users (except on public routes)\n  if (!isAuthenticated && !isPublicRoute) {\n    return (\n      <div className=\"rb-app\">\n        <BetaLanding />\n        <NotificationToastContainer />\n      </div>\n    );\n  }\n\n  // Special handling for explicit /beta route\n  const isBetaLanding = location.pathname === '/beta';\n  if (isBetaLanding) {\n    return (\n      <div className=\"rb-app\">\n        <BetaLanding />\n        <NotificationToastContainer />\n      </div>\n    );\n  }\n\n  // Reader page gets its own full-screen layout without app chrome\n  if (isReaderPage) {\n    return (\n      <div className=\"rb-app\">\n        <ErrorBoundary>\n          <Suspense fallback={<PageLoader />}>\n            <Routes>\n              <Route path=\"/reader/:contentId\" element={<ReaderPage />} />\n            </Routes>\n          </Suspense>\n        </ErrorBoundary>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"rb-app\">\n      <Header />\n      {showLibrarySidebar && <LibrarySidebar />}\n      <main\n        className=\"rb-main\"\n        style={{\n          display: 'grid',\n          gridTemplateColumns: showCreatorSidebar ? '240px 1fr' : '1fr',\n          gap: 16,\n          marginLeft: showLibrarySidebar ? 320 : 0,\n          transition: 'margin-left 0.3s ease',\n        }}\n      >\n        {showCreatorSidebar && <CreatorSidebar />}\n        <div>\n          <ErrorBoundary>\n            <Suspense fallback={<PageLoader />}>\n              <Routes>\n                <Route path=\"/\" element={<HomePage />} />\n                <Route path=\"/beta\" element={<BetaLanding />} />\n                <Route path=\"/login\" element={<Navigate to=\"/auth\" replace />} />\n                <Route path=\"/signup\" element={<Navigate to=\"/auth\" replace />} />\n                <Route path=\"/search\" element={<SearchPage />} />\n                <Route path=\"/studio\" element={<StudioPage />} />\n                <Route path=\"/dashboard\" element={<DashboardPage />} />\n                <Route path=\"/profile\" element={<ProfilePage />} />\n                <Route path=\"/profile/:username\" element={<PublicProfilePage />} />\n                <Route path=\"/collaborators\" element={<CollaboratorsPage />} />\n                <Route path=\"/auth\" element={<AuthPage />} />\n                <Route path=\"/wallet-info\" element={<WalletInfoPage />} />\n                <Route path=\"/terms\" element={<TermsOfServicePage />} />\n                <Route path=\"/legal/terms\" element={<TermsOfServicePage />} />\n                <Route path=\"/legal/privacy\" element={<PrivacyPolicyPage />} />\n                <Route path=\"/legal/content-policy\" element={<ContentPolicyPage />} />\n                <Route path=\"/legal/dmca\" element={<DMCAPolicyPage />} />\n                <Route path=\"/legal/creator-agreement\" element={<CreatorAgreementPage />} />\n                <Route path=\"/content/:id\" element={<ContentDetail />} />\n                <Route path=\"/purchase/success\" element={<PurchaseSuccessPage />} />\n                <Route path=\"/collaborations\" element={<ProtectedRoute><CollaborationDashboard /></ProtectedRoute>} />\n                <Route path=\"/collaborations/:projectId\" element={<ProtectedRoute><CollaborativeProjectPage /></ProtectedRoute>} />\n                <Route path=\"/notifications\" element={<ProtectedRoute><NotificationsPage /></ProtectedRoute>} />\n                <Route path=\"/feed\" element={<ProtectedRoute><FollowingFeedPage /></ProtectedRoute>} />\n              </Routes>\n            </Suspense>\n          </ErrorBoundary>\n        </div>\n      </main>\n      {showFooter && <Footer />}\n      <NotificationToastContainer />\n      <CookieBanner />\n      <TestModeBanner />\n      <BetaOnboarding />\n    </div>\n  );\n}\n","import './polyfills';\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter } from 'react-router-dom';\n\n// Polyfills for Node globals used by some dependencies in the browser\nimport { Buffer } from 'buffer';\nimport process from 'process';\nif (!(window as any).Buffer) (window as any).Buffer = Buffer;\nif (!(window as any).process) (window as any).process = process;\n\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\nroot.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>\n);\n"],"file":"assets/index-CceaTp3C.js"}