import{j as e}from"./web3auth-BGmWjNJV.js";import{r,a as n,e as t}from"./router-CzH47hF_.js";import{c as a,e as o,f as i,X as s,l}from"./index-nkA1Nj9U.js";import{s as d,p as c}from"./sanitize-MG3ZWMPS.js";import{A as x}from"./arrow-left-C2x3eiKt.js";import{S as p}from"./settings-CSLeqZys.js";import{B as u}from"./book-open-B6MSCtbg.js";import"./vendor-Cfs_Iq82.js";
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=a("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),f=a("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),h=a("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),m=a("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]),b=a("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),y=a("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),v=a("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),j={fontSize:"medium",lineHeight:"normal",theme:"dark",fontFamily:"bookerly",margins:"medium",textAlign:"justify",columns:"two",continuousScroll:!1},k={xsmall:"14px",small:"16px",medium:"18px",large:"22px",xlarge:"26px"},w={compact:"1.4",normal:"1.7",relaxed:"2.0"},S={light:{background:"#ffffff",text:"#1a1a1a",secondary:"#6b7280",border:"#e5e7eb",accent:"#0066cc"},sepia:{background:"#f5e6c8",text:"#5b4636",secondary:"#8b7355",border:"#d4c4a8",accent:"#8b5a2b"},green:{background:"#d4e8d4",text:"#2d4a2d",secondary:"#4a6b4a",border:"#a8c8a8",accent:"#2d6b2d"},dark:{background:"#0a1628",text:"#c9d1d9",secondary:"#8b949e",border:"#21262d",accent:"#58a6ff"}},C={"amazon-ember":{name:"Amazon Ember",css:"'Amazon Ember', 'Helvetica Neue', Helvetica, Arial, sans-serif"},baskerville:{name:"Baskerville",css:"Baskerville, 'Baskerville Old Face', 'Times New Roman', serif"},bookerly:{name:"Bookerly",css:"Bookerly, Georgia, 'Times New Roman', serif"},georgia:{name:"Georgia",css:"Georgia, 'Times New Roman', serif"},palatino:{name:"Palatino",css:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"}},z={narrow:"20px",medium:"48px",wide:"80px"},R="rb_reader_settings";function I(){const[e,n]=r.useState(()=>{try{const e=localStorage.getItem(R);if(e){const r=function(e){const r={...e};"serif"===e.fontFamily?r.fontFamily="georgia":"sans-serif"===e.fontFamily&&(r.fontFamily="amazon-ember");r.margins||(r.margins=j.margins);r.textAlign||(r.textAlign=j.textAlign);r.columns||(r.columns=j.columns);void 0===r.continuousScroll&&(r.continuousScroll=j.continuousScroll);return r}(JSON.parse(e));return{...j,...r}}}catch(e){}return j});r.useEffect(()=>{try{localStorage.setItem(R,JSON.stringify(e))}catch(r){}},[e]);const t=r.useCallback((e,r)=>{n(n=>({...n,[e]:r}))},[]),a=r.useCallback(()=>{n(j)},[]),o=r.useMemo(()=>({"--reader-font-size":k[e.fontSize],"--reader-line-height":w[e.lineHeight],"--reader-bg":S[e.theme].background,"--reader-text":S[e.theme].text,"--reader-secondary":S[e.theme].secondary,"--reader-border":S[e.theme].border,"--reader-accent":S[e.theme].accent,"--reader-font-family":C[e.fontFamily].css,"--reader-margin":z[e.margins],"--reader-text-align":e.textAlign}),[e]),i=`reader-theme-${e.theme}`;return{settings:e,updateSetting:t,resetSettings:a,cssVars:o,themeClass:i}}function T({title:r,chapterTitle:n,onBack:t,onToggleSettings:a,onToggleTOC:o,visible:i}){return e.jsxs("header",{className:"reader-header "+(i?"visible":"hidden"),style:{position:"fixed",top:0,left:0,right:0,height:"60px",background:"var(--reader-bg)",borderBottom:"1px solid var(--reader-border)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",zIndex:100,transition:"transform 0.3s ease, opacity 0.3s ease",transform:i?"translateY(0)":"translateY(-100%)",opacity:i?1:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:t,className:"reader-icon-button","aria-label":"Go back",style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(x,{size:24})}),e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx("h1",{style:{fontSize:"16px",fontWeight:600,color:"var(--reader-text)",margin:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:"200px"},children:r}),n&&e.jsx("p",{style:{fontSize:"12px",color:"var(--reader-secondary)",margin:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:"200px"},children:n})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("button",{onClick:o,className:"reader-icon-button","aria-label":"Table of Contents",style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(f,{size:24})}),e.jsx("button",{onClick:a,className:"reader-icon-button","aria-label":"Settings",style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(p,{size:24})})]})]})}function A({currentPage:r,totalPages:n,percentComplete:t,visible:a,continuousScroll:o=!1}){return e.jsxs("footer",{className:"reader-footer "+(a?"visible":"hidden"),style:{position:"fixed",bottom:0,left:0,right:0,height:"50px",background:"var(--reader-bg)",borderTop:"1px solid var(--reader-border)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 16px",zIndex:100,transition:"transform 0.3s ease, opacity 0.3s ease",transform:a?"translateY(0)":"translateY(100%)",opacity:a?1:0},children:[e.jsx("div",{style:{width:"100%",maxWidth:"400px",height:"3px",background:"var(--reader-border)",borderRadius:"2px",marginBottom:"8px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${t}%`,height:"100%",background:"var(--reader-accent, var(--reader-secondary))",borderRadius:"2px",transition:"width 0.3s ease"}})}),e.jsx("p",{style:{fontSize:"12px",color:"var(--reader-secondary)",margin:0},children:o?`${t}% complete`:`Page ${r+1} of ${n} (${t}%)`})]})}function M({onPrevious:r,onNext:n,onCenter:t,isFirstPage:a,isLastPage:s,showArrows:l}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"reader-nav-zone reader-nav-left",onClick:e=>{e.stopPropagation(),a||r()},style:{position:"fixed",left:0,top:"60px",bottom:"50px",width:"25%",cursor:a?"default":"pointer",zIndex:50,display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:"12px"},role:"button","aria-label":"Previous page",children:l&&!a&&e.jsx("div",{className:"reader-nav-arrow",style:{opacity:.3,transition:"opacity 0.2s ease",color:"var(--reader-secondary)"},children:e.jsx(o,{size:32})})}),e.jsx("div",{className:"reader-nav-zone reader-nav-center",onClick:e=>{e.stopPropagation(),t()},style:{position:"fixed",left:"25%",right:"25%",top:"60px",bottom:"50px",cursor:"pointer",zIndex:50},role:"button","aria-label":"Toggle controls"}),e.jsx("div",{className:"reader-nav-zone reader-nav-right",onClick:e=>{e.stopPropagation(),s||n()},style:{position:"fixed",right:0,top:"60px",bottom:"50px",width:"25%",cursor:s?"default":"pointer",zIndex:50,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"12px"},role:"button","aria-label":"Next page",children:l&&!s&&e.jsx("div",{className:"reader-nav-arrow",style:{opacity:.3,transition:"opacity 0.2s ease",color:"var(--reader-secondary)"},children:e.jsx(i,{size:32})})})]})}function L({settings:n,updateSetting:t,resetSettings:a,onClose:o,visible:i}){const[l,d]=r.useState("font");if(!i)return null;const c=["xsmall","small","medium","large","xlarge"],x=c.indexOf(n.fontSize);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"reader-settings-backdrop",onClick:o,style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:200,animation:"fadeIn 0.2s ease"}}),e.jsxs("div",{className:"reader-settings-panel",style:{position:"fixed",top:0,right:0,bottom:0,width:"320px",maxWidth:"90vw",background:"var(--reader-bg)",borderLeft:"1px solid var(--reader-border)",zIndex:201,display:"flex",flexDirection:"column",animation:"slideFromRight 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--reader-border)",padding:"0 8px"},children:[[{id:"font",label:"Font"},{id:"layout",label:"Layout"},{id:"themes",label:"Themes"},{id:"more",label:"More"}].map(r=>e.jsx("button",{onClick:()=>d(r.id),style:{flex:1,padding:"16px 8px",background:"none",border:"none",borderBottom:l===r.id?"2px solid var(--reader-accent, #58a6ff)":"2px solid transparent",color:l===r.id?"var(--reader-accent, #58a6ff)":"var(--reader-secondary)",fontSize:"14px",fontWeight:l===r.id?600:400,cursor:"pointer",transition:"all 0.2s ease"},children:r.label},r.id)),e.jsx("button",{onClick:o,style:{background:"none",border:"none",color:"var(--reader-secondary)",cursor:"pointer",padding:"16px 12px"},"aria-label":"Close settings",children:e.jsx(s,{size:20})})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:["font"===l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsx("div",{children:e.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Object.keys(C).map(r=>e.jsxs("button",{onClick:()=>t("fontFamily",r),style:{padding:"12px 16px",border:n.fontFamily===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:n.fontFamily===r?"rgba(88, 166, 255, 0.1)":"transparent",color:n.fontFamily===r?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",fontFamily:C[r].css,fontSize:"18px",minWidth:"70px"},children:["Aa",e.jsx("div",{style:{fontSize:"10px",marginTop:"4px",fontFamily:"system-ui"},children:C[r].name})]},r))})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Size"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("span",{style:{fontSize:"14px",color:"var(--reader-text)"},children:"A"}),e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("input",{type:"range",min:0,max:c.length-1,value:x,onChange:e=>t("fontSize",c[parseInt(e.target.value)]),style:{width:"100%",height:"4px",appearance:"none",background:"var(--reader-border)",borderRadius:"2px",cursor:"pointer"}}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:c.map((r,n)=>e.jsx("div",{style:{width:"2px",height:"6px",background:n<=x?"var(--reader-accent, #58a6ff)":"var(--reader-border)",borderRadius:"1px"}},n))})]}),e.jsx("span",{style:{fontSize:"22px",color:"var(--reader-text)"},children:"A"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:["Spacing",e.jsx("span",{style:{fontSize:"12px",color:"var(--reader-secondary)"},children:"Adjust text spacing of the page."})]}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:["compact","normal","relaxed"].map(r=>e.jsx("button",{onClick:()=>t("lineHeight",r),style:{flex:1,padding:"10px 8px",border:n.lineHeight===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:n.lineHeight===r?"rgba(88, 166, 255, 0.1)":"transparent",color:n.lineHeight===r?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",fontSize:"12px",textTransform:"capitalize"},children:r},r))})]})]}),"layout"===l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Page Color"}),e.jsx("div",{style:{display:"flex",gap:"12px"},children:Object.keys(S).map(r=>e.jsx("button",{onClick:()=>t("theme",r),style:{width:"48px",height:"48px",borderRadius:"50%",background:S[r].background,border:n.theme===r?"3px solid var(--reader-accent, #58a6ff)":"2px solid var(--reader-border)",cursor:"pointer",transition:"transform 0.2s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},title:r.charAt(0).toUpperCase()+r.slice(1)},r))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("label",{style:{fontSize:"14px",color:"var(--reader-text)"},children:"Continuous Scrolling"}),e.jsx("button",{onClick:()=>t("continuousScroll",!n.continuousScroll),style:{width:"48px",height:"28px",borderRadius:"14px",border:"none",background:n.continuousScroll?"var(--reader-accent, #58a6ff)":"var(--reader-border)",cursor:"pointer",position:"relative",transition:"background 0.2s ease"},children:e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"#fff",position:"absolute",top:"2px",left:n.continuousScroll?"22px":"2px",transition:"left 0.2s ease",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Alignment"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>t("textAlign","left"),style:{flex:1,padding:"12px",border:"left"===n.textAlign?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"left"===n.textAlign?"rgba(88, 166, 255, 0.1)":"transparent",color:"left"===n.textAlign?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(b,{size:20})}),e.jsx("button",{onClick:()=>t("textAlign","justify"),style:{flex:1,padding:"12px",border:"justify"===n.textAlign?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"justify"===n.textAlign?"rgba(88, 166, 255, 0.1)":"transparent",color:"justify"===n.textAlign?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(m,{size:20})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Margins"}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:["narrow","medium","wide"].map(r=>e.jsx("button",{onClick:()=>t("margins",r),style:{flex:1,padding:"12px 8px",border:n.margins===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:n.margins===r?"rgba(88, 166, 255, 0.1)":"transparent",color:n.margins===r?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{width:"narrow"===r?"28px":"medium"===r?"20px":"12px",height:"20px",background:"currentColor",opacity:.3,borderRadius:"2px"}})},r))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:500,color:"var(--reader-secondary)",marginBottom:"12px"},children:"Layout"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>t("columns","single"),style:{flex:1,padding:"12px 8px",border:"single"===n.columns?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"single"===n.columns?"rgba(88, 166, 255, 0.1)":"transparent",color:"single"===n.columns?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx("div",{style:{width:"24px",height:"32px",border:"2px solid currentColor",borderRadius:"3px"}}),e.jsx("span",{style:{fontSize:"11px"},children:"Single"})]}),e.jsxs("button",{onClick:()=>t("columns","two"),style:{flex:1,padding:"12px 8px",border:"two"===n.columns?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"8px",background:"two"===n.columns?"rgba(88, 166, 255, 0.1)":"transparent",color:"two"===n.columns?"var(--reader-accent, #58a6ff)":"var(--reader-text)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsxs("div",{style:{display:"flex",gap:"3px"},children:[e.jsx("div",{style:{width:"16px",height:"32px",border:"2px solid currentColor",borderRadius:"3px"}}),e.jsx("div",{style:{width:"16px",height:"32px",border:"2px solid currentColor",borderRadius:"3px"}})]}),e.jsx("span",{style:{fontSize:"11px"},children:"Two Column"})]})]})]})]}),"themes"===l&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:Object.keys(S).map(r=>e.jsxs("button",{onClick:()=>t("theme",r),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",border:n.theme===r?"2px solid var(--reader-accent, #58a6ff)":"1px solid var(--reader-border)",borderRadius:"12px",background:"transparent",cursor:"pointer",textAlign:"left"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"8px",background:S[r].background,border:"1px solid var(--reader-border)",display:"flex",alignItems:"center",justifyContent:"center",color:S[r].text,fontSize:"16px",fontFamily:"Georgia, serif"},children:"Aa"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"15px",fontWeight:500,color:"var(--reader-text)",textTransform:"capitalize"},children:r}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--reader-secondary)",marginTop:"2px"},children:["light"===r&&"Classic white background","sepia"===r&&"Warm, paper-like tone","green"===r&&"Easy on the eyes","dark"===r&&"Perfect for night reading"]})]}),n.theme===r&&e.jsx("div",{style:{marginLeft:"auto",width:"20px",height:"20px",borderRadius:"50%",background:"var(--reader-accent, #58a6ff)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]},r))}),"more"===l&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx("button",{onClick:a,style:{width:"100%",padding:"14px",border:"1px solid var(--reader-border)",borderRadius:"8px",background:"transparent",color:"var(--reader-text)",cursor:"pointer",fontSize:"14px"},children:"Reset to Defaults"}),e.jsxs("div",{style:{padding:"16px",background:"rgba(255,255,255,0.02)",borderRadius:"8px",border:"1px solid var(--reader-border)"},children:[e.jsx("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--reader-text)",marginBottom:"12px"},children:"Keyboard Shortcuts"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",fontSize:"12px",color:"var(--reader-secondary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Next page"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"Arrow Right"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Previous page"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"Arrow Left"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Toggle settings"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"S"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Table of contents"}),e.jsx("kbd",{style:{background:"var(--reader-border)",padding:"2px 8px",borderRadius:"4px"},children:"T"})]})]})]})]})]}),e.jsxs("div",{style:{padding:"16px 20px",borderTop:"1px solid var(--reader-border)",display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--reader-secondary)",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),e.jsx("input",{type:"range",min:0,max:100,defaultValue:100,style:{flex:1,height:"4px",appearance:"none",background:"linear-gradient(to right, var(--reader-border) 0%, var(--reader-text) 100%)",borderRadius:"2px",cursor:"pointer"},title:"Brightness (system controlled)",disabled:!0}),e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"var(--reader-text)",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})]})]}),e.jsx("style",{children:'\n        @keyframes slideFromRight {\n          from { transform: translateX(100%); }\n          to { transform: translateX(0); }\n        }\n\n        input[type="range"]::-webkit-slider-thumb {\n          -webkit-appearance: none;\n          width: 16px;\n          height: 16px;\n          border-radius: 50%;\n          background: var(--reader-accent, #58a6ff);\n          cursor: pointer;\n          border: 2px solid white;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n        }\n\n        input[type="range"]::-moz-range-thumb {\n          width: 16px;\n          height: 16px;\n          border-radius: 50%;\n          background: var(--reader-accent, #58a6ff);\n          cursor: pointer;\n          border: 2px solid white;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n        }\n      '})]})}function B({chapters:r,currentChapterId:n,onSelectChapter:t,onClose:a,visible:o}){return o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"reader-toc-backdrop",onClick:a,style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:200,animation:"fadeIn 0.2s ease"}}),e.jsxs("div",{className:"reader-toc-panel",style:{position:"fixed",top:0,left:0,bottom:0,width:"300px",maxWidth:"80vw",background:"var(--reader-bg)",borderRight:"1px solid var(--reader-border)",zIndex:201,display:"flex",flexDirection:"column",animation:"slideRight 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid var(--reader-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(u,{size:20,color:"var(--reader-text)"}),e.jsx("h2",{style:{fontSize:"18px",fontWeight:600,color:"var(--reader-text)",margin:0},children:"Contents"})]}),e.jsx("button",{onClick:a,style:{background:"none",border:"none",color:"var(--reader-text)",cursor:"pointer",padding:"8px"},"aria-label":"Close table of contents",children:e.jsx(s,{size:24})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:0===r.length?e.jsx("p",{style:{color:"var(--reader-secondary)",fontSize:"14px",textAlign:"center",padding:"20px"},children:"No chapters detected"}):e.jsx("ul",{style:{listStyle:"none",margin:0,padding:0},children:r.map(r=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>{t(r),a()},style:{width:"100%",padding:"12px 16px",paddingLeft:16+16*(r.level-1)+"px",border:"none",borderRadius:"8px",background:n===r.id?"var(--reader-border)":"transparent",color:n===r.id?"var(--reader-text)":"var(--reader-secondary)",cursor:"pointer",textAlign:"left",fontSize:1===r.level?"15px":"14px",fontWeight:1===r.level?500:400,display:"flex",alignItems:"center",gap:"8px",transition:"background 0.2s ease"},onMouseEnter:e=>{n!==r.id&&(e.currentTarget.style.background="var(--reader-border)")},onMouseLeave:e=>{n!==r.id&&(e.currentTarget.style.background="transparent")},children:[1===r.level&&e.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:n===r.id?"var(--reader-text)":"var(--reader-secondary)",flexShrink:0}}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.title})]})},r.id))})})]})]}):null}function E({contentId:t,title:a,htmlContent:o,onBack:i}){const s=n(),l=r.useRef(null),c=r.useRef(null),x=r.useRef(null),[p,u]=r.useState(!0),[g,f]=r.useState(!1),[h,m]=r.useState(!1),[b,y]=r.useState([]),[v,j]=r.useState(0),[k,w]=r.useState(1),[S,C]=r.useState(0),[z,R]=r.useState(0),{settings:E,updateSetting:F,resetSettings:W,cssVars:N,themeClass:P}=I(),D=r.useMemo(()=>function(e){const r=(new DOMParser).parseFromString(e,"text/html");return r.querySelectorAll("h1, h2, h3").forEach((e,r)=>{e.id||(e.id=`chapter-${r+1}`)}),r.body.innerHTML}(o),[o]);r.useEffect(()=>{const e=function(e){const r=[];return(new DOMParser).parseFromString(e,"text/html").querySelectorAll("h1, h2, h3").forEach((e,n)=>{var t;const a=e.tagName.toLowerCase(),o=parseInt(a.charAt(1),10),i=(null==(t=e.textContent)?void 0:t.trim())||`Chapter ${n+1}`,s=e.id||`chapter-${n+1}`;e.id||(e.id=s),r.push({id:s,title:i,level:o,pageIndex:0,elementId:s})}),r}(o);y(e)},[o]);const H=r.useCallback(()=>{const e=c.current,r=x.current;if(!e||!r||E.continuousScroll)return void w(1);const n=e.clientWidth;C(n);const t="two"===E.columns?Math.floor((n-60)/2):n;R(t),requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(!r)return;const e=r.scrollWidth,t=Math.max(1,Math.ceil(e/n));w(t),j(e=>Math.min(e,Math.max(0,t-1)))})})},[E.continuousScroll,E.columns]);r.useEffect(()=>{if(E.continuousScroll)return;const e=setTimeout(H,250),r=()=>{setTimeout(H,150)};return window.addEventListener("resize",r),()=>{clearTimeout(e),window.removeEventListener("resize",r)}},[H,E.continuousScroll]),r.useEffect(()=>{const e=setTimeout(H,200);return()=>clearTimeout(e)},[D,H,E.fontSize,E.lineHeight,E.columns,E.margins]);const O=r.useCallback(e=>{const r=Math.max(0,Math.min(e,k-1));j(r)},[k]),_=r.useCallback(()=>{v<k-1&&O(v+1)},[v,k,O]),$=r.useCallback(()=>{v>0&&O(v-1)},[v,O]),Y=r.useCallback(()=>{O(0)},[O]),G=r.useCallback(()=>{O(k-1)},[k,O]),q=r.useMemo(()=>function(e,r){if(0===e.length)return null;let n=null;for(const t of e){if(!(t.pageIndex<=r))break;n=t}return n}(b,v),[b,v]),X=r.useCallback(e=>{O(e.pageIndex),m(!1)},[O]),K=r.useCallback(()=>{g||h||u(e=>!e)},[g,h]),U=r.useCallback(()=>{i?i():s(-1)},[s,i]);!function(e,n){const{onSwipeLeft:t,onSwipeRight:a,onSwipeUp:o,onSwipeDown:i,threshold:s=50,velocityThreshold:l=.3,enabled:d=!0}=n,c=r.useRef(null),x=r.useRef(null),p=r.useCallback(e=>{if(!d)return;const r=e.touches[0];c.current={x:r.clientX,y:r.clientY,time:Date.now()},x.current=null},[d]),u=r.useCallback(e=>{if(!d||!c.current)return;const r=e.touches[0];x.current={x:r.clientX,y:r.clientY,time:Date.now()};const n=r.clientX-c.current.x,t=r.clientY-c.current.y;Math.abs(n)>Math.abs(t)&&Math.abs(n)>10&&e.preventDefault()},[d]),g=r.useCallback(e=>{if(!d||!c.current||!x.current)return;const r=c.current,n=x.current,p=n.x-r.x,u=n.y-r.y,g=n.time-r.time,f=Math.abs(p)/g,h=Math.abs(u)/g;Math.abs(p)>Math.abs(u)?Math.abs(p)>=s&&f>=l&&(p>0?null==a||a():null==t||t()):Math.abs(u)>=s&&h>=l&&(u>0?null==i||i():null==o||o()),c.current=null,x.current=null},[d,s,l,t,a,o,i]);r.useEffect(()=>{const r=e.current;if(r&&d)return r.addEventListener("touchstart",p,{passive:!0}),r.addEventListener("touchmove",u,{passive:!1}),r.addEventListener("touchend",g,{passive:!0}),()=>{r.removeEventListener("touchstart",p),r.removeEventListener("touchmove",u),r.removeEventListener("touchend",g)}},[e,d,p,u,g])}(l,{onSwipeLeft:_,onSwipeRight:$,enabled:!g&&!h&&!E.continuousScroll}),function(e){const{onNext:n,onPrevious:t,onFirst:a,onLast:o,onEscape:i,onToggleSettings:s,onToggleTOC:l,enabled:d=!0}=e,c=r.useCallback(e=>{if(d&&!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement))switch(e.key){case"ArrowRight":case"PageDown":case" ":" "===e.key&&e.preventDefault(),null==n||n();break;case"ArrowLeft":case"PageUp":null==t||t();break;case"Home":e.preventDefault(),null==a||a();break;case"End":e.preventDefault(),null==o||o();break;case"Escape":null==i||i();break;case"s":case"S":e.ctrlKey||e.metaKey||null==s||s();break;case"t":case"T":e.ctrlKey||e.metaKey||null==l||l()}},[d,n,t,a,o,i,s,l]);r.useEffect(()=>{if(d)return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[d,c])}({onNext:E.continuousScroll?void 0:_,onPrevious:E.continuousScroll?void 0:$,onFirst:Y,onLast:G,onEscape:()=>{g||h?(f(!1),m(!1)):p&&u(!1)},onToggleSettings:()=>{h||f(e=>!e)},onToggleTOC:()=>{g||m(e=>!e)},enabled:!0});const V=r.useMemo(()=>k<=1?100:Math.round((v+1)/k*100),[v,k]),J=0===v,Z=v>=k-1,Q={"--reader-font-size":N["--reader-font-size"],"--reader-line-height":N["--reader-line-height"],"--reader-bg":N["--reader-bg"],"--reader-text":N["--reader-text"],"--reader-secondary":N["--reader-secondary"],"--reader-border":N["--reader-border"],"--reader-accent":N["--reader-accent"],"--reader-font-family":N["--reader-font-family"],"--reader-margin":N["--reader-margin"],"--reader-text-align":N["--reader-text-align"]},ee="two"===E.columns?1200:650;return e.jsxs("div",{ref:l,className:`kindle-reader ${P}`,style:{position:"fixed",inset:0,background:"var(--reader-bg)",color:"var(--reader-text)",overflow:"hidden",touchAction:E.continuousScroll?"auto":"pan-y",...Q},children:[e.jsx(T,{title:a,chapterTitle:null==q?void 0:q.title,onBack:U,onToggleSettings:()=>f(!0),onToggleTOC:()=>m(!0),visible:p}),e.jsx("div",{className:"reader-content-area",style:{position:"fixed",top:p?"60px":"0",left:0,right:0,bottom:p?"50px":"0",display:"flex",justifyContent:"center",overflow:E.continuousScroll?"auto":"hidden",transition:"top 0.3s ease, bottom 0.3s ease",background:"var(--reader-bg)"},children:e.jsx("div",{ref:c,className:"reader-viewport",style:{width:"100%",maxWidth:`${ee}px`,height:"100%",overflow:"hidden",position:"relative"},children:e.jsx("div",{ref:x,className:"reader-columns",dangerouslySetInnerHTML:{__html:d(D)},style:{height:E.continuousScroll?"auto":"100%",padding:E.continuousScroll?"24px 48px":"24px 0",boxSizing:"border-box",columnGap:"two"===E.columns?"60px":"0",columnFill:"auto",columnWidth:E.continuousScroll?void 0:z>0?`${z}px`:void 0,transform:E.continuousScroll?"none":`translateX(-${v*S}px)`,transition:"transform 0.35s cubic-bezier(0.4, 0, 0.2, 1)",fontFamily:"var(--reader-font-family)",fontSize:"var(--reader-font-size)",lineHeight:"var(--reader-line-height)",color:"var(--reader-text)",textAlign:E.textAlign,hyphens:"justify"===E.textAlign?"auto":"none",WebkitHyphens:"justify"===E.textAlign?"auto":"none",wordBreak:"break-word"}})})}),!E.continuousScroll&&e.jsx(M,{onPrevious:$,onNext:_,onCenter:K,isFirstPage:J,isLastPage:Z,showArrows:p}),e.jsx(A,{currentPage:E.continuousScroll?0:v,totalPages:E.continuousScroll?1:k,percentComplete:V,visible:p,continuousScroll:E.continuousScroll}),e.jsx(L,{settings:E,updateSetting:F,resetSettings:W,onClose:()=>f(!1),visible:g}),e.jsx(B,{chapters:b,currentChapterId:null==q?void 0:q.id,onSelectChapter:X,onClose:()=>m(!1),visible:h}),e.jsx("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n\n        @keyframes slideUp {\n          from { transform: translateY(100%); }\n          to { transform: translateY(0); }\n        }\n\n        @keyframes slideRight {\n          from { transform: translateX(-100%); }\n          to { transform: translateX(0); }\n        }\n\n        .reader-nav-zone:hover .reader-nav-arrow {\n          opacity: 0.7 !important;\n        }\n\n        .reader-icon-button:hover {\n          background: var(--reader-border) !important;\n        }\n\n        /*\n          Reader content styles - Kindle-like typography\n          IMPORTANT: Visual margins are applied here to content elements,\n          NOT to the column container. This keeps columns aligned with pages.\n        */\n        .reader-columns {\n          letter-spacing: 0.01em;\n        }\n\n        /* Apply horizontal padding to all direct children and common elements */\n        .reader-columns > *,\n        .reader-columns p,\n        .reader-columns h1,\n        .reader-columns h2,\n        .reader-columns h3,\n        .reader-columns h4,\n        .reader-columns h5,\n        .reader-columns h6,\n        .reader-columns ul,\n        .reader-columns ol,\n        .reader-columns blockquote,\n        .reader-columns pre,\n        .reader-columns div {\n          padding-left: 32px;\n          padding-right: 32px;\n          box-sizing: border-box;\n        }\n\n        .reader-columns h1,\n        .reader-columns h2,\n        .reader-columns h3 {\n          color: var(--reader-text);\n          margin-top: 1.5em;\n          margin-bottom: 0.7em;\n          line-height: 1.3;\n          break-after: avoid;\n        }\n\n        .reader-columns h1:first-child,\n        .reader-columns h2:first-child,\n        .reader-columns h3:first-child {\n          margin-top: 0;\n        }\n\n        .reader-columns h1 {\n          font-size: 1.5em;\n          font-weight: 700;\n        }\n\n        .reader-columns h2 {\n          font-size: 1.3em;\n          font-weight: 600;\n        }\n\n        .reader-columns h3 {\n          font-size: 1.15em;\n          font-weight: 600;\n        }\n\n        .reader-columns p {\n          margin: 0 0 1em 0;\n          text-indent: 0;\n          orphans: 2;\n          widows: 2;\n        }\n\n        .reader-columns p + p {\n          text-indent: 1.5em;\n          margin-top: 0;\n        }\n\n        .reader-columns blockquote {\n          margin: 1em 0;\n          padding-top: 0.6em;\n          padding-bottom: 0.6em;\n          border-left: 3px solid var(--reader-border);\n          color: var(--reader-secondary);\n          font-style: italic;\n          margin-left: 32px;\n          padding-left: 1em;\n        }\n\n        .reader-columns a {\n          color: var(--reader-accent, var(--reader-text));\n          text-decoration: underline;\n          text-underline-offset: 2px;\n        }\n\n        .reader-columns img {\n          max-width: calc(100% - 64px);\n          height: auto;\n          margin: 1em auto;\n          display: block;\n        }\n\n        .reader-columns ul,\n        .reader-columns ol {\n          margin: 1em 0;\n          padding-left: calc(32px + 1.5em);\n        }\n\n        .reader-columns li {\n          margin-bottom: 0.3em;\n          padding-left: 0;\n          padding-right: 0;\n        }\n\n        .reader-columns hr {\n          border: none;\n          text-align: center;\n          margin: 1.5em 32px;\n          padding: 0;\n        }\n\n        .reader-columns hr::before {\n          content: \"* * *\";\n          color: var(--reader-secondary);\n          letter-spacing: 0.5em;\n        }\n\n        .reader-columns sup {\n          font-size: 0.75em;\n          vertical-align: super;\n          line-height: 0;\n        }\n\n        .reader-columns pre,\n        .reader-columns code {\n          font-family: 'SF Mono', Monaco, 'Consolas', monospace;\n          font-size: 0.85em;\n          background: rgba(128, 128, 128, 0.1);\n          border-radius: 4px;\n        }\n\n        .reader-columns pre {\n          padding-top: 0.8em;\n          padding-bottom: 0.8em;\n          overflow-x: auto;\n          margin: 1em 0;\n        }\n\n        .reader-columns code {\n          padding: 0.15em 0.35em;\n        }\n\n        .reader-columns pre code {\n          padding: 0;\n          background: none;\n        }\n\n        /* Scrollbar for continuous mode */\n        .reader-content-area::-webkit-scrollbar {\n          width: 8px;\n        }\n\n        .reader-content-area::-webkit-scrollbar-track {\n          background: transparent;\n        }\n\n        .reader-content-area::-webkit-scrollbar-thumb {\n          background: var(--reader-border);\n          border-radius: 4px;\n        }\n\n        .reader-content-area::-webkit-scrollbar-thumb:hover {\n          background: var(--reader-secondary);\n        }\n\n        /* Selection */\n        .reader-columns ::selection {\n          background: var(--reader-accent, #58a6ff);\n          color: white;\n        }\n      "})]})}function F({title:n,imageUrl:t,creator:a,onBack:o}){const[i,s]=r.useState(1),[l,d]=r.useState(!1),c=r.useRef(null),p=()=>s(e=>Math.min(e+.25,3)),u=()=>s(e=>Math.max(e-.25,.5)),f=()=>s(1);return r.useEffect(()=>{const e=()=>{d(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),r.useEffect(()=>{const e=e=>{"Escape"!==e.key||document.fullscreenElement?"+"===e.key||"="===e.key?p():"-"===e.key?u():"0"===e.key&&f():o()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[o]),e.jsxs("div",{ref:c,style:{position:"fixed",inset:0,background:"#0a0f1a",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 20px",background:"#111827",borderBottom:"1px solid #1f2937",zIndex:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:o,style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center",gap:8},children:e.jsx(x,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#f8fafc",fontSize:16,fontWeight:600},children:n}),e.jsxs("div",{style:{color:"#64748b",fontSize:13},children:["by ",a]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{onClick:u,disabled:i<=.5,style:{background:"#1f2937",border:"none",color:i<=.5?"#475569":"#94a3b8",cursor:i<=.5?"not-allowed":"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center"},title:"Zoom out (-)",children:e.jsx(v,{size:18})}),e.jsxs("span",{style:{color:"#94a3b8",fontSize:13,minWidth:50,textAlign:"center",cursor:"pointer"},onClick:f,title:"Reset zoom (0)",children:[Math.round(100*i),"%"]}),e.jsx("button",{onClick:p,disabled:i>=3,style:{background:"#1f2937",border:"none",color:i>=3?"#475569":"#94a3b8",cursor:i>=3?"not-allowed":"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center"},title:"Zoom in (+)",children:e.jsx(y,{size:18})}),e.jsx("div",{style:{width:1,height:24,background:"#334155",margin:"0 8px"}}),e.jsx("button",{onClick:()=>{var e;document.fullscreenElement?(document.exitFullscreen(),d(!1)):(null==(e=c.current)||e.requestFullscreen(),d(!0))},style:{background:"#1f2937",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center"},title:"Toggle fullscreen",children:e.jsx(h,{size:18})}),e.jsx("a",{href:t,download:!0,target:"_blank",rel:"noopener noreferrer",style:{background:"#1f2937",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,display:"flex",alignItems:"center",textDecoration:"none"},title:"Download",children:e.jsx(g,{size:18})})]})]}),e.jsx("div",{style:{flex:1,overflow:"auto",display:"flex",alignItems:"center",justifyContent:"center",padding:24},children:e.jsx("img",{src:t,alt:n,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",transform:`scale(${i})`,transition:"transform 0.2s ease",borderRadius:8,boxShadow:"0 8px 32px rgba(0,0,0,0.5)"},draggable:!1})}),e.jsxs("div",{style:{padding:"8px 20px",background:"#111827",borderTop:"1px solid #1f2937",textAlign:"center",color:"#64748b",fontSize:12},children:["Press ",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"+"})," /",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"-"})," to zoom,",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"0"})," to reset,",e.jsx("kbd",{style:{background:"#1f2937",padding:"2px 6px",borderRadius:4,marginInline:4},children:"Esc"})," to go back"]})]})}function W({title:r,contentType:n,creator:t,onBack:a}){return e.jsxs("div",{style:{position:"fixed",inset:0,background:"#0a0f1a",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:24},children:[e.jsxs("button",{onClick:a,style:{position:"absolute",top:20,left:20,background:"#1f2937",border:"none",color:"#94a3b8",cursor:"pointer",padding:"8px 16px",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx(x,{size:18}),"Back"]}),e.jsxs("div",{style:{textAlign:"center",maxWidth:400},children:[e.jsx("div",{style:{width:80,height:80,background:"#1f2937",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",fontSize:32},children:"music"===n?"ðŸŽµ":"ðŸŽ¬"}),e.jsx("h2",{style:{color:"#f8fafc",fontSize:24,marginBottom:8},children:r}),e.jsxs("p",{style:{color:"#64748b",marginBottom:4},children:["by ",t]}),e.jsxs("p",{style:{color:"#94a3b8",marginTop:16},children:["music"===n?"Music":"Film"," playback coming soon"]})]})]})}function N(){const{contentId:a}=t(),o=n(),[i,s]=r.useState(null),[d,x]=r.useState(!0),[p,u]=r.useState(null),g=r.useRef(null);r.useEffect(()=>{if(!a)return;return(async()=>{try{x(!0),u(null);const e=await l.getFullContent(parseInt(a));s(e)}catch(e){u(e instanceof Error?e.message:"Failed to load content")}finally{x(!1)}})(),()=>{g.current&&clearTimeout(g.current)}},[a]),r.useCallback((e,r)=>{if(!a)return;const n=r>1?(e+1)/r*100:100;g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{l.updateProgress(parseInt(a),n,JSON.stringify({page:e,totalPages:r})).catch(e=>{})},2e3)},[a]);const f=r.useCallback(()=>{o(-1)},[o]);if(d)return e.jsxs("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",color:"#94a3b8",fontSize:16},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:40,height:40,border:"3px solid #1f2937",borderTopColor:"#f59e0b",borderRadius:"50%",margin:"0 auto 16px",animation:"spin 1s linear infinite"}}),"Loading content..."]}),e.jsx("style",{children:"\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        "})]});if(p||!i)return e.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",padding:24},children:e.jsxs("div",{style:{maxWidth:400,background:"#ef444420",border:"1px solid #ef4444",borderRadius:12,padding:24,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#fca5a5",marginBottom:8},children:p||"Content not found"}),e.jsx("div",{style:{fontSize:14,color:"#94a3b8",marginBottom:16},children:"You may not have access to this content."}),e.jsx("button",{onClick:()=>o("/"),style:{background:"#f59e0b",color:"#111827",padding:"10px 20px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},children:"Go to Home"})]})});if("art"===i.content_type)return i.teaser_link?e.jsx(F,{title:i.title,imageUrl:i.teaser_link,creator:i.creator,onBack:f}):e.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#0a0f1a",padding:24},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:"ðŸŽ¨"}),e.jsx("div",{style:{color:"#f8fafc",fontSize:20,fontWeight:600,marginBottom:8},children:i.title}),e.jsx("div",{style:{color:"#94a3b8",marginBottom:24},children:"Image not available"}),e.jsx("button",{onClick:f,style:{background:"#f59e0b",color:"#111827",padding:"10px 20px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},children:"Go Back"})]})});if("music"===i.content_type||"film"===i.content_type)return e.jsx(W,{title:i.title,contentType:i.content_type,creator:i.creator,onBack:f});const h=c.sanitize(i.content_html,{ALLOWED_TAGS:["p","br","strong","em","u","i","b","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","pre","code","a","img","div","span"],ALLOWED_ATTR:["href","src","alt","title","class","id"],FORBID_TAGS:["script","style","iframe","object","embed","form","input"],FORBID_ATTR:["onerror","onclick","onload","onmouseover"],ALLOW_DATA_ATTR:!1});return e.jsx(E,{contentId:a||"",title:i.title,htmlContent:h,onBack:f})}r.forwardRef(({htmlContent:r,cssVars:n},t)=>e.jsx("div",{ref:t,className:"reader-content-container",style:{position:"fixed",top:"60px",left:0,right:0,bottom:"50px",overflow:"hidden",padding:"20px 24px",boxSizing:"border-box",background:"var(--reader-bg)",...n},children:e.jsx("div",{className:"reader-content",dangerouslySetInnerHTML:{__html:d(r)},style:{height:"100%",columnWidth:"100vw",columnGap:"48px",columnFill:"auto",fontFamily:"var(--reader-font-family)",fontSize:"var(--reader-font-size)",lineHeight:"var(--reader-line-height)",color:"var(--reader-text)",textAlign:"justify",hyphens:"auto",wordBreak:"break-word",overflowX:"hidden",overflowY:"hidden"}})})).displayName="ReaderContent";export{N as ReaderPage};
//# sourceMappingURL=ReaderPage-D_hxgTEl.js.map
