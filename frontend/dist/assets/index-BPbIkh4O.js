const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-BksgpWMm.js","assets/web3auth-BGmWjNJV.js","assets/router-CzH47hF_.js","assets/vendor-Cfs_Iq82.js","assets/VideoCard-Ttt5y9o_.js","assets/eye-Ble6fBLi.js","assets/star-DRO2iioZ.js","assets/thumbs-up-gjG5_mxA.js","assets/book-open-DnhKMfQ0.js","assets/chevron-up-BcfekGbc.js","assets/SearchPage-DCEUtc2R.js","assets/StudioPage-NnLvFEqW.js","assets/quill.snow-BbG6kXaY.js","assets/quill-CkbfgUCq.css","assets/plus-DVe0rGCI.js","assets/file-text-CPC4YXgV.js","assets/PreviewModal-B9Hn9aVj.js","assets/sanitize-MG3ZWMPS.js","assets/socialApi-4T9qhOxC.js","assets/pen-D2IlY0Ac.js","assets/send-C1FLS1V2.js","assets/triangle-alert-C-zOCDLb.js","assets/twitter-D8hAfkMm.js","assets/external-link-D_F3q4nq.js","assets/StudioPage-CicczrQ-.css","assets/DashboardPage-CiU7BFi1.js","assets/ProfilePageRedesigned-BCODPoQ7.js","assets/user-check-BUMZ8f8F.js","assets/settings-BSikCcl6.js","assets/circle-alert-DOT81D6c.js","assets/map-pin-DTV7s3IB.js","assets/palette-CWrrLmCU.js","assets/film-QkQKGFtv.js","assets/AuthPage-C_EkhT9c.js","assets/WalletInfoPage-B-se9e1j.js","assets/BetaLanding-BHmxc8Ru.js","assets/sparkles-DO9KLSbx.js","assets/heart-c1p7IrTw.js","assets/BetaLanding-BhmzUrnj.css","assets/CollaboratorsPage-DO5EvXEA.js","assets/InviteModal-BZ7SI2YT.js","assets/video-B0pzEJwM.js","assets/PublicProfilePage-DQ4cpnnE.js","assets/RatingForm-BtYp4dNa.js","assets/book-CaULKz65.js","assets/ContentDetail-GWRiY_Ev.js","assets/arrow-left-BaXiqX2Q.js","assets/PurchaseSuccessPage-D2WdKN1v.js","assets/ReaderPage-vVRludcH.js","assets/CollaborationDashboard-BW6XdGg4.js","assets/CollaborativeProjectPage-Bv4pQ3Wu.js","assets/NotificationsPage-CPutmDqX.js","assets/FollowingFeedPage-BpzZs80f.js","assets/TermsOfServicePage-BwdxyyW5.js","assets/LegalPageLayout-DsJD7Q13.js","assets/PrivacyPolicyPage-K4V0qBLn.js","assets/ContentPolicyPage-3x6N8spa.js","assets/DMCAPolicyPage-DhfkLGiD.js","assets/CreatorAgreementPage-ue9NoAAQ.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,n,i)=>((t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i)(t,"symbol"!=typeof n?n+"":n,i);import{B as n,p as i,e as o,j as r,_ as a,R as s}from"./web3auth-BGmWjNJV.js";import{r as l,L as c,u as d,N as p,a as u,R as h,b as g,c as f,B as x}from"./router-CzH47hF_.js";import"./vendor-Cfs_Iq82.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const y="undefined"!=typeof globalThis?globalThis:window;if(y.global||(y.global=y),y.Buffer||(y.Buffer=n),y.process||(y.process=i),y.process&&!y.process.on){const e=new o.EventEmitter;y.process.on=e.on.bind(e),y.process.once=e.once.bind(e),y.process.off=e.off.bind(e),y.process.emit=e.emit.bind(e),y.process.removeListener=e.removeListener.bind(e),y.process.removeAllListeners=e.removeAllListeners.bind(e),y.process.listeners=e.listeners.bind(e)}y.process.env||(y.process.env={});const m="https://api.renaissblock.com";const b={async getLibrary(){const e=await fetch(`${m}/api/library/`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch library: ${e.statusText}`);return e.json()},async getFullContent(e){const t=await fetch(`${m}/api/content/${e}/full/`,{method:"GET",credentials:"include"});if(!t.ok){if(403===t.status)throw new Error("You do not own this content");throw new Error(`Failed to fetch content: ${t.statusText}`)}return t.json()},async updateProgress(e,t,n=""){const i=await async function(){try{const e=await fetch(`${m}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch(e){return""}}(),o=await fetch(`${m}/api/reading-progress/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":i,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({content_id:e,progress_percentage:t,last_position:n})});if(!o.ok)throw new Error(`Failed to update progress: ${o.statusText}`);return o.json()},async getProgress(e){const t=await fetch(`${m}/api/reading-progress/${e}/`,{method:"GET",credentials:"include"});if(!t.ok)throw new Error(`Failed to fetch progress: ${t.statusText}`);return t.json()},async getAllProgress(){const e=await fetch(`${m}/api/reading-progress/`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch all progress: ${e.statusText}`);return e.json()}};const j=l.memo(function({item:e,onClick:t}){const n=Math.round(e.progress);return r.jsxs(c,{to:`/reader/${e.id}`,className:"library-item-card",onClick:t,style:{display:"flex",gap:12,padding:12,background:"#0b1220",border:"1px solid #2a3444",borderRadius:8,textDecoration:"none",color:"inherit",transition:"all 0.2s ease",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.background="#111827",e.currentTarget.style.borderColor="#374151"},onMouseLeave:e=>{e.currentTarget.style.background="#0b1220",e.currentTarget.style.borderColor="#2a3444"},children:[r.jsxs("div",{style:{position:"relative",width:80,height:80,flexShrink:0,borderRadius:6,overflow:"hidden",background:"#0e1320"},children:[r.jsx("img",{src:e.thumbnail||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="80" height="80"%3E%3Crect fill="%23111827" width="80" height="80"/%3E%3Ctext fill="%2394a3b8" font-family="sans-serif" font-size="12" x="50%25" y="50%25" text-anchor="middle" dominant-baseline="middle"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E',alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="80" height="80"%3E%3Crect fill="%23111827" width="80" height="80"/%3E%3Ctext fill="%2394a3b8" font-family="sans-serif" font-size="12" x="50%25" y="50%25" text-anchor="middle" dominant-baseline="middle"%3E%F0%9F%93%96%3C/text%3E%3C/svg%3E'}}),e.progress>0&&r.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:4,background:"rgba(0,0,0,0.5)"},children:r.jsx("div",{style:{height:"100%",width:`${e.progress}%`,background:"#f59e0b",transition:"width 0.3s ease"}})})]}),r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",minWidth:0},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600,fontSize:14,color:"#e5e7eb",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8"},children:e.creator})]}),r.jsx("div",{style:{fontSize:11,color:"#10b981",fontWeight:600},children:n>0?`${n}% complete`:"Not started"})]})]})}),v=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},k=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),S=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var w={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=l.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:o="",children:r,iconNode:a,...s},c)=>l.createElement("svg",{ref:c,...w,width:t,height:t,stroke:e,strokeWidth:i?24*Number(n)/Number(t):n,className:k("lucide",o),...!r&&!S(s)&&{"aria-hidden":"true"},...s},[...a.map(([e,t])=>l.createElement(e,t)),...Array.isArray(r)?r:[r]])),T=(e,t)=>{const n=l.forwardRef(({className:n,...i},o)=>{return l.createElement(C,{ref:o,iconNode:t,className:k(`lucide-${r=v(e),r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...i});var r});return n.displayName=v(e),n},_=T("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),R=T("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),z=T("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),E=T("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),P=T("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),$=T("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),I=T("file-pen",[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]]),L=T("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),W=T("mail-open",[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]]),A=T("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),M=T("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),X=T("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),N=T("party-popper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]),B=T("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),O=T("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),D=T("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),q=T("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),F=()=>{const[e,t]=l.useState({user:null,loading:!0,isAuthenticated:!1}),n=l.useCallback(async()=>{try{const e=await fetch(`${m}/api/auth/status/`,{credentials:"include"});if(!e.ok)return void t({user:null,loading:!1,isAuthenticated:!1});const n=await e.json();(null==n?void 0:n.authenticated)&&(null==n?void 0:n.user)?t({user:n.user,loading:!1,isAuthenticated:!0}):t({user:null,loading:!1,isAuthenticated:!1})}catch(e){t({user:null,loading:!1,isAuthenticated:!1})}},[]),i=l.useCallback(async()=>{try{const e=await fetch(`${m}/api/auth/csrf/`,{credentials:"include"}),n=await e.json(),i=(null==n?void 0:n.csrfToken)||"";await fetch(`${m}/api/auth/logout/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":i,"X-Requested-With":"XMLHttpRequest"}}),t({user:null,loading:!1,isAuthenticated:!1})}catch(e){}},[]),o=l.useCallback(()=>{t(e=>({...e,loading:!0})),n()},[n]);return l.useEffect(()=>{n()},[n]),{user:e.user,loading:e.loading,isAuthenticated:e.isAuthenticated,logout:i,refreshAuth:o}};
/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function H(){const[e,t]=l.useState(null),[n,i]=l.useState(!0),[o,a]=l.useState(null),[s,d]=l.useState(!0),[p,u]=l.useState("books"),{isAuthenticated:h}=F();l.useEffect(()=>{h?g():(t(null),i(!1),a(null))},[h]);const g=async()=>{try{i(!0),a(null);const e=await b.getLibrary();t(e)}catch(e){a(e instanceof Error?e.message:"Failed to load library")}finally{i(!1)}};if(!h)return null;if(!s)return r.jsxs("div",{style:{position:"fixed",left:0,top:72,bottom:0,width:48,background:"#0b1220",borderRight:"1px solid #2a3444",display:"flex",flexDirection:"column",alignItems:"center",padding:"12px 0",zIndex:40},children:[r.jsx("button",{onClick:()=>d(!0),style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#111827",e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},"aria-label":"Expand library",children:r.jsx(z,{size:20})}),r.jsx("div",{style:{writingMode:"vertical-rl",fontSize:12,fontWeight:600,color:"#94a3b8",marginTop:16},children:"LIBRARY"})]});const f=e?Object.values(e).reduce((e,t)=>e+t.length,0):0,x=(null==e?void 0:e[p])||[];return r.jsxs("div",{style:{position:"fixed",left:0,top:72,bottom:0,width:320,background:"#0b1220",borderRight:"1px solid #2a3444",display:"flex",flexDirection:"column",zIndex:40,transition:"width 0.3s ease"},children:[r.jsxs("div",{style:{padding:16,borderBottom:"1px solid #2a3444",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#e5e7eb"},children:"My Library"}),r.jsxs("div",{style:{fontSize:12,color:"#94a3b8",marginTop:2},children:[f," ",1===f?"item":"items"]})]}),r.jsx("button",{onClick:()=>d(!1),style:{background:"transparent",border:"none",color:"#94a3b8",cursor:"pointer",padding:8,borderRadius:8,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#111827",e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},"aria-label":"Collapse library",children:r.jsx(R,{size:20})})]}),r.jsx("div",{style:{display:"flex",gap:4,padding:"12px 16px",borderBottom:"1px solid #2a3444",overflowX:"auto"},children:["books","art","film","music"].map(t=>{var n;const i=(null==(n=null==e?void 0:e[t])?void 0:n.length)||0,o=p===t;return r.jsxs("button",{onClick:()=>u(t),style:{background:o?"#f59e0b":"#111827",border:"1px solid",borderColor:o?"#f59e0b":"#2a3444",color:o?"#111827":"#cbd5e1",padding:"6px 12px",borderRadius:18,fontSize:12,fontWeight:600,cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.2s ease"},onMouseEnter:e=>{o||(e.currentTarget.style.background="#1f2937",e.currentTarget.style.borderColor="#374151")},onMouseLeave:e=>{o||(e.currentTarget.style.background="#111827",e.currentTarget.style.borderColor="#2a3444")},children:[t.charAt(0).toUpperCase()+t.slice(1)," (",i,")"]},t)})}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:16},children:[n&&r.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8",fontSize:14},children:"Loading library..."}),o&&r.jsxs("div",{style:{background:"#ef444420",border:"1px solid #ef4444",borderRadius:8,padding:16,color:"#fca5a5",fontSize:14},children:[o,r.jsx("button",{onClick:g,style:{marginTop:8,background:"#ef4444",color:"#fff",padding:"6px 12px",fontSize:12},children:"Retry"})]}),!n&&!o&&0===x.length&&r.jsxs("div",{style:{textAlign:"center",padding:32,color:"#94a3b8",fontSize:14},children:["No ",p," in your library yet."]}),!n&&!o&&x.length>0&&r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:x.map(e=>r.jsx(j,{item:e},e.id))})]}),r.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #2a3444",flexShrink:0},children:[r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px 12px",marginBottom:8},children:[r.jsx(c,{to:"/legal/terms",style:V,children:"Terms"}),r.jsx(c,{to:"/legal/privacy",style:V,children:"Privacy"}),r.jsx(c,{to:"/legal/content-policy",style:V,children:"Content Policy"}),r.jsx(c,{to:"/legal/dmca",style:V,children:"DMCA"})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px 12px",marginBottom:10},children:[r.jsx("a",{href:"mailto:support@renaissblock.com",style:V,children:"Contact"}),r.jsx("a",{href:"mailto:dmca@renaissblock.com",style:V,children:"Report Copyright"})]}),r.jsxs("div",{style:{fontSize:11,color:"#64748b"},children:["Â© ",(new Date).getFullYear()," renaissBlock"]})]})]})}const V={fontSize:11,color:"#64748b",textDecoration:"none",transition:"color 0.2s"};function J({children:e}){const[t,n]=l.useState(null),i=d();l.useEffect(()=>{o()},[]);const o=async()=>{try{const e=await fetch(`${m}/api/auth/status/`,{credentials:"include"}),t=await e.json();n(!!(null==t?void 0:t.authenticated))}catch{n(!1)}};return null===t?r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"60vh",color:"#94a3b8",fontSize:16},children:"Checking authentication..."}):t?r.jsx(r.Fragment,{children:e}):r.jsx(p,{to:"/auth",state:{from:i},replace:!0})}class Y extends l.Component{constructor(e){super(e),t(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})}),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?this.props.fallback?this.props.fallback:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px",padding:"40px",textAlign:"center",color:"var(--text, #e5e7eb)"},children:[r.jsx("h2",{style:{marginBottom:"16px",color:"var(--text, #e5e7eb)"},children:"Something went wrong"}),r.jsx("p",{style:{marginBottom:"24px",color:"var(--text-muted, #94a3b8)"},children:"An error occurred while loading this section."}),r.jsx("button",{onClick:this.handleRetry,style:{padding:"10px 24px",background:"var(--accent, #f59e0b)",color:"#111",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Try Again"})]}):this.props.children}}const G={notifications:[],unreadCount:0,lastChecked:null,isPolling:!1,lastError:null,knownNotificationIds:new Set,initialLoadComplete:!1},U={POLLING_INTERVAL:3e4,MAX_RETRIES:3,RETRY_DELAY:5e3};async function Z(){try{const e=await fetch(`${m}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch(e){return""}}async function K(e,t={}){const n=e.startsWith("/")?`${m}${e}`:e,i=await fetch(n,{credentials:"include",headers:{"Content-Type":"application/json",...t.headers},...t});if(!i.ok){const e=await i.json().catch(()=>({}));throw new Error((null==e?void 0:e.error)||`API request failed: ${i.status}`)}return i.json()}async function Q(){try{const e=await K("/api/notifications/");return G.notifications=e,G.unreadCount=e.filter(e=>!e.read).length,G.lastChecked=new Date,G.lastError=null,e.forEach(e=>G.knownNotificationIds.add(e.id)),ae.emit("notifications:updated",{notifications:e,unreadCount:G.unreadCount}),e}catch(e){throw G.lastError=e,e}}let ee=null,te=0,ne=null;async function ie(){if(G.isPolling)try{const e=new Set(G.knownNotificationIds);if(await Q(),G.initialLoadComplete){const t=G.notifications.filter(t=>!e.has(t.id)&&!t.read);t.length>0&&ae.emit("notifications:new",{notifications:t,count:t.length})}else G.initialLoadComplete=!0;te=0}catch(e){te++,te>=U.MAX_RETRIES?(re(),ae.emit("notifications:polling-error",{error:e,retryCount:te})):(ne&&clearTimeout(ne),ne=setTimeout(()=>{ie()},U.RETRY_DELAY))}}function oe(){G.isPolling||(G.isPolling=!0,te=0,ie(),ee=setInterval(ie,U.POLLING_INTERVAL),ae.emit("notifications:polling-started",{}))}function re(){G.isPolling&&(G.isPolling=!1,ee&&(clearInterval(ee),ee=null),ne&&(clearTimeout(ne),ne=null),ae.emit("notifications:polling-stopped",{}))}const ae=new class{constructor(){t(this,"listeners",new Map)}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>this.off(e,t)}off(e,t){const n=this.listeners.get(e);n&&n.delete(t)}emit(e,t){const n=this.listeners.get(e);n&&n.forEach(e=>{try{e(t)}catch(n){}})}clear(){this.listeners.clear()}};function se(e){const t=new Date(e),n=new Date,i=Math.floor((n.getTime()-t.getTime())/1e3);return i<60?"just now":i<3600?`${Math.floor(i/60)}m ago`:i<86400?`${Math.floor(i/3600)}h ago`:i<604800?`${Math.floor(i/86400)}d ago`:t.toLocaleDateString()}function le(e){return{invitation:"ðŸ“¬",invitation_response:"âœ‰ï¸",comment:"ðŸ’¬",approval:"âœ…",section_update:"ðŸ“",revenue_proposal:"ðŸ’°",mint_ready:"ðŸŽ‰"}[e]||"ðŸ””"}function ce(e){return{invitation:"#3b82f6",invitation_response:"#8b5cf6",comment:"#06b6d4",approval:"#10b981",section_update:"#f59e0b",revenue_proposal:"#eab308",mint_ready:"#ec4899"}[e]||"#6b7280"}const de={getNotifications:Q,getUnreadNotifications:async function(){return(await Q()).filter(e=>!e.read)},getUnreadCount:async function(){try{const e=(await Q()).filter(e=>!e.read).length;return G.unreadCount=e,ae.emit("notifications:unread-count",{count:e}),e}catch(e){return G.unreadCount}},markNotificationRead:async function(e){try{const t=await Z();await K(`/api/notifications/${e}/mark-read/`,{method:"POST",headers:{"X-CSRFToken":t}});const n=G.notifications.find(t=>t.id===e);n&&!n.read&&(n.read=!0,G.unreadCount=Math.max(0,G.unreadCount-1),ae.emit("notifications:updated",{notifications:G.notifications,unreadCount:G.unreadCount}),ae.emit("notifications:unread-count",{count:G.unreadCount}))}catch(t){throw t}},markAllNotificationsRead:async function(){try{const e=await Z();await K("/api/notifications/mark-all-read/",{method:"POST",headers:{"X-CSRFToken":e}}),G.notifications.forEach(e=>e.read=!0),G.unreadCount=0,ae.emit("notifications:updated",{notifications:G.notifications,unreadCount:0}),ae.emit("notifications:unread-count",{count:0})}catch(e){throw e}},deleteNotification:async function(e){const t=()=>{const t=G.notifications.findIndex(t=>t.id===e);if(-1!==t){const n=!G.notifications[t].read;G.notifications.splice(t,1),n&&(G.unreadCount=Math.max(0,G.unreadCount-1)),G.knownNotificationIds.delete(e),ae.emit("notifications:updated",{notifications:G.notifications,unreadCount:G.unreadCount}),ae.emit("notifications:unread-count",{count:G.unreadCount})}};try{const n=await Z(),i=`${m}/api/notifications/${e}/`,o=await fetch(i,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":n}});if(404===o.status)return void t();if(!o.ok)throw new Error(`Failed to delete notification: ${o.status}`);t()}catch(n){throw t(),n}},getNotificationStats:async function(){const e=await Q(),t={total:e.length,unread:e.filter(e=>!e.read).length,by_type:{invitation:0,invitation_response:0,comment:0,approval:0,section_update:0,revenue_proposal:0,mint_ready:0}};return e.forEach(e=>{t.by_type[e.type]=(t.by_type[e.type]||0)+1}),t},startPolling:oe,stopPolling:re,isPolling:function(){return G.isPolling},setPollingInterval:function(e){U.POLLING_INTERVAL=e,G.isPolling&&(re(),oe())},getState:function(){return{...G}},getCachedNotifications:function(){return[...G.notifications]},getCachedUnreadCount:function(){return G.unreadCount},reset:function(){re(),G.notifications=[],G.unreadCount=0,G.lastChecked=null,G.lastError=null,G.knownNotificationIds.clear(),G.initialLoadComplete=!1,ae.clear()},events:ae,getTimeAgo:se,getNotificationIcon:le,getNotificationColor:ce};function pe(e={}){const{autoStart:t=!1,onNewNotification:n}=e,[i,o]=l.useState([]),[r,a]=l.useState(0),[s,c]=l.useState(!1),[d,p]=l.useState(!1),[u,h]=l.useState(null),g=l.useCallback(async()=>{c(!0),h(null);try{const e=await de.getNotifications();o(e),a(e.filter(e=>!e.read).length)}catch(e){h(e)}finally{c(!1)}},[]),f=l.useCallback(async e=>{try{await de.markNotificationRead(e)}catch(t){throw h(t),t}},[]),x=l.useCallback(async()=>{try{await de.markAllNotificationsRead()}catch(e){throw h(e),e}},[]),y=l.useCallback(async e=>{try{await de.deleteNotification(e)}catch(t){}},[]),m=l.useCallback(()=>{de.startPolling(),p(!0)},[]),b=l.useCallback(()=>{de.stopPolling(),p(!1)},[]),j=l.useCallback(async()=>{try{return await de.getNotificationStats()}catch(e){throw h(e),e}},[]);return l.useEffect(()=>{const e=ae.on("notifications:updated",({notifications:e,unreadCount:t})=>{o(e),a(t)}),t=ae.on("notifications:unread-count",({count:e})=>{a(e)}),i=ae.on("notifications:new",({notifications:e})=>{n&&n(e)}),r=ae.on("notifications:polling-started",()=>{p(!0)}),s=ae.on("notifications:polling-stopped",()=>{p(!1)}),l=ae.on("notifications:polling-error",({error:e})=>{h(e),p(!1)});return()=>{e(),t(),i(),r(),s(),l()}},[n]),l.useEffect(()=>(t&&(m(),g()),()=>{t&&b()}),[t,m,b,g]),{notifications:i,unreadCount:r,isLoading:s,isPolling:d,error:u,refresh:g,markAsRead:f,markAllAsRead:x,deleteNotification:y,startPolling:m,stopPolling:b,getStats:j}}const ue=l.memo(function({notification:e,onClick:t,onDelete:n,onViewInvite:i}){const o=function(e){const t={size:20};switch(e){case"invitation":return r.jsx(A,{...t});case"invitation_response":return r.jsx(W,{...t});case"comment":return r.jsx(X,{...t});case"approval":return r.jsx(E,{...t});case"section_update":return r.jsx(I,{...t});case"revenue_proposal":return r.jsx($,{...t});case"mint_ready":return r.jsx(N,{...t});default:return r.jsx(_,{...t})}}(e.type),a=ce(e.type),s=se(e.created_at),l="invitation"===e.type;return r.jsxs("div",{onClick:t,role:"button",tabIndex:0,"aria-label":`${e.read?"Read":"Unread"} notification: ${e.title}`,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t())},style:{padding:"12px 20px",cursor:"pointer",background:e.read?"transparent":"#0b1220",borderLeft:`3px solid ${e.read?"transparent":a}`,transition:"all 0.2s",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b"},onMouseLeave:t=>{t.currentTarget.style.background=e.read?"transparent":"#0b1220"},children:[r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsx("div",{style:{width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:`${a}20`,borderRadius:8,flexShrink:0,color:a},"aria-hidden":"true",children:o}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#e5e7eb",marginBottom:4,lineHeight:1.4},children:e.title}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginBottom:6,lineHeight:1.5},children:e.message}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:11,color:"#64748b"},children:[r.jsxs("span",{children:["@",e.from_user.username]}),r.jsx("span",{children:"â€¢"}),r.jsx("span",{children:s})]}),l&&i&&r.jsx("button",{onClick:t=>{t.stopPropagation(),i(e)},style:{marginTop:10,background:"#f59e0b",color:"#000",border:"none",padding:"8px 16px",borderRadius:6,fontSize:12,fontWeight:700,cursor:"pointer",display:"flex",alignItems:"center",gap:6,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#fbbf24"},onMouseLeave:e=>{e.currentTarget.style.background="#f59e0b"},children:"View Invite â†’"})]}),r.jsx("button",{onClick:n,"aria-label":"Delete notification",style:{background:"transparent",border:"none",color:"#64748b",cursor:"pointer",padding:4,borderRadius:4,fontSize:18,width:28,height:28,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,opacity:.6,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b",e.currentTarget.style.color="#ef4444",e.currentTarget.style.opacity="1"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#64748b",e.currentTarget.style.opacity="0.6"},children:"Ã—"})]}),!e.read&&r.jsx("div",{"aria-label":"Unread",style:{position:"absolute",top:18,right:20,width:8,height:8,background:a,borderRadius:"50%",boxShadow:`0 0 8px ${a}`}})]})});async function he(){try{const e=await fetch(`${m}/api/auth/csrf/`,{credentials:"include"}),t=await e.json();return(null==t?void 0:t.csrfToken)||""}catch(e){return""}}async function ge(e){if(!e.ok){let t=`Request failed: ${e.statusText}`;try{const n=await e.json();n.error?t=n.error:n.detail&&(t=n.detail)}catch{}throw new Error(t)}return e.json()}const fe={async createCollaborativeProject(e){const t=await he();return ge(await fetch(`${m}/api/collaborative-projects/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)}))},getCollaborativeProjects:async()=>ge(await fetch(`${m}/api/collaborative-projects/`,{method:"GET",credentials:"include"})),getCollaborativeProject:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/`,{method:"GET",credentials:"include"})),getPendingInvites:async()=>ge(await fetch(`${m}/api/collaborative-projects/pending_invites/`,{method:"GET",credentials:"include"})),updateCollaborativeProject:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),async deleteCollaborativeProject(e){const t=await fetch(`${m}/api/collaborative-projects/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete project: ${t.statusText}`)},inviteCollaborator:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/invite_collaborator/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),acceptInvitation:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/accept_invitation/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),declineInvitation:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/decline_invitation/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),counterProposeInvite:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/counter_propose/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),proposeRevenueSplit:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/propose_revenue_split/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({splits:t})})),approveCurrentVersion:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/approve_version/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),async getApprovalStatus(e){const t=await this.getCollaborativeProject(e),n=t.collaborators.filter(e=>!("accepted"!==e.status||e.approved_current_version&&e.approved_revenue_split)).map(e=>e.username);return{is_fully_approved:t.is_fully_approved,pending_approvals:n}},getProjectPreview:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/preview/`,{method:"GET",credentials:"include"})),async createProjectSection(e){const t=new FormData;t.append("project",e.project.toString()),t.append("section_type",e.section_type),t.append("title",e.title),e.content_html&&t.append("content_html",e.content_html),e.media_file&&t.append("media_file",e.media_file),void 0!==e.order&&t.append("order",e.order.toString());return ge(await fetch(`${m}/api/project-sections/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:t}))},async updateProjectSection(e,t){const n=new FormData;t.section_type&&n.append("section_type",t.section_type),t.title&&n.append("title",t.title),void 0!==t.content_html&&n.append("content_html",t.content_html),t.media_file&&n.append("media_file",t.media_file),void 0!==t.order&&n.append("order",t.order.toString());return ge(await fetch(`${m}/api/project-sections/${e}/`,{method:"PATCH",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:n}))},async deleteProjectSection(e){const t=await fetch(`${m}/api/project-sections/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete section: ${t.statusText}`)},getProjectSections:async e=>ge(await fetch(`${m}/api/project-sections/?project=${e}`,{method:"GET",credentials:"include"})),async addComment(e){if(e.attachments&&e.attachments.length>0){const t=new FormData;t.append("project",e.project.toString()),t.append("content",e.content),e.section&&t.append("section",e.section.toString()),e.parent_comment&&t.append("parent_comment",e.parent_comment.toString()),e.mentions&&t.append("mentions",JSON.stringify(e.mentions)),e.attachments.forEach((e,n)=>{t.append(`attachment_${n}`,e)});return ge(await fetch(`${m}/api/project-comments/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:t}))}return ge(await fetch(`${m}/api/project-comments/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)}))},async getComments(e,t){let n=`${m}/api/project-comments/?project=${e}`;t&&(n+=`&section=${t}`);return ge(await fetch(n,{method:"GET",credentials:"include"}))},resolveComment:async e=>ge(await fetch(`${m}/api/project-comments/${e}/resolve/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),unresolveComment:async e=>ge(await fetch(`${m}/api/project-comments/${e}/unresolve/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),updateComment:async(e,t)=>ge(await fetch(`${m}/api/project-comments/${e}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({content:t})})),async deleteComment(e){const t=await fetch(`${m}/api/project-comments/${e}/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`Failed to delete comment: ${t.statusText}`)},addReaction:async(e,t)=>ge(await fetch(`${m}/api/project-comments/${e}/add-reaction/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({emoji:t})})),async removeReaction(e,t){const n=await fetch(`${m}/api/project-comments/${e}/remove-reaction/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({reaction_id:t})});if(!n.ok)throw new Error(`Failed to remove reaction: ${n.statusText}`)},getCommentThread:async e=>ge(await fetch(`${m}/api/project-comments/${e}/thread/`,{method:"GET",credentials:"include"})),async getCommentsBySection(e,t=!1){let n=`${m}/api/project-comments/by-section/?project=${e}`;t&&(n+="&include_resolved=true");return ge(await fetch(n,{method:"GET",credentials:"include"}))},async getUnresolvedCommentCount(e){return(await this.getComments(e)).filter(e=>!e.resolved).length},requestApproval:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/request_approval/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),approveProject:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/approve_project/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),setPrice:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/set_price/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({price_usd:t})})),updateCustomization:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/update_customization/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),mintProject:async(e,t=!1)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/mint/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({force_mint:t})})),getMintingStatus:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/minting-status/`,{method:"GET",credentials:"include"})),cancelApproval:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/cancel_approval/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),getProposals:async e=>ge(await fetch(`${m}/api/collaborative-projects/${e}/proposals/`,{method:"GET",credentials:"include"})),createProposal:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/proposals/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)})),castVote:async(e,t,n)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/proposals/${t}/vote/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(n)})),cancelProposal:async(e,t)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/proposals/${t}/cancel/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"}})),rateCollaborator:async(e,t,n)=>ge(await fetch(`${m}/api/collaborative-projects/${e}/rate_collaborator/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":await he(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({rated_user_id:t,...n})})),getUserRatings:async e=>ge(await fetch(`${m}/api/users/${e}/ratings/`,{method:"GET",credentials:"include"}))};function xe({open:e,onClose:t,projectId:n,notificationMessage:i}){const o=u(),[a,s]=l.useState(!0),[c,d]=l.useState(null),[p,h]=l.useState(null),[g,f]=l.useState("view"),[x,y]=l.useState(50),[m,b]=l.useState(""),[j,v]=l.useState(!1),[k,S]=l.useState(""),[w,C]=l.useState("");if(l.useEffect(()=>{if(!e||!n)return;(async()=>{s(!0),S("");try{const e=await fe.getCollaborativeProject(n);d(e);const t=e.collaborators.find(e=>"invited"===e.status);t&&(h(t),y(t.revenue_percentage))}catch(e){S(e.message||"Failed to load project details")}finally{s(!1)}})()},[e,n]),l.useEffect(()=>{e||(f("view"),b(""),S(""),C(""))},[e]),!e)return null;const T=null==c?void 0:c.collaborators.find(e=>e.user===c.created_by),_=p?100-p.revenue_percentage:0;return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.9)",display:"grid",placeItems:"center",zIndex:1e3,padding:20},onClick:e=>{e.target!==e.currentTarget||j||t()},children:r.jsxs("div",{style:{background:"#0f172a",border:"1px solid #334155",borderRadius:16,width:"100%",maxWidth:600,maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.5)"},children:[r.jsxs("div",{style:{padding:24,borderBottom:"1px solid #334155",background:"linear-gradient(135deg, #1e293b 0%, #0f172a 100%)",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("span",{style:{fontSize:24},children:"ðŸ¤"}),r.jsx("h2",{style:{margin:0,color:"#f8fafc",fontSize:20,fontWeight:600},children:"Collaboration Invite"})]}),T&&r.jsxs("p",{style:{margin:0,color:"#94a3b8",fontSize:14},children:["from ",r.jsxs("span",{style:{color:"#f59e0b"},children:["@",T.username]})]})]}),r.jsx("button",{onClick:t,disabled:j,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:24,cursor:j?"not-allowed":"pointer",padding:4},children:"Ã—"})]}),r.jsx("div",{style:{padding:24},children:a?r.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"Loading project details..."}):k&&!c?r.jsx("div",{style:{textAlign:"center",padding:40,color:"#ef4444"},children:k}):c&&p?"view"===g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:24},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("span",{style:{background:"#f59e0b20",color:"#f59e0b",padding:"4px 12px",borderRadius:6,fontSize:12,fontWeight:600},children:{book:"Book",music:"Music",video:"Video",art:"Art"}[c.content_type]||c.content_type}),r.jsx("span",{style:{color:"#64748b",fontSize:13},children:"draft"===c.status?"Draft":"Active"})]}),r.jsx("h3",{style:{margin:0,color:"#f8fafc",fontSize:24,fontWeight:700},children:c.title}),c.description&&r.jsx("p",{style:{margin:"8px 0 0",color:"#94a3b8",fontSize:14,lineHeight:1.6},children:c.description})]}),r.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[r.jsx("div",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,marginBottom:8,textTransform:"uppercase"},children:"Your Role"}),r.jsx("div",{style:{color:"#f8fafc",fontSize:18,fontWeight:600},children:p.role||"Collaborator"})]}),p.contract_tasks&&p.contract_tasks.length>0&&r.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[r.jsx("span",{style:{fontSize:18},children:"ðŸ“‹"}),r.jsxs("span",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,textTransform:"uppercase"},children:["Your Contract Tasks (",p.contract_tasks.length,")"]})]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:p.contract_tasks.map((e,t)=>r.jsxs("div",{style:{background:"#0f172a",borderRadius:8,padding:14,borderLeft:"3px solid #f59e0b"},children:[r.jsx("div",{style:{color:"#f8fafc",fontSize:14,fontWeight:600},children:e.title}),e.description&&r.jsx("div",{style:{color:"#94a3b8",fontSize:13,marginTop:6,lineHeight:1.5},children:e.description}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:10,color:"#f59e0b",fontSize:12,fontWeight:500},children:[r.jsx("span",{children:"â°"}),r.jsxs("span",{children:["Due: ",new Date(e.deadline).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})]})]})]},e.id||t))}),r.jsxs("div",{style:{marginTop:16,padding:12,background:"rgba(245, 158, 11, 0.1)",borderRadius:8,display:"flex",alignItems:"flex-start",gap:10},children:[r.jsx("span",{style:{fontSize:16},children:"âš ï¸"}),r.jsxs("div",{style:{color:"#f59e0b",fontSize:12,lineHeight:1.5},children:[r.jsx("strong",{children:"Contract Terms:"})," By accepting, you commit to completing these tasks by their deadlines. Tasks become binding and can only be changed via mutual agreement. Missing deadlines may affect the collaboration."]})]})]}),i&&r.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20,borderLeft:"3px solid #3b82f6"},children:[r.jsxs("div",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,marginBottom:8,textTransform:"uppercase"},children:["Message from @",null==T?void 0:T.username]}),r.jsx("div",{style:{color:"#cbd5e1",fontSize:14,lineHeight:1.6,whiteSpace:"pre-wrap"},children:i})]}),r.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[r.jsx("span",{style:{fontSize:18},children:"ðŸ’°"}),r.jsx("span",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,textTransform:"uppercase"},children:"Revenue Split"})]}),r.jsxs("div",{style:{display:"flex",gap:4,marginBottom:8},children:[r.jsxs("div",{style:{flex:p.revenue_percentage,background:"#f59e0b",height:40,borderRadius:"8px 0 0 8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#000",fontWeight:700,fontSize:14,minWidth:60},children:["You: ",p.revenue_percentage,"%"]}),r.jsxs("div",{style:{flex:_,background:"#334155",height:40,borderRadius:"0 8px 8px 0",display:"flex",alignItems:"center",justifyContent:"center",color:"#cbd5e1",fontWeight:600,fontSize:14,minWidth:60},children:["Others: ",_,"%"]})]})]}),r.jsxs("div",{style:{background:"#1e293b",borderRadius:12,padding:16,marginBottom:20},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[r.jsx("span",{style:{fontSize:18},children:"âœï¸"}),r.jsx("span",{style:{color:"#94a3b8",fontSize:12,fontWeight:600,textTransform:"uppercase"},children:"Your Permissions"})]}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[{key:"can_edit_text",label:"Text",value:p.can_edit_text},{key:"can_edit_images",label:"Images",value:p.can_edit_images},{key:"can_edit_audio",label:"Audio",value:p.can_edit_audio},{key:"can_edit_video",label:"Video",value:p.can_edit_video}].map(e=>r.jsxs("span",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",borderRadius:6,background:e.value?"#10b98120":"#64748b20",color:e.value?"#10b981":"#64748b",fontSize:13,fontWeight:500},children:[e.value?"âœ“":"âœ—"," ",e.label]},e.key))})]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #7c3aed20 0%, #3b82f620 100%)",border:"1px solid #7c3aed40",borderRadius:12,padding:16,marginBottom:24},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("span",{style:{fontSize:18},children:"â›“ï¸"}),r.jsx("span",{style:{color:"#a78bfa",fontSize:13,fontWeight:600},children:"On-Chain Agreement"})]}),r.jsx("p",{style:{margin:0,color:"#c4b5fd",fontSize:13,lineHeight:1.6},children:"By accepting, you agree to the revenue split above. When this project is minted as an NFT, the split will be enforced via smart contract. USDC payments will be distributed automatically."})]}),k&&r.jsx("div",{style:{background:"#ef444420",border:"1px solid #ef4444",color:"#fca5a5",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:k}),w&&r.jsx("div",{style:{background:"#10b98120",border:"1px solid #10b981",color:"#6ee7b7",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:w}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsx("button",{onClick:async()=>{v(!0),S("");try{await fe.declineInvitation(n),C("Invite declined."),setTimeout(()=>{t()},1500)}catch(e){S(e.message||"Failed to decline invitation")}finally{v(!1)}},disabled:j,style:{flex:1,padding:"14px 20px",borderRadius:10,border:"1px solid #ef4444",background:"transparent",color:"#ef4444",fontSize:14,fontWeight:600,cursor:j?"not-allowed":"pointer",opacity:j?.6:1},children:"Decline"}),r.jsx("button",{onClick:()=>f("counter-propose"),disabled:j,style:{flex:1,padding:"14px 20px",borderRadius:10,border:"1px solid #3b82f6",background:"transparent",color:"#3b82f6",fontSize:14,fontWeight:600,cursor:j?"not-allowed":"pointer",opacity:j?.6:1},children:"Counter-Propose"}),r.jsx("button",{onClick:async()=>{v(!0),S("");try{await fe.acceptInvitation(n),C("Invite accepted! Redirecting to project..."),setTimeout(()=>{t(),o(`/collaborations/${n}`)},1500)}catch(e){S(e.message||"Failed to accept invitation")}finally{v(!1)}},disabled:j,style:{flex:1.5,padding:"14px 20px",borderRadius:10,border:"none",background:"#10b981",color:"#fff",fontSize:14,fontWeight:700,cursor:j?"not-allowed":"pointer",opacity:j?.6:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:j?"Processing...":"âœ“ Accept Invite"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>f("view"),style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:14,cursor:"pointer",padding:0,marginBottom:16,display:"flex",alignItems:"center",gap:8},children:"â† Back to invite"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:24},children:[r.jsx("span",{style:{fontSize:24},children:"ðŸ’¬"}),r.jsx("h3",{style:{margin:0,color:"#f8fafc",fontSize:20,fontWeight:600},children:"Propose Different Terms"})]}),r.jsxs("div",{style:{marginBottom:24},children:[r.jsxs("label",{style:{display:"block",color:"#94a3b8",fontSize:13,fontWeight:600,marginBottom:12},children:["Suggested Revenue Split: ",x,"% for you"]}),r.jsx("input",{type:"range",min:5,max:95,step:5,value:x,onChange:e=>y(parseInt(e.target.value)),style:{width:"100%",marginBottom:8}}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,color:"#64748b"},children:[r.jsxs("span",{children:["Current offer: ",p.revenue_percentage,"%"]}),r.jsxs("span",{children:["Proposing: ",x,"%"]})]}),x!==p.revenue_percentage&&r.jsxs("div",{style:{marginTop:12,padding:12,background:"#1e293b",borderRadius:8,fontSize:13},children:[r.jsx("span",{style:{color:"#94a3b8"},children:"Change: "}),r.jsxs("span",{style:{color:x>p.revenue_percentage?"#10b981":"#ef4444",fontWeight:600},children:[p.revenue_percentage,"% â†’ ",x,"% (",x>p.revenue_percentage?"+":"",x-p.revenue_percentage,"%)"]})]})]}),r.jsxs("div",{style:{marginBottom:24},children:[r.jsxs("label",{style:{display:"block",color:"#94a3b8",fontSize:13,fontWeight:600,marginBottom:8},children:["Message to @",null==T?void 0:T.username]}),r.jsx("textarea",{value:m,onChange:e=>b(e.target.value),placeholder:"Explain why you'd like a different split...",style:{width:"100%",minHeight:120,background:"#1e293b",border:"1px solid #334155",borderRadius:8,padding:12,color:"#f8fafc",fontSize:14,resize:"vertical"}}),r.jsxs("div",{style:{fontSize:11,color:"#64748b",marginTop:4},children:[m.length,"/500 characters"]})]}),k&&r.jsx("div",{style:{background:"#ef444420",border:"1px solid #ef4444",color:"#fca5a5",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:k}),w&&r.jsx("div",{style:{background:"#10b98120",border:"1px solid #10b981",color:"#6ee7b7",padding:12,borderRadius:8,fontSize:13,marginBottom:16},children:w}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsx("button",{onClick:()=>f("view"),disabled:j,style:{flex:1,padding:"14px 20px",borderRadius:10,border:"1px solid #334155",background:"transparent",color:"#cbd5e1",fontSize:14,fontWeight:600,cursor:j?"not-allowed":"pointer"},children:"Cancel"}),r.jsx("button",{onClick:async()=>{if(m.trim()){v(!0),S("");try{await fe.counterProposeInvite(n,{proposed_percentage:x,message:m}),C("Counter-proposal sent! Waiting for response..."),setTimeout(()=>{t()},2e3)}catch(e){S(e.message||"Failed to send counter-proposal")}finally{v(!1)}}else S("Please add a message explaining your counter-proposal")},disabled:j||!m.trim()||m.length>500,style:{flex:2,padding:"14px 20px",borderRadius:10,border:"none",background:"#3b82f6",color:"#fff",fontSize:14,fontWeight:700,cursor:j||!m.trim()||m.length>500?"not-allowed":"pointer",opacity:j||!m.trim()||m.length>500?.6:1},children:j?"Sending...":"Send Counter-Offer"})]})]}):r.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"No invite found for this project."})})]})})}function ye({isOpen:e,onClose:t,anchorEl:n}){const i=u(),o=l.useRef(null),[a,s]=l.useState(!1),[c,d]=l.useState(null),{notifications:p,unreadCount:h,isLoading:g,markAsRead:f,markAllAsRead:x,deleteNotification:y,refresh:m}=pe(),b=p.slice(0,10),j=async e=>{e.read||await f(e.id),d(e),s(!0)};l.useEffect(()=>{if(!e)return;const i=e=>{o.current&&!o.current.contains(e.target)&&n&&!n.contains(e.target)&&t()},r=setTimeout(()=>{document.addEventListener("mousedown",i)},100);return()=>{clearTimeout(r),document.removeEventListener("mousedown",i)}},[e,t,n]),l.useEffect(()=>{if(!e)return;const n=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[e,t]),l.useEffect(()=>{e&&m()},[e,m]);return e?r.jsxs("div",{ref:o,role:"dialog","aria-label":"Notifications","aria-modal":"false",style:{position:"absolute",top:"100%",right:0,marginTop:8,width:420,maxHeight:600,background:"#0f172a",border:"1px solid #1f2937",borderRadius:12,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5)",zIndex:3e3,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #1f2937",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#e5e7eb",margin:0},children:"Notifications"}),h>0&&r.jsx("div",{"aria-label":`${h} unread`,style:{background:"#ef4444",color:"#fff",fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:10,minWidth:20,textAlign:"center"},children:h})]}),b.length>0&&h>0&&r.jsx("button",{onClick:async()=>{try{await x()}catch(e){}},"aria-label":"Mark all as read",style:{background:"transparent",color:"#3b82f6",border:"none",fontSize:12,fontWeight:600,cursor:"pointer",padding:"4px 8px",borderRadius:4,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"Mark All Read"})]}),r.jsx("div",{style:{flex:1,overflowY:"auto",maxHeight:500},children:g&&0===b.length?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#94a3b8",fontSize:14},children:"Loading notifications..."}):0===b.length?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#94a3b8"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:12},"aria-hidden":"true",children:"ðŸ””"}),r.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:4},children:"No notifications yet"}),r.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"We'll notify you when there's activity on your collaborations"})]}):r.jsx("div",{style:{padding:"8px 0"},children:b.map(e=>r.jsx(ue,{notification:e,onClick:()=>(async e=>{e.read||await f(e.id),e.action_url?(i(e.action_url),t()):e.project_id&&(i(`/collaborations/${e.project_id}`),t())})(e),onDelete:t=>(async(e,t)=>{e.stopPropagation();try{await y(t)}catch(n){}})(t,e.id),onViewInvite:j},e.id))})}),b.length>0&&r.jsx("div",{style:{padding:"12px 20px",borderTop:"1px solid #1f2937",display:"flex",gap:8},children:p.length>10&&r.jsx("button",{onClick:()=>{i("/notifications"),t()},"aria-label":"View all notifications",style:{background:"transparent",color:"#3b82f6",border:"none",fontSize:13,fontWeight:600,cursor:"pointer",padding:"6px 12px",borderRadius:6,flex:1,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#1e293b"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"View All"})}),c&&c.project_id&&r.jsx(xe,{open:a,onClose:()=>{s(!1),d(null),m()},projectId:c.project_id,notificationMessage:c.message})]}):null}function me(){const[e,t]=l.useState(!1),[n,i]=l.useState(!1),o=l.useRef(null),{unreadCount:a}=function(e=!1){const[t,n]=l.useState(0),i=l.useCallback(async()=>{try{const e=await de.getUnreadCount();n(e)}catch(e){}},[]);return l.useEffect(()=>{const t=ae.on("notifications:unread-count",({count:e})=>{n(e)});return e&&i(),()=>{t()}},[e,i]),{unreadCount:t,refresh:i}}();l.useEffect(()=>{const e=ae.on("notifications:new",()=>{i(!0),setTimeout(()=>i(!1),1e3)});return()=>e()},[]);return r.jsxs("div",{style:{position:"relative"},children:[r.jsxs("button",{ref:o,onClick:()=>{t(!e)},"aria-label":"Notifications"+(a>0?` (${a} unread)`:""),"aria-expanded":e,"aria-haspopup":"true",className:"rb-nav-link",style:{position:"relative"},title:"Notifications",children:[r.jsx(_,{size:20,style:{animation:n?"ring 1s ease-in-out":"none",transformOrigin:"top center"}}),a>0&&r.jsx("span",{style:{position:"absolute",top:4,right:4,background:"#ef4444",color:"#fff",fontSize:10,fontWeight:700,padding:"2px 6px",borderRadius:10,minWidth:18,textAlign:"center",boxShadow:"0 0 8px rgba(239, 68, 68, 0.5)"},"aria-label":`${a} unread notifications`,children:a})]}),r.jsx(ye,{isOpen:e,onClose:()=>t(!1),anchorEl:o.current}),r.jsx("style",{children:"\n        @keyframes ring {\n          0%, 100% { transform: rotate(0deg); }\n          10%, 30%, 50%, 70% { transform: rotate(15deg); }\n          20%, 40%, 60%, 80% { transform: rotate(-15deg); }\n          90% { transform: rotate(5deg); }\n        }\n      "})]})}function be({notification:e,onDismiss:t,autoDismissMs:n=5e3}){const i=u(),[o,a]=l.useState(!1),s=le(e.type),c=ce(e.type);l.useEffect(()=>{const e=setTimeout(()=>{d()},n);return()=>clearTimeout(e)},[n]);const d=()=>{a(!0),setTimeout(()=>{t()},300)};return r.jsxs("div",{role:"alert","aria-live":"polite","aria-atomic":"true",style:{width:380,background:"#1e293b",border:`1px solid ${c}40`,borderLeft:`4px solid ${c}`,borderRadius:8,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",overflow:"hidden",marginBottom:12,animation:o?"slideOut 0.3s ease-out forwards":"slideIn 0.3s ease-out"},children:[r.jsx("div",{style:{height:3,background:`linear-gradient(90deg, ${c} 0%, transparent 100%)`,animation:`progress ${n}ms linear forwards`}}),r.jsxs("div",{style:{padding:"16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12,marginBottom:12},children:[r.jsx("div",{style:{fontSize:24,width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:`${c}20`,borderRadius:8,flexShrink:0},"aria-hidden":"true",children:s}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#e5e7eb",marginBottom:4,lineHeight:1.3},children:e.title}),r.jsx("div",{style:{fontSize:13,color:"#94a3b8",lineHeight:1.4},children:e.message})]}),r.jsx("button",{onClick:d,"aria-label":"Dismiss notification",style:{background:"transparent",border:"none",color:"#64748b",cursor:"pointer",padding:4,fontSize:20,lineHeight:1,transition:"color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.color="#64748b"},children:"Ã—"})]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[(e.action_url||e.project_id)&&r.jsx("button",{onClick:()=>{e.action_url?i(e.action_url):e.project_id&&i(`/collaborations/${e.project_id}`),d()},style:{background:c,color:"#fff",border:"none",borderRadius:6,padding:"6px 16px",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.opacity="0.9",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.opacity="1",e.currentTarget.style.transform="translateY(0)"},children:"View"}),r.jsx("button",{onClick:d,style:{background:"transparent",color:"#94a3b8",border:"1px solid #334155",borderRadius:6,padding:"6px 16px",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="#334155",e.currentTarget.style.color="#e5e7eb"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},children:"Dismiss"})]})]}),r.jsx("style",{children:"\n        @keyframes slideIn {\n          from {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n\n        @keyframes slideOut {\n          from {\n            transform: translateX(0);\n            opacity: 1;\n          }\n          to {\n            transform: translateX(400px);\n            opacity: 0;\n          }\n        }\n\n        @keyframes progress {\n          from {\n            transform: scaleX(1);\n          }\n          to {\n            transform: scaleX(0);\n          }\n        }\n      "})]})}function je(){const[e,t]=l.useState([]);l.useEffect(()=>{const e=ae.on("notifications:new",({notifications:e})=>{t(t=>[...t,...e])});return()=>e()},[]);return 0===e.length?null:r.jsx("div",{"aria-live":"polite","aria-atomic":"false",style:{position:"fixed",top:80,right:20,zIndex:9999,display:"flex",flexDirection:"column",alignItems:"flex-end",pointerEvents:"none"},children:r.jsx("div",{style:{pointerEvents:"auto"},children:e.map(e=>r.jsx(be,{notification:e,onDismiss:()=>{return n=e.id,void t(e=>e.filter(e=>e.id!==n));var n}},e.id))})})}function ve({isOpen:e,onClose:t}){const[n,i]=l.useState(""),[o,a]=l.useState(""),[s,c]=l.useState(!1),[d,p]=l.useState(!1),[u,h]=l.useState("");if(!e)return null;return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},onClick:t,children:r.jsx("div",{style:{background:"#1a1f2e",border:"1px solid #2a3444",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:d?r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"âœ“"}),r.jsx("h2",{style:{fontSize:"24px",fontWeight:700,color:"#10b981",margin:"0 0 8px 0"},children:"Thank You!"}),r.jsx("p",{style:{fontSize:"14px",color:"#94a3b8",margin:0},children:"Your feedback helps us improve renaissBlock"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsx("h2",{style:{fontSize:"24px",fontWeight:700,color:"#e5e7eb",margin:0},children:"Beta Feedback"}),r.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:"24px",cursor:"pointer",padding:"0",lineHeight:1},children:"Ã—"})]}),r.jsx("p",{style:{fontSize:"14px",color:"#94a3b8",margin:0},children:"Help us improve by sharing your thoughts, bugs, or feature requests"})]}),r.jsxs("form",{onSubmit:async e=>{e.preventDefault(),c(!0),h("");try{(await fetch(`${m}/api/feedback/`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({feedback:n,email:o||"anonymous"})})).ok?(p(!0),i(""),a(""),setTimeout(()=>{t(),p(!1)},2e3)):h("Failed to submit feedback. Please try again.")}catch(r){h("Network error. Please try again later.")}finally{c(!1)}},style:{display:"grid",gap:"16px"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"13px",color:"#cbd5e1",marginBottom:"8px",fontWeight:600},children:"Your Feedback *"}),r.jsx("textarea",{value:n,onChange:e=>i(e.target.value),placeholder:"Tell us what you think! Include bugs, feature requests, or general feedback...",required:!0,rows:6,style:{width:"100%",padding:"12px",background:"#0f1419",border:"1px solid #2a3444",borderRadius:"8px",color:"#e5e7eb",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:"13px",color:"#cbd5e1",marginBottom:"8px",fontWeight:600},children:"Email (optional)"}),r.jsx("input",{type:"email",value:o,onChange:e=>a(e.target.value),placeholder:"your@email.com (if you'd like a response)",style:{width:"100%",padding:"12px",background:"#0f1419",border:"1px solid #2a3444",borderRadius:"8px",color:"#e5e7eb",fontSize:"14px"}})]}),u&&r.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#dc2626",borderRadius:"8px",fontSize:"14px"},children:u}),r.jsx("button",{type:"submit",disabled:s||!n.trim(),style:{background:s?"#94a3b8":"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",border:"none",padding:"14px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:700,cursor:s?"not-allowed":"pointer",width:"100%"},children:s?"Submitting...":"Submit Feedback"})]})]})})})}function ke({variant:e="header",showTestMode:t=!0}){return"header"===e?r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"4px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:700,color:"#000",letterSpacing:"0.5px",boxShadow:"0 2px 8px rgba(245, 158, 11, 0.3)"},children:[r.jsx("span",{children:"BETA"}),t&&r.jsx("span",{style:{background:"rgba(0, 0, 0, 0.2)",padding:"2px 6px",borderRadius:"4px",fontSize:"10px"},children:"TEST MODE"})]}):"inline"===e?r.jsx("span",{style:{display:"inline-block",background:"#f59e0b",color:"#000",padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:700,letterSpacing:"0.5px",marginLeft:"8px"},children:"BETA"}):"full"===e?r.jsxs("div",{style:{background:"linear-gradient(135deg, #f59e0b15 0%, #d9770615 100%)",border:"1px solid #f59e0b40",borderRadius:"12px",padding:"16px 20px",display:"flex",alignItems:"center",gap:"16px"},children:[r.jsx("div",{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:700,color:"#000",letterSpacing:"0.5px",whiteSpace:"nowrap"},children:"BETA"}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#e5e7eb",marginBottom:"4px"},children:"You're in the Beta!"}),r.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8",lineHeight:1.4},children:["Help us improve by"," ",r.jsx("a",{href:"mailto:feedback@renaissblock.com",style:{color:"#f59e0b",textDecoration:"none",fontWeight:600},children:"sharing feedback"}),". All transactions are in test mode."]})]})]}):null}function Se(){const[e,t]=l.useState(!1);return r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>t(!0),style:{position:"fixed",bottom:20,right:20,background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",border:"none",padding:"12px 20px",borderRadius:"30px",fontSize:"14px",fontWeight:700,cursor:"pointer",zIndex:1e3,boxShadow:"0 4px 12px rgba(245, 158, 11, 0.4)",display:"flex",alignItems:"center",gap:"8px",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 6px 16px rgba(245, 158, 11, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(245, 158, 11, 0.4)"},title:"Send feedback about the beta",children:[r.jsx(X,{size:18}),"Feedback"]}),r.jsx(ve,{isOpen:e,onClose:()=>t(!1)})]})}function we({onClose:e}){return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},onClick:e,children:r.jsxs("div",{style:{background:"#1a1f2e",border:"1px solid #2a3444",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"24px"},children:[r.jsx("div",{style:{display:"inline-block",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"12px 24px",borderRadius:"12px",fontSize:"18px",fontWeight:700,color:"#000",letterSpacing:"1px",marginBottom:"16px"},children:"BETA TESTER"}),r.jsx("h2",{style:{fontSize:"24px",fontWeight:700,color:"#e5e7eb",margin:"0 0 8px 0"},children:"Welcome to renaissBlock Beta!"}),r.jsx("p",{style:{fontSize:"14px",color:"#94a3b8",margin:0},children:"You're one of the first creators to experience the future"})]}),r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#f59e0b",marginBottom:"8px"},children:"ðŸ§ª Test Mode Active"}),r.jsxs("ul",{style:{fontSize:"13px",color:"#cbd5e1",margin:"0",paddingLeft:"20px",lineHeight:1.6},children:[r.jsx("li",{children:"No real money charged (use test card: 4242 4242 4242 4242)"}),r.jsx("li",{children:"Blockchain features use Solana devnet (fake SOL)"}),r.jsx("li",{children:"Some features still being polished"})]})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#f59e0b",marginBottom:"8px"},children:"ðŸ’¡ What to Try"}),r.jsxs("ul",{style:{fontSize:"13px",color:"#cbd5e1",margin:"0",paddingLeft:"20px",lineHeight:1.6},children:[r.jsx("li",{children:"Create and publish your first content"}),r.jsx("li",{children:"Collaborate with other beta testers"}),r.jsx("li",{children:"Test the purchase and reading experience"})]})]}),r.jsxs("div",{style:{background:"#f59e0b20",border:"1px solid #f59e0b40",borderRadius:"8px",padding:"12px",marginTop:"16px"},children:[r.jsx("div",{style:{fontSize:"13px",color:"#fbbf24",fontWeight:600,marginBottom:"4px"},children:"ðŸŽ Beta Perks"}),r.jsx("p",{style:{fontSize:"12px",color:"#cbd5e1",margin:0,lineHeight:1.5},children:"As a beta tester, you'll get early access to new features and special recognition when we launch!"})]})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("button",{onClick:e,style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",border:"none",padding:"12px 32px",borderRadius:"8px",fontSize:"14px",fontWeight:700,cursor:"pointer",width:"100%",marginBottom:"12px"},children:"Let's Go! ðŸš€"}),r.jsxs("div",{style:{fontSize:"12px",color:"#64748b"},children:["Questions?"," ",r.jsx("a",{href:"mailto:feedback@renaissblock.com",style:{color:"#f59e0b",textDecoration:"none",fontWeight:600},children:"feedback@renaissblock.com"})]})]})]})})}function Ce(){const{isAuthenticated:e,user:t}=F(),[n,i]=l.useState(!1);l.useEffect(()=>{if(!e||!t)return;const n=localStorage.getItem("beta_welcome_seen"),o=localStorage.getItem("beta_welcome_user_id");n&&o===String(t.id)||setTimeout(()=>{i(!0)},1e3)},[e,t]);return r.jsx(r.Fragment,{children:n&&r.jsx(we,{onClose:()=>{t&&(localStorage.setItem("beta_welcome_seen","true"),localStorage.setItem("beta_welcome_user_id",String(t.id))),i(!1)}})})}function Te(){const e=(new Date).getFullYear();return r.jsx("footer",{style:{marginTop:"auto",padding:"24px 20px",borderTop:"1px solid var(--border, #334155)",background:"var(--bg-secondary, #1e293b)"},children:r.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-start",gap:32},children:[r.jsxs("div",{style:{minWidth:200},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[r.jsx("img",{src:"/rb-logo.png",alt:"renaissBlock",style:{height:28,width:"auto",borderRadius:4}}),r.jsx("span",{style:{fontSize:16,fontWeight:700,color:"var(--text, #e5e7eb)"},children:"renaissBlock"})]}),r.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"A platform for serious creators."})]}),r.jsxs("div",{style:{minWidth:150},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--text, #e5e7eb)",marginBottom:12,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Legal"}),r.jsxs("nav",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsx(c,{to:"/legal/terms",style:_e,children:"Terms of Service"}),r.jsx(c,{to:"/legal/privacy",style:_e,children:"Privacy Policy"}),r.jsx(c,{to:"/legal/content-policy",style:_e,children:"Content Policy"}),r.jsx(c,{to:"/legal/dmca",style:_e,children:"DMCA / Copyright"}),r.jsx(c,{to:"/legal/creator-agreement",style:_e,children:"Creator Agreement"})]})]}),r.jsxs("div",{style:{minWidth:150},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--text, #e5e7eb)",marginBottom:12,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Support"}),r.jsxs("nav",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsx("a",{href:"mailto:support@renaissblock.com",style:_e,children:"Contact Us"}),r.jsx("a",{href:"mailto:dmca@renaissblock.com",style:_e,children:"Report Copyright"}),r.jsx("a",{href:"mailto:reports@renaissblock.com",style:_e,children:"Report Content"})]})]}),r.jsx("div",{style:{width:"100%",paddingTop:16,borderTop:"1px solid var(--border, #334155)",marginTop:8},children:r.jsxs("div",{style:{fontSize:12,color:"var(--text-muted, #94a3b8)",textAlign:"center"},children:["Â© ",e," renaissBlock. All rights reserved."]})})]})})}const _e={fontSize:13,color:"var(--text-muted, #94a3b8)",textDecoration:"none",transition:"color 0.2s"},Re="rb_cookie_consent";function ze(){const[e,t]=l.useState(!1),[n,i]=l.useState(!1),[o,a]=l.useState({necessary:!0,analytics:!1,marketing:!1});l.useEffect(()=>{if(!localStorage.getItem(Re)){const e=setTimeout(()=>t(!0),1e3);return()=>clearTimeout(e)}},[]);const s=e=>{localStorage.setItem(Re,JSON.stringify({...e,timestamp:(new Date).toISOString()})),t(!1)},d=()=>{s({necessary:!0,analytics:!1,marketing:!1})};return e?r.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,zIndex:9999,background:"var(--bg, #0f172a)",borderTop:"1px solid var(--border, #334155)",padding:"16px 20px",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.3)"},children:r.jsx("div",{style:{maxWidth:1200,margin:"0 auto"},children:n?r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:600,color:"var(--text, #e5e7eb)"},children:"Cookie Preferences"}),r.jsx("button",{onClick:()=>i(!1),style:{background:"none",border:"none",padding:4,cursor:"pointer",color:"var(--text-muted, #94a3b8)"},children:r.jsx(q,{size:18})})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:16},children:[r.jsxs("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:12,background:"var(--bg-secondary, #1e293b)",borderRadius:6},children:[r.jsx("input",{type:"checkbox",checked:!0,disabled:!0,style:{marginTop:3}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500,color:"var(--text, #e5e7eb)",marginBottom:2},children:"Necessary Cookies"}),r.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"Required for the website to function. Cannot be disabled."})]})]}),r.jsxs("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:12,background:"var(--bg-secondary, #1e293b)",borderRadius:6,cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:o.analytics,onChange:e=>a(t=>({...t,analytics:e.target.checked})),style:{marginTop:3}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500,color:"var(--text, #e5e7eb)",marginBottom:2},children:"Analytics Cookies"}),r.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"Help us understand how you use the site to improve it."})]})]}),r.jsxs("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:12,background:"var(--bg-secondary, #1e293b)",borderRadius:6,cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:o.marketing,onChange:e=>a(t=>({...t,marketing:e.target.checked})),style:{marginTop:3}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:500,color:"var(--text, #e5e7eb)",marginBottom:2},children:"Marketing Cookies"}),r.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #94a3b8)"},children:"Used to show you relevant content and ads."})]})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{onClick:d,style:{padding:"8px 16px",borderRadius:6,border:"1px solid var(--border, #334155)",background:"transparent",color:"var(--text, #e5e7eb)",fontSize:13,cursor:"pointer"},children:"Reject All"}),r.jsx("button",{onClick:()=>{s(o)},style:{padding:"8px 16px",borderRadius:6,border:"none",background:"var(--accent, #f59e0b)",color:"#000",fontSize:13,fontWeight:600,cursor:"pointer"},children:"Save Preferences"})]})]}):r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:16,justifyContent:"space-between"},children:[r.jsx("div",{style:{flex:"1 1 400px"},children:r.jsxs("p",{style:{margin:0,fontSize:14,color:"var(--text, #e5e7eb)"},children:["We use cookies to improve your experience."," ",r.jsx(c,{to:"/legal/privacy",style:{color:"var(--accent, #f59e0b)"},children:"Learn more in our Privacy Policy"})]})}),r.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("button",{onClick:()=>i(!0),style:{padding:"8px 16px",borderRadius:6,border:"1px solid var(--border, #334155)",background:"transparent",color:"var(--text, #e5e7eb)",fontSize:13,cursor:"pointer"},children:"Customize"}),r.jsx("button",{onClick:d,style:{padding:"8px 16px",borderRadius:6,border:"1px solid var(--border, #334155)",background:"transparent",color:"var(--text, #e5e7eb)",fontSize:13,cursor:"pointer"},children:"Reject Non-Essential"}),r.jsx("button",{onClick:()=>{s({necessary:!0,analytics:!0,marketing:!0})},style:{padding:"8px 16px",borderRadius:6,border:"none",background:"var(--accent, #f59e0b)",color:"#000",fontSize:13,fontWeight:600,cursor:"pointer"},children:"Accept All"})]})]})})}):null}const Ee="rb_recent_searches";function Pe({onSearch:e}){const[t,n]=l.useState(""),[i,o]=l.useState([]),[a,s]=l.useState([]),[c,d]=l.useState(!1),[p,h]=l.useState(-1),[g,f]=l.useState(!1),x=l.useRef(null),y=l.useRef(null),b=u();l.useEffect(()=>{try{const e=localStorage.getItem(Ee);e&&s(JSON.parse(e))}catch{}},[]);l.useEffect(()=>{if(t.length<2)return void o([]);const e=setTimeout(()=>{f(!0),fetch(`${m}/api/search/?q=${encodeURIComponent(t)}`,{credentials:"include"}).then(e=>e.json()).then(e=>{Array.isArray(e)&&o(e.slice(0,6))}).catch(()=>o([])).finally(()=>f(!1))},200);return()=>clearTimeout(e)},[t]),l.useEffect(()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const j=t=>{t.trim()&&((e=>{if(!e.trim())return;const t=[e,...a.filter(t=>t!==e)].slice(0,5);s(t);try{localStorage.setItem(Ee,JSON.stringify(t))}catch{}})(t.trim()),d(!1),n(t),e?e(t):b(`/search?q=${encodeURIComponent(t.trim())}`))};l.useEffect(()=>{h(-1)},[i,a]);const v=c&&(t.length>=2?i.length>0:a.length>0);return r.jsxs("div",{ref:y,className:"search-autocomplete",style:{position:"relative",width:"100%"},children:[r.jsxs("form",{onSubmit:e=>{e.preventDefault(),j(t)},className:"rb-search",children:[r.jsx("input",{ref:x,type:"text",value:t,onChange:e=>n(e.target.value),onFocus:()=>d(!0),onKeyDown:e=>{var n,o;const r=(t.length>=2?i:a).length;switch(e.key){case"ArrowDown":e.preventDefault(),h(e=>e<r-1?e+1:e);break;case"ArrowUp":e.preventDefault(),h(e=>e>0?e-1:-1);break;case"Enter":if(e.preventDefault(),p>=0&&p<r){const e=t.length>=2?null==(n=i[p])?void 0:n.title:a[p];e&&j(e)}else j(t);break;case"Escape":d(!1),null==(o=x.current)||o.blur()}},placeholder:"Search",autoComplete:"off"}),r.jsx("button",{type:"submit",children:r.jsx(B,{size:18})})]}),v&&r.jsx("div",{className:"search-dropdown",style:{position:"absolute",top:"100%",left:0,right:0,marginTop:4,background:"#1e293b",borderRadius:8,boxShadow:"0 4px 20px rgba(0,0,0,0.4)",zIndex:1e3,overflow:"hidden",border:"1px solid #334155"},children:t.length>=2?r.jsx(r.Fragment,{children:i.map((e,t)=>r.jsxs("div",{onClick:()=>j(e.title),style:{display:"flex",alignItems:"center",gap:12,padding:"10px 16px",cursor:"pointer",background:p===t?"#334155":"transparent"},onMouseEnter:()=>h(t),children:[r.jsx(B,{size:16,style:{color:"#64748b",flexShrink:0}}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{color:"#f1f5f9",fontSize:14,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.title}),e.creator_username&&r.jsxs("div",{style:{color:"#64748b",fontSize:12},children:["by ",e.creator_username]})]}),e.content_type&&r.jsx("span",{style:{fontSize:10,padding:"2px 6px",background:"#334155",borderRadius:4,color:"#94a3b8",textTransform:"capitalize"},children:e.content_type})]},e.id))}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{padding:"8px 16px",fontSize:12,color:"#64748b",borderBottom:"1px solid #334155"},children:"Recent searches"}),a.map((e,t)=>r.jsxs("div",{onClick:()=>j(e),style:{display:"flex",alignItems:"center",gap:12,padding:"10px 16px",cursor:"pointer",background:p===t?"#334155":"transparent"},onMouseEnter:()=>h(t),children:[r.jsx(P,{size:16,style:{color:"#64748b",flexShrink:0}}),r.jsx("span",{style:{flex:1,color:"#f1f5f9",fontSize:14},children:e}),r.jsx("button",{onClick:t=>((e,t)=>{t.stopPropagation();const n=a.filter(t=>t!==e);s(n);try{localStorage.setItem(Ee,JSON.stringify(n))}catch{}})(e,t),style:{background:"none",border:"none",padding:4,cursor:"pointer",color:"#64748b",display:"flex",alignItems:"center"},children:r.jsx(q,{size:14})})]},e))]})})]})}const $e=l.lazy(()=>a(()=>import("./HomePage-BksgpWMm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),Ie=l.lazy(()=>a(()=>import("./SearchPage-DCEUtc2R.js"),__vite__mapDeps([10,1,2,3,4,5,6,7]))),Le=l.lazy(()=>a(()=>import("./StudioPage-NnLvFEqW.js"),__vite__mapDeps([11,1,2,3,12,13,14,9,15,16,17,18,7,19,20,21,5,22,23,24]))),We=l.lazy(()=>a(()=>import("./DashboardPage-CiU7BFi1.js"),__vite__mapDeps([25,1,2,3]))),Ae=l.lazy(()=>a(()=>import("./ProfilePageRedesigned-BCODPoQ7.js"),__vite__mapDeps([26,1,2,3,16,17,18,7,19,9,20,21,27,23,28,29,5,30,14,8,15,31,32]))),Me=l.lazy(()=>a(()=>import("./AuthPage-C_EkhT9c.js"),__vite__mapDeps([33,1,2,3]))),Xe=l.lazy(()=>a(()=>import("./WalletInfoPage-B-se9e1j.js"),__vite__mapDeps([34,1,2,3]))),Ne=l.lazy(()=>a(()=>import("./BetaLanding-BHmxc8Ru.js"),__vite__mapDeps([35,1,2,3,36,19,37,38]))),Be=l.lazy(()=>a(()=>import("./CollaboratorsPage-DO5EvXEA.js"),__vite__mapDeps([39,1,2,3,40,14,8,31,32,30,41,15,5,19,6]))),Oe=l.lazy(()=>a(()=>import("./PublicProfilePage-DQ4cpnnE.js"),__vite__mapDeps([42,1,2,3,40,14,8,31,32,30,41,15,5,19,43,6,20,18,36,27,9,23,22,44]))),De=l.lazy(()=>a(()=>import("./ContentDetail-GWRiY_Ev.js"),__vite__mapDeps([45,1,2,3,16,17,18,7,19,9,20,43,6,36,46]))),qe=l.lazy(()=>a(()=>import("./PurchaseSuccessPage-D2WdKN1v.js"),__vite__mapDeps([47,1,2,3]))),Fe=l.lazy(()=>a(()=>import("./ReaderPage-vVRludcH.js"),__vite__mapDeps([48,1,2,3,17,46,28,8])).then(e=>({default:e.ReaderPage}))),He=l.lazy(()=>a(()=>import("./CollaborationDashboard-BW6XdGg4.js"),__vite__mapDeps([49,1,2,3]))),Ve=l.lazy(()=>a(()=>import("./CollaborativeProjectPage-Bv4pQ3Wu.js"),__vite__mapDeps([50,1,2,3,15,12,13,17,5,20,41,31,29]))),Je=l.lazy(()=>a(()=>import("./NotificationsPage-CPutmDqX.js"),__vite__mapDeps([51,1,2,3,46]))),Ye=l.lazy(()=>a(()=>import("./FollowingFeedPage-BpzZs80f.js"),__vite__mapDeps([52,1,2,3,18,5,37,31,32,44]))),Ge=l.lazy(()=>a(()=>import("./TermsOfServicePage-BwdxyyW5.js"),__vite__mapDeps([53,1,2,3,54]))),Ue=l.lazy(()=>a(()=>import("./PrivacyPolicyPage-K4V0qBLn.js"),__vite__mapDeps([55,1,2,3,54]))),Ze=l.lazy(()=>a(()=>import("./ContentPolicyPage-3x6N8spa.js"),__vite__mapDeps([56,1,2,3,54]))),Ke=l.lazy(()=>a(()=>import("./DMCAPolicyPage-DhfkLGiD.js"),__vite__mapDeps([57,1,2,3,54]))),Qe=l.lazy(()=>a(()=>import("./CreatorAgreementPage-ue9NoAAQ.js"),__vite__mapDeps([58,1,2,3,54]))),et=()=>r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"200px",color:"var(--text-muted, #94a3b8)"},children:"Loading..."});function tt(){const[e,t]=l.useState(!1),[n,i]=l.useState(""),[o,a]=l.useState(null),[s,p]=l.useState(!1),h=u(),g=d(),x=f.useCallback(()=>{fetch(`${m}/api/auth/status/`,{credentials:"include"}).then(e=>e.json()).then(e=>{var n;const o=!!(null==e?void 0:e.authenticated);t(o),o&&(null==(n=null==e?void 0:e.user)?void 0:n.username)?(i(e.user.username),a(e.user.avatar_url||null)):(i(""),a(null)),o?de.isPolling()||de.startPolling():(de.isPolling()&&de.stopPolling(),de.reset())}).catch(()=>{t(!1),i(""),a(null),de.stopPolling(),de.reset()})},[]);l.useEffect(()=>{x();const e=setInterval(x,1e4);return()=>{clearInterval(e),de.stopPolling()}},[g.pathname,x]),l.useEffect(()=>{"/"===g.pathname&&x()},[g.pathname,x]);return r.jsxs("nav",{className:"rb-header",children:[r.jsxs("div",{className:"rb-header-left",children:[r.jsx(c,{to:"/",className:"rb-logo-link",children:r.jsx("img",{src:"/rb-logo.png",alt:"renaissBlock",className:"rb-logo-img"})}),r.jsx(ke,{variant:"header",showTestMode:!0})]}),r.jsx("div",{className:"rb-header-center",children:r.jsx(Pe,{})}),r.jsx("button",{className:"rb-mobile-menu-toggle",onClick:()=>p(!s),"aria-label":"Toggle menu",children:s?r.jsx(q,{size:24}):r.jsx(M,{size:24})}),r.jsxs("div",{className:"rb-header-right rb-nav "+(s?"rb-nav-mobile-open":""),children:[e&&r.jsxs(r.Fragment,{children:[r.jsx(me,{}),r.jsx(c,{to:"/collaborators",className:"rb-nav-link",title:"Find Collaborators",children:r.jsx(D,{size:20})}),r.jsxs(c,{to:"/profile",className:"rb-nav-link rb-profile-link",title:"Profile",children:[o?r.jsx("img",{src:o,alt:n,style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid var(--accent)"}}):r.jsx(O,{size:20}),r.jsxs("span",{children:["@",n||"Profile"]})]}),r.jsxs("button",{onClick:async()=>{try{const e=await fetch(`${m}/api/auth/csrf/`,{credentials:"include"}).then(e=>e.json()).then(e=>(null==e?void 0:e.csrfToken)||"");await fetch(`${m}/api/auth/logout/`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":e,"X-Requested-With":"XMLHttpRequest"}})}catch{}de.stopPolling(),de.reset(),t(!1),h("/"),setTimeout(()=>x(),100)},className:"rb-nav-link rb-logout-btn",title:"Logout",children:[r.jsx(L,{size:20}),r.jsx("span",{children:"Logout"})]})]}),!e&&r.jsxs("button",{onClick:()=>{h("/auth")},className:"rb-nav-link rb-signin-btn",children:[r.jsx(O,{size:20}),r.jsx("span",{children:"Sign in"})]})]})]})}function nt(){const e=d(),{isAuthenticated:t,loading:n}=F(),i=t&&[/^\/$/,/^\/search/].some(t=>t.test(e.pathname)),o=/^\/reader/.test(e.pathname),a=!i,s=["/auth","/terms","/wallet-info","/beta","/profile/","/legal"].some(t=>e.pathname.startsWith(t));if(n)return r.jsx("div",{className:"rb-app",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"var(--bg)",color:"var(--text)"},children:r.jsx("div",{style:{textAlign:"center"},children:r.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"Loading..."})})});if(!t&&!s)return r.jsxs("div",{className:"rb-app",children:[r.jsx(Ne,{}),r.jsx(je,{})]});return"/beta"===e.pathname?r.jsxs("div",{className:"rb-app",children:[r.jsx(Ne,{}),r.jsx(je,{})]}):o?r.jsx("div",{className:"rb-app",children:r.jsx(Y,{children:r.jsx(l.Suspense,{fallback:r.jsx(et,{}),children:r.jsx(h,{children:r.jsx(g,{path:"/reader/:contentId",element:r.jsx(Fe,{})})})})})}):r.jsxs("div",{className:"rb-app",children:[r.jsx(tt,{}),i&&r.jsx(H,{}),r.jsxs("main",{className:"rb-main",style:{display:"grid",gridTemplateColumns:"1fr",gap:16,marginLeft:i?320:0,transition:"margin-left 0.3s ease"},children:[!1,r.jsx("div",{children:r.jsx(Y,{children:r.jsx(l.Suspense,{fallback:r.jsx(et,{}),children:r.jsxs(h,{children:[r.jsx(g,{path:"/",element:r.jsx($e,{})}),r.jsx(g,{path:"/beta",element:r.jsx(Ne,{})}),r.jsx(g,{path:"/login",element:r.jsx(p,{to:"/auth",replace:!0})}),r.jsx(g,{path:"/signup",element:r.jsx(p,{to:"/auth",replace:!0})}),r.jsx(g,{path:"/search",element:r.jsx(Ie,{})}),r.jsx(g,{path:"/studio",element:r.jsx(Le,{})}),r.jsx(g,{path:"/dashboard",element:r.jsx(We,{})}),r.jsx(g,{path:"/profile",element:r.jsx(Ae,{})}),r.jsx(g,{path:"/profile/:username",element:r.jsx(Oe,{})}),r.jsx(g,{path:"/collaborators",element:r.jsx(Be,{})}),r.jsx(g,{path:"/auth",element:r.jsx(Me,{})}),r.jsx(g,{path:"/wallet-info",element:r.jsx(Xe,{})}),r.jsx(g,{path:"/terms",element:r.jsx(Ge,{})}),r.jsx(g,{path:"/legal/terms",element:r.jsx(Ge,{})}),r.jsx(g,{path:"/legal/privacy",element:r.jsx(Ue,{})}),r.jsx(g,{path:"/legal/content-policy",element:r.jsx(Ze,{})}),r.jsx(g,{path:"/legal/dmca",element:r.jsx(Ke,{})}),r.jsx(g,{path:"/legal/creator-agreement",element:r.jsx(Qe,{})}),r.jsx(g,{path:"/content/:id",element:r.jsx(De,{})}),r.jsx(g,{path:"/purchase/success",element:r.jsx(qe,{})}),r.jsx(g,{path:"/collaborations",element:r.jsx(J,{children:r.jsx(He,{})})}),r.jsx(g,{path:"/collaborations/:projectId",element:r.jsx(J,{children:r.jsx(Ve,{})})}),r.jsx(g,{path:"/notifications",element:r.jsx(J,{children:r.jsx(Je,{})})}),r.jsx(g,{path:"/feed",element:r.jsx(J,{children:r.jsx(Ye,{})})})]})})})})]}),a&&r.jsx(Te,{}),r.jsx(je,{}),r.jsx(ze,{}),r.jsx(Se,{}),r.jsx(Ce,{})]})}window.Buffer||(window.Buffer=n),window.process||(window.process=i);s.createRoot(document.getElementById("root")).render(r.jsx(f.StrictMode,{children:r.jsx(x,{children:r.jsx(nt,{})})}));export{m as A,_ as B,E as C,$ as D,xe as I,X as M,ue as N,B as S,D as U,q as X,P as a,fe as b,T as c,O as d,R as e,z as f,pe as g,b as l,F as u};
//# sourceMappingURL=index-BPbIkh4O.js.map
