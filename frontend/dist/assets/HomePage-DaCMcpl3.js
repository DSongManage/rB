import{j as e}from"./web3auth-BkZxjmxM.js";import{r as t,a as r,L as o}from"./router-cVcvJ1e3.js";import{B as a,C as n,a as i,A as s}from"./index-BYzJnJSi.js";import{S as l,V as d}from"./VideoCard-Bup1RVJr.js";import{E as c}from"./eye-CFO_j4CY.js";import{T as p}from"./thumbs-up-DGd6HW0S.js";import"./vendor-Cfs_Iq82.js";import"./star-lGD7AE4o.js";function u(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${e}`}const g=t.memo(function({id:s,title:d,coverImageUrl:g,author:b,chapters:h,publishedChapters:x,totalViews:f,totalLikes:m,totalPrice:y,averageRating:v,ratingCount:j,timeText:k}){const[w,S]=t.useState(!1),_=r(),C=h.find(e=>e.content_id),$=x>1,z=f>=100,T=f>=1e3;return!(null!=v&&j>0)||(Number(v).toFixed(1),u(j)),e.jsxs("div",{className:"yt-card",style:{background:"#0f172a",border:"1px solid #1e293b",borderRadius:16,overflow:"hidden",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)",e.currentTarget.style.borderColor="#334155"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor="#1e293b"},children:[e.jsxs("div",{onClick:()=>{$?S(!w):C&&_(`/content/${C.content_id}`)},style:{width:"100%",paddingTop:"56.25%",background:g?`url(${g})`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",position:"relative",cursor:"pointer"},children:[!g&&e.jsx("div",{style:{position:"absolute",inset:0,display:"grid",placeItems:"center",color:"rgba(255,255,255,0.3)"},children:e.jsx(a,{size:48})}),$&&e.jsxs("div",{style:{position:"absolute",top:8,right:8,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",padding:"4px 10px",borderRadius:12,fontSize:12,fontWeight:600,color:"#f8fafc"},children:[x," chapters"]}),y>0&&e.jsxs("div",{style:{position:"absolute",top:$?40:8,right:8,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(4px)",padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:700,color:"#10b981"},children:["$",y.toFixed(2)]})]}),e.jsxs("div",{style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600,color:"#f8fafc",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},children:d}),f>0&&e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,fontSize:11,fontWeight:T?700:z?600:500,color:T?"#f59e0b":z?"#10b981":"#94a3b8",background:T?"rgba(245, 158, 11, 0.15)":z?"rgba(16, 185, 129, 0.1)":"transparent",padding:z?"2px 6px":"0",borderRadius:4,flexShrink:0},children:[e.jsx(c,{size:12}),u(f)]})]}),e.jsxs("div",{style:{fontSize:13,color:"#94a3b8",marginBottom:12,display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[e.jsx(o,{to:`/profile/${b}`,style:{color:"#60a5fa",textDecoration:"none"},onClick:e=>e.stopPropagation(),children:b}),e.jsx("span",{children:"•"}),e.jsx(l,{rating:v,count:j,size:11}),e.jsx("span",{children:"•"}),e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:2},children:[e.jsx(p,{size:12})," ",u(m)]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:k})]}),$&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>S(!w),style:{width:"100%",background:"#1e293b",border:"none",borderRadius:8,padding:"8px 12px",color:"#94a3b8",fontSize:13,fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{children:"Chapters"}),w?e.jsx(n,{size:16}):e.jsx(i,{size:16})]}),w&&e.jsx("div",{style:{background:"#0d1117",borderRadius:8,padding:8,marginTop:8,maxHeight:200,overflowY:"auto"},children:h.map((t,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:6,background:r%2==0?"transparent":"rgba(255,255,255,0.02)"},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:13,color:"#e2e8f0",fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:["Ch ",t.order+1,": ",t.title]}),e.jsxs("div",{style:{fontSize:11,color:"#64748b"},children:["$",t.price_usd.toFixed(2)," • ",t.view_count," views"]})]}),e.jsx("button",{onClick:e=>{var r;e.stopPropagation(),r=t.content_id,_(`/content/${r}`)},style:{background:"transparent",border:"1px solid #334155",borderRadius:6,padding:"4px 10px",color:"#94a3b8",fontSize:11,fontWeight:500,cursor:"pointer",marginLeft:8,flexShrink:0},children:"View"})]},t.id))})]})]})]})}),b=[{label:"All",value:"all"},{label:"Books",value:"book"},{label:"Art",value:"art"},{label:"Film",value:"film",comingSoon:!0},{label:"Music",value:"music",comingSoon:!0}];function h(){const[r,o]=t.useState([]),[a,n]=t.useState([]),[i,l]=t.useState("all");t.useEffect(()=>{const e=new AbortController,t=fetch(`${s}/api/content/`,{credentials:"include",signal:e.signal}).then(e=>e.json()).then(e=>e&&Array.isArray(e.results)?e.results.filter(e=>"book"!==e.content_type):Array.isArray(e)?e.filter(e=>"book"!==e.content_type):[]),r=fetch(`${s}/api/book-projects/public/`,{credentials:"include",signal:e.signal}).then(e=>e.json()).then(e=>Array.isArray(e)?e:[]);return Promise.all([t,r]).then(([e,t])=>{o(e),n(t)}).catch(e=>{"AbortError"!==e.name&&(o([]),n([]))}),()=>e.abort()},[]);const c=e=>{if(!e)return"Recently";const t=new Date(e),r=new Date,o=Math.floor((r.getTime()-t.getTime())/1e3);return o<60?"Just now":o<3600?`${Math.floor(o/60)} minutes ago`:o<86400?`${Math.floor(o/3600)} hours ago`:o<604800?`${Math.floor(o/86400)} days ago`:`${Math.floor(o/604800)} weeks ago`},p=t.useMemo(()=>{const e=[];return r.forEach(t=>{e.push({type:"content",sortKey:t.created_at?new Date(t.created_at).getTime():0,data:t})}),a.forEach(t=>{e.push({type:"book",sortKey:t.created_at?new Date(t.created_at).getTime():0,data:t})}),e.sort((e,t)=>t.sortKey-e.sortKey),e},[r,a]),u=t.useMemo(()=>"all"===i?p:p.filter(e=>"book"===e.type?"book"===i:e.data.content_type===i),[p,i]);return e.jsxs("div",{children:[e.jsx("div",{className:"chips","data-tour":"genre-filters",children:b.map(t=>e.jsxs("button",{className:`chip ${i===t.value?"active":""} ${t.comingSoon?"disabled":""}`,onClick:()=>!t.comingSoon&&l(t.value),disabled:t.comingSoon,style:{opacity:t.comingSoon?.5:1,cursor:t.comingSoon?"not-allowed":"pointer"},children:[t.label,t.comingSoon&&e.jsx("span",{style:{fontSize:9,background:"#f59e0b",color:"#000",padding:"1px 4px",borderRadius:3,marginLeft:4,fontWeight:700},children:"SOON"})]},t.value))}),e.jsx("div",{className:"page",style:{padding:0,background:"transparent",border:"none",boxShadow:"none"},children:e.jsx("div",{className:"yt-grid","data-tour":"content-grid",children:u.map(t=>{var r;if("book"===t.type){const r=t.data;return e.jsx(g,{id:r.id,title:r.title,coverImageUrl:r.cover_image_url||"",author:r.creator_username,chapters:r.chapters,publishedChapters:r.published_chapters,totalViews:r.total_views,totalLikes:r.total_likes,totalPrice:r.total_price,averageRating:r.average_rating,ratingCount:r.rating_count,timeText:c(r.created_at)},`book-${r.id}`)}{const o=t.data;return e.jsx(d,{id:o.id,title:o.title,author:o.creator_username||`Creator #${o.creator??0}`,likeCount:o.like_count,viewCount:o.view_count,averageRating:o.average_rating,ratingCount:o.rating_count,timeText:c(o.created_at),thumbnailUrl:o.teaser_link||"",price:o.price_usd,editions:o.editions,owned:o.owned,isCollaborative:o.is_collaborative,collaborators:null==(r=o.collaborators)?void 0:r.map(e=>e.username)},`content-${o.id}`)}})})})]})}export{h as default};
