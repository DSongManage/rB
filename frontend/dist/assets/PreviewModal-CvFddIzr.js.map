{"version":3,"file":"PreviewModal-CvFddIzr.js","sources":["../../node_modules/lucide-react/dist/esm/icons/message-circle.js","../../node_modules/lucide-react/dist/esm/icons/reply.js","../../node_modules/lucide-react/dist/esm/icons/share-2.js","../../src/components/social/LikeButton.tsx","../../src/hooks/useLikes.ts","../../src/components/social/CommentItem.tsx","../../src/components/social/ContentCommentsSection.tsx","../../src/hooks/useContentComments.ts","../../src/components/AddToCartButton.tsx","../../src/components/PreviewModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719\",\n      key: \"1sd12s\"\n    }\n  ]\n];\nconst MessageCircle = createLucideIcon(\"message-circle\", __iconNode);\n\nexport { __iconNode, MessageCircle as default };\n//# sourceMappingURL=message-circle.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M20 18v-2a4 4 0 0 0-4-4H4\", key: \"5vmcpk\" }],\n  [\"path\", { d: \"m9 17-5-5 5-5\", key: \"nvlc11\" }]\n];\nconst Reply = createLucideIcon(\"reply\", __iconNode);\n\nexport { __iconNode, Reply as default };\n//# sourceMappingURL=reply.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"18\", cy: \"5\", r: \"3\", key: \"gq8acd\" }],\n  [\"circle\", { cx: \"6\", cy: \"12\", r: \"3\", key: \"w7nqdw\" }],\n  [\"circle\", { cx: \"18\", cy: \"19\", r: \"3\", key: \"1xt0gg\" }],\n  [\"line\", { x1: \"8.59\", x2: \"15.42\", y1: \"13.51\", y2: \"17.49\", key: \"47mynk\" }],\n  [\"line\", { x1: \"15.41\", x2: \"8.59\", y1: \"6.51\", y2: \"10.49\", key: \"1n3mei\" }]\n];\nconst Share2 = createLucideIcon(\"share-2\", __iconNode);\n\nexport { __iconNode, Share2 as default };\n//# sourceMappingURL=share-2.js.map\n","/**\n * LikeButton Component\n *\n * Modern like button with thumbs up icon, animated interactions.\n */\n\nimport React from 'react';\nimport { ThumbsUp } from 'lucide-react';\nimport { useLikes } from '../../hooks/useLikes';\n\ninterface LikeButtonProps {\n  contentId: number;\n  initialLiked?: boolean;\n  initialCount?: number;\n  size?: 'sm' | 'md' | 'lg';\n  showCount?: boolean;\n  className?: string;\n  onAuthRequired?: () => void;\n  isAuthenticated?: boolean;\n}\n\nexport function LikeButton({\n  contentId,\n  initialLiked = false,\n  initialCount = 0,\n  size = 'md',\n  showCount = true,\n  className = '',\n  onAuthRequired,\n  isAuthenticated = true,\n}: LikeButtonProps) {\n  const { liked, likeCount, isLoading, toggle } = useLikes(contentId, {\n    initialLiked,\n    initialCount,\n  });\n\n  const sizeConfig = {\n    sm: { icon: 18, padding: '6px 10px', fontSize: 12 },\n    md: { icon: 22, padding: '8px 14px', fontSize: 14 },\n    lg: { icon: 26, padding: '10px 18px', fontSize: 16 },\n  };\n\n  const config = sizeConfig[size];\n\n  const handleClick = async (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!isAuthenticated) {\n      onAuthRequired?.();\n      return;\n    }\n\n    await toggle();\n  };\n\n  return (\n    <button\n      onClick={handleClick}\n      disabled={isLoading}\n      className={className}\n      style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        gap: 8,\n        padding: config.padding,\n        background: liked ? 'rgba(59, 130, 246, 0.15)' : 'rgba(255, 255, 255, 0.05)',\n        border: `1px solid ${liked ? 'rgba(59, 130, 246, 0.3)' : 'rgba(255, 255, 255, 0.1)'}`,\n        borderRadius: 10,\n        cursor: isLoading ? 'not-allowed' : 'pointer',\n        opacity: isLoading ? 0.6 : 1,\n        transition: 'all 0.2s ease',\n      }}\n      onMouseEnter={(e) => {\n        if (!isLoading) {\n          e.currentTarget.style.background = liked ? 'rgba(59, 130, 246, 0.25)' : 'rgba(255, 255, 255, 0.1)';\n          e.currentTarget.style.transform = 'scale(1.05)';\n        }\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.background = liked ? 'rgba(59, 130, 246, 0.15)' : 'rgba(255, 255, 255, 0.05)';\n        e.currentTarget.style.transform = 'scale(1)';\n      }}\n      aria-label={liked ? 'Unlike' : 'Like'}\n    >\n      <ThumbsUp\n        size={config.icon}\n        fill={liked ? '#3b82f6' : 'transparent'}\n        color={liked ? '#3b82f6' : '#94a3b8'}\n        style={{\n          transition: 'all 0.2s ease',\n        }}\n      />\n      {showCount && (\n        <span style={{\n          fontSize: config.fontSize,\n          fontWeight: 600,\n          color: liked ? '#3b82f6' : '#cbd5e1',\n        }}>\n          {likeCount > 0 ? likeCount.toLocaleString() : 'Like'}\n        </span>\n      )}\n    </button>\n  );\n}\n\nexport default LikeButton;\n","/**\n * useLikes Hook\n *\n * Manages like state for content with optimistic updates.\n * Includes debouncing to prevent rate limiting.\n */\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { toggleLike, getLikeStatus } from '../services/socialApi';\n\ninterface UseLikesOptions {\n  initialLiked?: boolean;\n  initialCount?: number;\n}\n\ninterface UseLikesReturn {\n  liked: boolean;\n  likeCount: number;\n  isLoading: boolean;\n  error: string | null;\n  toggle: () => Promise<void>;\n  refresh: () => Promise<void>;\n}\n\nexport function useLikes(\n  contentId: number,\n  options: UseLikesOptions = {}\n): UseLikesReturn {\n  const [liked, setLiked] = useState(options.initialLiked ?? false);\n  const [likeCount, setLikeCount] = useState(options.initialCount ?? 0);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Refs to prevent race conditions and duplicate requests\n  const pendingRequest = useRef<boolean>(false);\n  const lastToggleTime = useRef<number>(0);\n  const DEBOUNCE_MS = 500; // Minimum time between toggles (allows responsive unlike)\n\n  const refresh = useCallback(async () => {\n    try {\n      const status = await getLikeStatus(contentId);\n      setLiked(status.liked);\n      setLikeCount(status.like_count);\n      setError(null);\n    } catch (err) {\n      // Silently fail on refresh - user might not be authenticated\n      console.error('Failed to get like status:', err);\n    }\n  }, [contentId]);\n\n  const toggle = useCallback(async () => {\n    // Prevent duplicate requests using ref (synchronous check)\n    if (pendingRequest.current) return;\n\n    // Debounce - prevent rapid clicks\n    const now = Date.now();\n    if (now - lastToggleTime.current < DEBOUNCE_MS) {\n      return;\n    }\n    lastToggleTime.current = now;\n    pendingRequest.current = true;\n\n    // Optimistic update\n    const previousLiked = liked;\n    const previousCount = likeCount;\n    setLiked(!liked);\n    setLikeCount(liked ? likeCount - 1 : likeCount + 1);\n    setError(null);\n    setIsLoading(true);\n\n    try {\n      const result = await toggleLike(contentId);\n      setLiked(result.liked);\n      setLikeCount(result.like_count);\n    } catch (err) {\n      // Rollback on error\n      setLiked(previousLiked);\n      setLikeCount(previousCount);\n      const message = err instanceof Error ? err.message : 'Failed to toggle like';\n      // Don't show throttle errors to user - just silently fail\n      if (!message.includes('throttle')) {\n        setError(message);\n      }\n    } finally {\n      setIsLoading(false);\n      pendingRequest.current = false;\n    }\n  }, [contentId, liked, likeCount]);\n\n  // Sync with options when they change\n  useEffect(() => {\n    if (options.initialLiked !== undefined) {\n      setLiked(options.initialLiked);\n    }\n    if (options.initialCount !== undefined) {\n      setLikeCount(options.initialCount);\n    }\n  }, [options.initialLiked, options.initialCount]);\n\n  return {\n    liked,\n    likeCount,\n    isLoading,\n    error,\n    toggle,\n    refresh,\n  };\n}\n\nexport default useLikes;\n","/**\n * CommentItem Component\n *\n * Modern comment with reply, edit, and delete functionality - dark theme.\n */\n\nimport React, { useState } from 'react';\nimport { Reply, Edit2, Trash2, ChevronDown, ChevronUp, Send } from 'lucide-react';\nimport { Link } from 'react-router-dom';\nimport { ContentComment } from '../../services/socialApi';\n\ninterface CommentItemProps {\n  comment: ContentComment;\n  onReply: (text: string, parentId: number) => Promise<void>;\n  onEdit: (commentId: number, text: string) => Promise<void>;\n  onDelete: (commentId: number) => Promise<void>;\n  onLoadReplies: (commentId: number) => Promise<ContentComment[]>;\n  isAuthenticated?: boolean;\n  currentUsername?: string;\n  depth?: number;\n  maxDepth?: number;\n}\n\nexport function CommentItem({\n  comment,\n  onReply,\n  onEdit,\n  onDelete,\n  onLoadReplies,\n  isAuthenticated = false,\n  currentUsername,\n  depth = 0,\n  maxDepth = 3,\n}: CommentItemProps) {\n  const [showReplyForm, setShowReplyForm] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [replyText, setReplyText] = useState('');\n  const [editText, setEditText] = useState(comment.text);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [showReplies, setShowReplies] = useState(false);\n  const [replies, setReplies] = useState<ContentComment[]>([]);\n  const [loadingReplies, setLoadingReplies] = useState(false);\n\n  const timeAgo = (date: string) => {\n    const now = new Date();\n    const then = new Date(date);\n    const diff = Math.floor((now.getTime() - then.getTime()) / 1000);\n\n    if (diff < 60) return 'just now';\n    if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n    if (diff < 2592000) return `${Math.floor(diff / 86400)}d ago`;\n    return then.toLocaleDateString();\n  };\n\n  const handleReplySubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!replyText.trim()) return;\n\n    setIsSubmitting(true);\n    try {\n      await onReply(replyText, comment.id);\n      setReplyText('');\n      setShowReplyForm(false);\n      await handleLoadReplies();\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleEditSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!editText.trim()) return;\n\n    setIsSubmitting(true);\n    try {\n      await onEdit(comment.id, editText);\n      setIsEditing(false);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!confirm('Are you sure you want to delete this comment?')) return;\n    await onDelete(comment.id);\n  };\n\n  const handleLoadReplies = async () => {\n    if (!showReplies && comment.replies_count > 0) {\n      setLoadingReplies(true);\n      try {\n        const loadedReplies = await onLoadReplies(comment.id);\n        setReplies(loadedReplies);\n      } finally {\n        setLoadingReplies(false);\n      }\n    }\n    setShowReplies(!showReplies);\n  };\n\n  const canReply = isAuthenticated && depth < maxDepth;\n  const marginLeft = Math.min(depth * 20, 60);\n\n  const buttonStyle: React.CSSProperties = {\n    display: 'inline-flex',\n    alignItems: 'center',\n    gap: 4,\n    background: 'transparent',\n    border: 'none',\n    padding: '4px 8px',\n    borderRadius: 6,\n    fontSize: 12,\n    color: '#64748b',\n    cursor: 'pointer',\n    transition: 'all 0.15s ease',\n  };\n\n  return (\n    <div style={{ marginLeft: `${marginLeft}px` }}>\n      <div style={{ padding: '12px 0' }}>\n        <div style={{ display: 'flex', gap: 12 }}>\n          {comment.author_avatar ? (\n            <img\n              src={comment.author_avatar}\n              alt={comment.author_username}\n              style={{\n                width: 36,\n                height: 36,\n                borderRadius: '50%',\n                objectFit: 'cover',\n                flexShrink: 0,\n              }}\n            />\n          ) : (\n            <div style={{\n              width: 36,\n              height: 36,\n              borderRadius: '50%',\n              background: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              color: '#fff',\n              fontSize: 14,\n              fontWeight: 600,\n              flexShrink: 0,\n            }}>\n              {comment.author_username.charAt(0).toUpperCase()}\n            </div>\n          )}\n\n          <div style={{ flex: 1, minWidth: 0 }}>\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              flexWrap: 'wrap',\n              marginBottom: 4,\n            }}>\n              <Link\n                to={`/profile/${comment.author_username}`}\n                style={{\n                  fontWeight: 600,\n                  color: '#f1f5f9',\n                  textDecoration: 'none',\n                  fontSize: 13,\n                }}\n              >\n                @{comment.author_username}\n              </Link>\n              <span style={{ fontSize: 11, color: '#64748b' }}>\n                {timeAgo(comment.created_at)}\n              </span>\n              {comment.edited && (\n                <span style={{ fontSize: 11, color: '#475569' }}>(edited)</span>\n              )}\n            </div>\n\n            {isEditing ? (\n              <form onSubmit={handleEditSubmit} style={{ marginTop: 8 }}>\n                <textarea\n                  value={editText}\n                  onChange={e => setEditText(e.target.value)}\n                  rows={2}\n                  disabled={isSubmitting}\n                  style={{\n                    width: '100%',\n                    padding: '10px 12px',\n                    background: '#0f172a',\n                    border: '1px solid #334155',\n                    borderRadius: 8,\n                    color: '#f1f5f9',\n                    fontSize: 13,\n                    resize: 'none',\n                    outline: 'none',\n                  }}\n                />\n                <div style={{ display: 'flex', gap: 8, marginTop: 8 }}>\n                  <button\n                    type=\"submit\"\n                    disabled={isSubmitting || !editText.trim()}\n                    style={{\n                      padding: '6px 12px',\n                      background: '#8b5cf6',\n                      border: 'none',\n                      borderRadius: 6,\n                      color: '#fff',\n                      fontSize: 12,\n                      fontWeight: 500,\n                      cursor: 'pointer',\n                      opacity: isSubmitting || !editText.trim() ? 0.5 : 1,\n                    }}\n                  >\n                    {isSubmitting ? 'Saving...' : 'Save'}\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditText(comment.text);\n                    }}\n                    style={{\n                      padding: '6px 12px',\n                      background: '#334155',\n                      border: 'none',\n                      borderRadius: 6,\n                      color: '#94a3b8',\n                      fontSize: 12,\n                      fontWeight: 500,\n                      cursor: 'pointer',\n                    }}\n                  >\n                    Cancel\n                  </button>\n                </div>\n              </form>\n            ) : (\n              <p style={{\n                color: '#cbd5e1',\n                fontSize: 14,\n                lineHeight: 1.6,\n                margin: 0,\n                whiteSpace: 'pre-wrap',\n              }}>\n                {comment.text}\n              </p>\n            )}\n\n            {/* Actions */}\n            {!isEditing && (\n              <div style={{ display: 'flex', alignItems: 'center', gap: 4, marginTop: 8 }}>\n                {canReply && (\n                  <button\n                    onClick={() => setShowReplyForm(!showReplyForm)}\n                    style={buttonStyle}\n                    onMouseEnter={(e) => e.currentTarget.style.color = '#a78bfa'}\n                    onMouseLeave={(e) => e.currentTarget.style.color = '#64748b'}\n                  >\n                    <Reply size={14} />\n                    Reply\n                  </button>\n                )}\n                {comment.can_edit && (\n                  <button\n                    onClick={() => setIsEditing(true)}\n                    style={buttonStyle}\n                    onMouseEnter={(e) => e.currentTarget.style.color = '#a78bfa'}\n                    onMouseLeave={(e) => e.currentTarget.style.color = '#64748b'}\n                  >\n                    <Edit2 size={14} />\n                    Edit\n                  </button>\n                )}\n                {comment.can_delete && (\n                  <button\n                    onClick={handleDelete}\n                    style={buttonStyle}\n                    onMouseEnter={(e) => e.currentTarget.style.color = '#ef4444'}\n                    onMouseLeave={(e) => e.currentTarget.style.color = '#64748b'}\n                  >\n                    <Trash2 size={14} />\n                    Delete\n                  </button>\n                )}\n                {comment.replies_count > 0 && (\n                  <button\n                    onClick={handleLoadReplies}\n                    style={{ ...buttonStyle, color: '#8b5cf6' }}\n                  >\n                    {showReplies ? (\n                      <>\n                        <ChevronUp size={14} />\n                        Hide replies\n                      </>\n                    ) : (\n                      <>\n                        <ChevronDown size={14} />\n                        {loadingReplies ? 'Loading...' : `${comment.replies_count} replies`}\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            )}\n\n            {/* Reply Form */}\n            {showReplyForm && (\n              <form onSubmit={handleReplySubmit} style={{ marginTop: 12 }}>\n                <div style={{\n                  display: 'flex',\n                  gap: 8,\n                  alignItems: 'flex-end',\n                }}>\n                  <textarea\n                    value={replyText}\n                    onChange={e => setReplyText(e.target.value)}\n                    placeholder={`Reply to @${comment.author_username}...`}\n                    rows={2}\n                    disabled={isSubmitting}\n                    style={{\n                      flex: 1,\n                      padding: '10px 12px',\n                      background: '#0f172a',\n                      border: '1px solid #334155',\n                      borderRadius: 8,\n                      color: '#f1f5f9',\n                      fontSize: 13,\n                      resize: 'none',\n                      outline: 'none',\n                    }}\n                  />\n                  <button\n                    type=\"submit\"\n                    disabled={isSubmitting || !replyText.trim()}\n                    style={{\n                      padding: '10px 14px',\n                      background: replyText.trim() ? '#8b5cf6' : '#334155',\n                      border: 'none',\n                      borderRadius: 8,\n                      color: replyText.trim() ? '#fff' : '#64748b',\n                      cursor: isSubmitting || !replyText.trim() ? 'not-allowed' : 'pointer',\n                    }}\n                  >\n                    <Send size={16} />\n                  </button>\n                </div>\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setShowReplyForm(false);\n                    setReplyText('');\n                  }}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: '#64748b',\n                    fontSize: 12,\n                    cursor: 'pointer',\n                    marginTop: 6,\n                  }}\n                >\n                  Cancel\n                </button>\n              </form>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Nested Replies */}\n      {showReplies && replies.length > 0 && (\n        <div style={{ borderLeft: '2px solid #1e293b', marginLeft: 18 }}>\n          {replies.map(reply => (\n            <CommentItem\n              key={reply.id}\n              comment={reply}\n              onReply={onReply}\n              onEdit={onEdit}\n              onDelete={onDelete}\n              onLoadReplies={onLoadReplies}\n              isAuthenticated={isAuthenticated}\n              currentUsername={currentUsername}\n              depth={depth + 1}\n              maxDepth={maxDepth}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default CommentItem;\n","/**\n * ContentCommentsSection Component\n *\n * Modern comment section with dark theme styling.\n */\n\nimport React, { useState } from 'react';\nimport { MessageSquare, Send } from 'lucide-react';\nimport CommentItem from './CommentItem';\nimport { useContentComments } from '../../hooks/useContentComments';\n\ninterface ContentCommentsSectionProps {\n  contentId: number;\n  isAuthenticated?: boolean;\n  currentUsername?: string;\n  onAuthRequired?: () => void;\n}\n\nexport function ContentCommentsSection({\n  contentId,\n  isAuthenticated = false,\n  currentUsername,\n  onAuthRequired,\n}: ContentCommentsSectionProps) {\n  const [newComment, setNewComment] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const {\n    comments,\n    isLoading,\n    error,\n    hasMore,\n    totalCount,\n    loadMore,\n    addComment,\n    editComment,\n    removeComment,\n    loadReplies,\n  } = useContentComments(contentId);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!isAuthenticated) {\n      onAuthRequired?.();\n      return;\n    }\n\n    if (!newComment.trim()) return;\n\n    setIsSubmitting(true);\n    try {\n      await addComment(newComment);\n      setNewComment('');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleReply = async (text: string, parentId: number) => {\n    await addComment(text, parentId);\n  };\n\n  return (\n    <div style={{\n      background: '#0f172a',\n      borderRadius: 16,\n      border: '1px solid #1e293b',\n      overflow: 'hidden',\n    }}>\n      {/* Header */}\n      <div style={{\n        padding: '20px 24px',\n        borderBottom: '1px solid #1e293b',\n        display: 'flex',\n        alignItems: 'center',\n        gap: 10,\n      }}>\n        <MessageSquare size={20} color=\"#8b5cf6\" />\n        <h3 style={{\n          margin: 0,\n          fontSize: 18,\n          fontWeight: 700,\n          color: '#f1f5f9',\n        }}>\n          Comments\n        </h3>\n        {totalCount > 0 && (\n          <span style={{\n            background: '#1e293b',\n            color: '#94a3b8',\n            padding: '4px 10px',\n            borderRadius: 12,\n            fontSize: 13,\n            fontWeight: 500,\n          }}>\n            {totalCount}\n          </span>\n        )}\n      </div>\n\n      {/* Content */}\n      <div style={{ padding: '20px 24px' }}>\n        {/* New Comment Form */}\n        <form onSubmit={handleSubmit} style={{ marginBottom: 24 }}>\n          <div style={{\n            display: 'flex',\n            gap: 12,\n            alignItems: 'flex-start',\n          }}>\n            <div style={{\n              width: 40,\n              height: 40,\n              borderRadius: '50%',\n              background: isAuthenticated\n                ? 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)'\n                : '#334155',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              color: '#fff',\n              fontSize: 16,\n              fontWeight: 600,\n              flexShrink: 0,\n            }}>\n              {currentUsername ? currentUsername.charAt(0).toUpperCase() : '?'}\n            </div>\n            <div style={{ flex: 1 }}>\n              <textarea\n                value={newComment}\n                onChange={e => setNewComment(e.target.value)}\n                placeholder={\n                  isAuthenticated\n                    ? 'Share your thoughts...'\n                    : 'Sign in to leave a comment'\n                }\n                rows={3}\n                disabled={!isAuthenticated || isSubmitting}\n                onClick={() => {\n                  if (!isAuthenticated) {\n                    onAuthRequired?.();\n                  }\n                }}\n                style={{\n                  width: '100%',\n                  padding: '12px 14px',\n                  background: '#1e293b',\n                  border: '1px solid #334155',\n                  borderRadius: 12,\n                  color: '#f1f5f9',\n                  fontSize: 14,\n                  resize: 'none',\n                  outline: 'none',\n                  transition: 'border-color 0.2s',\n                  cursor: !isAuthenticated ? 'pointer' : 'text',\n                }}\n                onFocus={(e) => {\n                  if (isAuthenticated) {\n                    e.target.style.borderColor = '#8b5cf6';\n                  }\n                }}\n                onBlur={(e) => e.target.style.borderColor = '#334155'}\n              />\n              {isAuthenticated && (\n                <div style={{\n                  display: 'flex',\n                  justifyContent: 'flex-end',\n                  marginTop: 12,\n                }}>\n                  <button\n                    type=\"submit\"\n                    disabled={isSubmitting || !newComment.trim()}\n                    style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: 8,\n                      padding: '10px 20px',\n                      background: newComment.trim()\n                        ? 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)'\n                        : '#334155',\n                      border: 'none',\n                      borderRadius: 10,\n                      color: newComment.trim() ? '#fff' : '#64748b',\n                      fontSize: 14,\n                      fontWeight: 600,\n                      cursor: isSubmitting || !newComment.trim() ? 'not-allowed' : 'pointer',\n                      opacity: isSubmitting ? 0.7 : 1,\n                      transition: 'all 0.2s ease',\n                    }}\n                  >\n                    <Send size={16} />\n                    {isSubmitting ? 'Posting...' : 'Post Comment'}\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n        </form>\n\n        {/* Error Message */}\n        {error && (\n          <p style={{\n            fontSize: 13,\n            color: '#ef4444',\n            marginBottom: 16,\n            padding: '10px 14px',\n            background: 'rgba(239, 68, 68, 0.1)',\n            borderRadius: 8,\n          }}>\n            {error}\n          </p>\n        )}\n\n        {/* Comments List */}\n        {isLoading && comments.length === 0 ? (\n          <div style={{\n            textAlign: 'center',\n            padding: '32px 0',\n            color: '#64748b',\n            fontSize: 14,\n          }}>\n            Loading comments...\n          </div>\n        ) : comments.length === 0 ? (\n          <div style={{\n            textAlign: 'center',\n            padding: '32px 0',\n            color: '#64748b',\n            fontSize: 14,\n          }}>\n            No comments yet. Be the first to comment!\n          </div>\n        ) : (\n          <>\n            <div>\n              {comments.map(comment => (\n                <div\n                  key={comment.id}\n                  style={{\n                    borderBottom: '1px solid #1e293b',\n                  }}\n                >\n                  <CommentItem\n                    comment={comment}\n                    onReply={handleReply}\n                    onEdit={editComment}\n                    onDelete={removeComment}\n                    onLoadReplies={loadReplies}\n                    isAuthenticated={isAuthenticated}\n                    currentUsername={currentUsername}\n                  />\n                </div>\n              ))}\n            </div>\n\n            {hasMore && (\n              <button\n                onClick={loadMore}\n                disabled={isLoading}\n                style={{\n                  width: '100%',\n                  marginTop: 16,\n                  padding: '12px',\n                  background: 'transparent',\n                  border: '1px solid #334155',\n                  borderRadius: 10,\n                  color: '#8b5cf6',\n                  fontSize: 14,\n                  fontWeight: 600,\n                  cursor: isLoading ? 'not-allowed' : 'pointer',\n                  opacity: isLoading ? 0.6 : 1,\n                  transition: 'all 0.2s ease',\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.background = 'rgba(139, 92, 246, 0.1)';\n                  e.currentTarget.style.borderColor = '#8b5cf6';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.background = 'transparent';\n                  e.currentTarget.style.borderColor = '#334155';\n                }}\n              >\n                {isLoading ? 'Loading...' : 'Load More Comments'}\n              </button>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default ContentCommentsSection;\n","/**\n * useContentComments Hook\n *\n * Manages comments for content with threading support.\n * Includes deduplication to prevent rate limiting.\n */\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport {\n  ContentComment,\n  getContentComments,\n  getCommentReplies,\n  createComment,\n  updateComment,\n  deleteComment,\n} from '../services/socialApi';\n\ninterface UseContentCommentsReturn {\n  comments: ContentComment[];\n  isLoading: boolean;\n  error: string | null;\n  hasMore: boolean;\n  totalCount: number;\n  loadMore: () => Promise<void>;\n  refresh: () => Promise<void>;\n  addComment: (text: string, parentId?: number) => Promise<ContentComment>;\n  editComment: (commentId: number, text: string) => Promise<void>;\n  removeComment: (commentId: number) => Promise<void>;\n  loadReplies: (commentId: number) => Promise<ContentComment[]>;\n}\n\nexport function useContentComments(contentId: number): UseContentCommentsReturn {\n  const [comments, setComments] = useState<ContentComment[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(false);\n  const [totalCount, setTotalCount] = useState(0);\n\n  // Refs to prevent duplicate requests\n  const fetchingRef = useRef<boolean>(false);\n  const initialLoadDone = useRef<boolean>(false);\n\n  const fetchComments = useCallback(async (pageNum: number, append: boolean = false) => {\n    // Prevent duplicate fetches\n    if (fetchingRef.current) return;\n    fetchingRef.current = true;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await getContentComments(contentId, pageNum, true);\n      setComments(prev =>\n        append ? [...prev, ...response.results] : response.results\n      );\n      setHasMore(response.next !== null);\n      setTotalCount(response.count);\n      setPage(pageNum);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to load comments';\n      // Don't show throttle errors\n      if (!message.includes('throttle')) {\n        setError(message);\n      }\n    } finally {\n      setIsLoading(false);\n      fetchingRef.current = false;\n    }\n  }, [contentId]);\n\n  const refresh = useCallback(async () => {\n    await fetchComments(1, false);\n  }, [fetchComments]);\n\n  const loadMore = useCallback(async () => {\n    if (isLoading || !hasMore || fetchingRef.current) return;\n    await fetchComments(page + 1, true);\n  }, [fetchComments, isLoading, hasMore, page]);\n\n  const addComment = useCallback(async (text: string, parentId?: number): Promise<ContentComment> => {\n    const newComment = await createComment(contentId, text, parentId);\n\n    if (parentId) {\n      // This is a reply - update the parent's reply count\n      setComments(prev =>\n        prev.map(c =>\n          c.id === parentId\n            ? { ...c, replies_count: c.replies_count + 1 }\n            : c\n        )\n      );\n    } else {\n      // This is a top-level comment - add to the beginning\n      setComments(prev => [newComment, ...prev]);\n      setTotalCount(prev => prev + 1);\n    }\n\n    return newComment;\n  }, [contentId]);\n\n  const editComment = useCallback(async (commentId: number, text: string): Promise<void> => {\n    const updated = await updateComment(commentId, text);\n    setComments(prev =>\n      prev.map(c => (c.id === commentId ? updated : c))\n    );\n  }, []);\n\n  const removeComment = useCallback(async (commentId: number): Promise<void> => {\n    await deleteComment(commentId);\n    setComments(prev => prev.filter(c => c.id !== commentId));\n    setTotalCount(prev => prev - 1);\n  }, []);\n\n  const loadReplies = useCallback(async (commentId: number): Promise<ContentComment[]> => {\n    const replies = await getCommentReplies(commentId);\n    return replies;\n  }, []);\n\n  // Initial load - only once per contentId\n  useEffect(() => {\n    if (!initialLoadDone.current) {\n      initialLoadDone.current = true;\n      fetchComments(1, false);\n    }\n  }, [contentId]); // Only depend on contentId, not fetchComments\n\n  // Reset when contentId changes\n  useEffect(() => {\n    return () => {\n      initialLoadDone.current = false;\n    };\n  }, [contentId]);\n\n  return {\n    comments,\n    isLoading,\n    error,\n    hasMore,\n    totalCount,\n    loadMore,\n    refresh,\n    addComment,\n    editComment,\n    removeComment,\n    loadReplies,\n  };\n}\n\nexport default useContentComments;\n","/**\n * Add to Cart Button Component\n *\n * Button for adding chapters/content to shopping cart.\n * Shows appropriate state: loading, in cart, cart full, or add action.\n */\n\nimport React, { useState } from 'react';\nimport { ShoppingCart, Check, AlertCircle } from 'lucide-react';\nimport { useCart } from '../contexts/CartContext';\n\ninterface AddToCartButtonProps {\n  chapterId?: number;\n  contentId?: number;\n  price: string;\n  alreadyOwned?: boolean;\n  compact?: boolean;\n  onSuccess?: () => void;\n  className?: string;\n}\n\nexport default function AddToCartButton({\n  chapterId,\n  contentId,\n  price,\n  alreadyOwned = false,\n  compact = false,\n  onSuccess,\n  className = '',\n}: AddToCartButtonProps) {\n  const { addToCart, cart, error, isInCart } = useCart();\n  const [loading, setLoading] = useState(false);\n  const [localError, setLocalError] = useState<string | null>(null);\n  const [justAdded, setJustAdded] = useState(false);\n\n  const type = chapterId ? 'chapter' : 'content';\n  const itemId = chapterId || contentId || 0;\n  const inCart = isInCart(itemId, type);\n  const cartFull = !!(cart && cart.item_count >= cart.max_items);\n\n  async function handleClick() {\n    if (alreadyOwned || inCart || cartFull || loading) return;\n\n    setLoading(true);\n    setLocalError(null);\n\n    const success = await addToCart(chapterId, contentId);\n\n    if (success) {\n      setJustAdded(true);\n      setTimeout(() => setJustAdded(false), 2000);\n      onSuccess?.();\n    } else {\n      setLocalError(error || 'Failed to add to cart');\n    }\n\n    setLoading(false);\n  }\n\n  // Already owned state\n  if (alreadyOwned) {\n    return (\n      <button\n        disabled\n        className={`rb-cart-btn rb-cart-btn--owned ${className}`}\n        style={{\n          display: 'inline-flex',\n          alignItems: 'center',\n          gap: '6px',\n          padding: compact ? '6px 12px' : '10px 16px',\n          backgroundColor: 'var(--bg-success, #064e3b)',\n          color: 'var(--text-success, #10b981)',\n          border: '1px solid var(--border-success, #10b981)',\n          borderRadius: '8px',\n          cursor: 'not-allowed',\n          fontSize: compact ? '13px' : '14px',\n          fontWeight: 500,\n        }}\n      >\n        <Check size={compact ? 14 : 16} />\n        Owned\n      </button>\n    );\n  }\n\n  // In cart state\n  if (inCart || justAdded) {\n    return (\n      <button\n        disabled\n        className={`rb-cart-btn rb-cart-btn--in-cart ${className}`}\n        style={{\n          display: 'inline-flex',\n          alignItems: 'center',\n          gap: '6px',\n          padding: compact ? '6px 12px' : '10px 16px',\n          backgroundColor: 'var(--bg-info, #1e3a5f)',\n          color: 'var(--text-info, #60a5fa)',\n          border: '1px solid var(--border-info, #3b82f6)',\n          borderRadius: '8px',\n          cursor: 'not-allowed',\n          fontSize: compact ? '13px' : '14px',\n          fontWeight: 500,\n        }}\n      >\n        <Check size={compact ? 14 : 16} />\n        {justAdded ? 'Added!' : 'In Cart'}\n      </button>\n    );\n  }\n\n  // Add to cart button\n  return (\n    <div style={{ display: 'inline-flex', flexDirection: 'column', gap: '4px' }}>\n      <button\n        onClick={handleClick}\n        disabled={loading || cartFull}\n        className={`rb-cart-btn rb-cart-btn--add ${className}`}\n        style={{\n          display: 'inline-flex',\n          alignItems: 'center',\n          gap: '6px',\n          padding: compact ? '6px 12px' : '10px 16px',\n          backgroundColor: loading || cartFull ? 'var(--bg-disabled, #475569)' : 'var(--accent, #3b82f6)',\n          color: 'white',\n          border: 'none',\n          borderRadius: '8px',\n          cursor: loading || cartFull ? 'not-allowed' : 'pointer',\n          fontSize: compact ? '13px' : '14px',\n          fontWeight: 500,\n          transition: 'all 0.2s ease',\n        }}\n      >\n        <ShoppingCart size={compact ? 14 : 16} />\n        {loading ? 'Adding...' : compact ? `$${price}` : `Add to Cart - $${price}`}\n      </button>\n\n      {localError && (\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: '4px',\n          color: 'var(--text-error, #ef4444)',\n          fontSize: '12px',\n        }}>\n          <AlertCircle size={12} />\n          {localError}\n        </div>\n      )}\n\n      {cartFull && (\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          gap: '4px',\n          color: 'var(--text-warning, #f59e0b)',\n          fontSize: '12px',\n        }}>\n          <AlertCircle size={12} />\n          Cart full (max {cart?.max_items})\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { MessageCircle, Share2, X } from 'lucide-react';\nimport { sanitizeHtml } from '../utils/sanitize';\nimport { API_URL } from '../config';\nimport { LikeButton } from './social/LikeButton';\nimport { ContentCommentsSection } from './social/ContentCommentsSection';\nimport AddToCartButton from './AddToCartButton';\n\n// Get CSRF token from cookie (avoids rate limiting)\nfunction getCsrfToken(): string {\n  const match = document.cookie.match(/csrftoken=([^;]+)/);\n  return match ? match[1] : '';\n}\n\ntype Collaborator = {\n  username: string;\n  role: string;\n  revenuePercentage: number;\n};\n\ntype Props = {\n  open: boolean;\n  onClose: ()=>void;\n  teaserUrl?: string;\n  contentType?: 'book'|'art'|'film'|'music';\n  contentId?: number;\n  price?: number;\n  editions?: number;\n  isCollaborative?: boolean;\n  collaborators?: Collaborator[];\n  creatorUsername?: string;\n  creatorAvatar?: string;\n  title?: string;\n  likeCount?: number;\n  userHasLiked?: boolean;\n  commentCount?: number;\n};\n\nexport default function PreviewModal({\n  open,\n  onClose,\n  teaserUrl,\n  contentType,\n  contentId,\n  price,\n  editions,\n  isCollaborative = false,\n  collaborators = [],\n  creatorUsername,\n  creatorAvatar,\n  title,\n  likeCount = 0,\n  userHasLiked = false,\n  commentCount = 0,\n}: Props){\n  const type = contentType || 'book';\n  const [html, setHtml] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n  const [purchasing, setPurchasing] = useState(false);\n  const [showComments, setShowComments] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [currentUsername, setCurrentUsername] = useState<string | undefined>();\n\n  // Check auth status\n  useEffect(() => {\n    if (open) {\n      fetch(`${API_URL}/api/auth/status/`, { credentials: 'include' })\n        .then(r => r.ok ? r.json() : null)\n        .then(data => {\n          setIsAuthenticated(!!data?.username);\n          setCurrentUsername(data?.username);\n        })\n        .catch(() => {});\n    }\n  }, [open]);\n\n  useEffect(() => {\n    const handleEsc = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && open) {\n        onClose();\n      }\n    };\n\n    if (open) {\n      window.addEventListener('keydown', handleEsc);\n      document.body.style.overflow = 'hidden';\n    }\n\n    return () => {\n      window.removeEventListener('keydown', handleEsc);\n      document.body.style.overflow = 'unset';\n    };\n  }, [open, onClose]);\n\n  useEffect(()=>{\n    let active = true;\n    if (open && type==='book' && teaserUrl) {\n      setLoading(true);\n      fetch(teaserUrl, { credentials:'include' })\n        .then(r=> r.ok ? r.text() : '')\n        .then(t=> {\n          if (active) {\n            setHtml(String(t||''));\n            setLoading(false);\n          }\n        })\n        .catch(()=> {\n          if (active) {\n            setHtml('<p>Preview unavailable</p>');\n            setLoading(false);\n          }\n        });\n    } else {\n      setLoading(false);\n    }\n    return ()=> { active = false; };\n  }, [open, type, teaserUrl]);\n\n  const safe = useMemo(()=> sanitizeHtml(html), [html]);\n\n  const handlePurchase = async () => {\n    if (!contentId) return;\n    setPurchasing(true);\n    try {\n      const csrfToken = getCsrfToken();\n\n      const res = await fetch(`${API_URL}/api/checkout/session/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({ content_id: contentId }),\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        if (data?.code === 'NOT_MINTED') alert('Content not available for purchase');\n        else if (data?.code === 'SOLD_OUT') alert('This content is sold out');\n        else if (data?.code === 'ALREADY_OWNED') alert('You already own this content');\n        else if (data?.code === 'NO_BUYER_WALLET') alert('Please set up your wallet in your profile before purchasing');\n        else if (data?.code === 'NO_CREATOR_WALLET') alert('Creator wallet not configured. Please contact support.');\n        else if (data?.code === 'STRIPE_ERROR') alert('Payment system error. Please try again.');\n        else alert(data?.error || 'Checkout failed');\n        return;\n      }\n\n      if (data?.checkout_url) {\n        window.location.href = data.checkout_url;\n      } else {\n        alert('No checkout URL received');\n      }\n    } catch {\n      alert('Failed to initiate checkout. Please try again.');\n    } finally {\n      setPurchasing(false);\n    }\n  };\n\n  const handleShare = async () => {\n    const url = `${window.location.origin}/content/${contentId}`;\n    if (navigator.share) {\n      try {\n        await navigator.share({ title: title || 'Check this out', url });\n      } catch {}\n    } else {\n      await navigator.clipboard.writeText(url);\n      alert('Link copied to clipboard!');\n    }\n  };\n\n  const canPurchase = editions !== undefined && editions > 0;\n  const priceText = price && price > 0 ? `$${price.toFixed(2)}` : 'Free';\n\n  if (!open) return null;\n\n  return (\n    <div\n      style={{\n        position:'fixed',\n        inset:0,\n        background:'rgba(0,0,0,0.9)',\n        backdropFilter:'blur(8px)',\n        display:'flex',\n        alignItems:'center',\n        justifyContent:'center',\n        zIndex:2000,\n        padding: 20,\n      }}\n      onClick={(e) => {\n        if (e.target === e.currentTarget) onClose();\n      }}\n    >\n      {/* Main Content Area */}\n      <div style={{\n        display: 'flex',\n        gap: 0,\n        maxWidth: 1200,\n        width: '100%',\n        height: '90vh',\n        maxHeight: 800,\n      }}>\n        {/* Preview Content */}\n        <div style={{\n          flex: 1,\n          background: '#0f172a',\n          borderRadius: '16px 0 0 16px',\n          overflow: 'hidden',\n          display: 'flex',\n          flexDirection: 'column',\n          position: 'relative',\n        }}>\n          {/* Header */}\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            padding: '16px 20px',\n            borderBottom: '1px solid #1e293b',\n            background: '#0b1220',\n          }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\n              <span style={{ color: '#f1f5f9', fontWeight: 600, fontSize: 16 }}>\n                {title || 'Preview'}\n              </span>\n              {editions !== undefined && (\n                <span style={{\n                  background: editions > 0 ? 'rgba(16, 185, 129, 0.15)' : 'rgba(239, 68, 68, 0.15)',\n                  color: editions > 0 ? '#10b981' : '#ef4444',\n                  padding: '4px 10px',\n                  borderRadius: 6,\n                  fontSize: 12,\n                  fontWeight: 600,\n                }}>\n                  {editions > 0 ? `${editions} available` : 'Sold out'}\n                </span>\n              )}\n            </div>\n            <button\n              onClick={onClose}\n              style={{\n                background: 'transparent',\n                border: 'none',\n                color: '#94a3b8',\n                cursor: 'pointer',\n                padding: 8,\n                borderRadius: 8,\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n              }}\n            >\n              <X size={24} />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div style={{ flex: 1, overflow: 'auto', padding: 16 }}>\n            {type === 'book' && (\n              <div style={{\n                width: '100%',\n                height: '100%',\n                overflow: 'auto',\n                padding: 16,\n                background: '#0b1220',\n                borderRadius: 8,\n                position: 'relative',\n              }}>\n                {loading ? (\n                  <div style={{ color: '#94a3b8', textAlign: 'center', padding: 40 }}>\n                    Loading preview...\n                  </div>\n                ) : safe ? (\n                  <>\n                    <div className=\"content-display\" dangerouslySetInnerHTML={{ __html: safe }} />\n                    <div style={{\n                      position: 'absolute',\n                      inset: 0,\n                      pointerEvents: 'none',\n                      display: 'flex',\n                      flexWrap: 'wrap',\n                      alignContent: 'flex-start',\n                      justifyContent: 'center',\n                      gap: '60px 80px',\n                      padding: 40,\n                      overflow: 'hidden',\n                    }}>\n                      {Array.from({ length: 30 }).map((_, i) => (\n                        <div\n                          key={i}\n                          style={{\n                            color: 'rgba(148, 163, 184, 0.08)',\n                            fontSize: 16,\n                            fontWeight: 600,\n                            transform: 'rotate(-25deg)',\n                            whiteSpace: 'nowrap',\n                            userSelect: 'none',\n                            letterSpacing: 2,\n                          }}\n                        >\n                          renaissBlock\n                        </div>\n                      ))}\n                    </div>\n                  </>\n                ) : (\n                  <div style={{ color: '#94a3b8', textAlign: 'center', padding: 40 }}>\n                    No preview available\n                  </div>\n                )}\n              </div>\n            )}\n            {type === 'art' && (\n              <div style={{ display: 'grid', placeItems: 'center', height: '100%', position: 'relative' }}>\n                <img src={teaserUrl} alt=\"preview\" style={{ maxWidth: '100%', maxHeight: '100%', objectFit: 'contain', borderRadius: 8 }} />\n                <div style={{\n                  position: 'absolute',\n                  inset: 0,\n                  pointerEvents: 'none',\n                  display: 'flex',\n                  flexWrap: 'wrap',\n                  alignContent: 'center',\n                  justifyContent: 'center',\n                  gap: '40px 60px',\n                  overflow: 'hidden',\n                }}>\n                  {Array.from({ length: 40 }).map((_, i) => (\n                    <div\n                      key={i}\n                      style={{\n                        color: 'rgba(255, 255, 255, 0.2)',\n                        fontSize: 14,\n                        fontWeight: 700,\n                        transform: 'rotate(-30deg)',\n                        whiteSpace: 'nowrap',\n                        userSelect: 'none',\n                        letterSpacing: 3,\n                        textShadow: '0 1px 2px rgba(0,0,0,0.5)',\n                      }}\n                    >\n                      renaissBlock\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n            {type === 'film' && (\n              <video src={teaserUrl} controls style={{ width: '100%', height: '100%', borderRadius: 8 }} />\n            )}\n            {type === 'music' && (\n              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%' }}>\n                <audio src={teaserUrl} controls style={{ width: '100%', maxWidth: 500 }} />\n              </div>\n            )}\n          </div>\n\n          {/* Purchase Bar */}\n          {contentId && canPurchase && (\n            <div style={{\n              padding: '16px 20px',\n              borderTop: '1px solid #1e293b',\n              background: '#0b1220',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              gap: 12,\n            }}>\n              {/* Add to Cart Button */}\n              {isAuthenticated && price && price > 0 && (\n                <AddToCartButton\n                  contentId={contentId}\n                  price={price.toFixed(2)}\n                />\n              )}\n\n              {/* Buy Now Button (direct checkout) */}\n              <button\n                onClick={handlePurchase}\n                disabled={purchasing}\n                style={{\n                  background: purchasing ? '#475569' : 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\n                  color: '#fff',\n                  border: 'none',\n                  borderRadius: 10,\n                  padding: '14px 40px',\n                  cursor: purchasing ? 'not-allowed' : 'pointer',\n                  fontSize: 16,\n                  fontWeight: 700,\n                  transition: 'all 0.2s',\n                }}\n              >\n                {purchasing ? 'Processing...' : `Buy Now ${priceText}`}\n              </button>\n            </div>\n          )}\n        </div>\n\n        {/* Right Sidebar - YouTube Style */}\n        <div style={{\n          width: showComments ? 380 : 72,\n          background: '#0b1220',\n          borderRadius: '0 16px 16px 0',\n          borderLeft: '1px solid #1e293b',\n          display: 'flex',\n          flexDirection: 'column',\n          transition: 'width 0.3s ease',\n          overflow: 'hidden',\n        }}>\n          {/* Action Buttons */}\n          <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            padding: '20px 0',\n            gap: 8,\n            borderBottom: showComments ? '1px solid #1e293b' : 'none',\n          }}>\n            {/* Like Button */}\n            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 4 }}>\n              {contentId && (\n                <LikeButton\n                  contentId={contentId}\n                  initialCount={likeCount}\n                  initialLiked={userHasLiked}\n                  isAuthenticated={isAuthenticated}\n                  onAuthRequired={() => window.location.href = '/auth'}\n                  size=\"lg\"\n                  showCount={false}\n                />\n              )}\n              <span style={{ fontSize: 12, color: '#94a3b8', fontWeight: 500 }}>\n                {likeCount > 0 ? likeCount.toLocaleString() : 'Like'}\n              </span>\n            </div>\n\n            {/* Comment Button */}\n            <button\n              onClick={() => setShowComments(!showComments)}\n              style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                gap: 4,\n                background: showComments ? 'rgba(139, 92, 246, 0.15)' : 'transparent',\n                border: 'none',\n                padding: '12px 16px',\n                borderRadius: 12,\n                cursor: 'pointer',\n                transition: 'all 0.2s',\n              }}\n            >\n              <MessageCircle\n                size={28}\n                color={showComments ? '#a78bfa' : '#94a3b8'}\n                fill={showComments ? '#a78bfa' : 'transparent'}\n              />\n              <span style={{ fontSize: 12, color: showComments ? '#a78bfa' : '#94a3b8', fontWeight: 500 }}>\n                {commentCount > 0 ? commentCount.toLocaleString() : 'Comments'}\n              </span>\n            </button>\n\n            {/* Share Button */}\n            <button\n              onClick={handleShare}\n              style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                gap: 4,\n                background: 'transparent',\n                border: 'none',\n                padding: '12px 16px',\n                borderRadius: 12,\n                cursor: 'pointer',\n              }}\n            >\n              <Share2 size={28} color=\"#94a3b8\" />\n              <span style={{ fontSize: 12, color: '#94a3b8', fontWeight: 500 }}>Share</span>\n            </button>\n          </div>\n\n          {/* Creator Info */}\n          {(creatorUsername || (isCollaborative && collaborators.length > 0)) && (\n            <div style={{\n              padding: '16px 12px',\n              borderBottom: showComments ? '1px solid #1e293b' : 'none',\n            }}>\n              {creatorUsername && (\n                <Link\n                  to={`/profile/${creatorUsername}`}\n                  onClick={(e) => e.stopPropagation()}\n                  style={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    gap: 8,\n                    textDecoration: 'none',\n                    marginBottom: isCollaborative ? 12 : 0,\n                  }}\n                >\n                  <div style={{\n                    width: 44,\n                    height: 44,\n                    borderRadius: '50%',\n                    background: creatorAvatar ? `url(${creatorAvatar}) center/cover` : 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: '#fff',\n                    fontSize: 18,\n                    fontWeight: 600,\n                  }}>\n                    {!creatorAvatar && creatorUsername.charAt(0).toUpperCase()}\n                  </div>\n                  <span style={{\n                    fontSize: 12,\n                    color: '#60a5fa',\n                    fontWeight: 600,\n                    textAlign: 'center',\n                    wordBreak: 'break-word',\n                  }}>\n                    @{creatorUsername}\n                  </span>\n                </Link>\n              )}\n\n              {/* Collaborators */}\n              {isCollaborative && collaborators.length > 0 && (\n                <div style={{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  alignItems: 'center',\n                  gap: 8,\n                }}>\n                  <span style={{ fontSize: 10, color: '#64748b', textTransform: 'uppercase', fontWeight: 600 }}>\n                    Collaborators\n                  </span>\n                  {collaborators.slice(0, 3).map((c) => (\n                    <Link\n                      key={c.username}\n                      to={`/profile/${c.username}`}\n                      onClick={(e) => e.stopPropagation()}\n                      style={{\n                        fontSize: 11,\n                        color: '#60a5fa',\n                        textDecoration: 'none',\n                      }}\n                    >\n                      @{c.username}\n                    </Link>\n                  ))}\n                  {collaborators.length > 3 && (\n                    <span style={{ fontSize: 11, color: '#64748b' }}>\n                      +{collaborators.length - 3} more\n                    </span>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Comments Section (expanded) */}\n          {showComments && contentId && (\n            <div style={{\n              flex: 1,\n              overflow: 'auto',\n              padding: 16,\n            }}>\n              <ContentCommentsSection\n                contentId={contentId}\n                isAuthenticated={isAuthenticated}\n                currentUsername={currentUsername}\n                onAuthRequired={() => window.location.href = '/auth'}\n              />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["MessageCircle","createLucideIcon","d","key","Reply","Share2","cx","cy","r","x1","x2","y1","y2","LikeButton","contentId","initialLiked","initialCount","size","showCount","className","onAuthRequired","isAuthenticated","liked","likeCount","isLoading","toggle","options","setLiked","useState","setLikeCount","setIsLoading","error","setError","pendingRequest","useRef","lastToggleTime","refresh","useCallback","async","status","getLikeStatus","like_count","err","current","now","Date","previousLiked","previousCount","result","toggleLike","message","Error","includes","useEffect","useLikes","config","sm","icon","padding","fontSize","md","lg","jsxs","onClick","e","preventDefault","stopPropagation","disabled","style","display","alignItems","gap","background","border","borderRadius","cursor","opacity","transition","onMouseEnter","currentTarget","transform","onMouseLeave","children","jsx","ThumbsUp","fill","color","fontWeight","toLocaleString","CommentItem","comment","onReply","onEdit","onDelete","onLoadReplies","currentUsername","depth","maxDepth","showReplyForm","setShowReplyForm","isEditing","setIsEditing","replyText","setReplyText","editText","setEditText","text","isSubmitting","setIsSubmitting","showReplies","setShowReplies","replies","setReplies","loadingReplies","setLoadingReplies","handleLoadReplies","replies_count","loadedReplies","id","canReply","marginLeft","Math","min","buttonStyle","author_avatar","src","alt","author_username","width","height","objectFit","flexShrink","justifyContent","charAt","toUpperCase","flex","minWidth","flexWrap","marginBottom","Link","to","textDecoration","date","then","diff","floor","getTime","toLocaleDateString","timeAgo","created_at","edited","onSubmit","trim","marginTop","value","onChange","target","rows","resize","outline","type","lineHeight","margin","whiteSpace","can_edit","Edit2","can_delete","confirm","Trash2","Fragment","ChevronUp","ChevronDown","placeholder","Send","length","borderLeft","map","reply","ContentCommentsSection","newComment","setNewComment","comments","hasMore","totalCount","loadMore","addComment","editComment","removeComment","loadReplies","setComments","page","setPage","setHasMore","setTotalCount","fetchingRef","initialLoadDone","fetchComments","pageNum","append","response","getContentComments","prev","results","next","count","parentId","createComment","c","commentId","updated","updateComment","deleteComment","filter","getCommentReplies","useContentComments","handleReply","overflow","borderBottom","MessageSquare","onFocus","borderColor","onBlur","textAlign","AddToCartButton","chapterId","price","alreadyOwned","compact","onSuccess","addToCart","cart","isInCart","useCart","loading","setLoading","localError","setLocalError","justAdded","setJustAdded","inCart","cartFull","item_count","max_items","backgroundColor","Check","flexDirection","setTimeout","ShoppingCart","AlertCircle","PreviewModal","open","onClose","teaserUrl","contentType","editions","isCollaborative","collaborators","creatorUsername","creatorAvatar","title","userHasLiked","commentCount","html","setHtml","purchasing","setPurchasing","showComments","setShowComments","setIsAuthenticated","setCurrentUsername","fetch","API_URL","credentials","ok","json","data","username","catch","handleEsc","window","addEventListener","document","body","removeEventListener","active","t","String","safe","useMemo","sanitizeHtml","canPurchase","priceText","toFixed","position","inset","backdropFilter","zIndex","maxWidth","maxHeight","X","dangerouslySetInnerHTML","__html","pointerEvents","alignContent","Array","from","_","i","userSelect","letterSpacing","placeItems","textShadow","controls","borderTop","csrfToken","match","cookie","getCsrfToken","res","method","headers","JSON","stringify","content_id","code","alert","checkout_url","location","href","url","origin","navigator","share","clipboard","writeText","wordBreak","textTransform","slice"],"mappings":"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","x_google_ignoreList":[0,1,2]}