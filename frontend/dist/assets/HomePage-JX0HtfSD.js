import{j as e}from"./web3auth-BkZxjmxM.js";import{r as t,a as r,L as o}from"./router-cVcvJ1e3.js";import{B as i,U as n,C as a,a as s,A as l}from"./index-Clb-55uW.js";import{S as d,V as c}from"./VideoCard-DCMZm_kR.js";import{E as p}from"./eye-Btrj3ogq.js";import{T as u}from"./thumbs-up-BVuG1z4M.js";import"./vendor-Cfs_Iq82.js";function g(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${e}`}const x=t.memo(function({id:l,title:c,coverImageUrl:x,author:b,chapters:h,publishedChapters:f,totalViews:v,totalLikes:m,totalPrice:y,averageRating:j,ratingCount:k,timeText:w,isCollaborative:S=!1}){const[_,C]=t.useState(!1),z=r(),$=h.find(e=>e.content_id),T=f>1,I=v>=100,R=v>=1e3;return!(null!=j&&k>0)||(Number(j).toFixed(1),g(k)),e.jsxs("div",{className:"yt-card",style:{background:"var(--bg-card)",border:"1px solid var(--panel-border-strong)",borderRadius:16,overflow:"hidden",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)",e.currentTarget.style.borderColor="var(--border)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor="var(--panel-border-strong)"},children:[e.jsxs("div",{onClick:()=>{T?C(!_):$&&z(`/content/${$.content_id}`)},style:{width:"100%",paddingTop:"56.25%",background:x?`url(${x})`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",position:"relative",cursor:"pointer"},children:[!x&&e.jsx("div",{style:{position:"absolute",inset:0,display:"grid",placeItems:"center",color:"rgba(255,255,255,0.3)"},children:e.jsx(i,{size:48})}),S&&e.jsxs("div",{style:{position:"absolute",top:8,left:8,background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"#000",padding:"4px 8px",borderRadius:6,fontSize:10,fontWeight:700,display:"flex",alignItems:"center",gap:4,zIndex:2},children:[e.jsx(n,{size:12}),"COLLAB"]}),T&&e.jsxs("div",{style:{position:"absolute",top:8,right:8,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",padding:"4px 10px",borderRadius:12,fontSize:12,fontWeight:600,color:"#f8fafc"},children:[f," chapters"]}),y>0&&e.jsxs("div",{style:{position:"absolute",top:T?40:8,right:8,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(4px)",padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:700,color:"#10b981"},children:["$",y.toFixed(2)]})]}),e.jsxs("div",{style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600,color:"var(--text)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},children:c}),v>0&&e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,fontSize:11,fontWeight:R?700:I?600:500,color:R?"#f59e0b":I?"#10b981":"var(--text-muted)",background:R?"rgba(245, 158, 11, 0.15)":I?"rgba(16, 185, 129, 0.1)":"transparent",padding:I?"2px 6px":"0",borderRadius:4,flexShrink:0},children:[e.jsx(p,{size:12}),g(v)]})]}),e.jsxs("div",{style:{fontSize:13,color:"var(--text-muted)",marginBottom:12,display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[e.jsx(o,{to:`/profile/${b}`,style:{color:"#60a5fa",textDecoration:"none"},onClick:e=>e.stopPropagation(),children:b}),e.jsx("span",{children:"•"}),e.jsx(d,{rating:j,count:k,size:11}),e.jsx("span",{children:"•"}),e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:2},children:[e.jsx(u,{size:12})," ",g(m)]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:w})]}),T&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>C(!_),style:{width:"100%",background:"var(--dropdown-hover)",border:"none",borderRadius:8,padding:"8px 12px",color:"var(--text-muted)",fontSize:13,fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{children:"Chapters"}),_?e.jsx(a,{size:16}):e.jsx(s,{size:16})]}),_&&e.jsx("div",{style:{background:"var(--bg-input)",borderRadius:8,padding:8,marginTop:8,maxHeight:200,overflowY:"auto"},children:h.map((t,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:6,background:r%2==0?"transparent":"var(--nav-hover-bg)"},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:13,color:"var(--text)",fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:["Ch ",t.order+1,": ",t.title]}),e.jsxs("div",{style:{fontSize:11,color:"var(--subtle)"},children:["$",t.price_usd.toFixed(2)," • ",t.view_count," views",void 0!==t.editions&&null!==t.editions&&e.jsxs(e.Fragment,{children:[" • ",e.jsx("span",{style:{color:t.editions>0?"#10b981":"#ef4444"},children:t.editions>0?`${t.editions} ed.`:"Sold out"})]})]})]}),e.jsx("button",{onClick:e=>{var r;e.stopPropagation(),r=t.content_id,z(`/content/${r}`)},style:{background:"transparent",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",color:"var(--text-muted)",fontSize:11,fontWeight:500,cursor:"pointer",marginLeft:8,flexShrink:0},children:"View"})]},t.id))})]})]})]})});function b(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${e}`}const h=t.memo(function({id:l,title:c,coverImageUrl:g,author:x,issues:h,publishedIssues:f,totalViews:v,totalLikes:m,totalPrice:y,averageRating:j,ratingCount:k,timeText:w,isCollaborative:S=!1}){const[_,C]=t.useState(!1),z=r(),$=h.find(e=>e.content_id),T=f>1,I=v>=100,R=v>=1e3;return!(null!=j&&k>0)||(Number(j).toFixed(1),b(k)),e.jsxs("div",{className:"yt-card",style:{background:"var(--bg-card)",border:"1px solid var(--panel-border-strong)",borderRadius:16,overflow:"hidden",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)",e.currentTarget.style.borderColor="var(--border)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor="var(--panel-border-strong)"},children:[e.jsxs("div",{onClick:()=>{T?C(!_):$&&z(`/content/${$.content_id}`)},style:{width:"100%",paddingTop:"56.25%",background:g?`url(${g})`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",position:"relative",cursor:"pointer"},children:[!g&&e.jsx("div",{style:{position:"absolute",inset:0,display:"grid",placeItems:"center",color:"rgba(255,255,255,0.3)"},children:e.jsx(i,{size:48})}),T&&e.jsxs("div",{style:{position:"absolute",top:8,right:8,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",padding:"4px 10px",borderRadius:12,fontSize:12,fontWeight:600,color:"#f8fafc"},children:[f," issues"]}),y>0&&e.jsxs("div",{style:{position:"absolute",top:T?40:8,right:8,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(4px)",padding:"4px 8px",borderRadius:4,fontSize:12,fontWeight:700,color:"#10b981"},children:["$",y.toFixed(2)]})]}),e.jsxs("div",{style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600,color:"var(--text)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},children:c}),v>0&&e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,fontSize:11,fontWeight:R?700:I?600:500,color:R?"#f59e0b":I?"#10b981":"var(--text-muted)",background:R?"rgba(245, 158, 11, 0.15)":I?"rgba(16, 185, 129, 0.1)":"transparent",padding:I?"2px 6px":"0",borderRadius:4,flexShrink:0},children:[e.jsx(p,{size:12}),b(v)]})]}),e.jsxs("div",{style:{fontSize:13,color:"var(--text-muted)",marginBottom:12,display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[e.jsx(o,{to:`/profile/${x}`,style:{color:"#60a5fa",textDecoration:"none"},onClick:e=>e.stopPropagation(),children:x}),S&&e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",padding:"1px 6px",borderRadius:4,fontSize:10,fontWeight:700,lineHeight:1},children:[e.jsx(n,{size:10}),"COLLAB"]}),e.jsx("span",{children:"•"}),e.jsx(d,{rating:j,count:k,size:11}),e.jsx("span",{children:"•"}),e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:2},children:[e.jsx(u,{size:12})," ",b(m)]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:w})]}),T&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>C(!_),style:{width:"100%",background:"var(--dropdown-hover)",border:"none",borderRadius:8,padding:"8px 12px",color:"var(--text-muted)",fontSize:13,fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{children:"Issues"}),_?e.jsx(a,{size:16}):e.jsx(s,{size:16})]}),_&&e.jsx("div",{style:{background:"var(--bg-input)",borderRadius:8,padding:8,marginTop:8,maxHeight:200,overflowY:"auto"},children:h.map((t,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:6,background:r%2==0?"transparent":"var(--nav-hover-bg)"},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:13,color:"var(--text)",fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:["Issue #",t.issue_number,": ",t.title]}),e.jsxs("div",{style:{fontSize:11,color:"var(--subtle)"},children:["$",t.price_usd.toFixed(2)," • ",t.view_count," views",void 0!==t.editions&&null!==t.editions&&e.jsxs(e.Fragment,{children:[" • ",e.jsx("span",{style:{color:t.editions>0?"#10b981":"#ef4444"},children:t.editions>0?`${t.editions} ed.`:"Sold out"})]})]})]}),e.jsx("button",{onClick:e=>{var r;e.stopPropagation(),r=t.content_id,z(`/content/${r}`)},style:{background:"transparent",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",color:"var(--text-muted)",fontSize:11,fontWeight:500,cursor:"pointer",marginLeft:8,flexShrink:0},children:"View"})]},t.id))})]})]})]})}),f=[{label:"All",value:"all"},{label:"Comics",value:"comic"},{label:"Books",value:"book"},{label:"Art",value:"art"},{label:"Film",value:"film",comingSoon:!0},{label:"Music",value:"music",comingSoon:!0}];function v(){const[r,o]=t.useState([]),[i,n]=t.useState([]),[a,s]=t.useState([]),[d,p]=t.useState("comic");t.useEffect(()=>{const e=new AbortController,t=fetch(`${l}/api/content/`,{credentials:"include",signal:e.signal}).then(e=>e.json()).then(e=>e&&Array.isArray(e.results)?e.results.filter(e=>"book"!==e.content_type&&"comic"!==e.content_type):Array.isArray(e)?e.filter(e=>"book"!==e.content_type&&"comic"!==e.content_type):[]),r=fetch(`${l}/api/book-projects/public/`,{credentials:"include",signal:e.signal}).then(e=>e.json()).then(e=>Array.isArray(e)?e:[]),i=fetch(`${l}/api/comic-projects/public/`,{credentials:"include",signal:e.signal}).then(e=>e.json()).then(e=>Array.isArray(e)?e:[]);return Promise.all([t,r,i]).then(([e,t,r])=>{o(e),n(t),s(r)}).catch(e=>{"AbortError"!==e.name&&(o([]),n([]),s([]))}),()=>e.abort()},[]);const u=e=>{if(!e)return"Recently";const t=new Date(e),r=new Date,o=Math.floor((r.getTime()-t.getTime())/1e3);if(o<60)return"Just now";if(o<3600){const e=Math.floor(o/60);return`${e} minute${1!==e?"s":""} ago`}if(o<86400){const e=Math.floor(o/3600);return`${e} hour${1!==e?"s":""} ago`}if(o<604800){const e=Math.floor(o/86400);return`${e} day${1!==e?"s":""} ago`}const i=Math.floor(o/604800);return`${i} week${1!==i?"s":""} ago`},g=t.useMemo(()=>{const e=[];return r.forEach(t=>{e.push({type:"content",sortKey:t.created_at?new Date(t.created_at).getTime():0,data:t})}),i.forEach(t=>{e.push({type:"book",sortKey:t.created_at?new Date(t.created_at).getTime():0,data:t})}),a.forEach(t=>{e.push({type:"comic",sortKey:t.created_at?new Date(t.created_at).getTime():0,data:t})}),e.sort((e,t)=>t.sortKey-e.sortKey),e},[r,i,a]),b=t.useMemo(()=>"all"===d?g:g.filter(e=>"book"===e.type?"book"===d:"comic"===e.type?"comic"===d:e.data.content_type===d),[g,d]);return e.jsxs("div",{children:[e.jsx("div",{className:"chips","data-tour":"genre-filters",children:f.map(t=>e.jsxs("button",{className:`chip ${d===t.value?"active":""} ${t.comingSoon?"disabled":""}`,onClick:()=>!t.comingSoon&&p(t.value),disabled:t.comingSoon,style:{opacity:t.comingSoon?.5:1,cursor:t.comingSoon?"not-allowed":"pointer"},children:[t.label,t.comingSoon&&e.jsx("span",{style:{fontSize:9,background:"#f59e0b",color:"#000",padding:"1px 4px",borderRadius:3,marginLeft:4,fontWeight:700},children:"SOON"})]},t.value))}),e.jsx("div",{className:"page",style:{padding:0,background:"transparent",border:"none",boxShadow:"none"},children:e.jsx("div",{className:"yt-grid","data-tour":"content-grid",children:b.map(t=>{var r;if("book"===t.type){const r=t.data;return e.jsx(x,{id:r.id,title:r.title,coverImageUrl:r.cover_image_url||"",author:r.creator_username,chapters:r.chapters,publishedChapters:r.published_chapters,totalViews:r.total_views,totalLikes:r.total_likes,totalPrice:r.total_price,averageRating:r.average_rating,ratingCount:r.rating_count,timeText:u(r.created_at)},`book-${r.id}`)}if("comic"===t.type){const r=t.data;return e.jsx(h,{id:r.id,title:r.title,coverImageUrl:r.cover_image_url||"",author:r.creator_username,issues:r.issues,publishedIssues:r.published_issues,totalViews:r.total_views,totalLikes:r.total_likes,totalPrice:r.total_price,averageRating:r.average_rating,ratingCount:r.rating_count,timeText:u(r.created_at),isCollaborative:r.is_collaborative},`comic-${r.id}`)}{const o=t.data;return e.jsx(c,{id:o.id,title:o.title,author:o.creator_username||`Creator #${o.creator??0}`,likeCount:o.like_count,viewCount:o.view_count,averageRating:o.average_rating,ratingCount:o.rating_count,timeText:u(o.created_at),thumbnailUrl:o.teaser_link||"",price:o.price_usd,editions:o.editions,owned:o.owned,isCollaborative:o.is_collaborative,collaborators:null==(r=o.collaborators)?void 0:r.map(e=>e.username)},`content-${o.id}`)}})})})]})}export{v as default};
