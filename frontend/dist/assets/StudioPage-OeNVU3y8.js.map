{"version":3,"file":"StudioPage-OeNVU3y8.js","sources":["../../node_modules/lucide-react/dist/esm/icons/layers.js","../../node_modules/lucide-react/dist/esm/icons/pen-line.js","../../node_modules/lucide-react/dist/esm/icons/tag.js","../../src/components/CreateWizard/TypeSelect.tsx","../../node_modules/tslib/tslib.es6.mjs","../../node_modules/file-selector/dist/es2015/file.js","../../node_modules/file-selector/dist/es2015/file-selector.js","../../node_modules/attr-accept/dist/es/index.js","../../node_modules/react-dropzone/dist/es/utils/index.js","../../node_modules/react-dropzone/dist/es/index.js","../../src/components/CreateWizard/CreateStep.tsx","../../src/components/CreateWizard/CustomizeStep.tsx","../../src/components/CreateWizard/TagSelector.tsx","../../src/components/CreateWizard/ConfigureStep.tsx","../../src/components/CreateWizard/MintStep.tsx","../../src/components/CreateWizard/ConfettiEffect.tsx","../../src/components/CreateWizard/ShareStep.tsx","../../src/components/CreateWizard/StepIndicator.tsx","../../src/services/bookApi.ts","../../src/components/BookEditor/ChapterList.tsx","../../src/components/ChapterManagement.tsx","../../src/components/BookEditor/ChapterEditor.tsx","../../src/components/BookEditor/PublishModal.tsx","../../src/components/BookEditor/BookEditor.tsx","../../src/components/CreateWizard/SoloComicEditor.tsx","../../src/components/CreateWizard/CreateWizard.tsx","../../src/services/legalApi.ts","../../src/hooks/useLegalAcceptance.ts","../../src/components/legal/CreatorAgreementModal.tsx","../../src/components/legal/CreatorAgreementGate.tsx","../../src/pages/StudioPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z\",\n      key: \"zw3jo\"\n    }\n  ],\n  [\n    \"path\",\n    {\n      d: \"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12\",\n      key: \"1wduqc\"\n    }\n  ],\n  [\n    \"path\",\n    {\n      d: \"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17\",\n      key: \"kqbvx6\"\n    }\n  ]\n];\nconst Layers = createLucideIcon(\"layers\", __iconNode);\n\nexport { __iconNode, Layers as default };\n//# sourceMappingURL=layers.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M13 21h8\", key: \"1jsn5i\" }],\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst PenLine = createLucideIcon(\"pen-line\", __iconNode);\n\nexport { __iconNode, PenLine as default };\n//# sourceMappingURL=pen-line.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z\",\n      key: \"vktsd0\"\n    }\n  ],\n  [\"circle\", { cx: \"7.5\", cy: \"7.5\", r: \".5\", fill: \"currentColor\", key: \"kqv944\" }]\n];\nconst Tag = createLucideIcon(\"tag\", __iconNode);\n\nexport { __iconNode, Tag as default };\n//# sourceMappingURL=tag.js.map\n","import React from 'react';\nimport { BookOpen, Layers, Image, Video } from 'lucide-react';\n\nexport default function TypeSelect({ onSelect }:{ onSelect:(t:'text'|'image'|'video'|'comic')=>void }){\n  const card = (\n    t:'text'|'image'|'video'|'comic',\n    icon: React.ReactNode,\n    title:string,\n    desc:string,\n    disabled?: boolean,\n    comingSoon?: boolean\n  ) => (\n    <button\n      className=\"type-select-card\"\n      onClick={()=> !disabled && onSelect(t)}\n      disabled={disabled}\n    >\n      {comingSoon && (\n        <span className=\"coming-soon-badge\">Coming Soon</span>\n      )}\n      <div className=\"type-select-icon\" style={{ color: disabled ? '#64748b' : undefined }}>\n        {icon}\n      </div>\n      <h4 style={{ color: disabled ? '#64748b' : undefined }}>{title}</h4>\n      <p>{desc}</p>\n    </button>\n  );\n  return (\n    <div className=\"type-select-grid\">\n      {card('text', <BookOpen size={28} />, 'Write a Book', 'Create a book with chapters, organize, and publish as a series or complete work')}\n      {card('comic', <Layers size={28} />, 'Create a Comic Book', 'Design pages with panels, artwork, and speech bubbles')}\n      {card('image', <Image size={28} />, 'Upload Image / Art', 'PNG/JPG/WebP up to 50MB; watermark optional')}\n      {card('video', <Video size={28} />, 'Upload Video / Song', 'MP4/MOV/MP3 up to 50MB; auto-compress', true, true)}\n    </div>\n  );\n}\n","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n","export const COMMON_MIME_TYPES = new Map([\n    // https://github.com/guzzle/psr7/blob/2d9260799e713f1c475d3c5fdc3d6561ff7441b2/src/MimeType.php\n    ['1km', 'application/vnd.1000minds.decision-model+xml'],\n    ['3dml', 'text/vnd.in3d.3dml'],\n    ['3ds', 'image/x-3ds'],\n    ['3g2', 'video/3gpp2'],\n    ['3gp', 'video/3gp'],\n    ['3gpp', 'video/3gpp'],\n    ['3mf', 'model/3mf'],\n    ['7z', 'application/x-7z-compressed'],\n    ['7zip', 'application/x-7z-compressed'],\n    ['123', 'application/vnd.lotus-1-2-3'],\n    ['aab', 'application/x-authorware-bin'],\n    ['aac', 'audio/x-acc'],\n    ['aam', 'application/x-authorware-map'],\n    ['aas', 'application/x-authorware-seg'],\n    ['abw', 'application/x-abiword'],\n    ['ac', 'application/vnd.nokia.n-gage.ac+xml'],\n    ['ac3', 'audio/ac3'],\n    ['acc', 'application/vnd.americandynamics.acc'],\n    ['ace', 'application/x-ace-compressed'],\n    ['acu', 'application/vnd.acucobol'],\n    ['acutc', 'application/vnd.acucorp'],\n    ['adp', 'audio/adpcm'],\n    ['aep', 'application/vnd.audiograph'],\n    ['afm', 'application/x-font-type1'],\n    ['afp', 'application/vnd.ibm.modcap'],\n    ['ahead', 'application/vnd.ahead.space'],\n    ['ai', 'application/pdf'],\n    ['aif', 'audio/x-aiff'],\n    ['aifc', 'audio/x-aiff'],\n    ['aiff', 'audio/x-aiff'],\n    ['air', 'application/vnd.adobe.air-application-installer-package+zip'],\n    ['ait', 'application/vnd.dvb.ait'],\n    ['ami', 'application/vnd.amiga.ami'],\n    ['amr', 'audio/amr'],\n    ['apk', 'application/vnd.android.package-archive'],\n    ['apng', 'image/apng'],\n    ['appcache', 'text/cache-manifest'],\n    ['application', 'application/x-ms-application'],\n    ['apr', 'application/vnd.lotus-approach'],\n    ['arc', 'application/x-freearc'],\n    ['arj', 'application/x-arj'],\n    ['asc', 'application/pgp-signature'],\n    ['asf', 'video/x-ms-asf'],\n    ['asm', 'text/x-asm'],\n    ['aso', 'application/vnd.accpac.simply.aso'],\n    ['asx', 'video/x-ms-asf'],\n    ['atc', 'application/vnd.acucorp'],\n    ['atom', 'application/atom+xml'],\n    ['atomcat', 'application/atomcat+xml'],\n    ['atomdeleted', 'application/atomdeleted+xml'],\n    ['atomsvc', 'application/atomsvc+xml'],\n    ['atx', 'application/vnd.antix.game-component'],\n    ['au', 'audio/x-au'],\n    ['avi', 'video/x-msvideo'],\n    ['avif', 'image/avif'],\n    ['aw', 'application/applixware'],\n    ['azf', 'application/vnd.airzip.filesecure.azf'],\n    ['azs', 'application/vnd.airzip.filesecure.azs'],\n    ['azv', 'image/vnd.airzip.accelerator.azv'],\n    ['azw', 'application/vnd.amazon.ebook'],\n    ['b16', 'image/vnd.pco.b16'],\n    ['bat', 'application/x-msdownload'],\n    ['bcpio', 'application/x-bcpio'],\n    ['bdf', 'application/x-font-bdf'],\n    ['bdm', 'application/vnd.syncml.dm+wbxml'],\n    ['bdoc', 'application/x-bdoc'],\n    ['bed', 'application/vnd.realvnc.bed'],\n    ['bh2', 'application/vnd.fujitsu.oasysprs'],\n    ['bin', 'application/octet-stream'],\n    ['blb', 'application/x-blorb'],\n    ['blorb', 'application/x-blorb'],\n    ['bmi', 'application/vnd.bmi'],\n    ['bmml', 'application/vnd.balsamiq.bmml+xml'],\n    ['bmp', 'image/bmp'],\n    ['book', 'application/vnd.framemaker'],\n    ['box', 'application/vnd.previewsystems.box'],\n    ['boz', 'application/x-bzip2'],\n    ['bpk', 'application/octet-stream'],\n    ['bpmn', 'application/octet-stream'],\n    ['bsp', 'model/vnd.valve.source.compiled-map'],\n    ['btif', 'image/prs.btif'],\n    ['buffer', 'application/octet-stream'],\n    ['bz', 'application/x-bzip'],\n    ['bz2', 'application/x-bzip2'],\n    ['c', 'text/x-c'],\n    ['c4d', 'application/vnd.clonk.c4group'],\n    ['c4f', 'application/vnd.clonk.c4group'],\n    ['c4g', 'application/vnd.clonk.c4group'],\n    ['c4p', 'application/vnd.clonk.c4group'],\n    ['c4u', 'application/vnd.clonk.c4group'],\n    ['c11amc', 'application/vnd.cluetrust.cartomobile-config'],\n    ['c11amz', 'application/vnd.cluetrust.cartomobile-config-pkg'],\n    ['cab', 'application/vnd.ms-cab-compressed'],\n    ['caf', 'audio/x-caf'],\n    ['cap', 'application/vnd.tcpdump.pcap'],\n    ['car', 'application/vnd.curl.car'],\n    ['cat', 'application/vnd.ms-pki.seccat'],\n    ['cb7', 'application/x-cbr'],\n    ['cba', 'application/x-cbr'],\n    ['cbr', 'application/x-cbr'],\n    ['cbt', 'application/x-cbr'],\n    ['cbz', 'application/x-cbr'],\n    ['cc', 'text/x-c'],\n    ['cco', 'application/x-cocoa'],\n    ['cct', 'application/x-director'],\n    ['ccxml', 'application/ccxml+xml'],\n    ['cdbcmsg', 'application/vnd.contact.cmsg'],\n    ['cda', 'application/x-cdf'],\n    ['cdf', 'application/x-netcdf'],\n    ['cdfx', 'application/cdfx+xml'],\n    ['cdkey', 'application/vnd.mediastation.cdkey'],\n    ['cdmia', 'application/cdmi-capability'],\n    ['cdmic', 'application/cdmi-container'],\n    ['cdmid', 'application/cdmi-domain'],\n    ['cdmio', 'application/cdmi-object'],\n    ['cdmiq', 'application/cdmi-queue'],\n    ['cdr', 'application/cdr'],\n    ['cdx', 'chemical/x-cdx'],\n    ['cdxml', 'application/vnd.chemdraw+xml'],\n    ['cdy', 'application/vnd.cinderella'],\n    ['cer', 'application/pkix-cert'],\n    ['cfs', 'application/x-cfs-compressed'],\n    ['cgm', 'image/cgm'],\n    ['chat', 'application/x-chat'],\n    ['chm', 'application/vnd.ms-htmlhelp'],\n    ['chrt', 'application/vnd.kde.kchart'],\n    ['cif', 'chemical/x-cif'],\n    ['cii', 'application/vnd.anser-web-certificate-issue-initiation'],\n    ['cil', 'application/vnd.ms-artgalry'],\n    ['cjs', 'application/node'],\n    ['cla', 'application/vnd.claymore'],\n    ['class', 'application/octet-stream'],\n    ['clkk', 'application/vnd.crick.clicker.keyboard'],\n    ['clkp', 'application/vnd.crick.clicker.palette'],\n    ['clkt', 'application/vnd.crick.clicker.template'],\n    ['clkw', 'application/vnd.crick.clicker.wordbank'],\n    ['clkx', 'application/vnd.crick.clicker'],\n    ['clp', 'application/x-msclip'],\n    ['cmc', 'application/vnd.cosmocaller'],\n    ['cmdf', 'chemical/x-cmdf'],\n    ['cml', 'chemical/x-cml'],\n    ['cmp', 'application/vnd.yellowriver-custom-menu'],\n    ['cmx', 'image/x-cmx'],\n    ['cod', 'application/vnd.rim.cod'],\n    ['coffee', 'text/coffeescript'],\n    ['com', 'application/x-msdownload'],\n    ['conf', 'text/plain'],\n    ['cpio', 'application/x-cpio'],\n    ['cpp', 'text/x-c'],\n    ['cpt', 'application/mac-compactpro'],\n    ['crd', 'application/x-mscardfile'],\n    ['crl', 'application/pkix-crl'],\n    ['crt', 'application/x-x509-ca-cert'],\n    ['crx', 'application/x-chrome-extension'],\n    ['cryptonote', 'application/vnd.rig.cryptonote'],\n    ['csh', 'application/x-csh'],\n    ['csl', 'application/vnd.citationstyles.style+xml'],\n    ['csml', 'chemical/x-csml'],\n    ['csp', 'application/vnd.commonspace'],\n    ['csr', 'application/octet-stream'],\n    ['css', 'text/css'],\n    ['cst', 'application/x-director'],\n    ['csv', 'text/csv'],\n    ['cu', 'application/cu-seeme'],\n    ['curl', 'text/vnd.curl'],\n    ['cww', 'application/prs.cww'],\n    ['cxt', 'application/x-director'],\n    ['cxx', 'text/x-c'],\n    ['dae', 'model/vnd.collada+xml'],\n    ['daf', 'application/vnd.mobius.daf'],\n    ['dart', 'application/vnd.dart'],\n    ['dataless', 'application/vnd.fdsn.seed'],\n    ['davmount', 'application/davmount+xml'],\n    ['dbf', 'application/vnd.dbf'],\n    ['dbk', 'application/docbook+xml'],\n    ['dcr', 'application/x-director'],\n    ['dcurl', 'text/vnd.curl.dcurl'],\n    ['dd2', 'application/vnd.oma.dd2+xml'],\n    ['ddd', 'application/vnd.fujixerox.ddd'],\n    ['ddf', 'application/vnd.syncml.dmddf+xml'],\n    ['dds', 'image/vnd.ms-dds'],\n    ['deb', 'application/x-debian-package'],\n    ['def', 'text/plain'],\n    ['deploy', 'application/octet-stream'],\n    ['der', 'application/x-x509-ca-cert'],\n    ['dfac', 'application/vnd.dreamfactory'],\n    ['dgc', 'application/x-dgc-compressed'],\n    ['dic', 'text/x-c'],\n    ['dir', 'application/x-director'],\n    ['dis', 'application/vnd.mobius.dis'],\n    ['disposition-notification', 'message/disposition-notification'],\n    ['dist', 'application/octet-stream'],\n    ['distz', 'application/octet-stream'],\n    ['djv', 'image/vnd.djvu'],\n    ['djvu', 'image/vnd.djvu'],\n    ['dll', 'application/octet-stream'],\n    ['dmg', 'application/x-apple-diskimage'],\n    ['dmn', 'application/octet-stream'],\n    ['dmp', 'application/vnd.tcpdump.pcap'],\n    ['dms', 'application/octet-stream'],\n    ['dna', 'application/vnd.dna'],\n    ['doc', 'application/msword'],\n    ['docm', 'application/vnd.ms-word.template.macroEnabled.12'],\n    ['docx', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'],\n    ['dot', 'application/msword'],\n    ['dotm', 'application/vnd.ms-word.template.macroEnabled.12'],\n    ['dotx', 'application/vnd.openxmlformats-officedocument.wordprocessingml.template'],\n    ['dp', 'application/vnd.osgi.dp'],\n    ['dpg', 'application/vnd.dpgraph'],\n    ['dra', 'audio/vnd.dra'],\n    ['drle', 'image/dicom-rle'],\n    ['dsc', 'text/prs.lines.tag'],\n    ['dssc', 'application/dssc+der'],\n    ['dtb', 'application/x-dtbook+xml'],\n    ['dtd', 'application/xml-dtd'],\n    ['dts', 'audio/vnd.dts'],\n    ['dtshd', 'audio/vnd.dts.hd'],\n    ['dump', 'application/octet-stream'],\n    ['dvb', 'video/vnd.dvb.file'],\n    ['dvi', 'application/x-dvi'],\n    ['dwd', 'application/atsc-dwd+xml'],\n    ['dwf', 'model/vnd.dwf'],\n    ['dwg', 'image/vnd.dwg'],\n    ['dxf', 'image/vnd.dxf'],\n    ['dxp', 'application/vnd.spotfire.dxp'],\n    ['dxr', 'application/x-director'],\n    ['ear', 'application/java-archive'],\n    ['ecelp4800', 'audio/vnd.nuera.ecelp4800'],\n    ['ecelp7470', 'audio/vnd.nuera.ecelp7470'],\n    ['ecelp9600', 'audio/vnd.nuera.ecelp9600'],\n    ['ecma', 'application/ecmascript'],\n    ['edm', 'application/vnd.novadigm.edm'],\n    ['edx', 'application/vnd.novadigm.edx'],\n    ['efif', 'application/vnd.picsel'],\n    ['ei6', 'application/vnd.pg.osasli'],\n    ['elc', 'application/octet-stream'],\n    ['emf', 'image/emf'],\n    ['eml', 'message/rfc822'],\n    ['emma', 'application/emma+xml'],\n    ['emotionml', 'application/emotionml+xml'],\n    ['emz', 'application/x-msmetafile'],\n    ['eol', 'audio/vnd.digital-winds'],\n    ['eot', 'application/vnd.ms-fontobject'],\n    ['eps', 'application/postscript'],\n    ['epub', 'application/epub+zip'],\n    ['es', 'application/ecmascript'],\n    ['es3', 'application/vnd.eszigno3+xml'],\n    ['esa', 'application/vnd.osgi.subsystem'],\n    ['esf', 'application/vnd.epson.esf'],\n    ['et3', 'application/vnd.eszigno3+xml'],\n    ['etx', 'text/x-setext'],\n    ['eva', 'application/x-eva'],\n    ['evy', 'application/x-envoy'],\n    ['exe', 'application/octet-stream'],\n    ['exi', 'application/exi'],\n    ['exp', 'application/express'],\n    ['exr', 'image/aces'],\n    ['ext', 'application/vnd.novadigm.ext'],\n    ['ez', 'application/andrew-inset'],\n    ['ez2', 'application/vnd.ezpix-album'],\n    ['ez3', 'application/vnd.ezpix-package'],\n    ['f', 'text/x-fortran'],\n    ['f4v', 'video/mp4'],\n    ['f77', 'text/x-fortran'],\n    ['f90', 'text/x-fortran'],\n    ['fbs', 'image/vnd.fastbidsheet'],\n    ['fcdt', 'application/vnd.adobe.formscentral.fcdt'],\n    ['fcs', 'application/vnd.isac.fcs'],\n    ['fdf', 'application/vnd.fdf'],\n    ['fdt', 'application/fdt+xml'],\n    ['fe_launch', 'application/vnd.denovo.fcselayout-link'],\n    ['fg5', 'application/vnd.fujitsu.oasysgp'],\n    ['fgd', 'application/x-director'],\n    ['fh', 'image/x-freehand'],\n    ['fh4', 'image/x-freehand'],\n    ['fh5', 'image/x-freehand'],\n    ['fh7', 'image/x-freehand'],\n    ['fhc', 'image/x-freehand'],\n    ['fig', 'application/x-xfig'],\n    ['fits', 'image/fits'],\n    ['flac', 'audio/x-flac'],\n    ['fli', 'video/x-fli'],\n    ['flo', 'application/vnd.micrografx.flo'],\n    ['flv', 'video/x-flv'],\n    ['flw', 'application/vnd.kde.kivio'],\n    ['flx', 'text/vnd.fmi.flexstor'],\n    ['fly', 'text/vnd.fly'],\n    ['fm', 'application/vnd.framemaker'],\n    ['fnc', 'application/vnd.frogans.fnc'],\n    ['fo', 'application/vnd.software602.filler.form+xml'],\n    ['for', 'text/x-fortran'],\n    ['fpx', 'image/vnd.fpx'],\n    ['frame', 'application/vnd.framemaker'],\n    ['fsc', 'application/vnd.fsc.weblaunch'],\n    ['fst', 'image/vnd.fst'],\n    ['ftc', 'application/vnd.fluxtime.clip'],\n    ['fti', 'application/vnd.anser-web-funds-transfer-initiation'],\n    ['fvt', 'video/vnd.fvt'],\n    ['fxp', 'application/vnd.adobe.fxp'],\n    ['fxpl', 'application/vnd.adobe.fxp'],\n    ['fzs', 'application/vnd.fuzzysheet'],\n    ['g2w', 'application/vnd.geoplan'],\n    ['g3', 'image/g3fax'],\n    ['g3w', 'application/vnd.geospace'],\n    ['gac', 'application/vnd.groove-account'],\n    ['gam', 'application/x-tads'],\n    ['gbr', 'application/rpki-ghostbusters'],\n    ['gca', 'application/x-gca-compressed'],\n    ['gdl', 'model/vnd.gdl'],\n    ['gdoc', 'application/vnd.google-apps.document'],\n    ['geo', 'application/vnd.dynageo'],\n    ['geojson', 'application/geo+json'],\n    ['gex', 'application/vnd.geometry-explorer'],\n    ['ggb', 'application/vnd.geogebra.file'],\n    ['ggt', 'application/vnd.geogebra.tool'],\n    ['ghf', 'application/vnd.groove-help'],\n    ['gif', 'image/gif'],\n    ['gim', 'application/vnd.groove-identity-message'],\n    ['glb', 'model/gltf-binary'],\n    ['gltf', 'model/gltf+json'],\n    ['gml', 'application/gml+xml'],\n    ['gmx', 'application/vnd.gmx'],\n    ['gnumeric', 'application/x-gnumeric'],\n    ['gpg', 'application/gpg-keys'],\n    ['gph', 'application/vnd.flographit'],\n    ['gpx', 'application/gpx+xml'],\n    ['gqf', 'application/vnd.grafeq'],\n    ['gqs', 'application/vnd.grafeq'],\n    ['gram', 'application/srgs'],\n    ['gramps', 'application/x-gramps-xml'],\n    ['gre', 'application/vnd.geometry-explorer'],\n    ['grv', 'application/vnd.groove-injector'],\n    ['grxml', 'application/srgs+xml'],\n    ['gsf', 'application/x-font-ghostscript'],\n    ['gsheet', 'application/vnd.google-apps.spreadsheet'],\n    ['gslides', 'application/vnd.google-apps.presentation'],\n    ['gtar', 'application/x-gtar'],\n    ['gtm', 'application/vnd.groove-tool-message'],\n    ['gtw', 'model/vnd.gtw'],\n    ['gv', 'text/vnd.graphviz'],\n    ['gxf', 'application/gxf'],\n    ['gxt', 'application/vnd.geonext'],\n    ['gz', 'application/gzip'],\n    ['gzip', 'application/gzip'],\n    ['h', 'text/x-c'],\n    ['h261', 'video/h261'],\n    ['h263', 'video/h263'],\n    ['h264', 'video/h264'],\n    ['hal', 'application/vnd.hal+xml'],\n    ['hbci', 'application/vnd.hbci'],\n    ['hbs', 'text/x-handlebars-template'],\n    ['hdd', 'application/x-virtualbox-hdd'],\n    ['hdf', 'application/x-hdf'],\n    ['heic', 'image/heic'],\n    ['heics', 'image/heic-sequence'],\n    ['heif', 'image/heif'],\n    ['heifs', 'image/heif-sequence'],\n    ['hej2', 'image/hej2k'],\n    ['held', 'application/atsc-held+xml'],\n    ['hh', 'text/x-c'],\n    ['hjson', 'application/hjson'],\n    ['hlp', 'application/winhlp'],\n    ['hpgl', 'application/vnd.hp-hpgl'],\n    ['hpid', 'application/vnd.hp-hpid'],\n    ['hps', 'application/vnd.hp-hps'],\n    ['hqx', 'application/mac-binhex40'],\n    ['hsj2', 'image/hsj2'],\n    ['htc', 'text/x-component'],\n    ['htke', 'application/vnd.kenameaapp'],\n    ['htm', 'text/html'],\n    ['html', 'text/html'],\n    ['hvd', 'application/vnd.yamaha.hv-dic'],\n    ['hvp', 'application/vnd.yamaha.hv-voice'],\n    ['hvs', 'application/vnd.yamaha.hv-script'],\n    ['i2g', 'application/vnd.intergeo'],\n    ['icc', 'application/vnd.iccprofile'],\n    ['ice', 'x-conference/x-cooltalk'],\n    ['icm', 'application/vnd.iccprofile'],\n    ['ico', 'image/x-icon'],\n    ['ics', 'text/calendar'],\n    ['ief', 'image/ief'],\n    ['ifb', 'text/calendar'],\n    ['ifm', 'application/vnd.shana.informed.formdata'],\n    ['iges', 'model/iges'],\n    ['igl', 'application/vnd.igloader'],\n    ['igm', 'application/vnd.insors.igm'],\n    ['igs', 'model/iges'],\n    ['igx', 'application/vnd.micrografx.igx'],\n    ['iif', 'application/vnd.shana.informed.interchange'],\n    ['img', 'application/octet-stream'],\n    ['imp', 'application/vnd.accpac.simply.imp'],\n    ['ims', 'application/vnd.ms-ims'],\n    ['in', 'text/plain'],\n    ['ini', 'text/plain'],\n    ['ink', 'application/inkml+xml'],\n    ['inkml', 'application/inkml+xml'],\n    ['install', 'application/x-install-instructions'],\n    ['iota', 'application/vnd.astraea-software.iota'],\n    ['ipfix', 'application/ipfix'],\n    ['ipk', 'application/vnd.shana.informed.package'],\n    ['irm', 'application/vnd.ibm.rights-management'],\n    ['irp', 'application/vnd.irepository.package+xml'],\n    ['iso', 'application/x-iso9660-image'],\n    ['itp', 'application/vnd.shana.informed.formtemplate'],\n    ['its', 'application/its+xml'],\n    ['ivp', 'application/vnd.immervision-ivp'],\n    ['ivu', 'application/vnd.immervision-ivu'],\n    ['jad', 'text/vnd.sun.j2me.app-descriptor'],\n    ['jade', 'text/jade'],\n    ['jam', 'application/vnd.jam'],\n    ['jar', 'application/java-archive'],\n    ['jardiff', 'application/x-java-archive-diff'],\n    ['java', 'text/x-java-source'],\n    ['jhc', 'image/jphc'],\n    ['jisp', 'application/vnd.jisp'],\n    ['jls', 'image/jls'],\n    ['jlt', 'application/vnd.hp-jlyt'],\n    ['jng', 'image/x-jng'],\n    ['jnlp', 'application/x-java-jnlp-file'],\n    ['joda', 'application/vnd.joost.joda-archive'],\n    ['jp2', 'image/jp2'],\n    ['jpe', 'image/jpeg'],\n    ['jpeg', 'image/jpeg'],\n    ['jpf', 'image/jpx'],\n    ['jpg', 'image/jpeg'],\n    ['jpg2', 'image/jp2'],\n    ['jpgm', 'video/jpm'],\n    ['jpgv', 'video/jpeg'],\n    ['jph', 'image/jph'],\n    ['jpm', 'video/jpm'],\n    ['jpx', 'image/jpx'],\n    ['js', 'application/javascript'],\n    ['json', 'application/json'],\n    ['json5', 'application/json5'],\n    ['jsonld', 'application/ld+json'],\n    // https://jsonlines.org/\n    ['jsonl', 'application/jsonl'],\n    ['jsonml', 'application/jsonml+json'],\n    ['jsx', 'text/jsx'],\n    ['jxr', 'image/jxr'],\n    ['jxra', 'image/jxra'],\n    ['jxrs', 'image/jxrs'],\n    ['jxs', 'image/jxs'],\n    ['jxsc', 'image/jxsc'],\n    ['jxsi', 'image/jxsi'],\n    ['jxss', 'image/jxss'],\n    ['kar', 'audio/midi'],\n    ['karbon', 'application/vnd.kde.karbon'],\n    ['kdb', 'application/octet-stream'],\n    ['kdbx', 'application/x-keepass2'],\n    ['key', 'application/x-iwork-keynote-sffkey'],\n    ['kfo', 'application/vnd.kde.kformula'],\n    ['kia', 'application/vnd.kidspiration'],\n    ['kml', 'application/vnd.google-earth.kml+xml'],\n    ['kmz', 'application/vnd.google-earth.kmz'],\n    ['kne', 'application/vnd.kinar'],\n    ['knp', 'application/vnd.kinar'],\n    ['kon', 'application/vnd.kde.kontour'],\n    ['kpr', 'application/vnd.kde.kpresenter'],\n    ['kpt', 'application/vnd.kde.kpresenter'],\n    ['kpxx', 'application/vnd.ds-keypoint'],\n    ['ksp', 'application/vnd.kde.kspread'],\n    ['ktr', 'application/vnd.kahootz'],\n    ['ktx', 'image/ktx'],\n    ['ktx2', 'image/ktx2'],\n    ['ktz', 'application/vnd.kahootz'],\n    ['kwd', 'application/vnd.kde.kword'],\n    ['kwt', 'application/vnd.kde.kword'],\n    ['lasxml', 'application/vnd.las.las+xml'],\n    ['latex', 'application/x-latex'],\n    ['lbd', 'application/vnd.llamagraphics.life-balance.desktop'],\n    ['lbe', 'application/vnd.llamagraphics.life-balance.exchange+xml'],\n    ['les', 'application/vnd.hhe.lesson-player'],\n    ['less', 'text/less'],\n    ['lgr', 'application/lgr+xml'],\n    ['lha', 'application/octet-stream'],\n    ['link66', 'application/vnd.route66.link66+xml'],\n    ['list', 'text/plain'],\n    ['list3820', 'application/vnd.ibm.modcap'],\n    ['listafp', 'application/vnd.ibm.modcap'],\n    ['litcoffee', 'text/coffeescript'],\n    ['lnk', 'application/x-ms-shortcut'],\n    ['log', 'text/plain'],\n    ['lostxml', 'application/lost+xml'],\n    ['lrf', 'application/octet-stream'],\n    ['lrm', 'application/vnd.ms-lrm'],\n    ['ltf', 'application/vnd.frogans.ltf'],\n    ['lua', 'text/x-lua'],\n    ['luac', 'application/x-lua-bytecode'],\n    ['lvp', 'audio/vnd.lucent.voice'],\n    ['lwp', 'application/vnd.lotus-wordpro'],\n    ['lzh', 'application/octet-stream'],\n    ['m1v', 'video/mpeg'],\n    ['m2a', 'audio/mpeg'],\n    ['m2v', 'video/mpeg'],\n    ['m3a', 'audio/mpeg'],\n    ['m3u', 'text/plain'],\n    ['m3u8', 'application/vnd.apple.mpegurl'],\n    ['m4a', 'audio/x-m4a'],\n    ['m4p', 'application/mp4'],\n    ['m4s', 'video/iso.segment'],\n    ['m4u', 'application/vnd.mpegurl'],\n    ['m4v', 'video/x-m4v'],\n    ['m13', 'application/x-msmediaview'],\n    ['m14', 'application/x-msmediaview'],\n    ['m21', 'application/mp21'],\n    ['ma', 'application/mathematica'],\n    ['mads', 'application/mads+xml'],\n    ['maei', 'application/mmt-aei+xml'],\n    ['mag', 'application/vnd.ecowin.chart'],\n    ['maker', 'application/vnd.framemaker'],\n    ['man', 'text/troff'],\n    ['manifest', 'text/cache-manifest'],\n    ['map', 'application/json'],\n    ['mar', 'application/octet-stream'],\n    ['markdown', 'text/markdown'],\n    ['mathml', 'application/mathml+xml'],\n    ['mb', 'application/mathematica'],\n    ['mbk', 'application/vnd.mobius.mbk'],\n    ['mbox', 'application/mbox'],\n    ['mc1', 'application/vnd.medcalcdata'],\n    ['mcd', 'application/vnd.mcd'],\n    ['mcurl', 'text/vnd.curl.mcurl'],\n    ['md', 'text/markdown'],\n    ['mdb', 'application/x-msaccess'],\n    ['mdi', 'image/vnd.ms-modi'],\n    ['mdx', 'text/mdx'],\n    ['me', 'text/troff'],\n    ['mesh', 'model/mesh'],\n    ['meta4', 'application/metalink4+xml'],\n    ['metalink', 'application/metalink+xml'],\n    ['mets', 'application/mets+xml'],\n    ['mfm', 'application/vnd.mfmp'],\n    ['mft', 'application/rpki-manifest'],\n    ['mgp', 'application/vnd.osgeo.mapguide.package'],\n    ['mgz', 'application/vnd.proteus.magazine'],\n    ['mid', 'audio/midi'],\n    ['midi', 'audio/midi'],\n    ['mie', 'application/x-mie'],\n    ['mif', 'application/vnd.mif'],\n    ['mime', 'message/rfc822'],\n    ['mj2', 'video/mj2'],\n    ['mjp2', 'video/mj2'],\n    ['mjs', 'application/javascript'],\n    ['mk3d', 'video/x-matroska'],\n    ['mka', 'audio/x-matroska'],\n    ['mkd', 'text/x-markdown'],\n    ['mks', 'video/x-matroska'],\n    ['mkv', 'video/x-matroska'],\n    ['mlp', 'application/vnd.dolby.mlp'],\n    ['mmd', 'application/vnd.chipnuts.karaoke-mmd'],\n    ['mmf', 'application/vnd.smaf'],\n    ['mml', 'text/mathml'],\n    ['mmr', 'image/vnd.fujixerox.edmics-mmr'],\n    ['mng', 'video/x-mng'],\n    ['mny', 'application/x-msmoney'],\n    ['mobi', 'application/x-mobipocket-ebook'],\n    ['mods', 'application/mods+xml'],\n    ['mov', 'video/quicktime'],\n    ['movie', 'video/x-sgi-movie'],\n    ['mp2', 'audio/mpeg'],\n    ['mp2a', 'audio/mpeg'],\n    ['mp3', 'audio/mpeg'],\n    ['mp4', 'video/mp4'],\n    ['mp4a', 'audio/mp4'],\n    ['mp4s', 'application/mp4'],\n    ['mp4v', 'video/mp4'],\n    ['mp21', 'application/mp21'],\n    ['mpc', 'application/vnd.mophun.certificate'],\n    ['mpd', 'application/dash+xml'],\n    ['mpe', 'video/mpeg'],\n    ['mpeg', 'video/mpeg'],\n    ['mpg', 'video/mpeg'],\n    ['mpg4', 'video/mp4'],\n    ['mpga', 'audio/mpeg'],\n    ['mpkg', 'application/vnd.apple.installer+xml'],\n    ['mpm', 'application/vnd.blueice.multipass'],\n    ['mpn', 'application/vnd.mophun.application'],\n    ['mpp', 'application/vnd.ms-project'],\n    ['mpt', 'application/vnd.ms-project'],\n    ['mpy', 'application/vnd.ibm.minipay'],\n    ['mqy', 'application/vnd.mobius.mqy'],\n    ['mrc', 'application/marc'],\n    ['mrcx', 'application/marcxml+xml'],\n    ['ms', 'text/troff'],\n    ['mscml', 'application/mediaservercontrol+xml'],\n    ['mseed', 'application/vnd.fdsn.mseed'],\n    ['mseq', 'application/vnd.mseq'],\n    ['msf', 'application/vnd.epson.msf'],\n    ['msg', 'application/vnd.ms-outlook'],\n    ['msh', 'model/mesh'],\n    ['msi', 'application/x-msdownload'],\n    ['msl', 'application/vnd.mobius.msl'],\n    ['msm', 'application/octet-stream'],\n    ['msp', 'application/octet-stream'],\n    ['msty', 'application/vnd.muvee.style'],\n    ['mtl', 'model/mtl'],\n    ['mts', 'model/vnd.mts'],\n    ['mus', 'application/vnd.musician'],\n    ['musd', 'application/mmt-usd+xml'],\n    ['musicxml', 'application/vnd.recordare.musicxml+xml'],\n    ['mvb', 'application/x-msmediaview'],\n    ['mvt', 'application/vnd.mapbox-vector-tile'],\n    ['mwf', 'application/vnd.mfer'],\n    ['mxf', 'application/mxf'],\n    ['mxl', 'application/vnd.recordare.musicxml'],\n    ['mxmf', 'audio/mobile-xmf'],\n    ['mxml', 'application/xv+xml'],\n    ['mxs', 'application/vnd.triscape.mxs'],\n    ['mxu', 'video/vnd.mpegurl'],\n    ['n-gage', 'application/vnd.nokia.n-gage.symbian.install'],\n    ['n3', 'text/n3'],\n    ['nb', 'application/mathematica'],\n    ['nbp', 'application/vnd.wolfram.player'],\n    ['nc', 'application/x-netcdf'],\n    ['ncx', 'application/x-dtbncx+xml'],\n    ['nfo', 'text/x-nfo'],\n    ['ngdat', 'application/vnd.nokia.n-gage.data'],\n    ['nitf', 'application/vnd.nitf'],\n    ['nlu', 'application/vnd.neurolanguage.nlu'],\n    ['nml', 'application/vnd.enliven'],\n    ['nnd', 'application/vnd.noblenet-directory'],\n    ['nns', 'application/vnd.noblenet-sealer'],\n    ['nnw', 'application/vnd.noblenet-web'],\n    ['npx', 'image/vnd.net-fpx'],\n    ['nq', 'application/n-quads'],\n    ['nsc', 'application/x-conference'],\n    ['nsf', 'application/vnd.lotus-notes'],\n    ['nt', 'application/n-triples'],\n    ['ntf', 'application/vnd.nitf'],\n    ['numbers', 'application/x-iwork-numbers-sffnumbers'],\n    ['nzb', 'application/x-nzb'],\n    ['oa2', 'application/vnd.fujitsu.oasys2'],\n    ['oa3', 'application/vnd.fujitsu.oasys3'],\n    ['oas', 'application/vnd.fujitsu.oasys'],\n    ['obd', 'application/x-msbinder'],\n    ['obgx', 'application/vnd.openblox.game+xml'],\n    ['obj', 'model/obj'],\n    ['oda', 'application/oda'],\n    ['odb', 'application/vnd.oasis.opendocument.database'],\n    ['odc', 'application/vnd.oasis.opendocument.chart'],\n    ['odf', 'application/vnd.oasis.opendocument.formula'],\n    ['odft', 'application/vnd.oasis.opendocument.formula-template'],\n    ['odg', 'application/vnd.oasis.opendocument.graphics'],\n    ['odi', 'application/vnd.oasis.opendocument.image'],\n    ['odm', 'application/vnd.oasis.opendocument.text-master'],\n    ['odp', 'application/vnd.oasis.opendocument.presentation'],\n    ['ods', 'application/vnd.oasis.opendocument.spreadsheet'],\n    ['odt', 'application/vnd.oasis.opendocument.text'],\n    ['oga', 'audio/ogg'],\n    ['ogex', 'model/vnd.opengex'],\n    ['ogg', 'audio/ogg'],\n    ['ogv', 'video/ogg'],\n    ['ogx', 'application/ogg'],\n    ['omdoc', 'application/omdoc+xml'],\n    ['onepkg', 'application/onenote'],\n    ['onetmp', 'application/onenote'],\n    ['onetoc', 'application/onenote'],\n    ['onetoc2', 'application/onenote'],\n    ['opf', 'application/oebps-package+xml'],\n    ['opml', 'text/x-opml'],\n    ['oprc', 'application/vnd.palm'],\n    ['opus', 'audio/ogg'],\n    ['org', 'text/x-org'],\n    ['osf', 'application/vnd.yamaha.openscoreformat'],\n    ['osfpvg', 'application/vnd.yamaha.openscoreformat.osfpvg+xml'],\n    ['osm', 'application/vnd.openstreetmap.data+xml'],\n    ['otc', 'application/vnd.oasis.opendocument.chart-template'],\n    ['otf', 'font/otf'],\n    ['otg', 'application/vnd.oasis.opendocument.graphics-template'],\n    ['oth', 'application/vnd.oasis.opendocument.text-web'],\n    ['oti', 'application/vnd.oasis.opendocument.image-template'],\n    ['otp', 'application/vnd.oasis.opendocument.presentation-template'],\n    ['ots', 'application/vnd.oasis.opendocument.spreadsheet-template'],\n    ['ott', 'application/vnd.oasis.opendocument.text-template'],\n    ['ova', 'application/x-virtualbox-ova'],\n    ['ovf', 'application/x-virtualbox-ovf'],\n    ['owl', 'application/rdf+xml'],\n    ['oxps', 'application/oxps'],\n    ['oxt', 'application/vnd.openofficeorg.extension'],\n    ['p', 'text/x-pascal'],\n    ['p7a', 'application/x-pkcs7-signature'],\n    ['p7b', 'application/x-pkcs7-certificates'],\n    ['p7c', 'application/pkcs7-mime'],\n    ['p7m', 'application/pkcs7-mime'],\n    ['p7r', 'application/x-pkcs7-certreqresp'],\n    ['p7s', 'application/pkcs7-signature'],\n    ['p8', 'application/pkcs8'],\n    ['p10', 'application/x-pkcs10'],\n    ['p12', 'application/x-pkcs12'],\n    ['pac', 'application/x-ns-proxy-autoconfig'],\n    ['pages', 'application/x-iwork-pages-sffpages'],\n    ['pas', 'text/x-pascal'],\n    ['paw', 'application/vnd.pawaafile'],\n    ['pbd', 'application/vnd.powerbuilder6'],\n    ['pbm', 'image/x-portable-bitmap'],\n    ['pcap', 'application/vnd.tcpdump.pcap'],\n    ['pcf', 'application/x-font-pcf'],\n    ['pcl', 'application/vnd.hp-pcl'],\n    ['pclxl', 'application/vnd.hp-pclxl'],\n    ['pct', 'image/x-pict'],\n    ['pcurl', 'application/vnd.curl.pcurl'],\n    ['pcx', 'image/x-pcx'],\n    ['pdb', 'application/x-pilot'],\n    ['pde', 'text/x-processing'],\n    ['pdf', 'application/pdf'],\n    ['pem', 'application/x-x509-user-cert'],\n    ['pfa', 'application/x-font-type1'],\n    ['pfb', 'application/x-font-type1'],\n    ['pfm', 'application/x-font-type1'],\n    ['pfr', 'application/font-tdpfr'],\n    ['pfx', 'application/x-pkcs12'],\n    ['pgm', 'image/x-portable-graymap'],\n    ['pgn', 'application/x-chess-pgn'],\n    ['pgp', 'application/pgp'],\n    ['php', 'application/x-httpd-php'],\n    ['php3', 'application/x-httpd-php'],\n    ['php4', 'application/x-httpd-php'],\n    ['phps', 'application/x-httpd-php-source'],\n    ['phtml', 'application/x-httpd-php'],\n    ['pic', 'image/x-pict'],\n    ['pkg', 'application/octet-stream'],\n    ['pki', 'application/pkixcmp'],\n    ['pkipath', 'application/pkix-pkipath'],\n    ['pkpass', 'application/vnd.apple.pkpass'],\n    ['pl', 'application/x-perl'],\n    ['plb', 'application/vnd.3gpp.pic-bw-large'],\n    ['plc', 'application/vnd.mobius.plc'],\n    ['plf', 'application/vnd.pocketlearn'],\n    ['pls', 'application/pls+xml'],\n    ['pm', 'application/x-perl'],\n    ['pml', 'application/vnd.ctc-posml'],\n    ['png', 'image/png'],\n    ['pnm', 'image/x-portable-anymap'],\n    ['portpkg', 'application/vnd.macports.portpkg'],\n    ['pot', 'application/vnd.ms-powerpoint'],\n    ['potm', 'application/vnd.ms-powerpoint.presentation.macroEnabled.12'],\n    ['potx', 'application/vnd.openxmlformats-officedocument.presentationml.template'],\n    ['ppa', 'application/vnd.ms-powerpoint'],\n    ['ppam', 'application/vnd.ms-powerpoint.addin.macroEnabled.12'],\n    ['ppd', 'application/vnd.cups-ppd'],\n    ['ppm', 'image/x-portable-pixmap'],\n    ['pps', 'application/vnd.ms-powerpoint'],\n    ['ppsm', 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12'],\n    ['ppsx', 'application/vnd.openxmlformats-officedocument.presentationml.slideshow'],\n    ['ppt', 'application/powerpoint'],\n    ['pptm', 'application/vnd.ms-powerpoint.presentation.macroEnabled.12'],\n    ['pptx', 'application/vnd.openxmlformats-officedocument.presentationml.presentation'],\n    ['pqa', 'application/vnd.palm'],\n    ['prc', 'application/x-pilot'],\n    ['pre', 'application/vnd.lotus-freelance'],\n    ['prf', 'application/pics-rules'],\n    ['provx', 'application/provenance+xml'],\n    ['ps', 'application/postscript'],\n    ['psb', 'application/vnd.3gpp.pic-bw-small'],\n    ['psd', 'application/x-photoshop'],\n    ['psf', 'application/x-font-linux-psf'],\n    ['pskcxml', 'application/pskc+xml'],\n    ['pti', 'image/prs.pti'],\n    ['ptid', 'application/vnd.pvi.ptid1'],\n    ['pub', 'application/x-mspublisher'],\n    ['pvb', 'application/vnd.3gpp.pic-bw-var'],\n    ['pwn', 'application/vnd.3m.post-it-notes'],\n    ['pya', 'audio/vnd.ms-playready.media.pya'],\n    ['pyv', 'video/vnd.ms-playready.media.pyv'],\n    ['qam', 'application/vnd.epson.quickanime'],\n    ['qbo', 'application/vnd.intu.qbo'],\n    ['qfx', 'application/vnd.intu.qfx'],\n    ['qps', 'application/vnd.publishare-delta-tree'],\n    ['qt', 'video/quicktime'],\n    ['qwd', 'application/vnd.quark.quarkxpress'],\n    ['qwt', 'application/vnd.quark.quarkxpress'],\n    ['qxb', 'application/vnd.quark.quarkxpress'],\n    ['qxd', 'application/vnd.quark.quarkxpress'],\n    ['qxl', 'application/vnd.quark.quarkxpress'],\n    ['qxt', 'application/vnd.quark.quarkxpress'],\n    ['ra', 'audio/x-realaudio'],\n    ['ram', 'audio/x-pn-realaudio'],\n    ['raml', 'application/raml+yaml'],\n    ['rapd', 'application/route-apd+xml'],\n    ['rar', 'application/x-rar'],\n    ['ras', 'image/x-cmu-raster'],\n    ['rcprofile', 'application/vnd.ipunplugged.rcprofile'],\n    ['rdf', 'application/rdf+xml'],\n    ['rdz', 'application/vnd.data-vision.rdz'],\n    ['relo', 'application/p2p-overlay+xml'],\n    ['rep', 'application/vnd.businessobjects'],\n    ['res', 'application/x-dtbresource+xml'],\n    ['rgb', 'image/x-rgb'],\n    ['rif', 'application/reginfo+xml'],\n    ['rip', 'audio/vnd.rip'],\n    ['ris', 'application/x-research-info-systems'],\n    ['rl', 'application/resource-lists+xml'],\n    ['rlc', 'image/vnd.fujixerox.edmics-rlc'],\n    ['rld', 'application/resource-lists-diff+xml'],\n    ['rm', 'audio/x-pn-realaudio'],\n    ['rmi', 'audio/midi'],\n    ['rmp', 'audio/x-pn-realaudio-plugin'],\n    ['rms', 'application/vnd.jcp.javame.midlet-rms'],\n    ['rmvb', 'application/vnd.rn-realmedia-vbr'],\n    ['rnc', 'application/relax-ng-compact-syntax'],\n    ['rng', 'application/xml'],\n    ['roa', 'application/rpki-roa'],\n    ['roff', 'text/troff'],\n    ['rp9', 'application/vnd.cloanto.rp9'],\n    ['rpm', 'audio/x-pn-realaudio-plugin'],\n    ['rpss', 'application/vnd.nokia.radio-presets'],\n    ['rpst', 'application/vnd.nokia.radio-preset'],\n    ['rq', 'application/sparql-query'],\n    ['rs', 'application/rls-services+xml'],\n    ['rsa', 'application/x-pkcs7'],\n    ['rsat', 'application/atsc-rsat+xml'],\n    ['rsd', 'application/rsd+xml'],\n    ['rsheet', 'application/urc-ressheet+xml'],\n    ['rss', 'application/rss+xml'],\n    ['rtf', 'text/rtf'],\n    ['rtx', 'text/richtext'],\n    ['run', 'application/x-makeself'],\n    ['rusd', 'application/route-usd+xml'],\n    ['rv', 'video/vnd.rn-realvideo'],\n    ['s', 'text/x-asm'],\n    ['s3m', 'audio/s3m'],\n    ['saf', 'application/vnd.yamaha.smaf-audio'],\n    ['sass', 'text/x-sass'],\n    ['sbml', 'application/sbml+xml'],\n    ['sc', 'application/vnd.ibm.secure-container'],\n    ['scd', 'application/x-msschedule'],\n    ['scm', 'application/vnd.lotus-screencam'],\n    ['scq', 'application/scvp-cv-request'],\n    ['scs', 'application/scvp-cv-response'],\n    ['scss', 'text/x-scss'],\n    ['scurl', 'text/vnd.curl.scurl'],\n    ['sda', 'application/vnd.stardivision.draw'],\n    ['sdc', 'application/vnd.stardivision.calc'],\n    ['sdd', 'application/vnd.stardivision.impress'],\n    ['sdkd', 'application/vnd.solent.sdkm+xml'],\n    ['sdkm', 'application/vnd.solent.sdkm+xml'],\n    ['sdp', 'application/sdp'],\n    ['sdw', 'application/vnd.stardivision.writer'],\n    ['sea', 'application/octet-stream'],\n    ['see', 'application/vnd.seemail'],\n    ['seed', 'application/vnd.fdsn.seed'],\n    ['sema', 'application/vnd.sema'],\n    ['semd', 'application/vnd.semd'],\n    ['semf', 'application/vnd.semf'],\n    ['senmlx', 'application/senml+xml'],\n    ['sensmlx', 'application/sensml+xml'],\n    ['ser', 'application/java-serialized-object'],\n    ['setpay', 'application/set-payment-initiation'],\n    ['setreg', 'application/set-registration-initiation'],\n    ['sfd-hdstx', 'application/vnd.hydrostatix.sof-data'],\n    ['sfs', 'application/vnd.spotfire.sfs'],\n    ['sfv', 'text/x-sfv'],\n    ['sgi', 'image/sgi'],\n    ['sgl', 'application/vnd.stardivision.writer-global'],\n    ['sgm', 'text/sgml'],\n    ['sgml', 'text/sgml'],\n    ['sh', 'application/x-sh'],\n    ['shar', 'application/x-shar'],\n    ['shex', 'text/shex'],\n    ['shf', 'application/shf+xml'],\n    ['shtml', 'text/html'],\n    ['sid', 'image/x-mrsid-image'],\n    ['sieve', 'application/sieve'],\n    ['sig', 'application/pgp-signature'],\n    ['sil', 'audio/silk'],\n    ['silo', 'model/mesh'],\n    ['sis', 'application/vnd.symbian.install'],\n    ['sisx', 'application/vnd.symbian.install'],\n    ['sit', 'application/x-stuffit'],\n    ['sitx', 'application/x-stuffitx'],\n    ['siv', 'application/sieve'],\n    ['skd', 'application/vnd.koan'],\n    ['skm', 'application/vnd.koan'],\n    ['skp', 'application/vnd.koan'],\n    ['skt', 'application/vnd.koan'],\n    ['sldm', 'application/vnd.ms-powerpoint.slide.macroenabled.12'],\n    ['sldx', 'application/vnd.openxmlformats-officedocument.presentationml.slide'],\n    ['slim', 'text/slim'],\n    ['slm', 'text/slim'],\n    ['sls', 'application/route-s-tsid+xml'],\n    ['slt', 'application/vnd.epson.salt'],\n    ['sm', 'application/vnd.stepmania.stepchart'],\n    ['smf', 'application/vnd.stardivision.math'],\n    ['smi', 'application/smil'],\n    ['smil', 'application/smil'],\n    ['smv', 'video/x-smv'],\n    ['smzip', 'application/vnd.stepmania.package'],\n    ['snd', 'audio/basic'],\n    ['snf', 'application/x-font-snf'],\n    ['so', 'application/octet-stream'],\n    ['spc', 'application/x-pkcs7-certificates'],\n    ['spdx', 'text/spdx'],\n    ['spf', 'application/vnd.yamaha.smaf-phrase'],\n    ['spl', 'application/x-futuresplash'],\n    ['spot', 'text/vnd.in3d.spot'],\n    ['spp', 'application/scvp-vp-response'],\n    ['spq', 'application/scvp-vp-request'],\n    ['spx', 'audio/ogg'],\n    ['sql', 'application/x-sql'],\n    ['src', 'application/x-wais-source'],\n    ['srt', 'application/x-subrip'],\n    ['sru', 'application/sru+xml'],\n    ['srx', 'application/sparql-results+xml'],\n    ['ssdl', 'application/ssdl+xml'],\n    ['sse', 'application/vnd.kodak-descriptor'],\n    ['ssf', 'application/vnd.epson.ssf'],\n    ['ssml', 'application/ssml+xml'],\n    ['sst', 'application/octet-stream'],\n    ['st', 'application/vnd.sailingtracker.track'],\n    ['stc', 'application/vnd.sun.xml.calc.template'],\n    ['std', 'application/vnd.sun.xml.draw.template'],\n    ['stf', 'application/vnd.wt.stf'],\n    ['sti', 'application/vnd.sun.xml.impress.template'],\n    ['stk', 'application/hyperstudio'],\n    ['stl', 'model/stl'],\n    ['stpx', 'model/step+xml'],\n    ['stpxz', 'model/step-xml+zip'],\n    ['stpz', 'model/step+zip'],\n    ['str', 'application/vnd.pg.format'],\n    ['stw', 'application/vnd.sun.xml.writer.template'],\n    ['styl', 'text/stylus'],\n    ['stylus', 'text/stylus'],\n    ['sub', 'text/vnd.dvb.subtitle'],\n    ['sus', 'application/vnd.sus-calendar'],\n    ['susp', 'application/vnd.sus-calendar'],\n    ['sv4cpio', 'application/x-sv4cpio'],\n    ['sv4crc', 'application/x-sv4crc'],\n    ['svc', 'application/vnd.dvb.service'],\n    ['svd', 'application/vnd.svd'],\n    ['svg', 'image/svg+xml'],\n    ['svgz', 'image/svg+xml'],\n    ['swa', 'application/x-director'],\n    ['swf', 'application/x-shockwave-flash'],\n    ['swi', 'application/vnd.aristanetworks.swi'],\n    ['swidtag', 'application/swid+xml'],\n    ['sxc', 'application/vnd.sun.xml.calc'],\n    ['sxd', 'application/vnd.sun.xml.draw'],\n    ['sxg', 'application/vnd.sun.xml.writer.global'],\n    ['sxi', 'application/vnd.sun.xml.impress'],\n    ['sxm', 'application/vnd.sun.xml.math'],\n    ['sxw', 'application/vnd.sun.xml.writer'],\n    ['t', 'text/troff'],\n    ['t3', 'application/x-t3vm-image'],\n    ['t38', 'image/t38'],\n    ['taglet', 'application/vnd.mynfc'],\n    ['tao', 'application/vnd.tao.intent-module-archive'],\n    ['tap', 'image/vnd.tencent.tap'],\n    ['tar', 'application/x-tar'],\n    ['tcap', 'application/vnd.3gpp2.tcap'],\n    ['tcl', 'application/x-tcl'],\n    ['td', 'application/urc-targetdesc+xml'],\n    ['teacher', 'application/vnd.smart.teacher'],\n    ['tei', 'application/tei+xml'],\n    ['teicorpus', 'application/tei+xml'],\n    ['tex', 'application/x-tex'],\n    ['texi', 'application/x-texinfo'],\n    ['texinfo', 'application/x-texinfo'],\n    ['text', 'text/plain'],\n    ['tfi', 'application/thraud+xml'],\n    ['tfm', 'application/x-tex-tfm'],\n    ['tfx', 'image/tiff-fx'],\n    ['tga', 'image/x-tga'],\n    ['tgz', 'application/x-tar'],\n    ['thmx', 'application/vnd.ms-officetheme'],\n    ['tif', 'image/tiff'],\n    ['tiff', 'image/tiff'],\n    ['tk', 'application/x-tcl'],\n    ['tmo', 'application/vnd.tmobile-livetv'],\n    ['toml', 'application/toml'],\n    ['torrent', 'application/x-bittorrent'],\n    ['tpl', 'application/vnd.groove-tool-template'],\n    ['tpt', 'application/vnd.trid.tpt'],\n    ['tr', 'text/troff'],\n    ['tra', 'application/vnd.trueapp'],\n    ['trig', 'application/trig'],\n    ['trm', 'application/x-msterminal'],\n    ['ts', 'video/mp2t'],\n    ['tsd', 'application/timestamped-data'],\n    ['tsv', 'text/tab-separated-values'],\n    ['ttc', 'font/collection'],\n    ['ttf', 'font/ttf'],\n    ['ttl', 'text/turtle'],\n    ['ttml', 'application/ttml+xml'],\n    ['twd', 'application/vnd.simtech-mindmapper'],\n    ['twds', 'application/vnd.simtech-mindmapper'],\n    ['txd', 'application/vnd.genomatix.tuxedo'],\n    ['txf', 'application/vnd.mobius.txf'],\n    ['txt', 'text/plain'],\n    ['u8dsn', 'message/global-delivery-status'],\n    ['u8hdr', 'message/global-headers'],\n    ['u8mdn', 'message/global-disposition-notification'],\n    ['u8msg', 'message/global'],\n    ['u32', 'application/x-authorware-bin'],\n    ['ubj', 'application/ubjson'],\n    ['udeb', 'application/x-debian-package'],\n    ['ufd', 'application/vnd.ufdl'],\n    ['ufdl', 'application/vnd.ufdl'],\n    ['ulx', 'application/x-glulx'],\n    ['umj', 'application/vnd.umajin'],\n    ['unityweb', 'application/vnd.unity'],\n    ['uoml', 'application/vnd.uoml+xml'],\n    ['uri', 'text/uri-list'],\n    ['uris', 'text/uri-list'],\n    ['urls', 'text/uri-list'],\n    ['usdz', 'model/vnd.usdz+zip'],\n    ['ustar', 'application/x-ustar'],\n    ['utz', 'application/vnd.uiq.theme'],\n    ['uu', 'text/x-uuencode'],\n    ['uva', 'audio/vnd.dece.audio'],\n    ['uvd', 'application/vnd.dece.data'],\n    ['uvf', 'application/vnd.dece.data'],\n    ['uvg', 'image/vnd.dece.graphic'],\n    ['uvh', 'video/vnd.dece.hd'],\n    ['uvi', 'image/vnd.dece.graphic'],\n    ['uvm', 'video/vnd.dece.mobile'],\n    ['uvp', 'video/vnd.dece.pd'],\n    ['uvs', 'video/vnd.dece.sd'],\n    ['uvt', 'application/vnd.dece.ttml+xml'],\n    ['uvu', 'video/vnd.uvvu.mp4'],\n    ['uvv', 'video/vnd.dece.video'],\n    ['uvva', 'audio/vnd.dece.audio'],\n    ['uvvd', 'application/vnd.dece.data'],\n    ['uvvf', 'application/vnd.dece.data'],\n    ['uvvg', 'image/vnd.dece.graphic'],\n    ['uvvh', 'video/vnd.dece.hd'],\n    ['uvvi', 'image/vnd.dece.graphic'],\n    ['uvvm', 'video/vnd.dece.mobile'],\n    ['uvvp', 'video/vnd.dece.pd'],\n    ['uvvs', 'video/vnd.dece.sd'],\n    ['uvvt', 'application/vnd.dece.ttml+xml'],\n    ['uvvu', 'video/vnd.uvvu.mp4'],\n    ['uvvv', 'video/vnd.dece.video'],\n    ['uvvx', 'application/vnd.dece.unspecified'],\n    ['uvvz', 'application/vnd.dece.zip'],\n    ['uvx', 'application/vnd.dece.unspecified'],\n    ['uvz', 'application/vnd.dece.zip'],\n    ['vbox', 'application/x-virtualbox-vbox'],\n    ['vbox-extpack', 'application/x-virtualbox-vbox-extpack'],\n    ['vcard', 'text/vcard'],\n    ['vcd', 'application/x-cdlink'],\n    ['vcf', 'text/x-vcard'],\n    ['vcg', 'application/vnd.groove-vcard'],\n    ['vcs', 'text/x-vcalendar'],\n    ['vcx', 'application/vnd.vcx'],\n    ['vdi', 'application/x-virtualbox-vdi'],\n    ['vds', 'model/vnd.sap.vds'],\n    ['vhd', 'application/x-virtualbox-vhd'],\n    ['vis', 'application/vnd.visionary'],\n    ['viv', 'video/vnd.vivo'],\n    ['vlc', 'application/videolan'],\n    ['vmdk', 'application/x-virtualbox-vmdk'],\n    ['vob', 'video/x-ms-vob'],\n    ['vor', 'application/vnd.stardivision.writer'],\n    ['vox', 'application/x-authorware-bin'],\n    ['vrml', 'model/vrml'],\n    ['vsd', 'application/vnd.visio'],\n    ['vsf', 'application/vnd.vsf'],\n    ['vss', 'application/vnd.visio'],\n    ['vst', 'application/vnd.visio'],\n    ['vsw', 'application/vnd.visio'],\n    ['vtf', 'image/vnd.valve.source.texture'],\n    ['vtt', 'text/vtt'],\n    ['vtu', 'model/vnd.vtu'],\n    ['vxml', 'application/voicexml+xml'],\n    ['w3d', 'application/x-director'],\n    ['wad', 'application/x-doom'],\n    ['wadl', 'application/vnd.sun.wadl+xml'],\n    ['war', 'application/java-archive'],\n    ['wasm', 'application/wasm'],\n    ['wav', 'audio/x-wav'],\n    ['wax', 'audio/x-ms-wax'],\n    ['wbmp', 'image/vnd.wap.wbmp'],\n    ['wbs', 'application/vnd.criticaltools.wbs+xml'],\n    ['wbxml', 'application/wbxml'],\n    ['wcm', 'application/vnd.ms-works'],\n    ['wdb', 'application/vnd.ms-works'],\n    ['wdp', 'image/vnd.ms-photo'],\n    ['weba', 'audio/webm'],\n    ['webapp', 'application/x-web-app-manifest+json'],\n    ['webm', 'video/webm'],\n    ['webmanifest', 'application/manifest+json'],\n    ['webp', 'image/webp'],\n    ['wg', 'application/vnd.pmi.widget'],\n    ['wgt', 'application/widget'],\n    ['wks', 'application/vnd.ms-works'],\n    ['wm', 'video/x-ms-wm'],\n    ['wma', 'audio/x-ms-wma'],\n    ['wmd', 'application/x-ms-wmd'],\n    ['wmf', 'image/wmf'],\n    ['wml', 'text/vnd.wap.wml'],\n    ['wmlc', 'application/wmlc'],\n    ['wmls', 'text/vnd.wap.wmlscript'],\n    ['wmlsc', 'application/vnd.wap.wmlscriptc'],\n    ['wmv', 'video/x-ms-wmv'],\n    ['wmx', 'video/x-ms-wmx'],\n    ['wmz', 'application/x-msmetafile'],\n    ['woff', 'font/woff'],\n    ['woff2', 'font/woff2'],\n    ['word', 'application/msword'],\n    ['wpd', 'application/vnd.wordperfect'],\n    ['wpl', 'application/vnd.ms-wpl'],\n    ['wps', 'application/vnd.ms-works'],\n    ['wqd', 'application/vnd.wqd'],\n    ['wri', 'application/x-mswrite'],\n    ['wrl', 'model/vrml'],\n    ['wsc', 'message/vnd.wfa.wsc'],\n    ['wsdl', 'application/wsdl+xml'],\n    ['wspolicy', 'application/wspolicy+xml'],\n    ['wtb', 'application/vnd.webturbo'],\n    ['wvx', 'video/x-ms-wvx'],\n    ['x3d', 'model/x3d+xml'],\n    ['x3db', 'model/x3d+fastinfoset'],\n    ['x3dbz', 'model/x3d+binary'],\n    ['x3dv', 'model/x3d-vrml'],\n    ['x3dvz', 'model/x3d+vrml'],\n    ['x3dz', 'model/x3d+xml'],\n    ['x32', 'application/x-authorware-bin'],\n    ['x_b', 'model/vnd.parasolid.transmit.binary'],\n    ['x_t', 'model/vnd.parasolid.transmit.text'],\n    ['xaml', 'application/xaml+xml'],\n    ['xap', 'application/x-silverlight-app'],\n    ['xar', 'application/vnd.xara'],\n    ['xav', 'application/xcap-att+xml'],\n    ['xbap', 'application/x-ms-xbap'],\n    ['xbd', 'application/vnd.fujixerox.docuworks.binder'],\n    ['xbm', 'image/x-xbitmap'],\n    ['xca', 'application/xcap-caps+xml'],\n    ['xcs', 'application/calendar+xml'],\n    ['xdf', 'application/xcap-diff+xml'],\n    ['xdm', 'application/vnd.syncml.dm+xml'],\n    ['xdp', 'application/vnd.adobe.xdp+xml'],\n    ['xdssc', 'application/dssc+xml'],\n    ['xdw', 'application/vnd.fujixerox.docuworks'],\n    ['xel', 'application/xcap-el+xml'],\n    ['xenc', 'application/xenc+xml'],\n    ['xer', 'application/patch-ops-error+xml'],\n    ['xfdf', 'application/vnd.adobe.xfdf'],\n    ['xfdl', 'application/vnd.xfdl'],\n    ['xht', 'application/xhtml+xml'],\n    ['xhtml', 'application/xhtml+xml'],\n    ['xhvml', 'application/xv+xml'],\n    ['xif', 'image/vnd.xiff'],\n    ['xl', 'application/excel'],\n    ['xla', 'application/vnd.ms-excel'],\n    ['xlam', 'application/vnd.ms-excel.addin.macroEnabled.12'],\n    ['xlc', 'application/vnd.ms-excel'],\n    ['xlf', 'application/xliff+xml'],\n    ['xlm', 'application/vnd.ms-excel'],\n    ['xls', 'application/vnd.ms-excel'],\n    ['xlsb', 'application/vnd.ms-excel.sheet.binary.macroEnabled.12'],\n    ['xlsm', 'application/vnd.ms-excel.sheet.macroEnabled.12'],\n    ['xlsx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'],\n    ['xlt', 'application/vnd.ms-excel'],\n    ['xltm', 'application/vnd.ms-excel.template.macroEnabled.12'],\n    ['xltx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.template'],\n    ['xlw', 'application/vnd.ms-excel'],\n    ['xm', 'audio/xm'],\n    ['xml', 'application/xml'],\n    ['xns', 'application/xcap-ns+xml'],\n    ['xo', 'application/vnd.olpc-sugar'],\n    ['xop', 'application/xop+xml'],\n    ['xpi', 'application/x-xpinstall'],\n    ['xpl', 'application/xproc+xml'],\n    ['xpm', 'image/x-xpixmap'],\n    ['xpr', 'application/vnd.is-xpr'],\n    ['xps', 'application/vnd.ms-xpsdocument'],\n    ['xpw', 'application/vnd.intercon.formnet'],\n    ['xpx', 'application/vnd.intercon.formnet'],\n    ['xsd', 'application/xml'],\n    ['xsl', 'application/xml'],\n    ['xslt', 'application/xslt+xml'],\n    ['xsm', 'application/vnd.syncml+xml'],\n    ['xspf', 'application/xspf+xml'],\n    ['xul', 'application/vnd.mozilla.xul+xml'],\n    ['xvm', 'application/xv+xml'],\n    ['xvml', 'application/xv+xml'],\n    ['xwd', 'image/x-xwindowdump'],\n    ['xyz', 'chemical/x-xyz'],\n    ['xz', 'application/x-xz'],\n    ['yaml', 'text/yaml'],\n    ['yang', 'application/yang'],\n    ['yin', 'application/yin+xml'],\n    ['yml', 'text/yaml'],\n    ['ymp', 'text/x-suse-ymp'],\n    ['z', 'application/x-compress'],\n    ['z1', 'application/x-zmachine'],\n    ['z2', 'application/x-zmachine'],\n    ['z3', 'application/x-zmachine'],\n    ['z4', 'application/x-zmachine'],\n    ['z5', 'application/x-zmachine'],\n    ['z6', 'application/x-zmachine'],\n    ['z7', 'application/x-zmachine'],\n    ['z8', 'application/x-zmachine'],\n    ['zaz', 'application/vnd.zzazz.deck+xml'],\n    ['zip', 'application/zip'],\n    ['zir', 'application/vnd.zul'],\n    ['zirz', 'application/vnd.zul'],\n    ['zmm', 'application/vnd.handheld-entertainment+xml'],\n    ['zsh', 'text/x-scriptzsh']\n]);\nexport function toFileWithPath(file, path, h) {\n    const f = withMimeType(file);\n    const { webkitRelativePath } = file;\n    const p = typeof path === 'string'\n        ? path\n        // If <input webkitdirectory> is set,\n        // the File will have a {webkitRelativePath} property\n        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/webkitdirectory\n        : typeof webkitRelativePath === 'string' && webkitRelativePath.length > 0\n            ? webkitRelativePath\n            : `./${file.name}`;\n    if (typeof f.path !== 'string') { // on electron, path is already set to the absolute path\n        setObjProp(f, 'path', p);\n    }\n    if (h !== undefined) {\n        Object.defineProperty(f, 'handle', {\n            value: h,\n            writable: false,\n            configurable: false,\n            enumerable: true\n        });\n    }\n    // Always populate a relative path so that even electron apps have access to a relativePath value\n    setObjProp(f, 'relativePath', p);\n    return f;\n}\nfunction withMimeType(file) {\n    const { name } = file;\n    const hasExtension = name && name.lastIndexOf('.') !== -1;\n    if (hasExtension && !file.type) {\n        const ext = name.split('.')\n            .pop().toLowerCase();\n        const type = COMMON_MIME_TYPES.get(ext);\n        if (type) {\n            Object.defineProperty(file, 'type', {\n                value: type,\n                writable: false,\n                configurable: false,\n                enumerable: true\n            });\n        }\n    }\n    return file;\n}\nfunction setObjProp(f, key, value) {\n    Object.defineProperty(f, key, {\n        value,\n        writable: false,\n        configurable: false,\n        enumerable: true\n    });\n}\n//# sourceMappingURL=file.js.map","import { __awaiter } from \"tslib\";\nimport { toFileWithPath } from './file';\nconst FILES_TO_IGNORE = [\n    // Thumbnail cache files for macOS and Windows\n    '.DS_Store', // macOs\n    'Thumbs.db' // Windows\n];\n/**\n * Convert a DragEvent's DataTrasfer object to a list of File objects\n * NOTE: If some of the items are folders,\n * everything will be flattened and placed in the same list but the paths will be kept as a {path} property.\n *\n * EXPERIMENTAL: A list of https://developer.mozilla.org/en-US/docs/Web/API/FileSystemHandle objects can also be passed as an arg\n * and a list of File objects will be returned.\n *\n * @param evt\n */\nexport function fromEvent(evt) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (isObject(evt) && isDataTransfer(evt.dataTransfer)) {\n            return getDataTransferFiles(evt.dataTransfer, evt.type);\n        }\n        else if (isChangeEvt(evt)) {\n            return getInputFiles(evt);\n        }\n        else if (Array.isArray(evt) && evt.every(item => 'getFile' in item && typeof item.getFile === 'function')) {\n            return getFsHandleFiles(evt);\n        }\n        return [];\n    });\n}\nfunction isDataTransfer(value) {\n    return isObject(value);\n}\nfunction isChangeEvt(value) {\n    return isObject(value) && isObject(value.target);\n}\nfunction isObject(v) {\n    return typeof v === 'object' && v !== null;\n}\nfunction getInputFiles(evt) {\n    return fromList(evt.target.files).map(file => toFileWithPath(file));\n}\n// Ee expect each handle to be https://developer.mozilla.org/en-US/docs/Web/API/FileSystemFileHandle\nfunction getFsHandleFiles(handles) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const files = yield Promise.all(handles.map(h => h.getFile()));\n        return files.map(file => toFileWithPath(file));\n    });\n}\nfunction getDataTransferFiles(dt, type) {\n    return __awaiter(this, void 0, void 0, function* () {\n        // IE11 does not support dataTransfer.items\n        // See https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/items#Browser_compatibility\n        if (dt.items) {\n            const items = fromList(dt.items)\n                .filter(item => item.kind === 'file');\n            // According to https://html.spec.whatwg.org/multipage/dnd.html#dndevents,\n            // only 'dragstart' and 'drop' has access to the data (source node)\n            if (type !== 'drop') {\n                return items;\n            }\n            const files = yield Promise.all(items.map(toFilePromises));\n            return noIgnoredFiles(flatten(files));\n        }\n        return noIgnoredFiles(fromList(dt.files)\n            .map(file => toFileWithPath(file)));\n    });\n}\nfunction noIgnoredFiles(files) {\n    return files.filter(file => FILES_TO_IGNORE.indexOf(file.name) === -1);\n}\n// IE11 does not support Array.from()\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from#Browser_compatibility\n// https://developer.mozilla.org/en-US/docs/Web/API/FileList\n// https://developer.mozilla.org/en-US/docs/Web/API/DataTransferItemList\nfunction fromList(items) {\n    if (items === null) {\n        return [];\n    }\n    const files = [];\n    // tslint:disable: prefer-for-of\n    for (let i = 0; i < items.length; i++) {\n        const file = items[i];\n        files.push(file);\n    }\n    return files;\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/DataTransferItem\nfunction toFilePromises(item) {\n    if (typeof item.webkitGetAsEntry !== 'function') {\n        return fromDataTransferItem(item);\n    }\n    const entry = item.webkitGetAsEntry();\n    // Safari supports dropping an image node from a different window and can be retrieved using\n    // the DataTransferItem.getAsFile() API\n    // NOTE: FileSystemEntry.file() throws if trying to get the file\n    if (entry && entry.isDirectory) {\n        return fromDirEntry(entry);\n    }\n    return fromDataTransferItem(item, entry);\n}\nfunction flatten(items) {\n    return items.reduce((acc, files) => [\n        ...acc,\n        ...(Array.isArray(files) ? flatten(files) : [files])\n    ], []);\n}\nfunction fromDataTransferItem(item, entry) {\n    return __awaiter(this, void 0, void 0, function* () {\n        var _a;\n        // Check if we're in a secure context; due to a bug in Chrome (as far as we know)\n        // the browser crashes when calling this API (yet to be confirmed as a consistent behaviour).\n        //\n        // See:\n        // - https://issues.chromium.org/issues/40186242\n        // - https://github.com/react-dropzone/react-dropzone/issues/1397\n        if (globalThis.isSecureContext && typeof item.getAsFileSystemHandle === 'function') {\n            const h = yield item.getAsFileSystemHandle();\n            if (h === null) {\n                throw new Error(`${item} is not a File`);\n            }\n            // It seems that the handle can be `undefined` (see https://github.com/react-dropzone/file-selector/issues/120),\n            // so we check if it isn't; if it is, the code path continues to the next API (`getAsFile`).\n            if (h !== undefined) {\n                const file = yield h.getFile();\n                file.handle = h;\n                return toFileWithPath(file);\n            }\n        }\n        const file = item.getAsFile();\n        if (!file) {\n            throw new Error(`${item} is not a File`);\n        }\n        const fwp = toFileWithPath(file, (_a = entry === null || entry === void 0 ? void 0 : entry.fullPath) !== null && _a !== void 0 ? _a : undefined);\n        return fwp;\n    });\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/FileSystemEntry\nfunction fromEntry(entry) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return entry.isDirectory ? fromDirEntry(entry) : fromFileEntry(entry);\n    });\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryEntry\nfunction fromDirEntry(entry) {\n    const reader = entry.createReader();\n    return new Promise((resolve, reject) => {\n        const entries = [];\n        function readEntries() {\n            // https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryEntry/createReader\n            // https://developer.mozilla.org/en-US/docs/Web/API/FileSystemDirectoryReader/readEntries\n            reader.readEntries((batch) => __awaiter(this, void 0, void 0, function* () {\n                if (!batch.length) {\n                    // Done reading directory\n                    try {\n                        const files = yield Promise.all(entries);\n                        resolve(files);\n                    }\n                    catch (err) {\n                        reject(err);\n                    }\n                }\n                else {\n                    const items = Promise.all(batch.map(fromEntry));\n                    entries.push(items);\n                    // Continue reading\n                    readEntries();\n                }\n            }), (err) => {\n                reject(err);\n            });\n        }\n        readEntries();\n    });\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/FileSystemFileEntry\nfunction fromFileEntry(entry) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            entry.file((file) => {\n                const fwp = toFileWithPath(file, entry.fullPath);\n                resolve(fwp);\n            }, (err) => {\n                reject(err);\n            });\n        });\n    });\n}\n//# sourceMappingURL=file-selector.js.map","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (file, acceptedFiles) {\n  if (file && acceptedFiles) {\n    var acceptedFilesArray = Array.isArray(acceptedFiles) ? acceptedFiles : acceptedFiles.split(',');\n\n    if (acceptedFilesArray.length === 0) {\n      return true;\n    }\n\n    var fileName = file.name || '';\n    var mimeType = (file.type || '').toLowerCase();\n    var baseMimeType = mimeType.replace(/\\/.*$/, '');\n    return acceptedFilesArray.some(function (type) {\n      var validType = type.trim().toLowerCase();\n\n      if (validType.charAt(0) === '.') {\n        return fileName.toLowerCase().endsWith(validType);\n      } else if (validType.endsWith('/*')) {\n        // This is something like a image/* mime type\n        return baseMimeType === validType.replace(/\\/.*$/, '');\n      }\n\n      return mimeType === validType;\n    });\n  }\n\n  return true;\n};","function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport _accepts from \"attr-accept\";\nvar accepts = typeof _accepts === \"function\" ? _accepts : _accepts.default; // Error codes\n\nexport var FILE_INVALID_TYPE = \"file-invalid-type\";\nexport var FILE_TOO_LARGE = \"file-too-large\";\nexport var FILE_TOO_SMALL = \"file-too-small\";\nexport var TOO_MANY_FILES = \"too-many-files\";\nexport var ErrorCode = {\n  FileInvalidType: FILE_INVALID_TYPE,\n  FileTooLarge: FILE_TOO_LARGE,\n  FileTooSmall: FILE_TOO_SMALL,\n  TooManyFiles: TOO_MANY_FILES\n};\n/**\n *\n * @param {string} accept\n */\n\nexport var getInvalidTypeRejectionErr = function getInvalidTypeRejectionErr() {\n  var accept = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n  var acceptArr = accept.split(\",\");\n  var msg = acceptArr.length > 1 ? \"one of \".concat(acceptArr.join(\", \")) : acceptArr[0];\n  return {\n    code: FILE_INVALID_TYPE,\n    message: \"File type must be \".concat(msg)\n  };\n};\nexport var getTooLargeRejectionErr = function getTooLargeRejectionErr(maxSize) {\n  return {\n    code: FILE_TOO_LARGE,\n    message: \"File is larger than \".concat(maxSize, \" \").concat(maxSize === 1 ? \"byte\" : \"bytes\")\n  };\n};\nexport var getTooSmallRejectionErr = function getTooSmallRejectionErr(minSize) {\n  return {\n    code: FILE_TOO_SMALL,\n    message: \"File is smaller than \".concat(minSize, \" \").concat(minSize === 1 ? \"byte\" : \"bytes\")\n  };\n};\nexport var TOO_MANY_FILES_REJECTION = {\n  code: TOO_MANY_FILES,\n  message: \"Too many files\"\n};\n/**\n * Check if file is accepted.\n *\n * Firefox versions prior to 53 return a bogus MIME type for every file drag,\n * so dragovers with that MIME type will always be accepted.\n *\n * @param {File} file\n * @param {string} accept\n * @returns\n */\n\nexport function fileAccepted(file, accept) {\n  var isAcceptable = file.type === \"application/x-moz-file\" || accepts(file, accept);\n  return [isAcceptable, isAcceptable ? null : getInvalidTypeRejectionErr(accept)];\n}\nexport function fileMatchSize(file, minSize, maxSize) {\n  if (isDefined(file.size)) {\n    if (isDefined(minSize) && isDefined(maxSize)) {\n      if (file.size > maxSize) return [false, getTooLargeRejectionErr(maxSize)];\n      if (file.size < minSize) return [false, getTooSmallRejectionErr(minSize)];\n    } else if (isDefined(minSize) && file.size < minSize) return [false, getTooSmallRejectionErr(minSize)];else if (isDefined(maxSize) && file.size > maxSize) return [false, getTooLargeRejectionErr(maxSize)];\n  }\n\n  return [true, null];\n}\n\nfunction isDefined(value) {\n  return value !== undefined && value !== null;\n}\n/**\n *\n * @param {object} options\n * @param {File[]} options.files\n * @param {string} [options.accept]\n * @param {number} [options.minSize]\n * @param {number} [options.maxSize]\n * @param {boolean} [options.multiple]\n * @param {number} [options.maxFiles]\n * @param {(f: File) => FileError|FileError[]|null} [options.validator]\n * @returns\n */\n\n\nexport function allFilesAccepted(_ref) {\n  var files = _ref.files,\n      accept = _ref.accept,\n      minSize = _ref.minSize,\n      maxSize = _ref.maxSize,\n      multiple = _ref.multiple,\n      maxFiles = _ref.maxFiles,\n      validator = _ref.validator;\n\n  if (!multiple && files.length > 1 || multiple && maxFiles >= 1 && files.length > maxFiles) {\n    return false;\n  }\n\n  return files.every(function (file) {\n    var _fileAccepted = fileAccepted(file, accept),\n        _fileAccepted2 = _slicedToArray(_fileAccepted, 1),\n        accepted = _fileAccepted2[0];\n\n    var _fileMatchSize = fileMatchSize(file, minSize, maxSize),\n        _fileMatchSize2 = _slicedToArray(_fileMatchSize, 1),\n        sizeMatch = _fileMatchSize2[0];\n\n    var customErrors = validator ? validator(file) : null;\n    return accepted && sizeMatch && !customErrors;\n  });\n} // React's synthetic events has event.isPropagationStopped,\n// but to remain compatibility with other libs (Preact) fall back\n// to check event.cancelBubble\n\nexport function isPropagationStopped(event) {\n  if (typeof event.isPropagationStopped === \"function\") {\n    return event.isPropagationStopped();\n  } else if (typeof event.cancelBubble !== \"undefined\") {\n    return event.cancelBubble;\n  }\n\n  return false;\n}\nexport function isEvtWithFiles(event) {\n  if (!event.dataTransfer) {\n    return !!event.target && !!event.target.files;\n  } // https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/types\n  // https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Recommended_drag_types#file\n\n\n  return Array.prototype.some.call(event.dataTransfer.types, function (type) {\n    return type === \"Files\" || type === \"application/x-moz-file\";\n  });\n}\nexport function isKindFile(item) {\n  return _typeof(item) === \"object\" && item !== null && item.kind === \"file\";\n} // allow the entire document to be a drag target\n\nexport function onDocumentDragOver(event) {\n  event.preventDefault();\n}\n\nfunction isIe(userAgent) {\n  return userAgent.indexOf(\"MSIE\") !== -1 || userAgent.indexOf(\"Trident/\") !== -1;\n}\n\nfunction isEdge(userAgent) {\n  return userAgent.indexOf(\"Edge/\") !== -1;\n}\n\nexport function isIeOrEdge() {\n  var userAgent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : window.navigator.userAgent;\n  return isIe(userAgent) || isEdge(userAgent);\n}\n/**\n * This is intended to be used to compose event handlers\n * They are executed in order until one of them calls `event.isPropagationStopped()`.\n * Note that the check is done on the first invoke too,\n * meaning that if propagation was stopped before invoking the fns,\n * no handlers will be executed.\n *\n * @param {Function} fns the event hanlder functions\n * @return {Function} the event handler to add to an element\n */\n\nexport function composeEventHandlers() {\n  for (var _len = arguments.length, fns = new Array(_len), _key = 0; _key < _len; _key++) {\n    fns[_key] = arguments[_key];\n  }\n\n  return function (event) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    return fns.some(function (fn) {\n      if (!isPropagationStopped(event) && fn) {\n        fn.apply(void 0, [event].concat(args));\n      }\n\n      return isPropagationStopped(event);\n    });\n  };\n}\n/**\n * canUseFileSystemAccessAPI checks if the [File System Access API](https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API)\n * is supported by the browser.\n * @returns {boolean}\n */\n\nexport function canUseFileSystemAccessAPI() {\n  return \"showOpenFilePicker\" in window;\n}\n/**\n * Convert the `{accept}` dropzone prop to the\n * `{types}` option for https://developer.mozilla.org/en-US/docs/Web/API/window/showOpenFilePicker\n *\n * @param {AcceptProp} accept\n * @returns {{accept: string[]}[]}\n */\n\nexport function pickerOptionsFromAccept(accept) {\n  if (isDefined(accept)) {\n    var acceptForPicker = Object.entries(accept).filter(function (_ref2) {\n      var _ref3 = _slicedToArray(_ref2, 2),\n          mimeType = _ref3[0],\n          ext = _ref3[1];\n\n      var ok = true;\n\n      if (!isMIMEType(mimeType)) {\n        console.warn(\"Skipped \\\"\".concat(mimeType, \"\\\" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.\"));\n        ok = false;\n      }\n\n      if (!Array.isArray(ext) || !ext.every(isExt)) {\n        console.warn(\"Skipped \\\"\".concat(mimeType, \"\\\" because an invalid file extension was provided.\"));\n        ok = false;\n      }\n\n      return ok;\n    }).reduce(function (agg, _ref4) {\n      var _ref5 = _slicedToArray(_ref4, 2),\n          mimeType = _ref5[0],\n          ext = _ref5[1];\n\n      return _objectSpread(_objectSpread({}, agg), {}, _defineProperty({}, mimeType, ext));\n    }, {});\n    return [{\n      // description is required due to https://crbug.com/1264708\n      description: \"Files\",\n      accept: acceptForPicker\n    }];\n  }\n\n  return accept;\n}\n/**\n * Convert the `{accept}` dropzone prop to an array of MIME types/extensions.\n * @param {AcceptProp} accept\n * @returns {string}\n */\n\nexport function acceptPropAsAcceptAttr(accept) {\n  if (isDefined(accept)) {\n    return Object.entries(accept).reduce(function (a, _ref6) {\n      var _ref7 = _slicedToArray(_ref6, 2),\n          mimeType = _ref7[0],\n          ext = _ref7[1];\n\n      return [].concat(_toConsumableArray(a), [mimeType], _toConsumableArray(ext));\n    }, []) // Silently discard invalid entries as pickerOptionsFromAccept warns about these\n    .filter(function (v) {\n      return isMIMEType(v) || isExt(v);\n    }).join(\",\");\n  }\n\n  return undefined;\n}\n/**\n * Check if v is an exception caused by aborting a request (e.g window.showOpenFilePicker()).\n *\n * See https://developer.mozilla.org/en-US/docs/Web/API/DOMException.\n * @param {any} v\n * @returns {boolean} True if v is an abort exception.\n */\n\nexport function isAbort(v) {\n  return v instanceof DOMException && (v.name === \"AbortError\" || v.code === v.ABORT_ERR);\n}\n/**\n * Check if v is a security error.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/API/DOMException.\n * @param {any} v\n * @returns {boolean} True if v is a security error.\n */\n\nexport function isSecurityError(v) {\n  return v instanceof DOMException && (v.name === \"SecurityError\" || v.code === v.SECURITY_ERR);\n}\n/**\n * Check if v is a MIME type string.\n *\n * See accepted format: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file#unique_file_type_specifiers.\n *\n * @param {string} v\n */\n\nexport function isMIMEType(v) {\n  return v === \"audio/*\" || v === \"video/*\" || v === \"image/*\" || v === \"text/*\" || v === \"application/*\" || /\\w+\\/[-+.\\w]+/g.test(v);\n}\n/**\n * Check if v is a file extension.\n * @param {string} v\n */\n\nexport function isExt(v) {\n  return /^.*\\.[\\w]+$/.test(v);\n}\n/**\n * @typedef {Object.<string, string[]>} AcceptProp\n */\n\n/**\n * @typedef {object} FileError\n * @property {string} message\n * @property {ErrorCode|string} code\n */\n\n/**\n * @typedef {\"file-invalid-type\"|\"file-too-large\"|\"file-too-small\"|\"too-many-files\"} ErrorCode\n */","var _excluded = [\"children\"],\n    _excluded2 = [\"open\"],\n    _excluded3 = [\"refKey\", \"role\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"onClick\", \"onDragEnter\", \"onDragOver\", \"onDragLeave\", \"onDrop\"],\n    _excluded4 = [\"refKey\", \"onChange\", \"onClick\"];\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* eslint prefer-template: 0 */\nimport React, { forwardRef, Fragment, useCallback, useEffect, useImperativeHandle, useMemo, useReducer, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { fromEvent } from \"file-selector\";\nimport { acceptPropAsAcceptAttr, allFilesAccepted, composeEventHandlers, fileAccepted, fileMatchSize, canUseFileSystemAccessAPI, isAbort, isEvtWithFiles, isIeOrEdge, isPropagationStopped, isSecurityError, onDocumentDragOver, pickerOptionsFromAccept, TOO_MANY_FILES_REJECTION } from \"./utils/index.js\";\n/**\n * Convenience wrapper component for the `useDropzone` hook\n *\n * ```jsx\n * <Dropzone>\n *   {({getRootProps, getInputProps}) => (\n *     <div {...getRootProps()}>\n *       <input {...getInputProps()} />\n *       <p>Drag 'n' drop some files here, or click to select files</p>\n *     </div>\n *   )}\n * </Dropzone>\n * ```\n */\n\nvar Dropzone = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var children = _ref.children,\n      params = _objectWithoutProperties(_ref, _excluded);\n\n  var _useDropzone = useDropzone(params),\n      open = _useDropzone.open,\n      props = _objectWithoutProperties(_useDropzone, _excluded2);\n\n  useImperativeHandle(ref, function () {\n    return {\n      open: open\n    };\n  }, [open]); // TODO: Figure out why react-styleguidist cannot create docs if we don't return a jsx element\n\n  return /*#__PURE__*/React.createElement(Fragment, null, children(_objectSpread(_objectSpread({}, props), {}, {\n    open: open\n  })));\n});\nDropzone.displayName = \"Dropzone\"; // Add default props for react-docgen\n\nvar defaultProps = {\n  disabled: false,\n  getFilesFromEvent: fromEvent,\n  maxSize: Infinity,\n  minSize: 0,\n  multiple: true,\n  maxFiles: 0,\n  preventDropOnDocument: true,\n  noClick: false,\n  noKeyboard: false,\n  noDrag: false,\n  noDragEventsBubbling: false,\n  validator: null,\n  useFsAccessApi: false,\n  autoFocus: false\n};\nDropzone.defaultProps = defaultProps;\nDropzone.propTypes = {\n  /**\n   * Render function that exposes the dropzone state and prop getter fns\n   *\n   * @param {object} params\n   * @param {Function} params.getRootProps Returns the props you should apply to the root drop container you render\n   * @param {Function} params.getInputProps Returns the props you should apply to hidden file input you render\n   * @param {Function} params.open Open the native file selection dialog\n   * @param {boolean} params.isFocused Dropzone area is in focus\n   * @param {boolean} params.isFileDialogActive File dialog is opened\n   * @param {boolean} params.isDragActive Active drag is in progress\n   * @param {boolean} params.isDragAccept Dragged files are accepted\n   * @param {boolean} params.isDragReject Some dragged files are rejected\n   * @param {File[]} params.acceptedFiles Accepted files\n   * @param {FileRejection[]} params.fileRejections Rejected files and why they were rejected\n   */\n  children: PropTypes.func,\n\n  /**\n   * Set accepted file types.\n   * Checkout https://developer.mozilla.org/en-US/docs/Web/API/window/showOpenFilePicker types option for more information.\n   * Keep in mind that mime type determination is not reliable across platforms. CSV files,\n   * for example, are reported as text/plain under macOS but as application/vnd.ms-excel under\n   * Windows. In some cases there might not be a mime type set at all (https://github.com/react-dropzone/react-dropzone/issues/276).\n   */\n  accept: PropTypes.objectOf(PropTypes.arrayOf(PropTypes.string)),\n\n  /**\n   * Allow drag 'n' drop (or selection from the file dialog) of multiple files\n   */\n  multiple: PropTypes.bool,\n\n  /**\n   * If false, allow dropped items to take over the current browser window\n   */\n  preventDropOnDocument: PropTypes.bool,\n\n  /**\n   * If true, disables click to open the native file selection dialog\n   */\n  noClick: PropTypes.bool,\n\n  /**\n   * If true, disables SPACE/ENTER to open the native file selection dialog.\n   * Note that it also stops tracking the focus state.\n   */\n  noKeyboard: PropTypes.bool,\n\n  /**\n   * If true, disables drag 'n' drop\n   */\n  noDrag: PropTypes.bool,\n\n  /**\n   * If true, stops drag event propagation to parents\n   */\n  noDragEventsBubbling: PropTypes.bool,\n\n  /**\n   * Minimum file size (in bytes)\n   */\n  minSize: PropTypes.number,\n\n  /**\n   * Maximum file size (in bytes)\n   */\n  maxSize: PropTypes.number,\n\n  /**\n   * Maximum accepted number of files\n   * The default value is 0 which means there is no limitation to how many files are accepted.\n   */\n  maxFiles: PropTypes.number,\n\n  /**\n   * Enable/disable the dropzone\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * Use this to provide a custom file aggregator\n   *\n   * @param {(DragEvent|Event|Array<FileSystemFileHandle>)} event A drag event or input change event (if files were selected via the file dialog)\n   */\n  getFilesFromEvent: PropTypes.func,\n\n  /**\n   * Cb for when closing the file dialog with no selection\n   */\n  onFileDialogCancel: PropTypes.func,\n\n  /**\n   * Cb for when opening the file dialog\n   */\n  onFileDialogOpen: PropTypes.func,\n\n  /**\n   * Set to true to use the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API\n   * to open the file picker instead of using an `<input type=\"file\">` click event.\n   */\n  useFsAccessApi: PropTypes.bool,\n\n  /**\n   * Set to true to focus the root element on render\n   */\n  autoFocus: PropTypes.bool,\n\n  /**\n   * Cb for when the `dragenter` event occurs.\n   *\n   * @param {DragEvent} event\n   */\n  onDragEnter: PropTypes.func,\n\n  /**\n   * Cb for when the `dragleave` event occurs\n   *\n   * @param {DragEvent} event\n   */\n  onDragLeave: PropTypes.func,\n\n  /**\n   * Cb for when the `dragover` event occurs\n   *\n   * @param {DragEvent} event\n   */\n  onDragOver: PropTypes.func,\n\n  /**\n   * Cb for when the `drop` event occurs.\n   * Note that this callback is invoked after the `getFilesFromEvent` callback is done.\n   *\n   * Files are accepted or rejected based on the `accept`, `multiple`, `minSize` and `maxSize` props.\n   * `accept` must be a valid [MIME type](http://www.iana.org/assignments/media-types/media-types.xhtml) according to [input element specification](https://www.w3.org/wiki/HTML/Elements/input/file) or a valid file extension.\n   * If `multiple` is set to false and additional files are dropped,\n   * all files besides the first will be rejected.\n   * Any file which does not have a size in the [`minSize`, `maxSize`] range, will be rejected as well.\n   *\n   * Note that the `onDrop` callback will always be invoked regardless if the dropped files were accepted or rejected.\n   * If you'd like to react to a specific scenario, use the `onDropAccepted`/`onDropRejected` props.\n   *\n   * `onDrop` will provide you with an array of [File](https://developer.mozilla.org/en-US/docs/Web/API/File) objects which you can then process and send to a server.\n   * For example, with [SuperAgent](https://github.com/visionmedia/superagent) as a http/ajax library:\n   *\n   * ```js\n   * function onDrop(acceptedFiles) {\n   *   const req = request.post('/upload')\n   *   acceptedFiles.forEach(file => {\n   *     req.attach(file.name, file)\n   *   })\n   *   req.end(callback)\n   * }\n   * ```\n   *\n   * @param {File[]} acceptedFiles\n   * @param {FileRejection[]} fileRejections\n   * @param {(DragEvent|Event)} event A drag event or input change event (if files were selected via the file dialog)\n   */\n  onDrop: PropTypes.func,\n\n  /**\n   * Cb for when the `drop` event occurs.\n   * Note that if no files are accepted, this callback is not invoked.\n   *\n   * @param {File[]} files\n   * @param {(DragEvent|Event)} event\n   */\n  onDropAccepted: PropTypes.func,\n\n  /**\n   * Cb for when the `drop` event occurs.\n   * Note that if no files are rejected, this callback is not invoked.\n   *\n   * @param {FileRejection[]} fileRejections\n   * @param {(DragEvent|Event)} event\n   */\n  onDropRejected: PropTypes.func,\n\n  /**\n   * Cb for when there's some error from any of the promises.\n   *\n   * @param {Error} error\n   */\n  onError: PropTypes.func,\n\n  /**\n   * Custom validation function. It must return null if there's no errors.\n   * @param {File} file\n   * @returns {FileError|FileError[]|null}\n   */\n  validator: PropTypes.func\n};\nexport default Dropzone;\n/**\n * A function that is invoked for the `dragenter`,\n * `dragover` and `dragleave` events.\n * It is not invoked if the items are not files (such as link, text, etc.).\n *\n * @callback dragCb\n * @param {DragEvent} event\n */\n\n/**\n * A function that is invoked for the `drop` or input change event.\n * It is not invoked if the items are not files (such as link, text, etc.).\n *\n * @callback dropCb\n * @param {File[]} acceptedFiles List of accepted files\n * @param {FileRejection[]} fileRejections List of rejected files and why they were rejected\n * @param {(DragEvent|Event)} event A drag event or input change event (if files were selected via the file dialog)\n */\n\n/**\n * A function that is invoked for the `drop` or input change event.\n * It is not invoked if the items are files (such as link, text, etc.).\n *\n * @callback dropAcceptedCb\n * @param {File[]} files List of accepted files that meet the given criteria\n * (`accept`, `multiple`, `minSize`, `maxSize`)\n * @param {(DragEvent|Event)} event A drag event or input change event (if files were selected via the file dialog)\n */\n\n/**\n * A function that is invoked for the `drop` or input change event.\n *\n * @callback dropRejectedCb\n * @param {File[]} files List of rejected files that do not meet the given criteria\n * (`accept`, `multiple`, `minSize`, `maxSize`)\n * @param {(DragEvent|Event)} event A drag event or input change event (if files were selected via the file dialog)\n */\n\n/**\n * A function that is used aggregate files,\n * in a asynchronous fashion, from drag or input change events.\n *\n * @callback getFilesFromEvent\n * @param {(DragEvent|Event|Array<FileSystemFileHandle>)} event A drag event or input change event (if files were selected via the file dialog)\n * @returns {(File[]|Promise<File[]>)}\n */\n\n/**\n * An object with the current dropzone state.\n *\n * @typedef {object} DropzoneState\n * @property {boolean} isFocused Dropzone area is in focus\n * @property {boolean} isFileDialogActive File dialog is opened\n * @property {boolean} isDragActive Active drag is in progress\n * @property {boolean} isDragAccept Dragged files are accepted\n * @property {boolean} isDragReject Some dragged files are rejected\n * @property {File[]} acceptedFiles Accepted files\n * @property {FileRejection[]} fileRejections Rejected files and why they were rejected\n */\n\n/**\n * An object with the dropzone methods.\n *\n * @typedef {object} DropzoneMethods\n * @property {Function} getRootProps Returns the props you should apply to the root drop container you render\n * @property {Function} getInputProps Returns the props you should apply to hidden file input you render\n * @property {Function} open Open the native file selection dialog\n */\n\nvar initialState = {\n  isFocused: false,\n  isFileDialogActive: false,\n  isDragActive: false,\n  isDragAccept: false,\n  isDragReject: false,\n  acceptedFiles: [],\n  fileRejections: []\n};\n/**\n * A React hook that creates a drag 'n' drop area.\n *\n * ```jsx\n * function MyDropzone(props) {\n *   const {getRootProps, getInputProps} = useDropzone({\n *     onDrop: acceptedFiles => {\n *       // do something with the File objects, e.g. upload to some server\n *     }\n *   });\n *   return (\n *     <div {...getRootProps()}>\n *       <input {...getInputProps()} />\n *       <p>Drag and drop some files here, or click to select files</p>\n *     </div>\n *   )\n * }\n * ```\n *\n * @function useDropzone\n *\n * @param {object} props\n * @param {import(\"./utils\").AcceptProp} [props.accept] Set accepted file types.\n * Checkout https://developer.mozilla.org/en-US/docs/Web/API/window/showOpenFilePicker types option for more information.\n * Keep in mind that mime type determination is not reliable across platforms. CSV files,\n * for example, are reported as text/plain under macOS but as application/vnd.ms-excel under\n * Windows. In some cases there might not be a mime type set at all (https://github.com/react-dropzone/react-dropzone/issues/276).\n * @param {boolean} [props.multiple=true] Allow drag 'n' drop (or selection from the file dialog) of multiple files\n * @param {boolean} [props.preventDropOnDocument=true] If false, allow dropped items to take over the current browser window\n * @param {boolean} [props.noClick=false] If true, disables click to open the native file selection dialog\n * @param {boolean} [props.noKeyboard=false] If true, disables SPACE/ENTER to open the native file selection dialog.\n * Note that it also stops tracking the focus state.\n * @param {boolean} [props.noDrag=false] If true, disables drag 'n' drop\n * @param {boolean} [props.noDragEventsBubbling=false] If true, stops drag event propagation to parents\n * @param {number} [props.minSize=0] Minimum file size (in bytes)\n * @param {number} [props.maxSize=Infinity] Maximum file size (in bytes)\n * @param {boolean} [props.disabled=false] Enable/disable the dropzone\n * @param {getFilesFromEvent} [props.getFilesFromEvent] Use this to provide a custom file aggregator\n * @param {Function} [props.onFileDialogCancel] Cb for when closing the file dialog with no selection\n * @param {boolean} [props.useFsAccessApi] Set to true to use the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API\n * to open the file picker instead of using an `<input type=\"file\">` click event.\n * @param {boolean} autoFocus Set to true to auto focus the root element.\n * @param {Function} [props.onFileDialogOpen] Cb for when opening the file dialog\n * @param {dragCb} [props.onDragEnter] Cb for when the `dragenter` event occurs.\n * @param {dragCb} [props.onDragLeave] Cb for when the `dragleave` event occurs\n * @param {dragCb} [props.onDragOver] Cb for when the `dragover` event occurs\n * @param {dropCb} [props.onDrop] Cb for when the `drop` event occurs.\n * Note that this callback is invoked after the `getFilesFromEvent` callback is done.\n *\n * Files are accepted or rejected based on the `accept`, `multiple`, `minSize` and `maxSize` props.\n * `accept` must be an object with keys as a valid [MIME type](http://www.iana.org/assignments/media-types/media-types.xhtml) according to [input element specification](https://www.w3.org/wiki/HTML/Elements/input/file) and the value an array of file extensions (optional).\n * If `multiple` is set to false and additional files are dropped,\n * all files besides the first will be rejected.\n * Any file which does not have a size in the [`minSize`, `maxSize`] range, will be rejected as well.\n *\n * Note that the `onDrop` callback will always be invoked regardless if the dropped files were accepted or rejected.\n * If you'd like to react to a specific scenario, use the `onDropAccepted`/`onDropRejected` props.\n *\n * `onDrop` will provide you with an array of [File](https://developer.mozilla.org/en-US/docs/Web/API/File) objects which you can then process and send to a server.\n * For example, with [SuperAgent](https://github.com/visionmedia/superagent) as a http/ajax library:\n *\n * ```js\n * function onDrop(acceptedFiles) {\n *   const req = request.post('/upload')\n *   acceptedFiles.forEach(file => {\n *     req.attach(file.name, file)\n *   })\n *   req.end(callback)\n * }\n * ```\n * @param {dropAcceptedCb} [props.onDropAccepted]\n * @param {dropRejectedCb} [props.onDropRejected]\n * @param {(error: Error) => void} [props.onError]\n *\n * @returns {DropzoneState & DropzoneMethods}\n */\n\nexport function useDropzone() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var _defaultProps$props = _objectSpread(_objectSpread({}, defaultProps), props),\n      accept = _defaultProps$props.accept,\n      disabled = _defaultProps$props.disabled,\n      getFilesFromEvent = _defaultProps$props.getFilesFromEvent,\n      maxSize = _defaultProps$props.maxSize,\n      minSize = _defaultProps$props.minSize,\n      multiple = _defaultProps$props.multiple,\n      maxFiles = _defaultProps$props.maxFiles,\n      onDragEnter = _defaultProps$props.onDragEnter,\n      onDragLeave = _defaultProps$props.onDragLeave,\n      onDragOver = _defaultProps$props.onDragOver,\n      onDrop = _defaultProps$props.onDrop,\n      onDropAccepted = _defaultProps$props.onDropAccepted,\n      onDropRejected = _defaultProps$props.onDropRejected,\n      onFileDialogCancel = _defaultProps$props.onFileDialogCancel,\n      onFileDialogOpen = _defaultProps$props.onFileDialogOpen,\n      useFsAccessApi = _defaultProps$props.useFsAccessApi,\n      autoFocus = _defaultProps$props.autoFocus,\n      preventDropOnDocument = _defaultProps$props.preventDropOnDocument,\n      noClick = _defaultProps$props.noClick,\n      noKeyboard = _defaultProps$props.noKeyboard,\n      noDrag = _defaultProps$props.noDrag,\n      noDragEventsBubbling = _defaultProps$props.noDragEventsBubbling,\n      onError = _defaultProps$props.onError,\n      validator = _defaultProps$props.validator;\n\n  var acceptAttr = useMemo(function () {\n    return acceptPropAsAcceptAttr(accept);\n  }, [accept]);\n  var pickerTypes = useMemo(function () {\n    return pickerOptionsFromAccept(accept);\n  }, [accept]);\n  var onFileDialogOpenCb = useMemo(function () {\n    return typeof onFileDialogOpen === \"function\" ? onFileDialogOpen : noop;\n  }, [onFileDialogOpen]);\n  var onFileDialogCancelCb = useMemo(function () {\n    return typeof onFileDialogCancel === \"function\" ? onFileDialogCancel : noop;\n  }, [onFileDialogCancel]);\n  /**\n   * @constant\n   * @type {React.MutableRefObject<HTMLElement>}\n   */\n\n  var rootRef = useRef(null);\n  var inputRef = useRef(null);\n\n  var _useReducer = useReducer(reducer, initialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var isFocused = state.isFocused,\n      isFileDialogActive = state.isFileDialogActive;\n  var fsAccessApiWorksRef = useRef(typeof window !== \"undefined\" && window.isSecureContext && useFsAccessApi && canUseFileSystemAccessAPI()); // Update file dialog active state when the window is focused on\n\n  var onWindowFocus = function onWindowFocus() {\n    // Execute the timeout only if the file dialog is opened in the browser\n    if (!fsAccessApiWorksRef.current && isFileDialogActive) {\n      setTimeout(function () {\n        if (inputRef.current) {\n          var files = inputRef.current.files;\n\n          if (!files.length) {\n            dispatch({\n              type: \"closeDialog\"\n            });\n            onFileDialogCancelCb();\n          }\n        }\n      }, 300);\n    }\n  };\n\n  useEffect(function () {\n    window.addEventListener(\"focus\", onWindowFocus, false);\n    return function () {\n      window.removeEventListener(\"focus\", onWindowFocus, false);\n    };\n  }, [inputRef, isFileDialogActive, onFileDialogCancelCb, fsAccessApiWorksRef]);\n  var dragTargetsRef = useRef([]);\n\n  var onDocumentDrop = function onDocumentDrop(event) {\n    if (rootRef.current && rootRef.current.contains(event.target)) {\n      // If we intercepted an event for our instance, let it propagate down to the instance's onDrop handler\n      return;\n    }\n\n    event.preventDefault();\n    dragTargetsRef.current = [];\n  };\n\n  useEffect(function () {\n    if (preventDropOnDocument) {\n      document.addEventListener(\"dragover\", onDocumentDragOver, false);\n      document.addEventListener(\"drop\", onDocumentDrop, false);\n    }\n\n    return function () {\n      if (preventDropOnDocument) {\n        document.removeEventListener(\"dragover\", onDocumentDragOver);\n        document.removeEventListener(\"drop\", onDocumentDrop);\n      }\n    };\n  }, [rootRef, preventDropOnDocument]); // Auto focus the root when autoFocus is true\n\n  useEffect(function () {\n    if (!disabled && autoFocus && rootRef.current) {\n      rootRef.current.focus();\n    }\n\n    return function () {};\n  }, [rootRef, autoFocus, disabled]);\n  var onErrCb = useCallback(function (e) {\n    if (onError) {\n      onError(e);\n    } else {\n      // Let the user know something's gone wrong if they haven't provided the onError cb.\n      console.error(e);\n    }\n  }, [onError]);\n  var onDragEnterCb = useCallback(function (event) {\n    event.preventDefault(); // Persist here because we need the event later after getFilesFromEvent() is done\n\n    event.persist();\n    stopPropagation(event);\n    dragTargetsRef.current = [].concat(_toConsumableArray(dragTargetsRef.current), [event.target]);\n\n    if (isEvtWithFiles(event)) {\n      Promise.resolve(getFilesFromEvent(event)).then(function (files) {\n        if (isPropagationStopped(event) && !noDragEventsBubbling) {\n          return;\n        }\n\n        var fileCount = files.length;\n        var isDragAccept = fileCount > 0 && allFilesAccepted({\n          files: files,\n          accept: acceptAttr,\n          minSize: minSize,\n          maxSize: maxSize,\n          multiple: multiple,\n          maxFiles: maxFiles,\n          validator: validator\n        });\n        var isDragReject = fileCount > 0 && !isDragAccept;\n        dispatch({\n          isDragAccept: isDragAccept,\n          isDragReject: isDragReject,\n          isDragActive: true,\n          type: \"setDraggedFiles\"\n        });\n\n        if (onDragEnter) {\n          onDragEnter(event);\n        }\n      }).catch(function (e) {\n        return onErrCb(e);\n      });\n    }\n  }, [getFilesFromEvent, onDragEnter, onErrCb, noDragEventsBubbling, acceptAttr, minSize, maxSize, multiple, maxFiles, validator]);\n  var onDragOverCb = useCallback(function (event) {\n    event.preventDefault();\n    event.persist();\n    stopPropagation(event);\n    var hasFiles = isEvtWithFiles(event);\n\n    if (hasFiles && event.dataTransfer) {\n      try {\n        event.dataTransfer.dropEffect = \"copy\";\n      } catch (_unused) {}\n      /* eslint-disable-line no-empty */\n\n    }\n\n    if (hasFiles && onDragOver) {\n      onDragOver(event);\n    }\n\n    return false;\n  }, [onDragOver, noDragEventsBubbling]);\n  var onDragLeaveCb = useCallback(function (event) {\n    event.preventDefault();\n    event.persist();\n    stopPropagation(event); // Only deactivate once the dropzone and all children have been left\n\n    var targets = dragTargetsRef.current.filter(function (target) {\n      return rootRef.current && rootRef.current.contains(target);\n    }); // Make sure to remove a target present multiple times only once\n    // (Firefox may fire dragenter/dragleave multiple times on the same element)\n\n    var targetIdx = targets.indexOf(event.target);\n\n    if (targetIdx !== -1) {\n      targets.splice(targetIdx, 1);\n    }\n\n    dragTargetsRef.current = targets;\n\n    if (targets.length > 0) {\n      return;\n    }\n\n    dispatch({\n      type: \"setDraggedFiles\",\n      isDragActive: false,\n      isDragAccept: false,\n      isDragReject: false\n    });\n\n    if (isEvtWithFiles(event) && onDragLeave) {\n      onDragLeave(event);\n    }\n  }, [rootRef, onDragLeave, noDragEventsBubbling]);\n  var setFiles = useCallback(function (files, event) {\n    var acceptedFiles = [];\n    var fileRejections = [];\n    files.forEach(function (file) {\n      var _fileAccepted = fileAccepted(file, acceptAttr),\n          _fileAccepted2 = _slicedToArray(_fileAccepted, 2),\n          accepted = _fileAccepted2[0],\n          acceptError = _fileAccepted2[1];\n\n      var _fileMatchSize = fileMatchSize(file, minSize, maxSize),\n          _fileMatchSize2 = _slicedToArray(_fileMatchSize, 2),\n          sizeMatch = _fileMatchSize2[0],\n          sizeError = _fileMatchSize2[1];\n\n      var customErrors = validator ? validator(file) : null;\n\n      if (accepted && sizeMatch && !customErrors) {\n        acceptedFiles.push(file);\n      } else {\n        var errors = [acceptError, sizeError];\n\n        if (customErrors) {\n          errors = errors.concat(customErrors);\n        }\n\n        fileRejections.push({\n          file: file,\n          errors: errors.filter(function (e) {\n            return e;\n          })\n        });\n      }\n    });\n\n    if (!multiple && acceptedFiles.length > 1 || multiple && maxFiles >= 1 && acceptedFiles.length > maxFiles) {\n      // Reject everything and empty accepted files\n      acceptedFiles.forEach(function (file) {\n        fileRejections.push({\n          file: file,\n          errors: [TOO_MANY_FILES_REJECTION]\n        });\n      });\n      acceptedFiles.splice(0);\n    }\n\n    dispatch({\n      acceptedFiles: acceptedFiles,\n      fileRejections: fileRejections,\n      isDragReject: fileRejections.length > 0,\n      type: \"setFiles\"\n    });\n\n    if (onDrop) {\n      onDrop(acceptedFiles, fileRejections, event);\n    }\n\n    if (fileRejections.length > 0 && onDropRejected) {\n      onDropRejected(fileRejections, event);\n    }\n\n    if (acceptedFiles.length > 0 && onDropAccepted) {\n      onDropAccepted(acceptedFiles, event);\n    }\n  }, [dispatch, multiple, acceptAttr, minSize, maxSize, maxFiles, onDrop, onDropAccepted, onDropRejected, validator]);\n  var onDropCb = useCallback(function (event) {\n    event.preventDefault(); // Persist here because we need the event later after getFilesFromEvent() is done\n\n    event.persist();\n    stopPropagation(event);\n    dragTargetsRef.current = [];\n\n    if (isEvtWithFiles(event)) {\n      Promise.resolve(getFilesFromEvent(event)).then(function (files) {\n        if (isPropagationStopped(event) && !noDragEventsBubbling) {\n          return;\n        }\n\n        setFiles(files, event);\n      }).catch(function (e) {\n        return onErrCb(e);\n      });\n    }\n\n    dispatch({\n      type: \"reset\"\n    });\n  }, [getFilesFromEvent, setFiles, onErrCb, noDragEventsBubbling]); // Fn for opening the file dialog programmatically\n\n  var openFileDialog = useCallback(function () {\n    // No point to use FS access APIs if context is not secure\n    // https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts#feature_detection\n    if (fsAccessApiWorksRef.current) {\n      dispatch({\n        type: \"openDialog\"\n      });\n      onFileDialogOpenCb(); // https://developer.mozilla.org/en-US/docs/Web/API/window/showOpenFilePicker\n\n      var opts = {\n        multiple: multiple,\n        types: pickerTypes\n      };\n      window.showOpenFilePicker(opts).then(function (handles) {\n        return getFilesFromEvent(handles);\n      }).then(function (files) {\n        setFiles(files, null);\n        dispatch({\n          type: \"closeDialog\"\n        });\n      }).catch(function (e) {\n        // AbortError means the user canceled\n        if (isAbort(e)) {\n          onFileDialogCancelCb(e);\n          dispatch({\n            type: \"closeDialog\"\n          });\n        } else if (isSecurityError(e)) {\n          fsAccessApiWorksRef.current = false; // CORS, so cannot use this API\n          // Try using the input\n\n          if (inputRef.current) {\n            inputRef.current.value = null;\n            inputRef.current.click();\n          } else {\n            onErrCb(new Error(\"Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided.\"));\n          }\n        } else {\n          onErrCb(e);\n        }\n      });\n      return;\n    }\n\n    if (inputRef.current) {\n      dispatch({\n        type: \"openDialog\"\n      });\n      onFileDialogOpenCb();\n      inputRef.current.value = null;\n      inputRef.current.click();\n    }\n  }, [dispatch, onFileDialogOpenCb, onFileDialogCancelCb, useFsAccessApi, setFiles, onErrCb, pickerTypes, multiple]); // Cb to open the file dialog when SPACE/ENTER occurs on the dropzone\n\n  var onKeyDownCb = useCallback(function (event) {\n    // Ignore keyboard events bubbling up the DOM tree\n    if (!rootRef.current || !rootRef.current.isEqualNode(event.target)) {\n      return;\n    }\n\n    if (event.key === \" \" || event.key === \"Enter\" || event.keyCode === 32 || event.keyCode === 13) {\n      event.preventDefault();\n      openFileDialog();\n    }\n  }, [rootRef, openFileDialog]); // Update focus state for the dropzone\n\n  var onFocusCb = useCallback(function () {\n    dispatch({\n      type: \"focus\"\n    });\n  }, []);\n  var onBlurCb = useCallback(function () {\n    dispatch({\n      type: \"blur\"\n    });\n  }, []); // Cb to open the file dialog when click occurs on the dropzone\n\n  var onClickCb = useCallback(function () {\n    if (noClick) {\n      return;\n    } // In IE11/Edge the file-browser dialog is blocking, therefore, use setTimeout()\n    // to ensure React can handle state changes\n    // See: https://github.com/react-dropzone/react-dropzone/issues/450\n\n\n    if (isIeOrEdge()) {\n      setTimeout(openFileDialog, 0);\n    } else {\n      openFileDialog();\n    }\n  }, [noClick, openFileDialog]);\n\n  var composeHandler = function composeHandler(fn) {\n    return disabled ? null : fn;\n  };\n\n  var composeKeyboardHandler = function composeKeyboardHandler(fn) {\n    return noKeyboard ? null : composeHandler(fn);\n  };\n\n  var composeDragHandler = function composeDragHandler(fn) {\n    return noDrag ? null : composeHandler(fn);\n  };\n\n  var stopPropagation = function stopPropagation(event) {\n    if (noDragEventsBubbling) {\n      event.stopPropagation();\n    }\n  };\n\n  var getRootProps = useMemo(function () {\n    return function () {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref2$refKey = _ref2.refKey,\n          refKey = _ref2$refKey === void 0 ? \"ref\" : _ref2$refKey,\n          role = _ref2.role,\n          onKeyDown = _ref2.onKeyDown,\n          onFocus = _ref2.onFocus,\n          onBlur = _ref2.onBlur,\n          onClick = _ref2.onClick,\n          onDragEnter = _ref2.onDragEnter,\n          onDragOver = _ref2.onDragOver,\n          onDragLeave = _ref2.onDragLeave,\n          onDrop = _ref2.onDrop,\n          rest = _objectWithoutProperties(_ref2, _excluded3);\n\n      return _objectSpread(_objectSpread(_defineProperty({\n        onKeyDown: composeKeyboardHandler(composeEventHandlers(onKeyDown, onKeyDownCb)),\n        onFocus: composeKeyboardHandler(composeEventHandlers(onFocus, onFocusCb)),\n        onBlur: composeKeyboardHandler(composeEventHandlers(onBlur, onBlurCb)),\n        onClick: composeHandler(composeEventHandlers(onClick, onClickCb)),\n        onDragEnter: composeDragHandler(composeEventHandlers(onDragEnter, onDragEnterCb)),\n        onDragOver: composeDragHandler(composeEventHandlers(onDragOver, onDragOverCb)),\n        onDragLeave: composeDragHandler(composeEventHandlers(onDragLeave, onDragLeaveCb)),\n        onDrop: composeDragHandler(composeEventHandlers(onDrop, onDropCb)),\n        role: typeof role === \"string\" && role !== \"\" ? role : \"presentation\"\n      }, refKey, rootRef), !disabled && !noKeyboard ? {\n        tabIndex: 0\n      } : {}), rest);\n    };\n  }, [rootRef, onKeyDownCb, onFocusCb, onBlurCb, onClickCb, onDragEnterCb, onDragOverCb, onDragLeaveCb, onDropCb, noKeyboard, noDrag, disabled]);\n  var onInputElementClick = useCallback(function (event) {\n    event.stopPropagation();\n  }, []);\n  var getInputProps = useMemo(function () {\n    return function () {\n      var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref3$refKey = _ref3.refKey,\n          refKey = _ref3$refKey === void 0 ? \"ref\" : _ref3$refKey,\n          onChange = _ref3.onChange,\n          onClick = _ref3.onClick,\n          rest = _objectWithoutProperties(_ref3, _excluded4);\n\n      var inputProps = _defineProperty({\n        accept: acceptAttr,\n        multiple: multiple,\n        type: \"file\",\n        style: {\n          border: 0,\n          clip: \"rect(0, 0, 0, 0)\",\n          clipPath: \"inset(50%)\",\n          height: \"1px\",\n          margin: \"0 -1px -1px 0\",\n          overflow: \"hidden\",\n          padding: 0,\n          position: \"absolute\",\n          width: \"1px\",\n          whiteSpace: \"nowrap\"\n        },\n        onChange: composeHandler(composeEventHandlers(onChange, onDropCb)),\n        onClick: composeHandler(composeEventHandlers(onClick, onInputElementClick)),\n        tabIndex: -1\n      }, refKey, inputRef);\n\n      return _objectSpread(_objectSpread({}, inputProps), rest);\n    };\n  }, [inputRef, accept, multiple, onDropCb, disabled]);\n  return _objectSpread(_objectSpread({}, state), {}, {\n    isFocused: isFocused && !disabled,\n    getRootProps: getRootProps,\n    getInputProps: getInputProps,\n    rootRef: rootRef,\n    inputRef: inputRef,\n    open: composeHandler(openFileDialog)\n  });\n}\n/**\n * @param {DropzoneState} state\n * @param {{type: string} & DropzoneState} action\n * @returns {DropzoneState}\n */\n\nfunction reducer(state, action) {\n  /* istanbul ignore next */\n  switch (action.type) {\n    case \"focus\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isFocused: true\n      });\n\n    case \"blur\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isFocused: false\n      });\n\n    case \"openDialog\":\n      return _objectSpread(_objectSpread({}, initialState), {}, {\n        isFileDialogActive: true\n      });\n\n    case \"closeDialog\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isFileDialogActive: false\n      });\n\n    case \"setDraggedFiles\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isDragActive: action.isDragActive,\n        isDragAccept: action.isDragAccept,\n        isDragReject: action.isDragReject\n      });\n\n    case \"setFiles\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        acceptedFiles: action.acceptedFiles,\n        fileRejections: action.fileRejections,\n        isDragReject: action.isDragReject\n      });\n\n    case \"reset\":\n      return _objectSpread({}, initialState);\n\n    default:\n      return state;\n  }\n}\n\nfunction noop() {}\n\nexport { ErrorCode } from \"./utils/index.js\";","import React, { useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\n\ntype Props = {\n  type: 'text'|'image'|'video';\n  onReady: (payload: { title: string; file?: File; textHtml?: string; }) => void;\n  registerSubmit?: (fn: ()=>void) => void;\n  showNextButton?: boolean;\n};\n\nexport default function CreateStep({ type, onReady, registerSubmit, showNextButton = true }: Props){\n  const [title, setTitle] = useState('');\n  const [textHtml, setTextHtml] = useState('');\n  const [file, setFile] = useState<File|undefined>();\n  const [msg, setMsg] = useState('');\n\n  const onDrop = (accepted: File[]) => {\n    if (accepted[0]) {\n      if (accepted[0].size > 50 * 1024 * 1024) { setMsg('File exceeds 50MB limit'); return; }\n      setFile(accepted[0]);\n      setMsg('');\n    }\n  };\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({ onDrop });\n\n  const next = () => {\n    onReady({ title, file, textHtml });\n  };\n\n  React.useEffect(()=>{\n    if (registerSubmit) {\n      registerSubmit(()=> onReady({ title, file, textHtml }));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [registerSubmit, title, file, textHtml]);\n\n  return (\n    <div style={{display:'grid', gap:12}}>\n      <input placeholder=\"Title\" value={title} onChange={(e)=> setTitle(e.target.value)} />\n      {type === 'text' && (\n        <ReactQuill theme=\"snow\" value={textHtml} onChange={setTextHtml} placeholder=\"Start writing...\" />\n      )}\n      {type !== 'text' && (\n        <div {...getRootProps()} style={{padding:24, border:'2px dashed var(--panel-border)', borderRadius:12, textAlign:'center', background:'var(--panel)'}}>\n          <input {...getInputProps()} />\n          {isDragActive ? 'Drop files here' : (file ? file.name : 'Drag & drop or click to upload (50MB max)')}\n        </div>\n      )}\n      <div style={{display:'flex', justifyContent:'space-between', alignItems:'center', gap:12}}>\n        <div style={{fontSize:12, color:'#94a3b8'}}>{msg}</div>\n        {showNextButton && (\n          <button onClick={next} style={{background:'var(--accent)', color:'#111', border:'none', padding:'8px 12px', borderRadius:8, width:120}}>Next</button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n","import React, { useEffect, useRef, useState } from 'react';\n\ntype Props = {\n  onNext?: (c: {\n    teaserPercent: number;\n    watermark: boolean;\n    price: number;\n    editions: number;\n    authorsNote: string;\n    tagIds: number[];\n    splits: Array<{ address: string; percent: number }>;\n  }) => void;\n  registerSubmit?: (fn: () => {\n    teaserPercent: number;\n    watermark: boolean;\n    price: number;\n    editions: number;\n    authorsNote: string;\n    tagIds: number[];\n    splits: Array<{ address: string; percent: number }>;\n  }) => void;\n};\n\n// Helper to count words\nfunction countWords(text: string): number {\n  return text.trim().split(/\\s+/).filter(w => w.length > 0).length;\n}\n\nexport default function CustomizeStep({ onNext, registerSubmit }: Props) {\n  const [teaser, setTeaser] = useState(10);\n  const [watermark, setWatermark] = useState(false);\n  const [price, setPrice] = useState(1);\n  const [editions, setEditions] = useState(10);\n  const [authorsNote, setAuthorsNote] = useState('');\n  const [splits] = useState<Array<{ address: string; percent: number }>>([]);\n  const latest = useRef({ teaserPercent: teaser, watermark, price, editions, authorsNote, tagIds: [] as number[], splits });\n\n  const wordCount = countWords(authorsNote);\n  const maxWords = 100;\n  const isOverLimit = wordCount > maxWords;\n\n  // Keep a ref of latest values without triggering parent state updates\n  useEffect(() => {\n    latest.current = { teaserPercent: teaser, watermark, price, editions, authorsNote, tagIds: [], splits };\n  }, [teaser, watermark, price, editions, authorsNote, splits]);\n\n  // Register once (or when registerSubmit identity changes)\n  useEffect(() => {\n    if (registerSubmit) {\n      registerSubmit(() => latest.current);\n    }\n  }, [registerSubmit]);\n\n  return (\n    <div style={{ display: 'grid', gap: 16 }}>\n      <label>Teaser shown to public: {teaser}% <input type=\"range\" min={0} max={100} value={teaser} onChange={(e) => setTeaser(parseInt(e.target.value))} /></label>\n      <label title=\"Show a watermark overlay on the teaser only (original remains clean)\"><input type=\"checkbox\" checked={watermark} onChange={(e) => setWatermark(e.target.checked)} /> Show watermark on teaser</label>\n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 8 }}>\n        <div style={{ display: 'grid', gap: 6 }}>\n          <div style={{ fontSize: 12, color: '#94a3b8' }}>Price per edition (USD)</div>\n          <input type=\"number\" min={0} step={0.01} value={price} onChange={(e) => setPrice(parseFloat(e.target.value || '0'))} />\n        </div>\n        <div style={{ display: 'grid', gap: 6 }}>\n          <div style={{ fontSize: 12, color: '#94a3b8' }}>Number of editions</div>\n          <input type=\"number\" min={1} value={editions} onChange={(e) => setEditions(parseInt(e.target.value || '1'))} />\n        </div>\n      </div>\n\n      {/* Author's Note */}\n      <div style={{ display: 'grid', gap: 6 }}>\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          <div style={{ fontSize: 12, color: '#94a3b8' }}>Author's Note (optional)</div>\n          <div style={{ fontSize: 11, color: isOverLimit ? '#ef4444' : '#64748b' }}>\n            {wordCount}/{maxWords} words\n          </div>\n        </div>\n        <textarea\n          value={authorsNote}\n          onChange={(e) => setAuthorsNote(e.target.value)}\n          placeholder=\"Share a brief note about this work with your audience...\"\n          style={{\n            width: '100%',\n            minHeight: 80,\n            padding: '10px 12px',\n            background: 'var(--bg)',\n            border: `1px solid ${isOverLimit ? '#ef4444' : 'var(--panel-border)'}`,\n            borderRadius: 8,\n            color: 'var(--text)',\n            fontSize: 14,\n            resize: 'vertical',\n            fontFamily: 'inherit',\n          }}\n        />\n        {isOverLimit && (\n          <div style={{ fontSize: 11, color: '#ef4444' }}>\n            Please keep your note under {maxWords} words.\n          </div>\n        )}\n      </div>\n\n      <div style={{ fontSize: 12, color: '#94a3b8' }}>Platform fee applies per terms</div>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { API_URL } from '../../config';\nimport { X, Plus, Search, ChevronDown, ChevronUp } from 'lucide-react';\n\ninterface Tag {\n  id: number;\n  name: string;\n  slug: string;\n  category: 'genre' | 'theme' | 'mood' | 'custom';\n  is_predefined: boolean;\n  usage_count: number;\n}\n\ninterface TagSelectorProps {\n  selectedIds: number[];\n  onChange: (ids: number[]) => void;\n  maxTags?: number;\n}\n\nasync function fetchCsrf(): Promise<string> {\n  try {\n    const res = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' });\n    const data = await res.json();\n    return data?.csrfToken || '';\n  } catch {\n    return '';\n  }\n}\n\nexport default function TagSelector({ selectedIds, onChange, maxTags = 10 }: TagSelectorProps) {\n  const [tags, setTags] = useState<Tag[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [creating, setCreating] = useState(false);\n  const [showAllTags, setShowAllTags] = useState(false);\n\n  // Fetch predefined tags on mount\n  useEffect(() => {\n    fetch(`${API_URL}/api/tags/?predefined=true`, { credentials: 'include' })\n      .then(r => r.ok ? r.json() : [])\n      .then(data => {\n        const tagsArray = Array.isArray(data) ? data : (data?.results || []);\n        setTags(tagsArray);\n      })\n      .catch(() => setTags([]))\n      .finally(() => setLoading(false));\n  }, []);\n\n  // Suggested tags - top 2 from each category (6 total)\n  const suggestedTags = useMemo(() => {\n    const genres = tags.filter(t => t.category === 'genre').slice(0, 2);\n    const themes = tags.filter(t => t.category === 'theme').slice(0, 2);\n    const moods = tags.filter(t => t.category === 'mood').slice(0, 2);\n    return [...genres, ...themes, ...moods];\n  }, [tags]);\n\n  // Filtered tags based on search\n  const filteredTags = useMemo(() => {\n    if (!searchQuery.trim()) return [];\n    const query = searchQuery.toLowerCase();\n    return tags.filter(t =>\n      t.name.toLowerCase().includes(query) &&\n      !selectedIds.includes(t.id)\n    ).slice(0, 8);\n  }, [tags, searchQuery, selectedIds]);\n\n  // Group tags by category for browse all view\n  const groupedTags = useMemo(() => ({\n    genre: tags.filter(t => t.category === 'genre'),\n    theme: tags.filter(t => t.category === 'theme'),\n    mood: tags.filter(t => t.category === 'mood'),\n  }), [tags]);\n\n  const toggleTag = (id: number) => {\n    if (selectedIds.includes(id)) {\n      onChange(selectedIds.filter(i => i !== id));\n    } else if (selectedIds.length < maxTags) {\n      onChange([...selectedIds, id]);\n      setSearchQuery('');\n    }\n  };\n\n  const addCustomTag = async () => {\n    const name = searchQuery.trim();\n    if (!name || creating || selectedIds.length >= maxTags) return;\n\n    // Check if tag already exists\n    const existing = tags.find(t => t.name.toLowerCase() === name.toLowerCase());\n    if (existing) {\n      if (!selectedIds.includes(existing.id)) {\n        onChange([...selectedIds, existing.id]);\n      }\n      setSearchQuery('');\n      return;\n    }\n\n    setCreating(true);\n    try {\n      const csrf = await fetchCsrf();\n      const res = await fetch(`${API_URL}/api/tags/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrf,\n        },\n        body: JSON.stringify({ name }),\n        credentials: 'include',\n      });\n\n      if (res.ok) {\n        const newTag = await res.json();\n        if (!tags.find(t => t.id === newTag.id)) {\n          setTags([...tags, newTag]);\n        }\n        if (!selectedIds.includes(newTag.id)) {\n          onChange([...selectedIds, newTag.id]);\n        }\n        setSearchQuery('');\n      }\n    } catch (err) {\n      console.error('Failed to create tag:', err);\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      if (filteredTags.length > 0) {\n        toggleTag(filteredTags[0].id);\n      } else if (searchQuery.trim()) {\n        addCustomTag();\n      }\n    }\n  };\n\n  const selectedTags = tags.filter(t => selectedIds.includes(t.id));\n  const isAtLimit = selectedIds.length >= maxTags;\n\n  if (loading) {\n    return (\n      <div className=\"tag-selector\">\n        <div className=\"tag-loading\">Loading tags...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"tag-selector\">\n      {/* Selected tags */}\n      {selectedTags.length > 0 && (\n        <div className=\"selected-tags\">\n          {selectedTags.map(tag => (\n            <span key={tag.id} className=\"tag-chip selected\">\n              {tag.name}\n              <button type=\"button\" onClick={() => toggleTag(tag.id)} aria-label={`Remove ${tag.name}`}>\n                <X size={12} />\n              </button>\n            </span>\n          ))}\n        </div>\n      )}\n\n      {/* Search input */}\n      <div className=\"tag-search\">\n        <Search size={16} className=\"search-icon\" />\n        <input\n          type=\"text\"\n          value={searchQuery}\n          onChange={e => setSearchQuery(e.target.value)}\n          onKeyDown={handleKeyDown}\n          placeholder={isAtLimit ? 'Max tags reached' : 'Search or add tags...'}\n          disabled={isAtLimit}\n        />\n        {searchQuery.trim() && !isAtLimit && (\n          <button\n            type=\"button\"\n            className=\"add-custom-btn\"\n            onClick={addCustomTag}\n            disabled={creating}\n          >\n            <Plus size={14} />\n            Add\n          </button>\n        )}\n      </div>\n\n      {/* Search results */}\n      {searchQuery.trim() && filteredTags.length > 0 && (\n        <div className=\"tag-search-results\">\n          {filteredTags.map(tag => (\n            <button\n              key={tag.id}\n              type=\"button\"\n              className=\"tag-chip\"\n              onClick={() => toggleTag(tag.id)}\n            >\n              {tag.name}\n              <span className=\"tag-category-hint\">{tag.category}</span>\n            </button>\n          ))}\n        </div>\n      )}\n\n      {/* Suggested tags (when not searching) */}\n      {!searchQuery.trim() && !showAllTags && (\n        <div className=\"suggested-tags\">\n          <div className=\"suggested-header\">\n            <span>Suggested</span>\n            <button\n              type=\"button\"\n              className=\"browse-all-btn\"\n              onClick={() => setShowAllTags(true)}\n            >\n              Browse all <ChevronDown size={14} />\n            </button>\n          </div>\n          <div className=\"tag-chips\">\n            {suggestedTags.map(tag => (\n              <button\n                key={tag.id}\n                type=\"button\"\n                className={`tag-chip ${selectedIds.includes(tag.id) ? 'active' : ''}`}\n                onClick={() => toggleTag(tag.id)}\n                disabled={!selectedIds.includes(tag.id) && isAtLimit}\n              >\n                {tag.name}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Browse all tags */}\n      {!searchQuery.trim() && showAllTags && (\n        <div className=\"all-tags\">\n          <button\n            type=\"button\"\n            className=\"collapse-btn\"\n            onClick={() => setShowAllTags(false)}\n          >\n            <ChevronUp size={14} /> Hide categories\n          </button>\n          {Object.entries(groupedTags).map(([category, categoryTags]) => (\n            categoryTags.length > 0 && (\n              <div key={category} className=\"tag-category\">\n                <h4>{category.charAt(0).toUpperCase() + category.slice(1)}</h4>\n                <div className=\"tag-chips\">\n                  {categoryTags.map(tag => (\n                    <button\n                      key={tag.id}\n                      type=\"button\"\n                      className={`tag-chip ${selectedIds.includes(tag.id) ? 'active' : ''}`}\n                      onClick={() => toggleTag(tag.id)}\n                      disabled={!selectedIds.includes(tag.id) && isAtLimit}\n                    >\n                      {tag.name}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )\n          ))}\n        </div>\n      )}\n\n      {/* Tag count */}\n      <p className=\"tag-limit-hint\">\n        {selectedIds.length}/{maxTags} tags\n      </p>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport TagSelector from './TagSelector';\nimport CopyrightPreview from '../BookEditor/CopyrightPreview';\n\ninterface ConfigureStepProps {\n  contentId?: number;\n  authorName?: string;\n  registerSubmit?: (fn: () => {\n    teaserPercent: number;\n    watermark: boolean;\n    price: number;\n    editions: number;\n    authorsNote: string;\n    tagIds: number[];\n    splits: Array<{ address: string; percent: number }>;\n  }) => void;\n}\n\nfunction countWords(text: string): number {\n  return text.trim().split(/\\s+/).filter(w => w.length > 0).length;\n}\n\nexport default function ConfigureStep({ contentId, authorName, registerSubmit }: ConfigureStepProps) {\n  const [teaser, setTeaser] = useState(10);\n  const [watermark, setWatermark] = useState(false);\n  const [price, setPrice] = useState(1);\n  const [editions, setEditions] = useState(10);\n  const [authorsNote, setAuthorsNote] = useState('');\n  const [selectedTags, setSelectedTags] = useState<number[]>([]);\n  const [splits] = useState<Array<{ address: string; percent: number }>>([]);\n\n  const wordCount = countWords(authorsNote);\n  const maxWords = 100;\n  const isOverLimit = wordCount > maxWords;\n\n  const latest = useRef({\n    teaserPercent: teaser,\n    watermark,\n    price,\n    editions,\n    authorsNote,\n    tagIds: selectedTags,\n    splits,\n  });\n\n  // Keep ref updated with latest values\n  useEffect(() => {\n    latest.current = {\n      teaserPercent: teaser,\n      watermark,\n      price,\n      editions,\n      authorsNote,\n      tagIds: selectedTags,\n      splits,\n    };\n  }, [teaser, watermark, price, editions, authorsNote, selectedTags, splits]);\n\n  // Register callback once\n  useEffect(() => {\n    if (registerSubmit) {\n      registerSubmit(() => latest.current);\n    }\n  }, [registerSubmit]);\n\n  // Calculate potential earnings\n  const potentialGross = price * editions;\n  const platformFee = potentialGross * 0.1; // 10% platform fee\n  const potentialEarnings = potentialGross - platformFee;\n\n  return (\n    <div className=\"configure-step\">\n      {/* Section 1: Tags & Discovery */}\n      <section className=\"config-section\">\n        <h3>Tags & Discovery</h3>\n        <p className=\"section-hint\">Add tags to help readers find your work</p>\n        <TagSelector\n          selectedIds={selectedTags}\n          onChange={setSelectedTags}\n          maxTags={10}\n        />\n      </section>\n\n      {/* Section 2: Author's Note */}\n      <section className=\"config-section\">\n        <div className=\"section-header\">\n          <h3>Author's Note</h3>\n          <span className={`word-count ${isOverLimit ? 'over-limit' : ''}`}>\n            {wordCount}/{maxWords} words\n          </span>\n        </div>\n        <p className=\"section-hint\">Share a brief note about this work with your audience</p>\n        <textarea\n          value={authorsNote}\n          onChange={(e) => setAuthorsNote(e.target.value)}\n          placeholder=\"What inspired this work? Any thoughts you'd like to share with readers...\"\n          className={`authors-note-input ${isOverLimit ? 'error' : ''}`}\n        />\n        {isOverLimit && (\n          <div className=\"error-text\">\n            Please keep your note under {maxWords} words.\n          </div>\n        )}\n      </section>\n\n      {/* Section 3: Preview Settings */}\n      <section className=\"config-section\">\n        <h3>Preview Settings</h3>\n        <p className=\"section-hint\">Control what readers see before purchase</p>\n\n        <div className=\"teaser-slider\">\n          <label>\n            Teaser shown to public: <strong>{teaser}%</strong>\n          </label>\n          <input\n            type=\"range\"\n            min={0}\n            max={100}\n            value={teaser}\n            onChange={(e) => setTeaser(parseInt(e.target.value))}\n          />\n          <div className=\"slider-labels\">\n            <span>0%</span>\n            <span>50%</span>\n            <span>100%</span>\n          </div>\n        </div>\n\n        <label className=\"watermark-toggle\">\n          <input\n            type=\"checkbox\"\n            checked={watermark}\n            onChange={(e) => setWatermark(e.target.checked)}\n          />\n          <span>Show watermark on teaser</span>\n          <span className=\"toggle-hint\">(Original remains clean)</span>\n        </label>\n      </section>\n\n      {/* Section 4: Pricing */}\n      <section className=\"config-section\">\n        <h3>Pricing</h3>\n        <p className=\"section-hint\">Set your price and edition limits</p>\n\n        <div className=\"pricing-grid\">\n          <div className=\"price-input\">\n            <label>Price per edition (USD)</label>\n            <div className=\"input-with-prefix\">\n              <span className=\"prefix\">$</span>\n              <input\n                type=\"number\"\n                min={0}\n                step={0.01}\n                value={price}\n                onChange={(e) => setPrice(parseFloat(e.target.value || '0'))}\n              />\n            </div>\n          </div>\n          <div className=\"editions-input\">\n            <label>Number of editions</label>\n            <input\n              type=\"number\"\n              min={1}\n              value={editions}\n              onChange={(e) => setEditions(parseInt(e.target.value || '1'))}\n            />\n          </div>\n        </div>\n\n        <div className=\"earnings-preview\">\n          <div className=\"earnings-row\">\n            <span>Potential gross (if sold out)</span>\n            <span>${potentialGross.toFixed(2)}</span>\n          </div>\n          <div className=\"earnings-row fee\">\n            <span>Platform fee (10%)</span>\n            <span>-${platformFee.toFixed(2)}</span>\n          </div>\n          <div className=\"earnings-row highlight\">\n            <span>Your potential earnings</span>\n            <span className=\"earnings-amount\">${potentialEarnings.toFixed(2)}</span>\n          </div>\n        </div>\n      </section>\n\n      {/* Section 5: Copyright Notice */}\n      <section className=\"config-section\">\n        <h3>Copyright Notice</h3>\n        <p className=\"section-hint\">This notice will be associated with your published work</p>\n        <CopyrightPreview authorName={authorName || 'Author'} />\n      </section>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { API_URL } from '../../config';\nimport { FileText, Tag, DollarSign, Rocket } from 'lucide-react';\n\ninterface ContentPreview {\n  id: number;\n  title: string;\n  teaser_link: string;\n  content_type: string;\n  tags?: Array<{ id: number; name: string }>;\n}\n\ninterface MintStepProps {\n  contentId?: number;\n  price?: number;\n  editions?: number;\n  onMint: () => void;\n}\n\nexport default function MintStep({ contentId, price, editions, onMint }: MintStepProps) {\n  const [agree, setAgree] = useState(false);\n  const [feePct, setFeePct] = useState<number>(10);\n  const [contentDetails, setContentDetails] = useState<ContentPreview | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  // Fetch platform fee\n  useEffect(() => {\n    fetch(`${API_URL}/api/dashboard/`, { credentials: 'include' })\n      .then(r => r.ok ? r.json() : null)\n      .then(d => { if (d && typeof d.fee === 'number') setFeePct(d.fee); })\n      .catch(() => { });\n  }, []);\n\n  // Fetch content preview\n  useEffect(() => {\n    if (!contentId) return;\n    fetch(`${API_URL}/api/content/${contentId}/preview/`, { credentials: 'include' })\n      .then(r => r.ok ? r.json() : null)\n      .then(d => {\n        if (d) {\n          setContentDetails({\n            id: d.id,\n            title: d.title,\n            teaser_link: d.teaser_link,\n            content_type: d.content_type,\n            tags: d.tags || [],\n          });\n        }\n      })\n      .catch(() => { });\n  }, [contentId]);\n\n  const gross = (Number(price || 0) * Number(editions || 1));\n  const platformFee = gross * (feePct / 100);\n  const netEarnings = gross - platformFee;\n\n  const handleMint = () => {\n    if (!agree || loading) return;\n    setLoading(true);\n    onMint();\n  };\n\n  return (\n    <div className=\"mint-step\">\n      <div className=\"mint-header\">\n        <h2>Review & Publish</h2>\n        <p className=\"mint-subtitle\">Double-check your settings before publishing</p>\n      </div>\n\n      {/* Content Preview Card */}\n      <div className=\"review-card content-preview-card\">\n        <div className=\"card-header\">\n          <FileText size={20} />\n          <h3>Your Work</h3>\n        </div>\n        {contentDetails ? (\n          <div className=\"content-preview\">\n            {contentDetails.teaser_link && (\n              <img\n                src={contentDetails.teaser_link}\n                alt=\"\"\n                className=\"content-thumbnail\"\n                onError={(e) => { (e.target as HTMLImageElement).style.display = 'none'; }}\n              />\n            )}\n            <div className=\"content-info\">\n              <h4>{contentDetails.title}</h4>\n              <span className=\"content-type\">{contentDetails.content_type}</span>\n            </div>\n          </div>\n        ) : (\n          <div className=\"content-preview-placeholder\">Loading content preview...</div>\n        )}\n      </div>\n\n      {/* Tags Card */}\n      {contentDetails?.tags && contentDetails.tags.length > 0 && (\n        <div className=\"review-card tags-card\">\n          <div className=\"card-header\">\n            <Tag size={20} />\n            <h3>Tags</h3>\n          </div>\n          <div className=\"tag-chips-preview\">\n            {contentDetails.tags.map(tag => (\n              <span key={tag.id} className=\"tag-chip-preview\">{tag.name}</span>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Pricing & Earnings Card */}\n      <div className=\"review-card earnings-card\">\n        <div className=\"card-header\">\n          <DollarSign size={20} />\n          <h3>Pricing & Earnings</h3>\n        </div>\n        <div className=\"earnings-breakdown\">\n          <div className=\"breakdown-row\">\n            <span>Price per edition</span>\n            <span>${(price || 0).toFixed(2)}</span>\n          </div>\n          <div className=\"breakdown-row\">\n            <span>Number of editions</span>\n            <span>{editions || 1}</span>\n          </div>\n          <div className=\"breakdown-divider\" />\n          <div className=\"breakdown-row\">\n            <span>Gross revenue (if sold out)</span>\n            <span>${gross.toFixed(2)}</span>\n          </div>\n          <div className=\"breakdown-row fee\">\n            <span>Platform fee ({feePct}%)</span>\n            <span>-${platformFee.toFixed(2)}</span>\n          </div>\n          <div className=\"breakdown-row highlight\">\n            <span>Your earnings</span>\n            <span className=\"earnings-amount\">${netEarnings.toFixed(2)}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Terms Agreement */}\n      <div className=\"terms-section\">\n        <label className=\"terms-checkbox\">\n          <input\n            type=\"checkbox\"\n            checked={agree}\n            onChange={(e) => setAgree(e.target.checked)}\n          />\n          <span>\n            I agree to the{' '}\n            <a href=\"/terms\" target=\"_blank\" rel=\"noreferrer\">Terms and Conditions</a>\n            {' '}and understand the platform fee structure\n          </span>\n        </label>\n      </div>\n\n      {/* Mint Button */}\n      <button\n        className=\"mint-button\"\n        disabled={!agree || loading}\n        onClick={handleMint}\n      >\n        <Rocket size={18} />\n        {loading ? 'Publishing...' : 'Mint & Publish'}\n      </button>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\n\ninterface ConfettiPiece {\n  id: number;\n  left: string;\n  delay: string;\n  color: string;\n  duration: string;\n}\n\nconst COLORS = ['#f59e0b', '#10b981', '#3b82f6', '#ef4444', '#8b5cf6', '#ec4899'];\n\nexport default function ConfettiEffect() {\n  const [pieces, setPieces] = useState<ConfettiPiece[]>([]);\n\n  useEffect(() => {\n    // Generate confetti pieces on mount\n    const newPieces: ConfettiPiece[] = Array.from({ length: 50 }).map((_, i) => ({\n      id: i,\n      left: `${Math.random() * 100}%`,\n      delay: `${Math.random() * 2}s`,\n      color: COLORS[i % COLORS.length],\n      duration: `${2 + Math.random() * 2}s`,\n    }));\n    setPieces(newPieces);\n  }, []);\n\n  return (\n    <div className=\"confetti-container\">\n      {pieces.map(piece => (\n        <div\n          key={piece.id}\n          className=\"confetti-piece\"\n          style={{\n            left: piece.left,\n            animationDelay: piece.delay,\n            animationDuration: piece.duration,\n            backgroundColor: piece.color,\n          }}\n        />\n      ))}\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { API_URL } from '../../config';\nimport { Copy, ExternalLink, Twitter, Check, Plus, Eye } from 'lucide-react';\nimport PreviewModal from '../PreviewModal';\nimport ConfettiEffect from './ConfettiEffect';\n\ninterface ShareStepProps {\n  contentId?: number;\n  minted: boolean;\n  onPublish?: () => void;\n}\n\nexport default function ShareStep({ contentId, minted, onPublish }: ShareStepProps) {\n  const url = contentId ? `${window.location.origin}/content/${contentId}` : '';\n  const [open, setOpen] = useState(false);\n  const [teaser, setTeaser] = useState<string | undefined>();\n  const [ctype, setCtype] = useState<'book' | 'art' | 'film' | 'music' | undefined>();\n  const [feePct, setFeePct] = useState<number>(10);\n  const [copied, setCopied] = useState(false);\n  const [showConfetti, setShowConfetti] = useState(false);\n  const [contentTitle, setContentTitle] = useState('');\n\n  useEffect(() => {\n    if (!contentId) return;\n    fetch(`${API_URL}/api/content/${contentId}/preview/`, { credentials: 'include' })\n      .then(r => r.ok ? r.json() : null)\n      .then(d => {\n        const teaserUrl = d?.content_type === 'book'\n          ? `${API_URL}/api/content/${contentId}/teaser/`\n          : d?.teaser_link;\n        setTeaser(teaserUrl);\n        setCtype(d?.content_type);\n        setContentTitle(d?.title || '');\n      })\n      .catch(() => { });\n\n    fetch(`${API_URL}/api/dashboard/`, { credentials: 'include' })\n      .then(r => r.ok ? r.json() : null)\n      .then(d => { if (d && typeof d.fee === 'number') setFeePct(d.fee); })\n      .catch(() => { });\n  }, [contentId]);\n\n  // Show confetti when minted changes to true\n  useEffect(() => {\n    if (minted) {\n      setShowConfetti(true);\n      const timer = setTimeout(() => setShowConfetti(false), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [minted]);\n\n  const handleCopy = () => {\n    if (url) {\n      navigator.clipboard.writeText(url);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  const handleShareTwitter = () => {\n    const text = contentTitle\n      ? `Check out my new work \"${contentTitle}\" on renaissBlock!`\n      : 'Check out my new work on renaissBlock!';\n    const twitterUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`;\n    window.open(twitterUrl, '_blank');\n  };\n\n  // Pre-mint state\n  if (!minted) {\n    return (\n      <div className=\"share-step pre-mint\">\n        <h2>Ready to Publish?</h2>\n        <p className=\"share-subtitle\">Preview your work and share the link before minting</p>\n\n        <div className=\"share-url-section\">\n          <label>Share URL</label>\n          <div className=\"share-url-input\">\n            <input value={url} readOnly />\n            <button onClick={handleCopy} className=\"copy-btn\">\n              {copied ? <Check size={16} /> : <Copy size={16} />}\n              {copied ? 'Copied!' : 'Copy'}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"fee-info\">\n          Platform Fee: {feePct}% &bull; Your Share: {Math.max(0, 100 - feePct)}%\n        </div>\n\n        <div className=\"pre-mint-actions\">\n          <button onClick={() => setOpen(true)} className=\"preview-btn\">\n            <Eye size={18} />\n            Preview Teaser\n          </button>\n          <button onClick={onPublish} className=\"mint-btn\">\n            Approve & Mint\n          </button>\n        </div>\n\n        <p className=\"collaborators-hint\">\n          Invite collaborators directly from the Collaborators page.\n        </p>\n\n        <PreviewModal\n          open={open}\n          onClose={() => setOpen(false)}\n          teaserUrl={teaser}\n          contentType={ctype as any}\n        />\n      </div>\n    );\n  }\n\n  // Post-mint success state\n  return (\n    <div className=\"share-step success\">\n      {showConfetti && <ConfettiEffect />}\n\n      <div className=\"success-badge\">\n        <div className=\"checkmark-circle\">\n          <Check size={40} strokeWidth={3} />\n        </div>\n        <h1>Published!</h1>\n        <p>Your work is now live on renaissBlock</p>\n      </div>\n\n      {contentTitle && (\n        <div className=\"published-content-card\">\n          <h3>{contentTitle}</h3>\n          <span className=\"content-type-badge\">{ctype}</span>\n        </div>\n      )}\n\n      <div className=\"share-section\">\n        <h3>Share Your Work</h3>\n        <div className=\"share-buttons\">\n          <button onClick={handleShareTwitter} className=\"share-twitter-btn\">\n            <Twitter size={18} />\n            Share on Twitter\n          </button>\n          <button onClick={handleCopy} className=\"share-copy-btn\">\n            {copied ? <Check size={18} /> : <Copy size={18} />}\n            {copied ? 'Copied!' : 'Copy Link'}\n          </button>\n        </div>\n      </div>\n\n      <div className=\"next-actions\">\n        <a href={`/content/${contentId}`} className=\"view-work-btn\">\n          <ExternalLink size={18} />\n          View Your Work\n        </a>\n        <a href=\"/studio?mode=solo\" className=\"create-another-btn\">\n          <Plus size={18} />\n          Create Another\n        </a>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { Check } from 'lucide-react';\n\ninterface StepIndicatorProps {\n  steps: string[];\n  currentStep: number;\n  maxStep: number;\n  onStepClick: (index: number) => void;\n}\n\nexport default function StepIndicator({ steps, currentStep, maxStep, onStepClick }: StepIndicatorProps) {\n  return (\n    <div className=\"step-indicator\">\n      {steps.map((label, i) => {\n        const isActive = i === currentStep;\n        const isCompleted = i < currentStep;\n        const canClick = i <= maxStep;\n\n        return (\n          <React.Fragment key={label}>\n            <div\n              className={`step ${isActive ? 'active' : ''} ${isCompleted ? 'completed' : ''} ${canClick ? 'clickable' : ''}`}\n              onClick={() => canClick && onStepClick(i)}\n              style={{ cursor: canClick ? 'pointer' : 'default' }}\n            >\n              <div className=\"step-circle\">\n                {isCompleted ? <Check size={16} /> : i + 1}\n              </div>\n              <div className=\"step-label\">{label}</div>\n            </div>\n            {i < steps.length - 1 && (\n              <div className={`step-connector ${isCompleted ? 'completed' : ''}`} />\n            )}\n          </React.Fragment>\n        );\n      })}\n    </div>\n  );\n}\n","/**\n * Book API Service\n *\n * Provides functions for managing book projects and chapters.\n */\n\nimport { API_URL as API_BASE } from '../config';\n\nexport interface Chapter {\n  id: number;\n  title: string;\n  content_html: string;\n  synopsis: string;\n  order: number;\n  created_at: string;\n  updated_at: string;\n  is_published: boolean;\n}\n\nexport interface CopyrightPreview {\n  copyright_line: string;\n  blockchain_message: string;\n  full_text: string;\n}\n\nexport interface SeriesInfo {\n  id: number;\n  title: string;\n  book_count: number;\n}\n\nexport interface BookProject {\n  id: number;\n  title: string;\n  description: string;\n  cover_image?: string | null;\n  cover_image_url?: string | null;\n  chapters: Chapter[];\n  chapter_count: number;\n  series?: number | null;\n  series_order?: number;\n  series_info?: SeriesInfo | null;\n  copyright_preview?: CopyrightPreview;\n  created_at: string;\n  updated_at: string;\n  is_published: boolean;\n  target_chapter_id?: number; // Set when loading by content ID of a specific chapter\n}\n\nexport interface Series {\n  id: number;\n  title: string;\n  synopsis: string;\n  cover_image?: string | null;\n  cover_image_url?: string | null;\n  book_count: number;\n  books: {\n    id: number;\n    title: string;\n    series_order: number;\n    is_published: boolean;\n  }[];\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface ContentResponse {\n  content_id: number;\n  message: string;\n}\n\n/**\n * Get fresh CSRF token from API\n * This is more reliable than reading from cookies\n */\nasync function getFreshCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_BASE}/api/auth/csrf/`, {\n      credentials: 'include',\n    });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to fetch CSRF token:', error);\n    return '';\n  }\n}\n\nexport const bookApi = {\n  /**\n   * Create a new book project\n   */\n  async createProject(title: string, description: string): Promise<BookProject> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ title, description }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to create project: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get all book projects for the current user\n   */\n  async getProjects(): Promise<BookProject[]> {\n    const response = await fetch(`${API_BASE}/api/book-projects/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Failed to fetch projects: ${response.statusText}`);\n    }\n    \n    return response.json();\n  },\n\n  /**\n   * Get a specific book project by ID\n   */\n  async getProject(id: number): Promise<BookProject> {\n    const response = await fetch(`${API_BASE}/api/book-projects/${id}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Failed to fetch project: ${response.statusText}`);\n    }\n    \n    return response.json();\n  },\n\n  /**\n   * Update a book project\n   */\n  async updateProject(id: number, data: Partial<BookProject>): Promise<BookProject> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to update project: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Upload cover image for a book project\n   */\n  async uploadCoverImage(id: number, imageFile: File): Promise<BookProject> {\n    const csrfToken = await getFreshCsrfToken();\n    const formData = new FormData();\n    formData.append('cover_image', imageFile);\n\n    const response = await fetch(`${API_BASE}/api/book-projects/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: formData,\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to upload cover image: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Delete a book project\n   */\n  async deleteProject(id: number): Promise<void> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete project: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Create a new chapter in a project\n   */\n  async createChapter(projectId: number, title: string): Promise<Chapter> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/${projectId}/chapters/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify({ title, content_html: '' }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to create chapter: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Update a chapter\n   */\n  async updateChapter(id: number, data: Partial<Chapter>): Promise<Chapter> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/chapters/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to update chapter: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Delete a chapter\n   */\n  async deleteChapter(id: number): Promise<void> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/chapters/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: {\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to delete chapter: ${response.statusText}`);\n    }\n  },\n\n  /**\n   * Publish a single chapter as Content/NFT\n   */\n  async publishChapter(chapterId: number): Promise<ContentResponse> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/chapters/${chapterId}/publish/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to publish chapter: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Publish entire book as Content/NFT\n   */\n  async publishBook(projectId: number): Promise<ContentResponse> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/${projectId}/publish/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to publish book: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Get book project by its published content ID\n   */\n  async getProjectByContentId(contentId: number): Promise<BookProject> {\n    const response = await fetch(`${API_BASE}/api/book-projects/by-content/${contentId}/`, {\n      method: 'GET',\n      credentials: 'include',\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Failed to fetch project by content: ${response.statusText}`);\n    }\n    \n    return response.json();\n  },\n\n  /**\n   * Prepare a chapter for minting (creates draft Content)\n   */\n  async prepareChapterForMint(chapterId: number): Promise<ContentResponse> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/chapters/${chapterId}/prepare/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to prepare chapter: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n\n  /**\n   * Prepare entire book for minting (creates draft Content)\n   */\n  async prepareBookForMint(projectId: number): Promise<ContentResponse> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/${projectId}/prepare/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n        'X-Requested-With': 'XMLHttpRequest',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to prepare book: ${response.statusText}`);\n    }\n\n    return response.json();\n  },\n};\n\n/**\n * Series API Service\n *\n * Provides functions for managing book series.\n */\nexport const seriesApi = {\n  /**\n   * Get all series for the current user\n   */\n  async getSeries(): Promise<Series[]> {\n    const response = await fetch(`${API_BASE}/api/series/`, {\n      credentials: 'include',\n    });\n    if (!response.ok) throw new Error('Failed to fetch series');\n    return response.json();\n  },\n\n  /**\n   * Get a specific series by ID\n   */\n  async getSeriesById(id: number): Promise<Series> {\n    const response = await fetch(`${API_BASE}/api/series/${id}/`, {\n      credentials: 'include',\n    });\n    if (!response.ok) throw new Error('Failed to fetch series');\n    return response.json();\n  },\n\n  /**\n   * Create a new series\n   */\n  async createSeries(title: string, synopsis: string): Promise<Series> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/series/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n      },\n      body: JSON.stringify({ title, synopsis }),\n    });\n    if (!response.ok) throw new Error('Failed to create series');\n    return response.json();\n  },\n\n  /**\n   * Update a series\n   */\n  async updateSeries(id: number, data: Partial<Series>): Promise<Series> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/series/${id}/`, {\n      method: 'PATCH',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-CSRFToken': csrfToken,\n      },\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) throw new Error('Failed to update series');\n    return response.json();\n  },\n\n  /**\n   * Delete a series\n   */\n  async deleteSeries(id: number): Promise<void> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/series/${id}/`, {\n      method: 'DELETE',\n      credentials: 'include',\n      headers: { 'X-CSRFToken': csrfToken },\n    });\n    if (!response.ok) throw new Error('Failed to delete series');\n  },\n\n  /**\n   * Add a book to a series\n   */\n  async addBookToSeries(seriesId: number, bookId: number): Promise<void> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/series/${seriesId}/add-book/${bookId}/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: { 'X-CSRFToken': csrfToken },\n    });\n    if (!response.ok) throw new Error('Failed to add book to series');\n  },\n\n  /**\n   * Remove a book from its series\n   */\n  async removeBookFromSeries(bookId: number): Promise<void> {\n    const csrfToken = await getFreshCsrfToken();\n    const response = await fetch(`${API_BASE}/api/book-projects/${bookId}/remove-from-series/`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: { 'X-CSRFToken': csrfToken },\n    });\n    if (!response.ok) throw new Error('Failed to remove book from series');\n  },\n};\n\n","import React from 'react';\nimport { Chapter } from '../../services/bookApi';\n\ninterface ChapterListProps {\n  chapters: Chapter[];\n  selectedChapterId: number | null;\n  onSelectChapter: (chapterId: number) => void;\n  onAddChapter: () => void;\n}\n\nexport default function ChapterList({ chapters, selectedChapterId, onSelectChapter, onAddChapter }: ChapterListProps) {\n  const totalWords = chapters.reduce((sum, ch) => {\n    const text = ch.content_html.replace(/<[^>]*>/g, '');\n    return sum + text.split(/\\s+/).filter(w => w.length > 0).length;\n  }, 0);\n\n  return (\n    <div style={{\n      background: 'var(--panel)',\n      border: '1px solid var(--panel-border)',\n      borderRadius: 12,\n      padding: 16,\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'column',\n      gap: 12,\n      minHeight: 0,\n      overflow: 'hidden',\n    }}>\n      {/* Header with Add button */}\n      <div style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        flexShrink: 0,\n      }}>\n        <div>\n          <div style={{ fontWeight: 700, color: 'var(--text)', fontSize: 15 }}>Chapters</div>\n          <div style={{ fontSize: 11, color: '#64748b', marginTop: 2 }}>{chapters.length} chapters  {totalWords} words</div>\n        </div>\n        <button\n          onClick={onAddChapter}\n          style={{\n            background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n            border: 'none',\n            borderRadius: 8,\n            padding: '8px 14px',\n            minHeight: 36,\n            color: '#fff',\n            fontWeight: 600,\n            cursor: 'pointer',\n            fontSize: 13,\n          }}\n        >\n          + Add\n        </button>\n      </div>\n\n      {/* Scrollable chapter list */}\n      <div style={{\n        flex: 1,\n        overflowY: 'auto',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: 6,\n        minHeight: 0,\n        scrollbarWidth: 'thin',\n        scrollbarColor: 'rgba(255,255,255,0.2) transparent',\n      }}>\n        {chapters.length === 0 && (\n          <div style={{\n            color: '#64748b',\n            fontSize: 13,\n            textAlign: 'center',\n            padding: '24px 12px',\n            background: 'rgba(255,255,255,0.02)',\n            borderRadius: 8,\n            border: '1px dashed var(--panel-border)',\n          }}>\n            No chapters yet.<br />\n            <span style={{ fontSize: 12 }}>Click \"+ Add\" to start writing.</span>\n          </div>\n        )}\n        {chapters.map((chapter) => (\n          <button\n            key={chapter.id}\n            onClick={() => onSelectChapter(chapter.id)}\n            style={{\n              background: selectedChapterId === chapter.id\n                ? 'rgba(245,158,11,0.12)'\n                : 'transparent',\n              border: 'none',\n              borderLeft: selectedChapterId === chapter.id\n                ? '3px solid #f59e0b'\n                : '3px solid transparent',\n              borderRadius: 0,\n              padding: '12px 12px',\n              minHeight: 52,\n              textAlign: 'left',\n              cursor: 'pointer',\n              transition: 'all 0.15s ease',\n              flexShrink: 0,\n            }}\n          >\n            <div style={{\n              fontWeight: selectedChapterId === chapter.id ? 600 : 400,\n              color: selectedChapterId === chapter.id ? '#f59e0b' : 'var(--text)',\n              fontSize: 14,\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n            }}>\n              <span style={{\n                color: '#64748b',\n                fontSize: 12,\n                minWidth: 20,\n              }}>{chapter.order + 1}.</span>\n              <span style={{ flex: 1, lineHeight: 1.3 }}>{chapter.title || 'Untitled'}</span>\n              {chapter.is_published && (\n                <span style={{\n                  fontSize: 9,\n                  fontWeight: 600,\n                  color: '#10b981',\n                  background: 'rgba(16, 185, 129, 0.15)',\n                  padding: '2px 5px',\n                  borderRadius: 3,\n                  textTransform: 'uppercase',\n                  letterSpacing: '0.5px',\n                }}>\n                  Minted\n                </span>\n              )}\n            </div>\n            <div style={{\n              fontSize: 11,\n              color: '#64748b',\n              marginTop: 4,\n              marginLeft: 28,\n            }}>\n              {chapter.content_html.replace(/<[^>]*>/g, '').split(/\\s+/).filter(w => w.length > 0).length} words\n            </div>\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n\n","/**\n * ChapterManagement Component\n *\n * Manages chapter removal and delisting with two-tier policy:\n * - Remove completely (permanent delete) if zero sales\n * - Delist from marketplace (hide but preserve access) if has sales\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  AlertTriangle,\n  Trash2,\n  EyeOff,\n  Eye,\n  Loader,\n  CheckCircle,\n  XCircle,\n  Info\n} from 'lucide-react';\nimport { API_URL } from '../config';\n\n/**\n * Get fresh CSRF token from API\n */\nasync function getFreshCsrfToken(): Promise<string> {\n  try {\n    const response = await fetch(`${API_URL}/api/auth/csrf/`, {\n      credentials: 'include',\n    });\n    const data = await response.json();\n    return data?.csrfToken || '';\n  } catch (error) {\n    console.error('Failed to fetch CSRF token:', error);\n    return '';\n  }\n}\n\ninterface Chapter {\n  id: number;\n  title: string;\n  order: number;\n  is_published: boolean;\n}\n\ninterface RemovalStatus {\n  chapter_id: number;\n  title: string;\n  is_listed: boolean;\n  delisted_at: string | null;\n  delisted_by: string | null;\n  delisted_reason: string;\n  purchase_count: number;\n  has_sales: boolean;\n  can_remove_completely: boolean;\n  can_delist: boolean;\n  is_collaborative: boolean;\n  pending_delist_request: {\n    id: number;\n    requested_by: string;\n    reason: string;\n    created_at: string;\n    approvals_count: number;\n    total_collaborators: number;\n    status: string;\n  } | null;\n}\n\ninterface ChapterManagementProps {\n  chapter: Chapter;\n  onStatusChange?: () => void;\n}\n\nconst ChapterManagement: React.FC<ChapterManagementProps> = ({ chapter, onStatusChange }) => {\n  const [status, setStatus] = useState<RemovalStatus | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [showRemoveModal, setShowRemoveModal] = useState(false);\n  const [showDelistModal, setShowDelistModal] = useState(false);\n  const [reason, setReason] = useState('');\n  const [actionLoading, setActionLoading] = useState(false);\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\n\n  useEffect(() => {\n    fetchRemovalStatus();\n  }, [chapter.id]);\n\n  const fetchRemovalStatus = async () => {\n    setLoading(true);\n    try {\n      const response = await fetch(`${API_URL}/api/chapters/${chapter.id}/removal-status/`, {\n        credentials: 'include'\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setStatus(data);\n      } else if (response.status === 404) {\n        // Chapter was deleted, don't show error\n        console.log('[ChapterManagement] Chapter no longer exists');\n      }\n    } catch (error) {\n      console.error('Error fetching removal status:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRemove = async () => {\n    if (!status?.can_remove_completely) return;\n\n    setActionLoading(true);\n    setMessage(null);\n\n    try {\n      const csrfToken = await getFreshCsrfToken();\n      const response = await fetch(`${API_URL}/api/chapters/${chapter.id}/remove/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken,\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        credentials: 'include',\n        body: JSON.stringify({ reason })\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setMessage({ type: 'success', text: data.message });\n        setShowRemoveModal(false);\n\n        // Chapter was deleted - wait a moment then trigger navigation\n        setTimeout(() => {\n          if (onStatusChange) {\n            onStatusChange();\n          }\n        }, 500);\n      } else {\n        setMessage({ type: 'error', text: data.error });\n      }\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to remove chapter' });\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleDelist = async () => {\n    if (!status?.can_delist || !reason.trim()) return;\n\n    setActionLoading(true);\n    setMessage(null);\n\n    try {\n      const csrfToken = await getFreshCsrfToken();\n      const response = await fetch(`${API_URL}/api/chapters/${chapter.id}/delist/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken,\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        credentials: 'include',\n        body: JSON.stringify({ reason })\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setMessage({ type: 'success', text: data.message });\n        setShowDelistModal(false);\n        setReason('');\n        fetchRemovalStatus();\n        onStatusChange?.();\n      } else {\n        setMessage({ type: 'error', text: data.error });\n      }\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to delist chapter' });\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleRelist = async () => {\n    setActionLoading(true);\n    setMessage(null);\n\n    try {\n      const csrfToken = await getFreshCsrfToken();\n      const response = await fetch(`${API_URL}/api/chapters/${chapter.id}/relist/`, {\n        method: 'POST',\n        headers: {\n          'X-CSRFToken': csrfToken,\n          'X-Requested-With': 'XMLHttpRequest',\n        },\n        credentials: 'include'\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setMessage({ type: 'success', text: data.message });\n        fetchRemovalStatus();\n        onStatusChange?.();\n      } else {\n        setMessage({ type: 'error', text: data.error });\n      }\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to relist chapter' });\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  if (loading || !status) {\n    return (\n      <div style={{ padding: 16, display: 'flex', alignItems: 'center', gap: 8 }}>\n        <Loader size={16} style={{ animation: 'spin 1s linear infinite' }} />\n        <span>Loading status...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ padding: 16, background: '#0f172a', border: '1px solid #1e293b', borderRadius: 8 }}>\n      {/* Status Messages */}\n      {message && (\n        <div style={{\n          padding: 12,\n          marginBottom: 16,\n          borderRadius: 8,\n          background: message.type === 'success' ? '#064e3b' : '#7f1d1d',\n          border: `1px solid ${message.type === 'success' ? '#10b981' : '#ef4444'}`,\n          display: 'flex',\n          alignItems: 'center',\n          gap: 8\n        }}>\n          {message.type === 'success' ? <CheckCircle size={20} /> : <XCircle size={20} />}\n          <span>{message.text}</span>\n        </div>\n      )}\n\n      {/* Chapter Status */}\n      <div style={{ marginBottom: 16 }}>\n        <h3 style={{ fontSize: 18, fontWeight: 600, marginBottom: 8 }}>\n          Chapter Removal Management\n        </h3>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 8, fontSize: 14 }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <span style={{ color: '#94a3b8' }}>Status:</span>\n            {status.is_listed ? (\n              <span style={{ display: 'flex', alignItems: 'center', gap: 4, color: '#10b981' }}>\n                <Eye size={16} /> Listed on marketplace\n              </span>\n            ) : (\n              <span style={{ display: 'flex', alignItems: 'center', gap: 4, color: '#f59e0b' }}>\n                <EyeOff size={16} /> Delisted from marketplace\n              </span>\n            )}\n          </div>\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <span style={{ color: '#94a3b8' }}>NFTs sold:</span>\n            <span style={{ fontWeight: 600 }}>{status.purchase_count}</span>\n          </div>\n          {status.is_collaborative && (\n            <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n              <Info size={16} style={{ color: '#3b82f6' }} />\n              <span style={{ color: '#94a3b8' }}>Collaborative content (requires unanimous approval)</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Delisted Info */}\n      {!status.is_listed && status.delisted_at && (\n        <div style={{\n          padding: 12,\n          marginBottom: 16,\n          background: '#1e293b',\n          border: '1px solid #334155',\n          borderRadius: 8\n        }}>\n          <div style={{ fontSize: 14, marginBottom: 4 }}>\n            <strong>Delisted by:</strong> {status.delisted_by}\n          </div>\n          <div style={{ fontSize: 14, marginBottom: 4 }}>\n            <strong>Date:</strong> {new Date(status.delisted_at).toLocaleDateString()}\n          </div>\n          {status.delisted_reason && (\n            <div style={{ fontSize: 14 }}>\n              <strong>Reason:</strong> {status.delisted_reason}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Pending Delist Request */}\n      {status.pending_delist_request && (\n        <div style={{\n          padding: 12,\n          marginBottom: 16,\n          background: '#422006',\n          border: '1px solid #f59e0b',\n          borderRadius: 8\n        }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 8 }}>\n            <AlertTriangle size={16} style={{ color: '#f59e0b' }} />\n            <strong>Pending Delist Request</strong>\n          </div>\n          <div style={{ fontSize: 14, color: '#94a3b8' }}>\n            <div>Requested by: <strong>{status.pending_delist_request.requested_by}</strong></div>\n            <div>Approvals: {status.pending_delist_request.approvals_count} / {status.pending_delist_request.total_collaborators}</div>\n            <div>Reason: {status.pending_delist_request.reason}</div>\n          </div>\n        </div>\n      )}\n\n      {/* Action Buttons */}\n      <div style={{ display: 'flex', gap: 12 }}>\n        {/* Remove Completely Button */}\n        {status.can_remove_completely && status.is_listed && (\n          <button\n            onClick={() => setShowRemoveModal(true)}\n            disabled={actionLoading}\n            style={{\n              padding: '10px 16px',\n              background: '#7f1d1d',\n              border: '1px solid #ef4444',\n              borderRadius: 8,\n              color: 'white',\n              cursor: actionLoading ? 'not-allowed' : 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              fontSize: 14,\n              fontWeight: 500\n            }}\n          >\n            <Trash2 size={16} />\n            Remove Permanently\n          </button>\n        )}\n\n        {/* Delist Button */}\n        {status.has_sales && status.can_delist && status.is_listed && !status.pending_delist_request && (\n          <button\n            onClick={() => setShowDelistModal(true)}\n            disabled={actionLoading}\n            style={{\n              padding: '10px 16px',\n              background: '#422006',\n              border: '1px solid #f59e0b',\n              borderRadius: 8,\n              color: 'white',\n              cursor: actionLoading ? 'not-allowed' : 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              fontSize: 14,\n              fontWeight: 500\n            }}\n          >\n            <EyeOff size={16} />\n            Delist from Marketplace\n          </button>\n        )}\n\n        {/* Relist Button */}\n        {!status.is_listed && status.can_delist && (\n          <button\n            onClick={handleRelist}\n            disabled={actionLoading}\n            style={{\n              padding: '10px 16px',\n              background: '#064e3b',\n              border: '1px solid #10b981',\n              borderRadius: 8,\n              color: 'white',\n              cursor: actionLoading ? 'not-allowed' : 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              fontSize: 14,\n              fontWeight: 500\n            }}\n          >\n            {actionLoading ? <Loader size={16} /> : <Eye size={16} />}\n            Relist on Marketplace\n          </button>\n        )}\n      </div>\n\n      {/* Remove Modal */}\n      {showRemoveModal && (\n        <div style={{\n          position: 'fixed',\n          inset: 0,\n          background: 'rgba(0, 0, 0, 0.8)',\n          display: 'grid',\n          placeItems: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: '#0f172a',\n            border: '1px solid #1e293b',\n            borderRadius: 16,\n            padding: 24,\n            maxWidth: 500,\n            width: '90%'\n          }}>\n            <h2 style={{ fontSize: 20, fontWeight: 600, marginBottom: 16, display: 'flex', alignItems: 'center', gap: 8 }}>\n              <AlertTriangle style={{ color: '#ef4444' }} />\n              Permanently Remove Chapter\n            </h2>\n            <p style={{ marginBottom: 16, color: '#94a3b8' }}>\n              This will <strong>permanently delete</strong> this chapter from the database.\n              This action cannot be undone.\n            </p>\n            <p style={{ marginBottom: 16, color: '#94a3b8' }}>\n              Are you sure you want to remove \"{chapter.title}\"?\n            </p>\n            <textarea\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder=\"Optional: Reason for removal (for audit logs)\"\n              style={{\n                width: '100%',\n                minHeight: 80,\n                padding: 12,\n                background: '#1e293b',\n                border: '1px solid #334155',\n                borderRadius: 8,\n                color: 'white',\n                marginBottom: 16,\n                resize: 'vertical'\n              }}\n            />\n            <div style={{ display: 'flex', gap: 12, justifyContent: 'flex-end' }}>\n              <button\n                onClick={() => setShowRemoveModal(false)}\n                disabled={actionLoading}\n                style={{\n                  padding: '10px 20px',\n                  background: '#1e293b',\n                  border: '1px solid #334155',\n                  borderRadius: 8,\n                  color: 'white',\n                  cursor: actionLoading ? 'not-allowed' : 'pointer'\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleRemove}\n                disabled={actionLoading}\n                style={{\n                  padding: '10px 20px',\n                  background: '#7f1d1d',\n                  border: '1px solid #ef4444',\n                  borderRadius: 8,\n                  color: 'white',\n                  cursor: actionLoading ? 'not-allowed' : 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8\n                }}\n              >\n                {actionLoading ? <Loader size={16} /> : <Trash2 size={16} />}\n                Remove Permanently\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Delist Modal */}\n      {showDelistModal && (\n        <div style={{\n          position: 'fixed',\n          inset: 0,\n          background: 'rgba(0, 0, 0, 0.8)',\n          display: 'grid',\n          placeItems: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: '#0f172a',\n            border: '1px solid #1e293b',\n            borderRadius: 16,\n            padding: 24,\n            maxWidth: 500,\n            width: '90%'\n          }}>\n            <h2 style={{ fontSize: 20, fontWeight: 600, marginBottom: 16, display: 'flex', alignItems: 'center', gap: 8 }}>\n              <EyeOff style={{ color: '#f59e0b' }} />\n              Delist from Marketplace\n            </h2>\n            <p style={{ marginBottom: 16, color: '#94a3b8' }}>\n              This will <strong>hide</strong> this chapter from the marketplace, but NFT holders\n              will still have access to their purchased content.\n            </p>\n            {status.is_collaborative && (\n              <p style={{ marginBottom: 16, color: '#f59e0b', fontSize: 14 }}>\n                This is collaborative content. All collaborators must approve before delisting.\n              </p>\n            )}\n            <textarea\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder=\"Reason for delisting (required) *\"\n              required\n              style={{\n                width: '100%',\n                minHeight: 80,\n                padding: 12,\n                background: '#1e293b',\n                border: `1px solid ${!reason.trim() ? '#ef4444' : '#334155'}`,\n                borderRadius: 8,\n                color: 'white',\n                marginBottom: 16,\n                resize: 'vertical'\n              }}\n            />\n            <div style={{ display: 'flex', gap: 12, justifyContent: 'flex-end' }}>\n              <button\n                onClick={() => {\n                  setShowDelistModal(false);\n                  setReason('');\n                }}\n                disabled={actionLoading}\n                style={{\n                  padding: '10px 20px',\n                  background: '#1e293b',\n                  border: '1px solid #334155',\n                  borderRadius: 8,\n                  color: 'white',\n                  cursor: actionLoading ? 'not-allowed' : 'pointer'\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleDelist}\n                disabled={actionLoading || !reason.trim()}\n                style={{\n                  padding: '10px 20px',\n                  background: '#422006',\n                  border: '1px solid #f59e0b',\n                  borderRadius: 8,\n                  color: 'white',\n                  cursor: (actionLoading || !reason.trim()) ? 'not-allowed' : 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8,\n                  opacity: !reason.trim() ? 0.5 : 1\n                }}\n              >\n                {actionLoading ? <Loader size={16} /> : <EyeOff size={16} />}\n                {status.is_collaborative ? 'Request Delist Approval' : 'Delist Now'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChapterManagement;\n","import React, { useEffect, useState, useRef, useMemo } from 'react';\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\nimport { Chapter } from '../../services/bookApi';\nimport ChapterManagement from '../ChapterManagement';\n\ninterface ChapterEditorProps {\n  chapter: Chapter | null;\n  onUpdateChapter: (chapterId: number, title: string, content: string, synopsis?: string) => void;\n  saving: boolean;\n  lastSaved: Date | null;\n  showManagement?: boolean;\n  onManagementChange?: () => void;\n}\n\nexport default function ChapterEditor({\n  chapter,\n  onUpdateChapter,\n  saving,\n  lastSaved,\n  showManagement,\n  onManagementChange\n}: ChapterEditorProps) {\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [synopsis, setSynopsis] = useState('');\n  const [showManagementPanel, setShowManagementPanel] = useState(false);\n  const [showSynopsis, setShowSynopsis] = useState(false);\n\n  // Mobile detection for responsive padding\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n\n  useEffect(() => {\n    const handleResize = () => setIsMobile(window.innerWidth < 768);\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Track whether we're syncing from props to avoid triggering save\n  const isSyncingFromProps = useRef(false);\n  // Track the last loaded chapter ID to only sync when chapter actually changes\n  const lastLoadedChapterId = useRef<number | null>(null);\n\n  // Update local state only when chapter ID changes (not on every re-render)\n  useEffect(() => {\n    if (chapter && chapter.id !== lastLoadedChapterId.current) {\n      isSyncingFromProps.current = true;\n      lastLoadedChapterId.current = chapter.id;\n      setTitle(chapter.title);\n      setContent(chapter.content_html || '');\n      setSynopsis(chapter.synopsis || '');\n      // Reset sync flag after state updates are processed\n      requestAnimationFrame(() => {\n        isSyncingFromProps.current = false;\n      });\n    } else if (!chapter) {\n      lastLoadedChapterId.current = null;\n      setTitle('');\n      setContent('');\n      setSynopsis('');\n    }\n  }, [chapter?.id, chapter?.title, chapter?.content_html, chapter?.synopsis]);\n\n  // Debounced save - only trigger if user made changes (not syncing from props)\n  useEffect(() => {\n    if (!chapter || isSyncingFromProps.current) return;\n\n    const timer = setTimeout(() => {\n      // Double-check we're not syncing and there are actual changes\n      if (!isSyncingFromProps.current && (title !== chapter.title || content !== chapter.content_html || synopsis !== chapter.synopsis)) {\n        onUpdateChapter(chapter.id, title, content, synopsis);\n      }\n    }, 3000); // 3 second debounce\n\n    return () => clearTimeout(timer);\n  }, [title, content, synopsis, chapter, onUpdateChapter]);\n\n  // Memoize word count calculation - must be before any early returns to follow Rules of Hooks\n  const wordCount = useMemo(() => {\n    return content.replace(/<[^>]*>/g, '').split(/\\s+/).filter(w => w.length > 0).length;\n  }, [content]);\n\n  if (!chapter) {\n    return (\n      <div style={{\n        flex: 1,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        color: '#94a3b8',\n        fontSize: isMobile ? 14 : 16,\n        background: 'var(--panel)',\n        border: isMobile ? 'none' : '1px solid var(--panel-border)',\n        borderRadius: isMobile ? 0 : 12,\n        minHeight: 0,\n        padding: isMobile ? 20 : 0,\n        textAlign: 'center',\n      }}>\n        {isMobile ? 'Tap the menu to select a chapter' : 'Select a chapter to start editing'}\n      </div>\n    );\n  }\n\n  const isMinted = chapter.is_published;\n\n  return (\n    <div style={{\n      flex: 1,\n      background: 'var(--panel)',\n      border: isMobile ? 'none' : '1px solid var(--panel-border)',\n      borderRadius: isMobile ? 0 : 12,\n      padding: isMobile ? 16 : 24,\n      display: 'flex',\n      flexDirection: 'column',\n      gap: isMobile ? 12 : 16,\n      minHeight: 0,\n      overflow: 'hidden',\n    }}>\n      {/* Header with title and status - Fixed height */}\n      <div style={{ display: 'flex', flexDirection: 'column', gap: 8, flexShrink: 0 }}>\n        {isMinted && (\n          <div style={{\n            background: 'rgba(16, 185, 129, 0.08)',\n            border: '1px solid rgba(16, 185, 129, 0.2)',\n            borderRadius: 8,\n            padding: '8px 12px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n          }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n              <span style={{ color: '#10b981', fontSize: 12 }}></span>\n              <span style={{ color: '#10b981', fontSize: 12, fontWeight: 500 }}>\n                Minted  Read-only\n              </span>\n            </div>\n            {showManagement && (\n              <button\n                onClick={() => setShowManagementPanel(!showManagementPanel)}\n                style={{\n                  background: 'transparent',\n                  border: '1px solid rgba(16, 185, 129, 0.3)',\n                  borderRadius: 4,\n                  padding: '3px 8px',\n                  color: '#10b981',\n                  fontSize: 10,\n                  fontWeight: 500,\n                  cursor: 'pointer',\n                }}\n              >\n                {showManagementPanel ? 'Hide' : 'Manage'}\n              </button>\n            )}\n          </div>\n        )}\n        {/* Management panel - collapsible */}\n        {showManagementPanel && showManagement && chapter && (\n          <ChapterManagement\n            chapter={chapter}\n            onStatusChange={() => {\n              setShowManagementPanel(false);\n              onManagementChange?.();\n            }}\n          />\n        )}\n        <input\n          type=\"text\"\n          value={title}\n          onChange={(e) => !isMinted && setTitle(e.target.value)}\n          placeholder=\"Chapter Title\"\n          disabled={isMinted}\n          style={{\n            background: isMinted ? 'rgba(100,100,100,0.05)' : 'var(--bg)',\n            border: '1px solid var(--panel-border)',\n            borderRadius: 8,\n            padding: '10px 14px',\n            color: isMinted ? '#64748b' : 'var(--text)',\n            fontSize: 16,\n            fontWeight: 600,\n            outline: 'none',\n            cursor: isMinted ? 'not-allowed' : 'text',\n          }}\n        />\n        {/* Synopsis toggle and field */}\n        <div>\n          <button\n            onClick={() => setShowSynopsis(!showSynopsis)}\n            style={{\n              background: 'transparent',\n              border: 'none',\n              color: '#94a3b8',\n              fontSize: 12,\n              cursor: 'pointer',\n              padding: '4px 0',\n              display: 'flex',\n              alignItems: 'center',\n              gap: 4,\n            }}\n          >\n            <span style={{ fontSize: 10, transform: showSynopsis ? 'rotate(90deg)' : 'rotate(0)', transition: 'transform 0.2s' }}>\n              \n            </span>\n            Synopsis {synopsis ? `(${synopsis.split(/\\s+/).filter(w => w).length} words)` : '(optional)'}\n          </button>\n          {showSynopsis && (\n            <div style={{ marginTop: 8 }}>\n              <textarea\n                value={synopsis}\n                onChange={(e) => !isMinted && setSynopsis(e.target.value)}\n                placeholder=\"Brief summary of this chapter (optional, max 150 words)...\"\n                disabled={isMinted}\n                maxLength={1000}\n                style={{\n                  width: '100%',\n                  minHeight: 80,\n                  background: isMinted ? 'rgba(100,100,100,0.05)' : 'var(--bg)',\n                  border: '1px solid var(--panel-border)',\n                  borderRadius: 8,\n                  padding: '10px 14px',\n                  color: isMinted ? '#64748b' : 'var(--text)',\n                  fontSize: 13,\n                  resize: 'vertical',\n                  cursor: isMinted ? 'not-allowed' : 'text',\n                  outline: 'none',\n                }}\n              />\n              <div style={{ fontSize: 10, color: '#64748b', marginTop: 4 }}>\n                {synopsis.split(/\\s+/).filter(w => w).length}/150 words recommended\n              </div>\n            </div>\n          )}\n        </div>\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          <div style={{ fontSize: 11, color: '#64748b' }}>\n            {wordCount.toLocaleString()} words\n          </div>\n          <div style={{ fontSize: 11, color: saving ? '#f59e0b' : '#64748b' }}>\n            {isMinted ? '' : saving ? 'Saving...' : lastSaved ? `Saved ${formatTimeAgo(lastSaved)}` : 'Not saved'}\n          </div>\n        </div>\n      </div>\n\n      {/* Editor - Takes remaining space, scrolls internally */}\n      <div style={{\n        flex: 1,\n        minHeight: 0, // Critical for flex overflow\n        display: 'flex',\n        flexDirection: 'column',\n      }}>\n        <ReactQuill\n          value={content}\n          onChange={(value) => !isMinted && setContent(value)}\n          readOnly={isMinted}\n          theme=\"snow\"\n          style={{\n            flex: 1,\n            display: 'flex',\n            flexDirection: 'column',\n            opacity: isMinted ? 0.6 : 1,\n          }}\n          modules={{\n            toolbar: isMinted ? false : [\n              [{ header: [1, 2, 3, false] }],\n              ['bold', 'italic', 'underline', 'strike'],\n              [{ list: 'ordered' }, { list: 'bullet' }],\n              ['blockquote', 'code-block'],\n              ['link'],\n              ['clean'],\n            ],\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction formatTimeAgo(date: Date): string {\n  const seconds = Math.floor((new Date().getTime() - date.getTime()) / 1000);\n  if (seconds < 60) return 'just now';\n  const minutes = Math.floor(seconds / 60);\n  if (minutes < 60) return `${minutes}m ago`;\n  const hours = Math.floor(minutes / 60);\n  if (hours < 24) return `${hours}h ago`;\n  return `${Math.floor(hours / 24)}d ago`;\n}\n\n","import React, { useState } from 'react';\nimport { BookProject, Chapter } from '../../services/bookApi';\n\ninterface PublishModalProps {\n  open: boolean;\n  onClose: () => void;\n  project: BookProject | null;\n  currentChapter: Chapter | null;\n  onPublish: (type: 'chapter' | 'book') => void;\n}\n\nexport default function PublishModal({ open, onClose, project, currentChapter, onPublish }: PublishModalProps) {\n  const [publishType, setPublishType] = useState<'chapter' | 'book'>('book');\n\n  if (!open || !project) return null;\n\n  const totalWords = project.chapters.reduce((sum, ch) => {\n    const text = ch.content_html.replace(/<[^>]*>/g, '');\n    return sum + text.split(/\\s+/).filter(w => w.length > 0).length;\n  }, 0);\n\n  const currentChapterWords = currentChapter \n    ? currentChapter.content_html.replace(/<[^>]*>/g, '').split(/\\s+/).filter(w => w.length > 0).length\n    : 0;\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: 'rgba(0,0,0,0.7)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n      }}\n      onClick={onClose}\n    >\n      <div\n        onClick={(e) => e.stopPropagation()}\n        style={{\n          background: 'var(--panel)',\n          border: '1px solid var(--panel-border)',\n          borderRadius: 16,\n          padding: 32,\n          maxWidth: 500,\n          width: '90%',\n          maxHeight: '80vh',\n          overflowY: 'auto',\n        }}\n      >\n        <h2 style={{ color: 'var(--text)', marginBottom: 24, fontSize: 24, fontWeight: 700 }}>\n          Publish Your Work\n        </h2>\n\n        <div style={{ marginBottom: 24 }}>\n          <div style={{ color: '#94a3b8', fontSize: 14, marginBottom: 16 }}>\n            Choose how you want to publish:\n          </div>\n\n          {/* Publish Chapter Option */}\n          {currentChapter && (\n            <label\n              style={{\n                display: 'flex',\n                alignItems: 'flex-start',\n                gap: 12,\n                padding: 16,\n                background: publishType === 'chapter' ? 'rgba(245,158,11,0.1)' : 'var(--bg)',\n                border: publishType === 'chapter' ? '2px solid #f59e0b' : '1px solid var(--panel-border)',\n                borderRadius: 12,\n                cursor: 'pointer',\n                marginBottom: 12,\n              }}\n            >\n              <input\n                type=\"radio\"\n                name=\"publishType\"\n                value=\"chapter\"\n                checked={publishType === 'chapter'}\n                onChange={() => setPublishType('chapter')}\n                style={{ marginTop: 4 }}\n              />\n              <div style={{ flex: 1 }}>\n                <div style={{ fontWeight: 700, color: 'var(--text)', marginBottom: 4 }}>\n                  Publish This Chapter\n                </div>\n                <div style={{ fontSize: 12, color: '#94a3b8', marginBottom: 8 }}>\n                  {currentChapter.title || 'Untitled Chapter'}  {currentChapterWords} words\n                </div>\n                <div style={{ fontSize: 12, color: '#94a3b8' }}>\n                  Mint this chapter as a standalone NFT. Readers can collect individual chapters.\n                </div>\n              </div>\n            </label>\n          )}\n\n          {/* Publish Book Option */}\n          <label\n            style={{\n              display: 'flex',\n              alignItems: 'flex-start',\n              gap: 12,\n              padding: 16,\n              background: publishType === 'book' ? 'rgba(245,158,11,0.1)' : 'var(--bg)',\n              border: publishType === 'book' ? '2px solid #f59e0b' : '1px solid var(--panel-border)',\n              borderRadius: 12,\n              cursor: 'pointer',\n            }}\n          >\n            <input\n              type=\"radio\"\n              name=\"publishType\"\n              value=\"book\"\n              checked={publishType === 'book'}\n              onChange={() => setPublishType('book')}\n              style={{ marginTop: 4 }}\n            />\n            <div style={{ flex: 1 }}>\n              <div style={{ fontWeight: 700, color: 'var(--text)', marginBottom: 4 }}>\n                Publish Entire Book\n              </div>\n              <div style={{ fontSize: 12, color: '#94a3b8', marginBottom: 8 }}>\n                {project.title}  {project.chapters.length} chapters  {totalWords} words\n              </div>\n              <div style={{ fontSize: 12, color: '#94a3b8' }}>\n                Combine all chapters into one complete book NFT. Perfect for finished works.\n              </div>\n            </div>\n          </label>\n        </div>\n\n        {/* Action Buttons */}\n        <div style={{ display: 'flex', gap: 12, justifyContent: 'flex-end' }}>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'transparent',\n              border: '1px solid var(--panel-border)',\n              borderRadius: 8,\n              padding: '10px 20px',\n              color: 'var(--text)',\n              fontWeight: 600,\n              cursor: 'pointer',\n            }}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={() => onPublish(publishType)}\n            style={{\n              background: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n              border: 'none',\n              borderRadius: 8,\n              padding: '10px 20px',\n              color: '#fff',\n              fontWeight: 700,\n              cursor: 'pointer',\n            }}\n          >\n            Continue to Mint\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { bookApi, BookProject, Chapter } from '../../services/bookApi';\nimport ChapterList from './ChapterList';\nimport ChapterEditor from './ChapterEditor';\nimport PublishModal from './PublishModal';\nimport { Menu, X, Settings } from 'lucide-react';\n\ninterface BookEditorProps {\n  onPublish: (contentId: number) => void;\n  onBack: () => void;\n  existingContentId?: number; // If provided, load the book project for this content\n  existingBookProjectId?: number; // If provided, load the book project directly by ID\n}\n\nexport default function BookEditor({ onPublish, onBack, existingContentId, existingBookProjectId }: BookEditorProps) {\n  const navigate = useNavigate();\n  const [project, setProject] = useState<BookProject | null>(null);\n  const [chapters, setChapters] = useState<Chapter[]>([]);\n  const [selectedChapterId, setSelectedChapterId] = useState<number | null>(null);\n  const [saving, setSaving] = useState(false);\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\n  const [showPublishModal, setShowPublishModal] = useState(false);\n  const [error, setError] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n\n  // Mobile responsive state\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const [settingsOpen, setSettingsOpen] = useState(false);\n\n  // Handle window resize for mobile detection\n  useEffect(() => {\n    const handleResize = () => {\n      const mobile = window.innerWidth < 768;\n      setIsMobile(mobile);\n      // Close drawer when switching to desktop\n      if (!mobile) {\n        setDrawerOpen(false);\n        setSettingsOpen(false);\n      }\n    };\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Initialize: Create a new project or load existing\n  useEffect(() => {\n    initializeProject();\n  }, [existingContentId, existingBookProjectId]);\n\n  const initializeProject = async () => {\n    setLoading(true);\n    try {\n      if (existingBookProjectId) {\n        // Load existing project directly by ID\n        const existingProject = await bookApi.getProject(existingBookProjectId);\n        setProject(existingProject);\n        setChapters(existingProject.chapters || []);\n        // Select first unminted chapter or first chapter\n        const firstUnminted = existingProject.chapters?.find(ch => !ch.is_published);\n        if (firstUnminted) {\n          setSelectedChapterId(firstUnminted.id);\n        } else if (existingProject.chapters && existingProject.chapters.length > 0) {\n          setSelectedChapterId(existingProject.chapters[0].id);\n        }\n      } else if (existingContentId) {\n        // Load existing project by content ID\n        const existingProject = await bookApi.getProjectByContentId(existingContentId);\n        setProject(existingProject);\n        setChapters(existingProject.chapters || []);\n        // Select the target chapter if specified (when editing a specific chapter's content)\n        // Otherwise select first unminted chapter or first chapter\n        if (existingProject.target_chapter_id) {\n          setSelectedChapterId(existingProject.target_chapter_id);\n        } else {\n          const firstUnminted = existingProject.chapters?.find(ch => !ch.is_published);\n          if (firstUnminted) {\n            setSelectedChapterId(firstUnminted.id);\n          } else if (existingProject.chapters && existingProject.chapters.length > 0) {\n            setSelectedChapterId(existingProject.chapters[0].id);\n          }\n        }\n      } else {\n        // Create a new project\n        const newProject = await bookApi.createProject('Untitled Book', '');\n        setProject(newProject);\n        setChapters(newProject.chapters || []);\n      }\n    } catch (err: any) {\n      // If content was deleted (404), navigate back to studio home\n      if (err.message?.toLowerCase().includes('not found') || err.message?.includes('404')) {\n        console.log('[BookEditor] Content no longer exists, navigating back to studio');\n        onBack();\n      } else {\n        setError(err.message || 'Failed to initialize project');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAddChapter = async () => {\n    if (!project) return;\n\n    try {\n      const newChapter = await bookApi.createChapter(project.id, `Chapter ${chapters.length + 1}`);\n      // Use functional update to ensure latest state\n      setChapters(prevChapters => [...prevChapters, newChapter]);\n      setSelectedChapterId(newChapter.id);\n\n      // Force a small delay to ensure state updates complete before render\n      await new Promise(resolve => setTimeout(resolve, 100));\n    } catch (err: any) {\n      setError(err.message || 'Failed to add chapter');\n    }\n  };\n\n  const handleUpdateChapter = async (chapterId: number, title: string, content: string, synopsis?: string) => {\n    setSaving(true);\n    try {\n      const updateData: Partial<Chapter> = { title, content_html: content };\n      if (synopsis !== undefined) {\n        updateData.synopsis = synopsis;\n      }\n      const updatedChapter = await bookApi.updateChapter(chapterId, updateData);\n      setChapters(chapters.map(ch => ch.id === chapterId ? updatedChapter : ch));\n      setLastSaved(new Date());\n    } catch (err: any) {\n      setError(err.message || 'Failed to save chapter');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteChapter = async (chapterId: number) => {\n    if (!confirm('Are you sure you want to delete this chapter?')) return;\n    \n    try {\n      await bookApi.deleteChapter(chapterId);\n      setChapters(chapters.filter(ch => ch.id !== chapterId));\n      if (selectedChapterId === chapterId) {\n        setSelectedChapterId(chapters[0]?.id || null);\n      }\n    } catch (err: any) {\n      setError(err.message || 'Failed to delete chapter');\n    }\n  };\n\n  const handlePublish = async (type: 'chapter' | 'book') => {\n    if (!project) return;\n    \n    try {\n      let response;\n      if (type === 'chapter' && selectedChapterId) {\n        console.log('[BookEditor] Preparing chapter for mint:', selectedChapterId);\n        response = await bookApi.prepareChapterForMint(selectedChapterId);\n      } else {\n        console.log('[BookEditor] Preparing book for mint:', project.id);\n        response = await bookApi.prepareBookForMint(project.id);\n      }\n      \n      console.log('[BookEditor] Prepare response:', response);\n      console.log('[BookEditor] Calling onPublish with contentId:', response.content_id);\n      \n      setShowPublishModal(false);\n      onPublish(response.content_id);\n    } catch (err: any) {\n      console.error('[BookEditor] Publish error:', err);\n      setError(err.message || 'Failed to prepare for publishing');\n    }\n  };\n\n  const handleUpdateProjectTitle = async (title: string) => {\n    if (!project) return;\n    \n    try {\n      const updatedProject = await bookApi.updateProject(project.id, { title });\n      setProject(updatedProject);\n    } catch (err: any) {\n      setError(err.message || 'Failed to update project title');\n    }\n  };\n\n  const handleCoverImageUpload = async (file: File) => {\n    if (!project) return;\n    \n    try {\n      const updatedProject = await bookApi.uploadCoverImage(project.id, file);\n      setProject(updatedProject);\n    } catch (err: any) {\n      setError(err.message || 'Failed to upload cover image');\n    }\n  };\n\n  const selectedChapter = chapters.find(ch => ch.id === selectedChapterId) || null;\n\n  // Check if project can be deleted (no published chapters)\n  const hasPublishedChapters = chapters.some(ch => ch.is_published);\n  const canDeleteProject = !hasPublishedChapters;\n\n  const handleDeleteProject = async () => {\n    if (!project || !canDeleteProject) return;\n\n    const confirmMessage = chapters.length > 0\n      ? `Are you sure you want to delete \"${project.title}\"? This will permanently delete ${chapters.length} unpublished chapter(s).`\n      : `Are you sure you want to delete \"${project.title}\"?`;\n\n    if (!window.confirm(confirmMessage)) return;\n\n    try {\n      await bookApi.deleteProject(project.id);\n      navigate('/profile'); // Navigate to profile page after deletion\n    } catch (err: any) {\n      setError(err.message || 'Failed to delete project');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div style={{ \n        width: '100%', \n        height: '60vh', \n        display: 'flex', \n        alignItems: 'center', \n        justifyContent: 'center',\n        color: '#94a3b8',\n        fontSize: 16,\n      }}>\n        Loading book project...\n      </div>\n    );\n  }\n\n  // Helper function for handling chapter selection (closes drawer on mobile)\n  const handleChapterSelect = (chapterId: number) => {\n    setSelectedChapterId(chapterId);\n    if (isMobile) {\n      setDrawerOpen(false);\n    }\n  };\n\n  // Cover/Synopsis component (reused in drawer and settings modal)\n  const CoverSynopsisSection = () => (\n    <>\n      {/* Compact Cover Image */}\n      <div style={{\n        background: 'var(--panel)',\n        border: '1px solid var(--panel-border)',\n        borderRadius: 12,\n        padding: 12,\n        flexShrink: 0,\n      }}>\n        <div style={{\n          display: 'flex',\n          gap: 12,\n          alignItems: 'flex-start',\n        }}>\n          {/* Cover thumbnail */}\n          <div style={{\n            width: 60,\n            height: 80,\n            borderRadius: 6,\n            overflow: 'hidden',\n            background: '#1e1e1e',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            border: '1px solid var(--panel-border)',\n            flexShrink: 0,\n          }}>\n            {project?.cover_image_url ? (\n              <img\n                src={project.cover_image_url}\n                alt=\"Cover\"\n                style={{ width: '100%', height: '100%', objectFit: 'cover' }}\n              />\n            ) : (\n              <span style={{ color: '#4b5563', fontSize: 9 }}>No cover</span>\n            )}\n          </div>\n          {/* Cover info + upload */}\n          <div style={{ flex: 1, minWidth: 0 }}>\n            <div style={{ fontSize: 12, fontWeight: 600, color: 'var(--text)', marginBottom: 4 }}>\n              Book Cover\n            </div>\n            <div style={{ fontSize: 10, color: '#64748b', marginBottom: 8, lineHeight: 1.4 }}>\n              Recommended: 16002400px\n            </div>\n            <label style={{\n              display: 'inline-block',\n              background: 'transparent',\n              border: '1px solid var(--panel-border)',\n              borderRadius: 5,\n              padding: '4px 10px',\n              color: '#94a3b8',\n              fontWeight: 500,\n              cursor: 'pointer',\n              fontSize: 11,\n              transition: 'all 0.15s ease',\n            }}>\n              {project?.cover_image_url ? 'Change' : 'Upload'}\n              <input\n                type=\"file\"\n                accept=\"image/*\"\n                style={{ display: 'none' }}\n                onChange={(e) => {\n                  const file = e.target.files?.[0];\n                  if (file) handleCoverImageUpload(file);\n                }}\n              />\n            </label>\n          </div>\n        </div>\n      </div>\n\n      {/* Book Synopsis */}\n      <div style={{\n        background: 'var(--panel)',\n        border: '1px solid var(--panel-border)',\n        borderRadius: 12,\n        padding: 12,\n        flexShrink: 0,\n      }}>\n        <div style={{ fontSize: 12, fontWeight: 600, color: 'var(--text)', marginBottom: 8 }}>\n          Book Synopsis\n        </div>\n        <textarea\n          value={project?.description || ''}\n          onChange={(e) => {\n            if (project) {\n              setProject({ ...project, description: e.target.value });\n            }\n          }}\n          onBlur={async () => {\n            if (project) {\n              try {\n                await bookApi.updateProject(project.id, { description: project.description });\n              } catch (err) {\n                console.error('Failed to update synopsis:', err);\n              }\n            }\n          }}\n          placeholder=\"What is this book about? Write a compelling synopsis...\"\n          style={{\n            width: '100%',\n            minHeight: 80,\n            background: 'var(--bg)',\n            border: '1px solid var(--panel-border)',\n            borderRadius: 8,\n            padding: 10,\n            color: 'var(--text)',\n            fontSize: 12,\n            resize: 'vertical',\n            outline: 'none',\n          }}\n        />\n        <div style={{ fontSize: 10, color: '#64748b', marginTop: 4 }}>\n          {(project?.description || '').split(/\\s+/).filter(w => w).length}/200 words recommended\n        </div>\n      </div>\n    </>\n  );\n\n  return (\n    <div style={{\n      width: '100%',\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n      overflow: 'hidden',\n    }}>\n      {/* Mobile Header */}\n      {isMobile ? (\n        <div className=\"book-editor-mobile-header\">\n          <button\n            className=\"menu-btn\"\n            onClick={() => setDrawerOpen(true)}\n            title=\"Open chapters\"\n          >\n            <Menu size={20} />\n          </button>\n          <input\n            className=\"title-input\"\n            type=\"text\"\n            value={project?.title || ''}\n            onChange={(e) => {\n              if (project) {\n                setProject({ ...project, title: e.target.value });\n              }\n            }}\n            onBlur={(e) => handleUpdateProjectTitle(e.target.value)}\n            placeholder=\"Book Title\"\n          />\n          <button\n            className=\"settings-btn\"\n            onClick={() => setSettingsOpen(true)}\n            title=\"Book settings\"\n          >\n            <Settings size={18} />\n          </button>\n          <button\n            className=\"publish-btn\"\n            onClick={() => setShowPublishModal(true)}\n            disabled={chapters.length === 0}\n          >\n            Publish\n          </button>\n        </div>\n      ) : (\n        /* Desktop Header */\n        <div style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          padding: '16px 0',\n          flexShrink: 0,\n        }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: 16, flex: 1 }}>\n            <button\n              onClick={onBack}\n              style={{\n                background: 'transparent',\n                border: '1px solid var(--panel-border)',\n                borderRadius: 8,\n                padding: '8px 16px',\n                color: 'var(--text)',\n                cursor: 'pointer',\n                fontSize: 14,\n              }}\n            >\n               Back\n            </button>\n            <input\n              type=\"text\"\n              value={project?.title || ''}\n              onChange={(e) => {\n                if (project) {\n                  setProject({ ...project, title: e.target.value });\n                }\n              }}\n              onBlur={(e) => handleUpdateProjectTitle(e.target.value)}\n              placeholder=\"Book Title\"\n              style={{\n                background: 'transparent',\n                border: 'none',\n                color: 'var(--text)',\n                fontSize: 20,\n                fontWeight: 700,\n                outline: 'none',\n                flex: 1,\n              }}\n            />\n          </div>\n          <div style={{ display: 'flex', gap: 12 }}>\n            {canDeleteProject && (\n              <button\n                onClick={handleDeleteProject}\n                style={{\n                  background: 'transparent',\n                  border: '1px solid #ef4444',\n                  borderRadius: 8,\n                  padding: '8px 16px',\n                  color: '#ef4444',\n                  fontWeight: 600,\n                  cursor: 'pointer',\n                  fontSize: 14,\n                }}\n                title=\"Delete this book project\"\n              >\n                {chapters.length === 0 ? 'Cancel Project' : 'Delete Project'}\n              </button>\n            )}\n            {selectedChapterId && selectedChapter && (\n              <button\n                onClick={() => handleDeleteChapter(selectedChapterId)}\n                disabled={selectedChapter.is_published}\n                style={{\n                  background: 'transparent',\n                  border: selectedChapter.is_published ? '1px solid #6b7280' : '1px solid #ef4444',\n                  borderRadius: 8,\n                  padding: '8px 16px',\n                  color: selectedChapter.is_published ? '#6b7280' : '#ef4444',\n                  fontWeight: 600,\n                  cursor: selectedChapter.is_published ? 'not-allowed' : 'pointer',\n                  fontSize: 14,\n                  opacity: selectedChapter.is_published ? 0.5 : 1,\n                }}\n                title={selectedChapter.is_published ? 'Cannot delete a minted chapter' : 'Delete this chapter'}\n              >\n                Delete Chapter\n              </button>\n            )}\n            <button\n              onClick={() => setShowPublishModal(true)}\n              disabled={chapters.length === 0}\n              style={{\n                background: chapters.length === 0 ? '#6b7280' : 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n                border: 'none',\n                borderRadius: 8,\n                padding: '8px 20px',\n                color: '#fff',\n                fontWeight: 700,\n                cursor: chapters.length === 0 ? 'not-allowed' : 'pointer',\n                fontSize: 14,\n              }}\n            >\n              Publish\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Error Message */}\n      {error && (\n        <div style={{\n          background: 'rgba(239, 68, 68, 0.1)',\n          border: '1px solid #ef4444',\n          borderRadius: 8,\n          padding: 12,\n          color: '#ef4444',\n          fontSize: 14,\n          flexShrink: 0,\n          marginBottom: 16,\n        }}>\n          {error}\n          <button\n            onClick={() => setError('')}\n            style={{\n              background: 'transparent',\n              border: 'none',\n              color: '#ef4444',\n              cursor: 'pointer',\n              float: 'right',\n              fontWeight: 700,\n            }}\n          >\n            \n          </button>\n        </div>\n      )}\n\n      {/* Mobile Drawer */}\n      {isMobile && drawerOpen && (\n        <>\n          <div\n            className=\"book-editor-drawer-overlay\"\n            onClick={() => setDrawerOpen(false)}\n          />\n          <div className=\"book-editor-drawer\">\n            <div className=\"book-editor-drawer-header\">\n              <h3>{project?.title || 'Untitled Book'}</h3>\n              <button\n                className=\"book-editor-drawer-close\"\n                onClick={() => setDrawerOpen(false)}\n              >\n                <X size={20} />\n              </button>\n            </div>\n            <CoverSynopsisSection />\n            <ChapterList\n              chapters={chapters}\n              selectedChapterId={selectedChapterId}\n              onSelectChapter={handleChapterSelect}\n              onAddChapter={handleAddChapter}\n            />\n            {/* Back button in drawer */}\n            <button\n              onClick={onBack}\n              style={{\n                background: 'transparent',\n                border: '1px solid var(--panel-border)',\n                borderRadius: 8,\n                padding: '10px 16px',\n                color: 'var(--text)',\n                cursor: 'pointer',\n                fontSize: 14,\n                marginTop: 'auto',\n              }}\n            >\n               Back to Studio\n            </button>\n          </div>\n        </>\n      )}\n\n      {/* Mobile Settings Modal */}\n      {isMobile && settingsOpen && (\n        <div\n          className=\"book-settings-modal-overlay\"\n          onClick={() => setSettingsOpen(false)}\n        >\n          <div\n            className=\"book-settings-modal\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"book-settings-modal-header\">\n              <h3>Book Settings</h3>\n              <button\n                className=\"book-settings-modal-close\"\n                onClick={() => setSettingsOpen(false)}\n              >\n                <X size={20} />\n              </button>\n            </div>\n            <div style={{ display: 'flex', flexDirection: 'column', gap: 16 }}>\n              <CoverSynopsisSection />\n              {/* Delete buttons */}\n              {canDeleteProject && (\n                <button\n                  onClick={() => {\n                    setSettingsOpen(false);\n                    handleDeleteProject();\n                  }}\n                  style={{\n                    background: 'transparent',\n                    border: '1px solid #ef4444',\n                    borderRadius: 8,\n                    padding: '12px 16px',\n                    color: '#ef4444',\n                    fontWeight: 600,\n                    cursor: 'pointer',\n                    fontSize: 14,\n                  }}\n                >\n                  {chapters.length === 0 ? 'Cancel Project' : 'Delete Project'}\n                </button>\n              )}\n              {selectedChapterId && selectedChapter && !selectedChapter.is_published && (\n                <button\n                  onClick={() => {\n                    setSettingsOpen(false);\n                    handleDeleteChapter(selectedChapterId);\n                  }}\n                  style={{\n                    background: 'transparent',\n                    border: '1px solid #ef4444',\n                    borderRadius: 8,\n                    padding: '12px 16px',\n                    color: '#ef4444',\n                    fontWeight: 600,\n                    cursor: 'pointer',\n                    fontSize: 14,\n                  }}\n                >\n                  Delete Current Chapter\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Main Content: Conditional layout for mobile vs desktop */}\n      <div style={{\n        display: 'flex',\n        gap: isMobile ? 0 : 16,\n        flex: 1,\n        minHeight: 0,\n        overflow: 'hidden',\n      }}>\n        {/* Desktop Sidebar: Cover + Chapters */}\n        {!isMobile && (\n          <div style={{\n            width: 260,\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 12,\n            height: '100%',\n            overflow: 'hidden',\n          }}>\n            <CoverSynopsisSection />\n            <ChapterList\n              chapters={chapters}\n              selectedChapterId={selectedChapterId}\n              onSelectChapter={setSelectedChapterId}\n              onAddChapter={handleAddChapter}\n            />\n          </div>\n        )}\n\n        {/* Editor (full width on mobile) */}\n        <div style={{\n          flex: 1,\n          display: 'flex',\n          flexDirection: 'column',\n          height: '100%',\n          minHeight: 0,\n          overflow: 'hidden',\n        }}>\n          <ChapterEditor\n            chapter={selectedChapter}\n            onUpdateChapter={handleUpdateChapter}\n            saving={saving}\n            lastSaved={lastSaved}\n            showManagement={selectedChapter?.is_published}\n            onManagementChange={async () => {\n              if (project?.id) {\n                try {\n                  const updatedProject = await bookApi.getProject(project.id);\n                  setProject(updatedProject);\n                  setChapters(updatedProject.chapters || []);\n                  const chapterStillExists = updatedProject.chapters?.some(ch => ch.id === selectedChapterId);\n                  if (!chapterStillExists) {\n                    if (updatedProject.chapters && updatedProject.chapters.length > 0) {\n                      setSelectedChapterId(updatedProject.chapters[0].id);\n                    } else {\n                      setSelectedChapterId(null);\n                    }\n                  }\n                } catch (err) {\n                  onBack();\n                }\n              }\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Publish Modal */}\n      <PublishModal\n        open={showPublishModal}\n        onClose={() => setShowPublishModal(false)}\n        project={project}\n        currentChapter={selectedChapter}\n        onPublish={handlePublish}\n      />\n    </div>\n  );\n}\n\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { API_URL } from '../../config';\nimport {\n  collaborationApi,\n  CollaborativeProject,\n} from '../../services/collaborationApi';\nimport CollaborativeComicEditor from '../collaboration/CollaborativeComicEditor';\nimport { ArrowLeft, Loader2, Pencil, Trash2, Image, X } from 'lucide-react';\n\ninterface SoloComicEditorProps {\n  onPublish: (contentId: number) => void;\n  onBack: () => void;\n  existingProjectId?: number;\n}\n\ninterface User {\n  id: number;\n  username: string;\n  display_name?: string;\n}\n\nexport default function SoloComicEditor({\n  onPublish,\n  onBack,\n  existingProjectId,\n}: SoloComicEditorProps) {\n  const navigate = useNavigate();\n  const [project, setProject] = useState<CollaborativeProject | null>(null);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [publishing, setPublishing] = useState(false);\n  const [editingTitle, setEditingTitle] = useState(false);\n  const [titleValue, setTitleValue] = useState('');\n  const [savingTitle, setSavingTitle] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [deleting, setDeleting] = useState(false);\n  const [uploadingCover, setUploadingCover] = useState(false);\n  const [showCoverModal, setShowCoverModal] = useState(false);\n  const coverInputRef = useRef<HTMLInputElement>(null);\n\n  // Guard to prevent duplicate initialization (React StrictMode runs effects twice)\n  const isInitializingRef = useRef(false);\n  const hasInitializedRef = useRef(false);\n\n  useEffect(() => {\n    // Guard against React StrictMode double-invocation\n    if (hasInitializedRef.current || isInitializingRef.current) {\n      return;\n    }\n    initializeProject();\n  }, [existingProjectId]);\n\n  const initializeProject = async () => {\n    // Prevent concurrent calls (React StrictMode protection)\n    if (isInitializingRef.current) {\n      console.log('[SoloComicEditor] Skipping duplicate initializeProject call');\n      return;\n    }\n    isInitializingRef.current = true;\n\n    setLoading(true);\n    setError('');\n\n    try {\n      // 1. Get current user\n      const authRes = await fetch(`${API_URL}/api/auth/status/`, {\n        credentials: 'include',\n      });\n      const authData = await authRes.json();\n\n      if (!authData.authenticated || !authData.user) {\n        setError('You must be logged in to create a comic');\n        setLoading(false);\n        return;\n      }\n\n      setCurrentUser({\n        id: authData.user.id,\n        username: authData.user.username,\n        display_name: authData.user.display_name,\n      });\n\n      // 2. Load existing project or create new one\n      if (existingProjectId) {\n        const existingProject = await collaborationApi.getCollaborativeProject(\n          existingProjectId\n        );\n        setProject(existingProject);\n      } else {\n        // Create new solo comic project\n        const newProject = await collaborationApi.createCollaborativeProject({\n          title: 'Untitled Comic',\n          content_type: 'comic',\n          description: '',\n          is_solo: true,\n        });\n        setProject(newProject);\n      }\n      hasInitializedRef.current = true;\n    } catch (err: any) {\n      setError(err.message || 'Failed to initialize comic editor');\n    } finally {\n      setLoading(false);\n      isInitializingRef.current = false;\n    }\n  };\n\n  const handleProjectUpdate = (updatedProject: CollaborativeProject) => {\n    setProject(updatedProject);\n  };\n\n  const handleStartEditTitle = () => {\n    setTitleValue(project?.title || 'Untitled Comic');\n    setEditingTitle(true);\n  };\n\n  const handleSaveTitle = async () => {\n    if (!project || !titleValue.trim()) return;\n\n    const newTitle = titleValue.trim();\n    if (newTitle === project.title) {\n      setEditingTitle(false);\n      return;\n    }\n\n    setSavingTitle(true);\n    try {\n      const updated = await collaborationApi.updateCollaborativeProject(project.id, {\n        title: newTitle,\n      });\n      setProject(updated);\n      setEditingTitle(false);\n    } catch (err: any) {\n      setError(err.message || 'Failed to update title');\n    } finally {\n      setSavingTitle(false);\n    }\n  };\n\n  const handleTitleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleSaveTitle();\n    } else if (e.key === 'Escape') {\n      setEditingTitle(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!project) return;\n\n    setDeleting(true);\n    try {\n      await collaborationApi.deleteCollaborativeProject(project.id);\n      // Navigate to profile page after deletion\n      navigate('/profile');\n    } catch (err: any) {\n      setError(err.message || 'Failed to delete comic');\n      setDeleting(false);\n      setShowDeleteConfirm(false);\n    }\n  };\n\n  const handleCoverUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file || !project) return;\n\n    // Validate file type\n    const validTypes = ['image/png', 'image/jpeg', 'image/webp', 'image/gif'];\n    if (!validTypes.includes(file.type)) {\n      setError('Cover image must be PNG, JPG, WebP, or GIF');\n      return;\n    }\n\n    // Validate file size (10MB max)\n    if (file.size > 10 * 1024 * 1024) {\n      setError('Cover image must be under 10MB');\n      return;\n    }\n\n    setUploadingCover(true);\n    setError('');\n\n    try {\n      const formData = new FormData();\n      formData.append('cover_image', file);\n\n      const csrfToken = await getCsrfToken();\n      const response = await fetch(\n        `${API_URL}/api/collaborative-projects/${project.id}/`,\n        {\n          method: 'PATCH',\n          credentials: 'include',\n          headers: {\n            'X-CSRFToken': csrfToken,\n            'X-Requested-With': 'XMLHttpRequest',\n          },\n          body: formData,\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to upload cover image');\n      }\n\n      const updated = await response.json();\n      setProject(updated);\n      setShowCoverModal(false);\n    } catch (err: any) {\n      setError(err.message || 'Failed to upload cover image');\n    } finally {\n      setUploadingCover(false);\n      if (coverInputRef.current) {\n        coverInputRef.current.value = '';\n      }\n    }\n  };\n\n  // Helper to get CSRF token\n  const getCsrfToken = async () => {\n    const res = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' });\n    const data = await res.json();\n    return data?.csrfToken || '';\n  };\n\n  const handlePublish = async () => {\n    if (!project) return;\n\n    setPublishing(true);\n    setError('');\n\n    try {\n      // Prepare comic for minting - creates Content record\n      const response = await fetch(\n        `${API_URL}/api/collaborative-projects/${project.id}/prepare_comic_for_mint/`,\n        {\n          method: 'POST',\n          credentials: 'include',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-CSRFToken': await getCsrfToken(),\n            'X-Requested-With': 'XMLHttpRequest',\n          },\n        }\n      );\n\n      if (!response.ok) {\n        const errData = await response.json();\n        throw new Error(errData.error || 'Failed to prepare comic for publishing');\n      }\n\n      const data = await response.json();\n      onPublish(data.content_id);\n    } catch (err: any) {\n      setError(err.message || 'Failed to publish comic');\n      setPublishing(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: 400 }}>\n        <Loader2 size={32} className=\"animate-spin\" style={{ color: '#f59e0b' }} />\n        <span style={{ marginLeft: 12, color: '#94a3b8' }}>Loading comic editor...</span>\n      </div>\n    );\n  }\n\n  if (error && !project) {\n    return (\n      <div style={{ padding: 32, textAlign: 'center' }}>\n        <p style={{ color: '#ef4444', marginBottom: 16 }}>{error}</p>\n        <button\n          onClick={onBack}\n          style={{\n            color: '#3b82f6',\n            background: 'none',\n            border: 'none',\n            cursor: 'pointer',\n            textDecoration: 'underline',\n          }}\n        >\n          Go Back\n        </button>\n      </div>\n    );\n  }\n\n  if (!project || !currentUser) {\n    return null;\n  }\n\n  return (\n    <div style={{ height: 'calc(100vh - 80px)', display: 'flex', flexDirection: 'column' }}>\n      {/* Header with back button and publish */}\n      <div\n        style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          padding: '12px 24px',\n          borderBottom: '1px solid var(--panel-border)',\n          background: 'var(--panel)',\n        }}\n      >\n        <button\n          onClick={onBack}\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            background: 'none',\n            border: 'none',\n            color: '#94a3b8',\n            cursor: 'pointer',\n            fontSize: 14,\n          }}\n        >\n          <ArrowLeft size={18} />\n          Back to Studio\n        </button>\n\n        <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\n          {editingTitle ? (\n            <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>\n              <input\n                type=\"text\"\n                value={titleValue}\n                onChange={(e) => setTitleValue(e.target.value)}\n                onKeyDown={handleTitleKeyDown}\n                onBlur={handleSaveTitle}\n                autoFocus\n                style={{\n                  background: 'var(--bg-secondary, #1e293b)',\n                  border: '1px solid #3b82f6',\n                  borderRadius: 4,\n                  color: '#e2e8f0',\n                  fontSize: 13,\n                  padding: '4px 8px',\n                  minWidth: 150,\n                  outline: 'none',\n                }}\n              />\n              {savingTitle && <Loader2 size={14} className=\"animate-spin\" style={{ color: '#3b82f6' }} />}\n            </div>\n          ) : (\n            <button\n              onClick={handleStartEditTitle}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: 6,\n                background: 'none',\n                border: 'none',\n                color: '#94a3b8',\n                cursor: 'pointer',\n                fontSize: 13,\n                padding: '4px 8px',\n                borderRadius: 4,\n              }}\n              onMouseEnter={(e) => (e.currentTarget.style.background = 'rgba(255,255,255,0.05)')}\n              onMouseLeave={(e) => (e.currentTarget.style.background = 'none')}\n              title=\"Click to edit title\"\n            >\n              {project.title || 'Untitled Comic'}\n              <Pencil size={12} style={{ opacity: 0.6 }} />\n            </button>\n          )}\n          {/* Cover Art Button */}\n          <button\n            onClick={() => setShowCoverModal(true)}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 6,\n              background: project.cover_image ? '#3b82f6' : 'transparent',\n              border: '1px solid #3b82f6',\n              borderRadius: 6,\n              padding: '6px 12px',\n              color: project.cover_image ? '#fff' : '#3b82f6',\n              cursor: 'pointer',\n              fontSize: 12,\n              fontWeight: 500,\n            }}\n            title=\"Set cover image\"\n          >\n            <Image size={14} />\n            {project.cover_image ? 'Cover Set' : 'Add Cover'}\n          </button>\n          {/* Delete Button */}\n          <button\n            onClick={() => setShowDeleteConfirm(true)}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 6,\n              background: 'transparent',\n              border: '1px solid #ef4444',\n              borderRadius: 6,\n              padding: '6px 12px',\n              color: '#ef4444',\n              cursor: 'pointer',\n              fontSize: 12,\n              fontWeight: 500,\n            }}\n            title=\"Delete comic\"\n          >\n            <Trash2 size={14} />\n            Delete\n          </button>\n          <button\n            onClick={handlePublish}\n            disabled={publishing}\n            style={{\n              background: publishing ? '#6b7280' : '#22c55e',\n              color: '#fff',\n              border: 'none',\n              borderRadius: 8,\n              padding: '8px 16px',\n              fontSize: 14,\n              fontWeight: 600,\n              cursor: publishing ? 'not-allowed' : 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n            }}\n          >\n            {publishing && <Loader2 size={16} className=\"animate-spin\" />}\n            {publishing ? 'Preparing...' : 'Publish Comic'}\n          </button>\n        </div>\n      </div>\n\n      {/* Error banner */}\n      {error && (\n        <div\n          style={{\n            background: 'rgba(239, 68, 68, 0.1)',\n            border: '1px solid #ef4444',\n            color: '#ef4444',\n            padding: '8px 16px',\n            fontSize: 13,\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n          }}\n        >\n          <span>{error}</span>\n          <button\n            onClick={() => setError('')}\n            style={{\n              background: 'none',\n              border: 'none',\n              color: '#ef4444',\n              cursor: 'pointer',\n              fontSize: 12,\n            }}\n          >\n            Dismiss\n          </button>\n        </div>\n      )}\n\n      {/* Comic Editor */}\n      <div style={{ flex: 1, overflow: 'hidden' }}>\n        <CollaborativeComicEditor\n          project={project}\n          currentUser={currentUser}\n          onProjectUpdate={handleProjectUpdate}\n        />\n      </div>\n\n      {/* Delete Confirmation Modal */}\n      {showDeleteConfirm && (\n        <div\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            background: 'rgba(0, 0, 0, 0.7)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            zIndex: 1000,\n          }}\n          onClick={() => !deleting && setShowDeleteConfirm(false)}\n        >\n          <div\n            style={{\n              background: 'var(--panel, #1e293b)',\n              borderRadius: 12,\n              padding: 24,\n              maxWidth: 400,\n              width: '90%',\n            }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <h3 style={{\n              margin: 0,\n              marginBottom: 16,\n              fontSize: 18,\n              fontWeight: 700,\n              color: '#e2e8f0',\n            }}>\n              Delete \"{project.title}\"?\n            </h3>\n            <p style={{\n              margin: 0,\n              marginBottom: 24,\n              fontSize: 14,\n              color: '#94a3b8',\n              lineHeight: 1.5,\n            }}>\n              This will permanently delete this comic and all its pages. This action cannot be undone.\n            </p>\n            <div style={{ display: 'flex', gap: 12, justifyContent: 'flex-end' }}>\n              <button\n                onClick={() => setShowDeleteConfirm(false)}\n                disabled={deleting}\n                style={{\n                  background: 'transparent',\n                  border: '1px solid #334155',\n                  borderRadius: 6,\n                  padding: '10px 20px',\n                  color: '#e2e8f0',\n                  fontWeight: 600,\n                  cursor: deleting ? 'not-allowed' : 'pointer',\n                  fontSize: 13,\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleDelete}\n                disabled={deleting}\n                style={{\n                  background: '#ef4444',\n                  border: 'none',\n                  borderRadius: 6,\n                  padding: '10px 20px',\n                  color: '#fff',\n                  fontWeight: 600,\n                  cursor: deleting ? 'not-allowed' : 'pointer',\n                  fontSize: 13,\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 8,\n                }}\n              >\n                {deleting && <Loader2 size={14} className=\"animate-spin\" />}\n                {deleting ? 'Deleting...' : 'Delete Comic'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Cover Upload Modal */}\n      {showCoverModal && (\n        <div\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            background: 'rgba(0, 0, 0, 0.7)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            zIndex: 1000,\n          }}\n          onClick={() => !uploadingCover && setShowCoverModal(false)}\n        >\n          <div\n            style={{\n              background: 'var(--panel, #1e293b)',\n              borderRadius: 12,\n              padding: 24,\n              maxWidth: 500,\n              width: '90%',\n            }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div style={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              marginBottom: 16,\n            }}>\n              <h3 style={{\n                margin: 0,\n                fontSize: 18,\n                fontWeight: 700,\n                color: '#e2e8f0',\n              }}>\n                Cover Image\n              </h3>\n              <button\n                onClick={() => setShowCoverModal(false)}\n                style={{\n                  background: 'none',\n                  border: 'none',\n                  color: '#64748b',\n                  cursor: 'pointer',\n                  padding: 4,\n                }}\n              >\n                <X size={20} />\n              </button>\n            </div>\n\n            {/* Current Cover Preview */}\n            {project.cover_image && (\n              <div style={{ marginBottom: 16 }}>\n                <p style={{ fontSize: 12, color: '#64748b', marginBottom: 8 }}>Current cover:</p>\n                <img\n                  src={project.cover_image}\n                  alt=\"Current cover\"\n                  style={{\n                    width: '100%',\n                    maxHeight: 200,\n                    objectFit: 'contain',\n                    borderRadius: 8,\n                    background: '#0f172a',\n                  }}\n                />\n              </div>\n            )}\n\n            {/* Upload Area */}\n            <div\n              style={{\n                border: '2px dashed #334155',\n                borderRadius: 8,\n                padding: 32,\n                textAlign: 'center',\n                cursor: 'pointer',\n              }}\n              onClick={() => coverInputRef.current?.click()}\n            >\n              <input\n                ref={coverInputRef}\n                type=\"file\"\n                accept=\"image/png,image/jpeg,image/webp,image/gif\"\n                onChange={handleCoverUpload}\n                style={{ display: 'none' }}\n              />\n              {uploadingCover ? (\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8 }}>\n                  <Loader2 size={24} className=\"animate-spin\" style={{ color: '#3b82f6' }} />\n                  <span style={{ color: '#94a3b8' }}>Uploading...</span>\n                </div>\n              ) : (\n                <>\n                  <Image size={32} style={{ color: '#64748b', marginBottom: 12 }} />\n                  <p style={{ margin: 0, fontSize: 14, color: '#94a3b8', marginBottom: 4 }}>\n                    Click to upload cover image\n                  </p>\n                  <p style={{ margin: 0, fontSize: 12, color: '#64748b' }}>\n                    PNG, JPG, WebP, or GIF (max 10MB)\n                  </p>\n                </>\n              )}\n            </div>\n\n            <p style={{\n              margin: 0,\n              marginTop: 12,\n              fontSize: 12,\n              color: '#64748b',\n              textAlign: 'center',\n            }}>\n              Recommended size: 800x1200 pixels (portrait orientation)\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useState, useCallback, useEffect, useMemo } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\nimport { API_URL } from '../../config';\nimport TypeSelect from './TypeSelect';\nimport CreateStep from './CreateStep';\nimport CustomizeStep from './CustomizeStep';\nimport ConfigureStep from './ConfigureStep';\nimport MintStep from './MintStep';\nimport ShareStep from './ShareStep';\nimport StepIndicator from './StepIndicator';\nimport BookEditor from '../BookEditor/BookEditor';\nimport SoloComicEditor from './SoloComicEditor';\nimport './CreateWizard.css';\n\ntype Payload = { title: string; type: 'text' | 'image' | 'video'; file?: File; textHtml?: string };\ntype FlowMode = 'full' | 'publish';\n\n// Step configurations for each flow\nconst FULL_FLOW_STEPS = ['Type', 'Create/Upload', 'Customize', 'Review', 'Share'];\nconst PUBLISH_FLOW_STEPS = ['Configure', 'Review', 'Share'];\n\nexport default function CreateWizard() {\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  // Flow mode: 'full' for fresh uploads, 'publish' when content already exists\n  const [flowMode, setFlowMode] = useState<FlowMode>('full');\n  const [step, setStep] = useState(0);\n  const [ctype, setCtype] = useState<'text' | 'image' | 'video' | 'comic' | 'none'>('none');\n  const [, setPayload] = useState<Payload | undefined>();\n  const [contentId, setContentId] = useState<number | undefined>();\n  const [msg, setMsg] = useState('');\n  const [maxStep, setMaxStep] = useState(0);\n  const [showBookEditor, setShowBookEditor] = useState(false);\n  const [showComicEditor, setShowComicEditor] = useState(false);\n  const [comicProjectId, setComicProjectId] = useState<number | undefined>(undefined);\n  const [minted, setMinted] = useState(false);\n\n  // Get current step labels based on flow mode\n  const steps = useMemo(() => (flowMode === 'publish' ? PUBLISH_FLOW_STEPS : FULL_FLOW_STEPS), [flowMode]);\n\n  // Check for mintContent parameter (from book editor publish flow)\n  useEffect(() => {\n    const mintContentParam = searchParams.get('mintContent');\n    if (mintContentParam) {\n      const contentIdFromParam = parseInt(mintContentParam, 10);\n      if (!isNaN(contentIdFromParam)) {\n        // Set content ID and switch to publish flow\n        setContentId(contentIdFromParam);\n        setFlowMode('publish');\n        setStep(0); // First step in publish flow (Configure)\n        setMaxStep(0);\n        // Clear the parameter from URL to prevent re-triggering\n        navigate('/studio?mode=solo', { replace: true });\n      }\n    }\n  }, [searchParams, navigate]);\n\n  // Check for projectId parameter (for editing existing comic projects)\n  useEffect(() => {\n    const typeParam = searchParams.get('type');\n    const projectIdParam = searchParams.get('projectId');\n    if (typeParam === 'comic' && projectIdParam) {\n      const projectId = parseInt(projectIdParam, 10);\n      if (!isNaN(projectId)) {\n        setComicProjectId(projectId);\n        setShowComicEditor(true);\n        setCtype('comic');\n      }\n    }\n  }, [searchParams]);\n\n  async function fetchCsrf() {\n    try {\n      const t = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' }).then(r => r.json());\n      return t?.csrfToken || '';\n    } catch {\n      return '';\n    }\n  }\n\n  const createContent = async (p: Payload) => {\n    const form = new FormData();\n    form.append('title', p.title);\n    const mapped = p.type === 'text' ? 'book' : (p.type === 'image' ? 'art' : 'film');\n    form.append('content_type', mapped);\n    if (p.file) {\n      form.append('file', p.file);\n    } else if (p.type === 'text' && p.textHtml) {\n      form.append('text', p.textHtml);\n    }\n    form.append('genre', 'other');\n    const csrf = await fetchCsrf();\n    const res = await fetch(`${API_URL}/api/content/`, {\n      method: 'POST',\n      headers: { 'X-CSRFToken': csrf, 'X-Requested-With': 'XMLHttpRequest' },\n      body: form,\n      credentials: 'include'\n    });\n    if (res.ok) {\n      const d = await res.json();\n      setContentId(d.id || d.pk);\n      setMsg('Created');\n      setStep(2); // Go to Customize step in full flow\n    } else {\n      setMsg('Create failed');\n    }\n  };\n\n  const doMint = async () => {\n    const csrf = await fetchCsrf();\n    const res = await fetch(`${API_URL}/api/mint/`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json', 'X-CSRFToken': csrf, 'X-Requested-With': 'XMLHttpRequest' },\n      body: JSON.stringify({ content_id: contentId, royalties: [] }),\n      credentials: 'include'\n    });\n    if (res.ok) {\n      setMinted(true);\n      // Move to Share step\n      if (flowMode === 'publish') {\n        setStep(2); // Share is step 2 in publish flow\n      } else {\n        setStep(4); // Share is step 4 in full flow\n      }\n    } else {\n      setMsg('Mint failed');\n    }\n  };\n\n  // Allow global Next placement (footer) by registering per-step submit\n  const [submitCurrent, setSubmitCurrent] = useState<(() => void) | null>(null);\n  const [collectCustomize, setCollectCustomize] = useState<(() => {\n    teaserPercent: number;\n    watermark: boolean;\n    price: number;\n    editions: number;\n    authorsNote: string;\n    tagIds: number[];\n    splits: any[];\n  }) | null>(null);\n\n  const registerSubmit = useCallback((fn: () => void) => { setSubmitCurrent(() => fn); }, []);\n  const registerCustomize = useCallback((fn: () => {\n    teaserPercent: number;\n    watermark: boolean;\n    price: number;\n    editions: number;\n    authorsNote: string;\n    tagIds: number[];\n    splits: any[];\n  }) => { setCollectCustomize(() => fn); }, []);\n\n  // Handle book editor publish\n  const handleBookPublish = (publishedContentId: number) => {\n    setContentId(publishedContentId);\n    setShowBookEditor(false);\n    setFlowMode('publish');\n    setStep(0); // First step in publish flow (Configure)\n    setMaxStep(0);\n  };\n\n  // Handle comic editor publish\n  const handleComicPublish = (publishedContentId: number) => {\n    setContentId(publishedContentId);\n    setShowComicEditor(false);\n    setFlowMode('publish');\n    setStep(0); // First step in publish flow (Configure)\n    setMaxStep(0);\n  };\n\n  // Save customizations helper\n  const saveCustomizations = async () => {\n    if (!collectCustomize || !contentId) return;\n\n    const c = collectCustomize();\n    const csrf = await fetchCsrf();\n    const body = JSON.stringify({\n      price_usd: c.price,\n      editions: c.editions,\n      teaser_percent: c.teaserPercent,\n      watermark_preview: c.watermark,\n      authors_note: c.authorsNote || '',\n      tag_ids: c.tagIds || [],\n    });\n\n    await fetch(`${API_URL}/api/content/detail/${contentId}/`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json', 'X-CSRFToken': csrf, 'X-Requested-With': 'XMLHttpRequest' },\n      credentials: 'include',\n      body\n    });\n  };\n\n  // If book editor is active, show it instead of the wizard\n  if (showBookEditor) {\n    return (\n      <BookEditor\n        onPublish={handleBookPublish}\n        onBack={() => {\n          setShowBookEditor(false);\n          setCtype('none');\n          setStep(0);\n        }}\n      />\n    );\n  }\n\n  // If comic editor is active, show it instead of the wizard\n  if (showComicEditor) {\n    return (\n      <SoloComicEditor\n        onPublish={handleComicPublish}\n        onBack={() => {\n          setShowComicEditor(false);\n          setComicProjectId(undefined);\n          setCtype('none');\n          setStep(0);\n        }}\n        existingProjectId={comicProjectId}\n      />\n    );\n  }\n\n  // Calculate actual step index for rendering components\n  // In publish flow: 0=Configure, 1=Review, 2=Share\n  // In full flow: 0=Type, 1=Create, 2=Customize, 3=Review, 4=Share\n  const renderFullFlow = flowMode === 'full';\n  const renderPublishFlow = flowMode === 'publish';\n\n  return (\n    <div className=\"create-wizard\">\n      {/* Step Indicator */}\n      <StepIndicator\n        steps={steps}\n        currentStep={step}\n        maxStep={maxStep}\n        onStepClick={(i) => i <= maxStep && setStep(i)}\n      />\n\n      {/* Navigation buttons - only show in full flow */}\n      {renderFullFlow && step >= 1 && (\n        <div className=\"wizard-nav\">\n          <button\n            onClick={() => setStep(Math.max(0, step - 1))}\n            className=\"back-btn\"\n          >\n            Back\n          </button>\n          <button\n            onClick={() => {\n              setCtype('none');\n              setPayload(undefined);\n              setContentId(undefined);\n              setStep(0);\n              setFlowMode('full');\n            }}\n            className=\"change-type-btn\"\n          >\n            Change type\n          </button>\n        </div>\n      )}\n\n      {/* Publish flow navigation - simpler, just back */}\n      {renderPublishFlow && step >= 1 && !minted && (\n        <div className=\"wizard-nav\">\n          <button\n            onClick={() => setStep(Math.max(0, step - 1))}\n            className=\"back-btn\"\n          >\n            Back\n          </button>\n        </div>\n      )}\n\n      {/* FULL FLOW STEPS */}\n      {renderFullFlow && step === 0 && (\n        <TypeSelect onSelect={(t) => {\n          setCtype(t);\n          if (t === 'text') {\n            setShowBookEditor(true);\n          } else if (t === 'comic') {\n            setShowComicEditor(true);\n          } else {\n            setMaxStep(Math.max(maxStep, 0));\n            setStep(1);\n          }\n        }} />\n      )}\n\n      {renderFullFlow && step === 1 && ctype !== 'none' && ctype !== 'comic' && (\n        <CreateStep\n          type={ctype}\n          registerSubmit={registerSubmit}\n          showNextButton={false}\n          onReady={(p) => {\n            setPayload({ title: p.title, type: ctype, file: p.file, textHtml: p.textHtml });\n            setMaxStep(Math.max(maxStep, 1));\n            createContent({ title: p.title, type: ctype, file: p.file, textHtml: p.textHtml });\n          }}\n        />\n      )}\n\n      {renderFullFlow && step === 2 && (\n        <CustomizeStep\n          registerSubmit={registerCustomize}\n          onNext={async (c) => {\n            try {\n              const csrf = await fetchCsrf();\n              const body = JSON.stringify({\n                price_usd: c.price,\n                editions: c.editions,\n                teaser_percent: c.teaserPercent,\n                watermark_preview: c.watermark,\n                authors_note: c.authorsNote || '',\n              });\n              await fetch(`${API_URL}/api/content/detail/${contentId}/`, {\n                method: 'PATCH',\n                headers: { 'Content-Type': 'application/json', 'X-CSRFToken': csrf, 'X-Requested-With': 'XMLHttpRequest' },\n                credentials: 'include',\n                body\n              });\n            } catch (_) { }\n            setMaxStep(Math.max(maxStep, 2));\n            setStep(3);\n          }}\n        />\n      )}\n\n      {renderFullFlow && step === 3 && (\n        <MintStep\n          contentId={contentId}\n          price={collectCustomize ? collectCustomize().price : undefined}\n          editions={collectCustomize ? collectCustomize().editions : undefined}\n          onMint={() => {\n            setMaxStep(Math.max(maxStep, 3));\n            doMint();\n          }}\n        />\n      )}\n\n      {renderFullFlow && step === 4 && (\n        <ShareStep\n          contentId={contentId}\n          minted={minted}\n          onPublish={async () => {\n            const csrf = await fetchCsrf();\n            const res = await fetch(`${API_URL}/api/mint/`, {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json', 'X-CSRFToken': csrf, 'X-Requested-With': 'XMLHttpRequest' },\n              body: JSON.stringify({ content_id: contentId }),\n              credentials: 'include'\n            });\n            if (res.ok) {\n              setMinted(true);\n              setMsg('Published');\n            }\n          }}\n        />\n      )}\n\n      {/* PUBLISH FLOW STEPS */}\n      {renderPublishFlow && step === 0 && (\n        <ConfigureStep\n          contentId={contentId}\n          registerSubmit={registerCustomize}\n        />\n      )}\n\n      {renderPublishFlow && step === 1 && (\n        <MintStep\n          contentId={contentId}\n          price={collectCustomize ? collectCustomize().price : undefined}\n          editions={collectCustomize ? collectCustomize().editions : undefined}\n          onMint={() => {\n            setMaxStep(Math.max(maxStep, 1));\n            doMint();\n          }}\n        />\n      )}\n\n      {renderPublishFlow && step === 2 && (\n        <ShareStep\n          contentId={contentId}\n          minted={minted}\n          onPublish={async () => {\n            const csrf = await fetchCsrf();\n            const res = await fetch(`${API_URL}/api/mint/`, {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json', 'X-CSRFToken': csrf, 'X-Requested-With': 'XMLHttpRequest' },\n              body: JSON.stringify({ content_id: contentId }),\n              credentials: 'include'\n            });\n            if (res.ok) {\n              setMinted(true);\n              setMsg('Published');\n            }\n          }}\n        />\n      )}\n\n      {/* Footer with Next buttons */}\n      <div className=\"wizard-footer\">\n        <div className=\"wizard-message\">{msg}</div>\n\n        {/* Full flow: step 1 Next button */}\n        {renderFullFlow && step === 1 && (\n          <button\n            onClick={() => submitCurrent && submitCurrent()}\n            className=\"next-btn\"\n          >\n            Next\n          </button>\n        )}\n\n        {/* Full flow: step 2 Next button */}\n        {renderFullFlow && step === 2 && (\n          <button\n            onClick={async () => {\n              setMaxStep(Math.max(maxStep, 2));\n              await saveCustomizations();\n              setStep(3);\n            }}\n            className=\"next-btn\"\n          >\n            Next\n          </button>\n        )}\n\n        {/* Publish flow: step 0 (Configure) Next button */}\n        {renderPublishFlow && step === 0 && (\n          <button\n            onClick={async () => {\n              setMaxStep(Math.max(maxStep, 0));\n              await saveCustomizations();\n              setStep(1);\n            }}\n            className=\"next-btn\"\n          >\n            Next\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\n * Legal API service for fetching and accepting legal documents.\n */\n\nimport { API_URL } from '../config';\n\nexport type DocumentType = 'tos' | 'privacy' | 'creator_agreement' | 'content_policy' | 'dmca' | 'cookie_policy';\n\nexport interface LegalDocument {\n  document_type: DocumentType;\n  document_type_display: string;\n  version: string;\n  content: string;\n  effective_date: string;\n  summary_of_changes: string;\n}\n\nexport interface AcceptanceStatus {\n  accepted: boolean;\n  version: string | null;\n  accepted_at: string | null;\n  display_name?: string;\n}\n\nexport interface PendingAcceptance {\n  document_type: DocumentType;\n  version: string;\n  document_id: number;\n}\n\n/**\n * Fetch a legal document by type.\n */\nexport async function getLegalDocument(documentType: DocumentType): Promise<LegalDocument> {\n  const response = await fetch(`${API_URL}/api/legal/documents/${documentType}/`, {\n    credentials: 'include',\n  });\n\n  if (!response.ok) {\n    throw new Error(`Failed to fetch legal document: ${documentType}`);\n  }\n\n  return response.json();\n}\n\n/**\n * Accept a legal document.\n */\nexport async function acceptLegalDocument(documentType: DocumentType): Promise<{\n  accepted: boolean;\n  document_type: DocumentType;\n  version: string;\n  accepted_at: string;\n}> {\n  // Get CSRF token\n  const csrfRes = await fetch(`${API_URL}/api/auth/csrf/`, { credentials: 'include' });\n  const csrfData = await csrfRes.json();\n  const csrf = csrfData?.csrfToken || '';\n\n  const response = await fetch(`${API_URL}/api/legal/accept/`, {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-CSRFToken': csrf,\n      'X-Requested-With': 'XMLHttpRequest',\n    },\n    body: JSON.stringify({ document_type: documentType }),\n  });\n\n  if (!response.ok) {\n    throw new Error(`Failed to accept legal document: ${documentType}`);\n  }\n\n  return response.json();\n}\n\n/**\n * Check acceptance status for a specific document type.\n */\nexport async function checkAcceptance(documentType: DocumentType): Promise<AcceptanceStatus> {\n  const response = await fetch(\n    `${API_URL}/api/legal/check-acceptance/?document_type=${documentType}`,\n    { credentials: 'include' }\n  );\n\n  if (!response.ok) {\n    throw new Error(`Failed to check acceptance: ${documentType}`);\n  }\n\n  return response.json();\n}\n\n/**\n * Check acceptance status for all document types.\n */\nexport async function checkAllAcceptances(): Promise<Record<DocumentType, AcceptanceStatus>> {\n  const response = await fetch(`${API_URL}/api/legal/check-acceptance/`, {\n    credentials: 'include',\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed to check all acceptances');\n  }\n\n  return response.json();\n}\n\n/**\n * Get list of documents pending user acceptance.\n */\nexport async function getPendingAcceptances(): Promise<{\n  pending: PendingAcceptance[];\n  has_pending: boolean;\n}> {\n  const response = await fetch(`${API_URL}/api/legal/pending-acceptances/`, {\n    credentials: 'include',\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed to get pending acceptances');\n  }\n\n  return response.json();\n}\n\n/**\n * Check if user has accepted the creator agreement.\n */\nexport async function getCreatorAgreementStatus(): Promise<{\n  has_accepted: boolean;\n  accepted_at: string | null;\n  version: string | null;\n}> {\n  const response = await fetch(`${API_URL}/api/legal/creator-agreement-status/`, {\n    credentials: 'include',\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed to get creator agreement status');\n  }\n\n  return response.json();\n}\n","/**\n * Hook for checking and managing legal document acceptances.\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n  DocumentType,\n  AcceptanceStatus,\n  checkAcceptance,\n  checkAllAcceptances,\n  acceptLegalDocument,\n  getCreatorAgreementStatus,\n} from '../services/legalApi';\n\ninterface UseLegalAcceptanceResult {\n  loading: boolean;\n  error: string | null;\n  hasAccepted: boolean;\n  acceptance: AcceptanceStatus | null;\n  accept: () => Promise<boolean>;\n  refresh: () => Promise<void>;\n}\n\n/**\n * Check acceptance status for a specific document type.\n */\nexport function useLegalAcceptance(documentType: DocumentType): UseLegalAcceptanceResult {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [acceptance, setAcceptance] = useState<AcceptanceStatus | null>(null);\n\n  const refresh = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const status = await checkAcceptance(documentType);\n      setAcceptance(status);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to check acceptance');\n    } finally {\n      setLoading(false);\n    }\n  }, [documentType]);\n\n  useEffect(() => {\n    refresh();\n  }, [refresh]);\n\n  const accept = useCallback(async (): Promise<boolean> => {\n    try {\n      await acceptLegalDocument(documentType);\n      await refresh();\n      return true;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to accept document');\n      return false;\n    }\n  }, [documentType, refresh]);\n\n  return {\n    loading,\n    error,\n    hasAccepted: acceptance?.accepted ?? false,\n    acceptance,\n    accept,\n    refresh,\n  };\n}\n\ninterface UseCreatorAgreementResult {\n  loading: boolean;\n  error: string | null;\n  hasAccepted: boolean;\n  acceptedAt: string | null;\n  version: string | null;\n  accept: () => Promise<boolean>;\n  refresh: () => Promise<void>;\n}\n\n/**\n * Specifically check creator agreement status.\n * Used to gate publishing functionality.\n */\nexport function useCreatorAgreement(): UseCreatorAgreementResult {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [status, setStatus] = useState<{\n    has_accepted: boolean;\n    accepted_at: string | null;\n    version: string | null;\n  } | null>(null);\n\n  const refresh = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const result = await getCreatorAgreementStatus();\n      setStatus(result);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to check creator agreement');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    refresh();\n  }, [refresh]);\n\n  const accept = useCallback(async (): Promise<boolean> => {\n    try {\n      await acceptLegalDocument('creator_agreement');\n      await refresh();\n      return true;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to accept creator agreement');\n      return false;\n    }\n  }, [refresh]);\n\n  return {\n    loading,\n    error,\n    hasAccepted: status?.has_accepted ?? false,\n    acceptedAt: status?.accepted_at ?? null,\n    version: status?.version ?? null,\n    accept,\n    refresh,\n  };\n}\n\ninterface UseAllAcceptancesResult {\n  loading: boolean;\n  error: string | null;\n  acceptances: Record<DocumentType, AcceptanceStatus> | null;\n  pendingTypes: DocumentType[];\n  refresh: () => Promise<void>;\n}\n\n/**\n * Check acceptance status for all document types.\n */\nexport function useAllLegalAcceptances(): UseAllAcceptancesResult {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [acceptances, setAcceptances] = useState<Record<DocumentType, AcceptanceStatus> | null>(null);\n\n  const refresh = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const result = await checkAllAcceptances();\n      setAcceptances(result);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to check acceptances');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    refresh();\n  }, [refresh]);\n\n  const pendingTypes: DocumentType[] = acceptances\n    ? (Object.entries(acceptances)\n        .filter(([_, status]) => !status.accepted && status.version !== null)\n        .map(([type]) => type as DocumentType))\n    : [];\n\n  return {\n    loading,\n    error,\n    acceptances,\n    pendingTypes,\n    refresh,\n  };\n}\n\nexport default useLegalAcceptance;\n","/**\n * Creator Agreement Modal - shown before first publish.\n * User must accept all terms before they can publish content.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { X, FileText, DollarSign, Users, Shield } from 'lucide-react';\nimport { acceptLegalDocument, getCreatorAgreementStatus } from '../../services/legalApi';\n\ninterface CreatorAgreementModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onAccept: () => void;\n}\n\nexport function CreatorAgreementModal({ isOpen, onClose, onAccept }: CreatorAgreementModalProps) {\n  const [hasScrolled, setHasScrolled] = useState(false);\n  const [checkboxes, setCheckboxes] = useState({\n    ownRights: false,\n    feeStructure: false,\n    contentPolicy: false,\n    collaborationTerms: false,\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const allChecked = Object.values(checkboxes).every(Boolean);\n\n  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    const target = e.target as HTMLDivElement;\n    const scrollPercentage = (target.scrollTop + target.clientHeight) / target.scrollHeight;\n    if (scrollPercentage > 0.9) {\n      setHasScrolled(true);\n    }\n  };\n\n  const handleAccept = async () => {\n    if (!allChecked) return;\n\n    setLoading(true);\n    setError('');\n\n    try {\n      await acceptLegalDocument('creator_agreement');\n      onAccept();\n    } catch (err) {\n      setError('Failed to record acceptance. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div style={{\n      position: 'fixed',\n      inset: 0,\n      zIndex: 1000,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      background: 'rgba(0, 0, 0, 0.8)',\n      padding: 20,\n    }}>\n      <div style={{\n        background: 'var(--bg, #0f172a)',\n        borderRadius: 12,\n        border: '1px solid var(--border, #334155)',\n        maxWidth: 600,\n        width: '100%',\n        maxHeight: '90vh',\n        display: 'flex',\n        flexDirection: 'column',\n      }}>\n        {/* Header */}\n        <div style={{\n          padding: '20px 24px',\n          borderBottom: '1px solid var(--border, #334155)',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n        }}>\n          <div>\n            <h2 style={{\n              fontSize: 20,\n              fontWeight: 700,\n              color: 'var(--text, #e5e7eb)',\n              margin: 0,\n            }}>\n              Creator Agreement\n            </h2>\n            <p style={{\n              fontSize: 14,\n              color: 'var(--text-muted, #94a3b8)',\n              margin: '4px 0 0 0',\n            }}>\n              Please review and accept before publishing\n            </p>\n          </div>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'none',\n              border: 'none',\n              padding: 8,\n              cursor: 'pointer',\n              color: 'var(--text-muted, #94a3b8)',\n            }}\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Scrollable Content */}\n        <div\n          onScroll={handleScroll}\n          style={{\n            padding: 24,\n            overflowY: 'auto',\n            flex: 1,\n          }}\n        >\n          {/* Key Points Summary */}\n          <div style={{\n            display: 'grid',\n            gap: 16,\n            marginBottom: 24,\n          }}>\n            <div style={{ display: 'flex', gap: 12, alignItems: 'flex-start' }}>\n              <FileText size={20} style={{ color: 'var(--accent, #f59e0b)', flexShrink: 0, marginTop: 2 }} />\n              <div>\n                <div style={{ fontWeight: 600, color: 'var(--text, #e5e7eb)', marginBottom: 4 }}>\n                  You Retain Ownership\n                </div>\n                <div style={{ fontSize: 14, color: 'var(--text-muted, #94a3b8)' }}>\n                  You keep full ownership of your content. We only get a license to display and\n                  distribute it on the platform.\n                </div>\n              </div>\n            </div>\n\n            <div style={{ display: 'flex', gap: 12, alignItems: 'flex-start' }}>\n              <DollarSign size={20} style={{ color: 'var(--accent, #f59e0b)', flexShrink: 0, marginTop: 2 }} />\n              <div>\n                <div style={{ fontWeight: 600, color: 'var(--text, #e5e7eb)', marginBottom: 4 }}>\n                  Platform Fees\n                </div>\n                <div style={{ fontSize: 14, color: 'var(--text-muted, #94a3b8)' }}>\n                  15% for sales under $10, 12% for $10-$50, 10% for over $50.\n                  Fees may change with 30 days' notice.\n                </div>\n              </div>\n            </div>\n\n            <div style={{ display: 'flex', gap: 12, alignItems: 'flex-start' }}>\n              <Users size={20} style={{ color: 'var(--accent, #f59e0b)', flexShrink: 0, marginTop: 2 }} />\n              <div>\n                <div style={{ fontWeight: 600, color: 'var(--text, #e5e7eb)', marginBottom: 4 }}>\n                  Collaboration Terms\n                </div>\n                <div style={{ fontSize: 14, color: 'var(--text-muted, #94a3b8)' }}>\n                  Revenue splits are binding once published. Changes require unanimous consent\n                  from all collaborators.\n                </div>\n              </div>\n            </div>\n\n            <div style={{ display: 'flex', gap: 12, alignItems: 'flex-start' }}>\n              <Shield size={20} style={{ color: 'var(--accent, #f59e0b)', flexShrink: 0, marginTop: 2 }} />\n              <div>\n                <div style={{ fontWeight: 600, color: 'var(--text, #e5e7eb)', marginBottom: 4 }}>\n                  Content Responsibility\n                </div>\n                <div style={{ fontSize: 14, color: 'var(--text-muted, #94a3b8)' }}>\n                  You must have rights to publish your content and comply with our Content Policy.\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <p style={{\n            fontSize: 14,\n            color: 'var(--text-muted, #94a3b8)',\n            marginBottom: 24,\n          }}>\n            Read the full{' '}\n            <Link\n              to=\"/legal/creator-agreement\"\n              target=\"_blank\"\n              style={{ color: 'var(--accent, #f59e0b)' }}\n            >\n              Creator Agreement\n            </Link>\n            {' '}for complete details.\n          </p>\n\n          {/* Checkboxes */}\n          <div style={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 12,\n            padding: 16,\n            background: 'var(--bg-secondary, #1e293b)',\n            borderRadius: 8,\n          }}>\n            <label style={{ display: 'flex', gap: 12, cursor: 'pointer' }}>\n              <input\n                type=\"checkbox\"\n                checked={checkboxes.ownRights}\n                onChange={(e) => setCheckboxes(prev => ({ ...prev, ownRights: e.target.checked }))}\n                style={{ marginTop: 2 }}\n              />\n              <span style={{ fontSize: 14, color: 'var(--text, #e5e7eb)' }}>\n                I own or have rights to the content I publish\n              </span>\n            </label>\n\n            <label style={{ display: 'flex', gap: 12, cursor: 'pointer' }}>\n              <input\n                type=\"checkbox\"\n                checked={checkboxes.feeStructure}\n                onChange={(e) => setCheckboxes(prev => ({ ...prev, feeStructure: e.target.checked }))}\n                style={{ marginTop: 2 }}\n              />\n              <span style={{ fontSize: 14, color: 'var(--text, #e5e7eb)' }}>\n                I understand the fee structure (15% / 12% / 10%)\n              </span>\n            </label>\n\n            <label style={{ display: 'flex', gap: 12, cursor: 'pointer' }}>\n              <input\n                type=\"checkbox\"\n                checked={checkboxes.contentPolicy}\n                onChange={(e) => setCheckboxes(prev => ({ ...prev, contentPolicy: e.target.checked }))}\n                style={{ marginTop: 2 }}\n              />\n              <span style={{ fontSize: 14, color: 'var(--text, #e5e7eb)' }}>\n                I agree to the{' '}\n                <Link\n                  to=\"/legal/content-policy\"\n                  target=\"_blank\"\n                  style={{ color: 'var(--accent, #f59e0b)' }}\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  Content Policy\n                </Link>\n              </span>\n            </label>\n\n            <label style={{ display: 'flex', gap: 12, cursor: 'pointer' }}>\n              <input\n                type=\"checkbox\"\n                checked={checkboxes.collaborationTerms}\n                onChange={(e) => setCheckboxes(prev => ({ ...prev, collaborationTerms: e.target.checked }))}\n                style={{ marginTop: 2 }}\n              />\n              <span style={{ fontSize: 14, color: 'var(--text, #e5e7eb)' }}>\n                I accept the collaboration terms\n              </span>\n            </label>\n          </div>\n\n          {error && (\n            <p style={{\n              marginTop: 16,\n              fontSize: 14,\n              color: '#ef4444',\n            }}>\n              {error}\n            </p>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div style={{\n          padding: '16px 24px',\n          borderTop: '1px solid var(--border, #334155)',\n          display: 'flex',\n          justifyContent: 'flex-end',\n          gap: 12,\n        }}>\n          <button\n            onClick={onClose}\n            style={{\n              padding: '10px 20px',\n              borderRadius: 8,\n              border: '1px solid var(--border, #334155)',\n              background: 'transparent',\n              color: 'var(--text, #e5e7eb)',\n              fontSize: 14,\n              fontWeight: 500,\n              cursor: 'pointer',\n            }}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleAccept}\n            disabled={!allChecked || loading}\n            style={{\n              padding: '10px 20px',\n              borderRadius: 8,\n              border: 'none',\n              background: allChecked ? 'var(--accent, #f59e0b)' : 'var(--bg-secondary, #1e293b)',\n              color: allChecked ? '#000' : 'var(--text-muted, #94a3b8)',\n              fontSize: 14,\n              fontWeight: 600,\n              cursor: allChecked && !loading ? 'pointer' : 'not-allowed',\n              opacity: loading ? 0.7 : 1,\n            }}\n          >\n            {loading ? 'Accepting...' : 'Accept & Continue'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CreatorAgreementModal;\n","/**\n * Creator Agreement Gate component.\n * Wraps publishing functionality and ensures user has accepted the creator agreement.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useCreatorAgreement } from '../../hooks/useLegalAcceptance';\nimport { CreatorAgreementModal } from './CreatorAgreementModal';\n\ninterface CreatorAgreementGateProps {\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n  onAccepted?: () => void;\n}\n\n/**\n * Wraps content that requires creator agreement acceptance.\n * Shows modal if not accepted, otherwise renders children.\n */\nexport function CreatorAgreementGate({\n  children,\n  fallback,\n  onAccepted,\n}: CreatorAgreementGateProps) {\n  const { loading, hasAccepted, refresh } = useCreatorAgreement();\n  const [showModal, setShowModal] = useState(false);\n\n  // Show modal if not accepted\n  useEffect(() => {\n    if (!loading && !hasAccepted) {\n      setShowModal(true);\n    }\n  }, [loading, hasAccepted]);\n\n  const handleAccept = () => {\n    setShowModal(false);\n    refresh();\n    onAccepted?.();\n  };\n\n  const handleClose = () => {\n    setShowModal(false);\n    // If user closes without accepting, they'll see the fallback\n  };\n\n  if (loading) {\n    return (\n      <div style={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        padding: 48,\n        color: 'var(--text-muted, #94a3b8)',\n      }}>\n        Checking agreement status...\n      </div>\n    );\n  }\n\n  // If accepted, render children\n  if (hasAccepted) {\n    return <>{children}</>;\n  }\n\n  // Show modal + fallback while not accepted\n  return (\n    <>\n      <CreatorAgreementModal\n        isOpen={showModal}\n        onClose={handleClose}\n        onAccept={handleAccept}\n      />\n      {fallback || (\n        <div style={{\n          padding: 48,\n          textAlign: 'center',\n          background: 'var(--bg-secondary, #1e293b)',\n          borderRadius: 12,\n          margin: 24,\n        }}>\n          <h2 style={{\n            fontSize: 20,\n            fontWeight: 700,\n            color: 'var(--text, #e5e7eb)',\n            marginBottom: 12,\n          }}>\n            Creator Agreement Required\n          </h2>\n          <p style={{\n            fontSize: 14,\n            color: 'var(--text-muted, #94a3b8)',\n            marginBottom: 24,\n          }}>\n            You need to accept the Creator Agreement before publishing content.\n          </p>\n          <button\n            onClick={() => setShowModal(true)}\n            style={{\n              padding: '12px 24px',\n              borderRadius: 8,\n              border: 'none',\n              background: 'var(--accent, #f59e0b)',\n              color: '#000',\n              fontSize: 14,\n              fontWeight: 600,\n              cursor: 'pointer',\n            }}\n          >\n            Review Creator Agreement\n          </button>\n        </div>\n      )}\n    </>\n  );\n}\n\n/**\n * Hook to check and prompt for creator agreement.\n * Useful for programmatic checks before publishing.\n */\nexport function useCreatorAgreementGate() {\n  const { loading, hasAccepted, accept, refresh } = useCreatorAgreement();\n  const [showModal, setShowModal] = useState(false);\n  const [onAcceptCallback, setOnAcceptCallback] = useState<(() => void) | null>(null);\n\n  const requireAgreement = (onAccept?: () => void): boolean => {\n    if (hasAccepted) {\n      onAccept?.();\n      return true;\n    }\n\n    // Store callback and show modal\n    if (onAccept) {\n      setOnAcceptCallback(() => onAccept);\n    }\n    setShowModal(true);\n    return false;\n  };\n\n  const handleAccept = async () => {\n    const success = await accept();\n    if (success) {\n      setShowModal(false);\n      onAcceptCallback?.();\n      setOnAcceptCallback(null);\n    }\n  };\n\n  const handleClose = () => {\n    setShowModal(false);\n    setOnAcceptCallback(null);\n  };\n\n  return {\n    loading,\n    hasAccepted,\n    requireAgreement,\n    modal: showModal ? (\n      <CreatorAgreementModal\n        isOpen={showModal}\n        onClose={handleClose}\n        onAccept={handleAccept}\n      />\n    ) : null,\n  };\n}\n\nexport default CreatorAgreementGate;\n","import React, { useEffect, useState } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\nimport CreateWizard from '../components/CreateWizard/CreateWizard';\nimport BookEditor from '../components/BookEditor/BookEditor';\nimport { CreatorAgreementGate } from '../components/legal/CreatorAgreementGate';\nimport { PenLine, Users } from 'lucide-react';\n\nexport default function StudioPage() {\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const [editContentId, setEditContentId] = useState<number | null>(null);\n  const [editBookProjectId, setEditBookProjectId] = useState<number | null>(null);\n  const [showChoice, setShowChoice] = useState(true);\n\n  useEffect(() => {\n    const contentIdParam = searchParams.get('editContent');\n    const bookProjectParam = searchParams.get('editBookProject');\n    const modeParam = searchParams.get('mode');\n    console.log('[StudioPage] editContent param:', contentIdParam);\n    console.log('[StudioPage] editBookProject param:', bookProjectParam);\n\n    if (bookProjectParam) {\n      // Edit book project directly by ID\n      setEditBookProjectId(parseInt(bookProjectParam, 10));\n      setEditContentId(null);\n      setShowChoice(false);\n    } else if (contentIdParam) {\n      setEditContentId(parseInt(contentIdParam, 10));\n      setEditBookProjectId(null);\n      setShowChoice(false);\n    } else if (modeParam) {\n      // If mode is set (solo or collab), skip choice screen\n      setShowChoice(false);\n    } else {\n      setEditContentId(null);\n      setEditBookProjectId(null);\n      setShowChoice(true);\n    }\n  }, [searchParams]);\n\n  // If editing existing content or book project, show BookEditor directly\n  // BUT: Don't show BookEditor if we're in the mintContent flow\n  const mintContentParam = searchParams.get('mintContent');\n  const modeParam = searchParams.get('mode');\n  console.log('[StudioPage] mintContent param:', mintContentParam);\n  console.log('[StudioPage] editContentId:', editContentId);\n  console.log('[StudioPage] editBookProjectId:', editBookProjectId);\n\n  if ((editContentId || editBookProjectId) && !mintContentParam) {\n    return (\n      <CreatorAgreementGate>\n        <div style={{\n          width: '100%',\n          maxWidth: 'none',\n          height: 'calc(100vh - 80px)', // Account for header\n          padding: '0 24px',\n          overflow: 'hidden',\n        }}>\n          <BookEditor\n            existingContentId={editContentId || undefined}\n            existingBookProjectId={editBookProjectId || undefined}\n            onPublish={(contentId) => {\n              // After preparing chapter/book, navigate to minting wizard\n              console.log('[StudioPage] onPublish called with contentId:', contentId);\n              console.log('[StudioPage] Navigating to /studio?mintContent=' + contentId);\n              navigate(`/studio?mintContent=${contentId}`);\n            }}\n            onBack={() => {\n              // Clear the query param and return to normal studio\n              navigate('/studio');\n              setEditContentId(null);\n              setEditBookProjectId(null);\n            }}\n          />\n        </div>\n      </CreatorAgreementGate>\n    );\n  }\n\n  // Show choice screen: Solo vs Collaboration\n  if (showChoice && !modeParam && !mintContentParam) {\n    return (\n      <div className=\"page create-choice-container\">\n        <div className=\"create-choice-header\">\n          <h1>Create New Content</h1>\n          <p>Choose how you want to create your content</p>\n        </div>\n\n        <div className=\"create-choice-grid\">\n          {/* Solo Content */}\n          <div\n            className=\"create-choice-card solo\"\n            onClick={() => navigate('/studio?mode=solo')}\n          >\n            <div className=\"create-choice-icon solo\">\n              <PenLine size={32} />\n            </div>\n            <h3>Create Solo</h3>\n            <p>\n              Work independently on your own content. Perfect for individual creators who want full control.\n            </p>\n            <ul>\n              <li>100% creative control</li>\n              <li>100% revenue</li>\n              <li>Quick to publish</li>\n            </ul>\n          </div>\n\n          {/* Collaborative Content */}\n          <div\n            className=\"create-choice-card collab\"\n            onClick={() => navigate('/collaborations')}\n          >\n            <div className=\"create-choice-icon collab\">\n              <Users size={32} />\n            </div>\n            <h3>Start Collaboration</h3>\n            <p>\n              Work with other creators. Combine skills and split revenue transparently.\n            </p>\n            <ul>\n              <li>Invite multiple creators</li>\n              <li>Set roles & permissions</li>\n              <li>Fair revenue splits</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <CreatorAgreementGate>\n      <div className=\"page\" style={{ width: '100%', maxWidth: 'none', padding: '16px' }}>\n        <CreateWizard />\n      </div>\n    </CreatorAgreementGate>\n  );\n}\n"],"names":["Layers","createLucideIcon","d","key","PenLine","Tag","cx","cy","r","fill","TypeSelect","onSelect","card","t","icon","title","desc","disabled","comingSoon","jsxs","className","onClick","children","jsx","style","color","BookOpen","size","Image","Video","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","SuppressedError","COMMON_MIME_TYPES","Map","toFileWithPath","file","path","h","f","name","lastIndexOf","type","ext","split","pop","toLowerCase","get","Object","defineProperty","writable","configurable","enumerable","withMimeType","webkitRelativePath","p","length","setObjProp","FILES_TO_IGNORE","isObject","v","noIgnoredFiles","files","filter","indexOf","fromList","items","i","push","toFilePromises","item","webkitGetAsEntry","fromDataTransferItem","entry","isDirectory","fromDirEntry","flatten","reduce","acc","Array","isArray","this","_a","globalThis","isSecureContext","getAsFileSystemHandle","Error","getFile","handle","getAsFile","fullPath","fromEntry","fwp","err","fromFileEntry","reader","createReader","entries","readEntries","batch","all","map","es","default","acceptedFiles","acceptedFilesArray","fileName","mimeType","baseMimeType","replace","some","validType","trim","charAt","endsWith","_toConsumableArray","arr","_arrayLikeToArray","_arrayWithoutHoles","iter","Symbol","iterator","from","_iterableToArray","_unsupportedIterableToArray","TypeError","_nonIterableSpread","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","_objectSpread","target","arguments","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","obj","_slicedToArray","_arrayWithHoles","_i","_s","_e","_arr","_n","_d","call","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","prototype","toString","slice","constructor","test","len","arr2","accepts","_accepts","getInvalidTypeRejectionErr","acceptArr","msg","concat","join","code","message","getTooLargeRejectionErr","maxSize","getTooSmallRejectionErr","minSize","TOO_MANY_FILES_REJECTION","fileAccepted","accept","isAcceptable","fileMatchSize","isDefined","isPropagationStopped","event","cancelBubble","isEvtWithFiles","dataTransfer","types","onDocumentDragOver","preventDefault","composeEventHandlers","_len","fns","_key","_len2","args","_key2","fn","isMIMEType","isExt","_excluded","_excluded2","_excluded3","_excluded4","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","sourceSymbolKeys","propertyIsEnumerable","Dropzone","forwardRef","_ref","ref","_useDropzone","useDropzone","open","props","useImperativeHandle","React","createElement","Fragment","displayName","defaultProps","getFilesFromEvent","evt","dt","kind","getDataTransferFiles","isChangeEvt","getInputFiles","every","handles","getFsHandleFiles","Infinity","multiple","maxFiles","preventDropOnDocument","noClick","noKeyboard","noDrag","noDragEventsBubbling","validator","useFsAccessApi","autoFocus","propTypes","PropTypes","func","objectOf","arrayOf","string","bool","number","onFileDialogCancel","onFileDialogOpen","onDragEnter","onDragLeave","onDragOver","onDrop","onDropAccepted","onDropRejected","onError","initialState","isFocused","isFileDialogActive","isDragActive","isDragAccept","isDragReject","fileRejections","_defaultProps$props","acceptAttr","useMemo","a","_ref6","_ref7","acceptPropAsAcceptAttr","pickerTypes","description","_ref2","_ref3","ok","agg","_ref4","_ref5","pickerOptionsFromAccept","onFileDialogOpenCb","noop","onFileDialogCancelCb","rootRef","useRef","inputRef","_useReducer2","useReducer","reducer","state","dispatch","fsAccessApiWorksRef","window","onWindowFocus","current","setTimeout","useEffect","addEventListener","removeEventListener","dragTargetsRef","onDocumentDrop","contains","document","focus","onErrCb","useCallback","onDragEnterCb","persist","stopPropagation","fileCount","accepted","sizeMatch","customErrors","allFilesAccepted","catch","onDragOverCb","hasFiles","dropEffect","_unused","onDragLeaveCb","targets","targetIdx","splice","setFiles","_fileAccepted2","acceptError","_fileMatchSize2","sizeError","errors","onDropCb","openFileDialog","opts","showOpenFilePicker","DOMException","ABORT_ERR","SECURITY_ERR","isSecurityError","click","onKeyDownCb","isEqualNode","keyCode","onFocusCb","onBlurCb","onClickCb","userAgent","navigator","isIe","isEdge","isIeOrEdge","composeHandler","composeKeyboardHandler","composeDragHandler","getRootProps","_ref2$refKey","refKey","role","onKeyDown","onFocus","onBlur","rest","tabIndex","onInputElementClick","getInputProps","_ref3$refKey","onChange","border","clip","clipPath","height","margin","overflow","padding","position","width","whiteSpace","action","CreateStep","onReady","registerSubmit","showNextButton","setTitle","useState","textHtml","setTextHtml","setFile","setMsg","display","gap","placeholder","ReactQuill","theme","borderRadius","textAlign","background","justifyContent","alignItems","fontSize","CustomizeStep","onNext","teaser","setTeaser","watermark","setWatermark","price","setPrice","editions","setEditions","authorsNote","setAuthorsNote","splits","latest","teaserPercent","tagIds","wordCount","w","isOverLimit","min","max","parseInt","checked","gridTemplateColumns","parseFloat","minHeight","resize","fontFamily","TagSelector","selectedIds","maxTags","tags","setTags","searchQuery","setSearchQuery","loading","setLoading","creating","setCreating","showAllTags","setShowAllTags","fetch","API_URL","credentials","json","data","tagsArray","results","finally","suggestedTags","category","filteredTags","query","includes","id","groupedTags","genre","mood","toggleTag","addCustomTag","async","existing","find","csrf","res","csrfToken","fetchCsrf","method","headers","body","JSON","stringify","newTag","selectedTags","isAtLimit","tag","X","Search","Plus","ChevronDown","ChevronUp","categoryTags","toUpperCase","ConfigureStep","contentId","authorName","setSelectedTags","potentialGross","platformFee","potentialEarnings","toFixed","CopyrightPreview","MintStep","onMint","agree","setAgree","feePct","setFeePct","contentDetails","setContentDetails","fee","teaser_link","content_type","gross","Number","netEarnings","FileText","src","alt","DollarSign","href","rel","Rocket","COLORS","ConfettiEffect","pieces","setPieces","newPieces","_","left","Math","random","delay","duration","piece","animationDelay","animationDuration","backgroundColor","ShareStep","minted","onPublish","url","location","origin","setOpen","ctype","setCtype","copied","setCopied","showConfetti","setShowConfetti","contentTitle","setContentTitle","teaserUrl","timer","clearTimeout","handleCopy","clipboard","writeText","Check","strokeWidth","text","twitterUrl","encodeURIComponent","Twitter","Copy","ExternalLink","readOnly","Eye","PreviewModal","onClose","contentType","StepIndicator","steps","currentStep","maxStep","onStepClick","label","isActive","isCompleted","canClick","cursor","getFreshCsrfToken","response","API_BASE","error","bookApi","createProject","statusText","getProjects","getProject","updateProject","uploadCoverImage","imageFile","formData","FormData","append","deleteProject","createChapter","projectId","content_html","updateChapter","deleteChapter","publishChapter","chapterId","publishBook","getProjectByContentId","prepareChapterForMint","prepareBookForMint","ChapterList","chapters","selectedChapterId","onSelectChapter","onAddChapter","totalWords","sum","ch","flex","flexDirection","flexShrink","fontWeight","marginTop","overflowY","scrollbarWidth","scrollbarColor","chapter","borderLeft","transition","minWidth","order","lineHeight","is_published","textTransform","letterSpacing","marginLeft","ChapterManagement","onStatusChange","status","setStatus","showRemoveModal","setShowRemoveModal","showDelistModal","setShowDelistModal","reason","setReason","actionLoading","setActionLoading","setMessage","fetchRemovalStatus","Loader","animation","marginBottom","CheckCircle","XCircle","is_listed","EyeOff","purchase_count","is_collaborative","Info","delisted_at","delisted_by","Date","toLocaleDateString","delisted_reason","pending_delist_request","AlertTriangle","requested_by","approvals_count","total_collaborators","can_remove_completely","Trash2","has_sales","can_delist","inset","placeItems","zIndex","maxWidth","required","opacity","ChapterEditor","onUpdateChapter","saving","lastSaved","showManagement","onManagementChange","content","setContent","synopsis","setSynopsis","showManagementPanel","setShowManagementPanel","showSynopsis","setShowSynopsis","isMobile","setIsMobile","innerWidth","handleResize","isSyncingFromProps","lastLoadedChapterId","requestAnimationFrame","isMinted","outline","transform","maxLength","toLocaleString","formatTimeAgo","modules","toolbar","header","list","date","seconds","floor","getTime","minutes","hours","PublishModal","project","currentChapter","publishType","setPublishType","currentChapterWords","top","right","bottom","maxHeight","BookEditor","onBack","existingContentId","existingBookProjectId","navigate","useNavigate","setProject","setChapters","setSelectedChapterId","setSaving","setLastSaved","showPublishModal","setShowPublishModal","setError","drawerOpen","setDrawerOpen","settingsOpen","setSettingsOpen","mobile","initializeProject","existingProject","firstUnminted","target_chapter_id","_b","newProject","_c","handleAddChapter","newChapter","prevChapters","handleDeleteChapter","confirm","handleUpdateProjectTitle","updatedProject","selectedChapter","canDeleteProject","handleDeleteProject","confirmMessage","CoverSynopsisSection","cover_image_url","objectFit","Menu","Settings","float","updateData","updatedChapter","content_id","SoloComicEditor","existingProjectId","currentUser","setCurrentUser","publishing","setPublishing","editingTitle","setEditingTitle","titleValue","setTitleValue","savingTitle","setSavingTitle","showDeleteConfirm","setShowDeleteConfirm","deleting","setDeleting","uploadingCover","setUploadingCover","showCoverModal","setShowCoverModal","coverInputRef","isInitializingRef","hasInitializedRef","authRes","authData","authenticated","user","username","display_name","collaborationApi","getCollaborativeProject","createCollaborativeProject","is_solo","handleSaveTitle","newTitle","updated","updateCollaborativeProject","getCsrfToken","Loader2","textDecoration","borderBottom","ArrowLeft","onMouseEnter","currentTarget","onMouseLeave","Pencil","cover_image","errData","CollaborativeComicEditor","onProjectUpdate","deleteCollaborativeProject","FULL_FLOW_STEPS","PUBLISH_FLOW_STEPS","CreateWizard","searchParams","useSearchParams","flowMode","setFlowMode","setStep","setPayload","setContentId","setMaxStep","showBookEditor","setShowBookEditor","showComicEditor","setShowComicEditor","comicProjectId","setComicProjectId","setMinted","mintContentParam","contentIdFromParam","isNaN","typeParam","projectIdParam","doMint","royalties","submitCurrent","setSubmitCurrent","collectCustomize","setCollectCustomize","registerCustomize","handleBookPublish","publishedContentId","handleComicPublish","saveCustomizations","c","price_usd","teaser_percent","watermark_preview","authors_note","tag_ids","renderFullFlow","renderPublishFlow","form","mapped","pk","createContent","acceptLegalDocument","documentType","csrfRes","csrfData","document_type","useCreatorAgreement","refresh","getCreatorAgreementStatus","hasAccepted","has_accepted","acceptedAt","accepted_at","version","CreatorAgreementModal","isOpen","onAccept","hasScrolled","setHasScrolled","checkboxes","setCheckboxes","ownRights","feeStructure","contentPolicy","collaborationTerms","allChecked","values","Boolean","onScroll","scrollTop","clientHeight","scrollHeight","Users","Shield","Link","to","prev","borderTop","CreatorAgreementGate","fallback","onAccepted","showModal","setShowModal","StudioPage","editContentId","setEditContentId","editBookProjectId","setEditBookProjectId","showChoice","setShowChoice","contentIdParam","bookProjectParam","modeParam"],"mappings":"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","x_google_ignoreList":[0,1,2,4,5,6,7,8,9]}